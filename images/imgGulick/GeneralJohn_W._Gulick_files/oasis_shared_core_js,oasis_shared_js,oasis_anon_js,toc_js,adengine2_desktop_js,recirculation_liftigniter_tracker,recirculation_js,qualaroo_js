(function(context){'use strict';var sloth=function(){var slice=Array.prototype.slice,wTop,wBottom,undef,debounce=(function(element){return element?parseInt(element.getAttribute('data-sloth-debounce'),10):200;})(context.document.querySelector('script[data-sloth-debounce]')),delegate=context.setTimeout,branches=[],Branch=function(element,threshold,callback){this.elem=element;this.threshold=threshold;this.callback=function(){callback(element);};},addEvent=function(){context.addEventListener('scroll',execute);},removeEvent=function(){context.removeEventListener('scroll',execute);},lock=0,execute=function(force){var i=branches.length,branch;if(debounce){removeEvent();}if(i&&(force||!lock)){if(debounce){lock=delegate(function(){lock=0;addEvent();},debounce);}wTop=context.scrollY||context.pageYOffset;wBottom=wTop+context.innerHeight;while(i--){branch=branches[i];if(branch.isVisible()){delegate(branch.callback,0);branches.splice(i,1);}}}};Branch.prototype.isVisible=function(){var elem=this.
elem,mayBeVisible=elem.offsetHeight||elem.offsetWidth,height,threshold,top,bottom;if(mayBeVisible){threshold=this.threshold;height=elem.offsetHeight;top=(elem.offsetTop||elem.y||0)-threshold;bottom=top+height+threshold;return wBottom>=top&&wTop<=bottom;}return false;};Branch.prototype.compare=function(element){return this.elem===element;};return function(params){if(params){var elements=params.on,prune=params.off,threshold=params.threshold!==undef?params.threshold:100,callback=params.callback,i;if(elements&&callback){if(elements.length!==undef){elements=slice.call(elements);i=elements.length;while(i--){branches.push(new Branch(elements[i],threshold,callback));}}else{branches.push(new Branch(elements,threshold,callback));}}if(prune){if(prune.length!==undef){prune=slice.call(prune);i=prune.length;while(i--){branches=branches.filter(function(branch){return!branch.compare(prune[i]);});}}else{branches=branches.filter(function(branch){return!branch.compare(prune);});}}}execute(true);};};if(
context.define&&context.define.amd){context.define('sloth',sloth);}else{context.sloth=sloth();}})(this);;var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(exports){exports.name="mustache.js";exports.version="0.5.0-dev";exports.tags=["{{","}}"];exports.parse=parse;exports.compile=compile;exports.render=render;exports.clearCache=clearCache;exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send==="function"){send(result);}else{return result;}};var _toString=Object.prototype.toString;var _isArray=Array.isArray;var _forEach=Array.prototype.forEach;var _trim=String.prototype.trim;var isArray;if(_isArray){isArray=_isArray;}else{isArray=function(obj){return _toString.call(obj)==="[object Array]";};}var forEach;if(_forEach){forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope);};}else{forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i){callback.call(scope,obj[i],i,obj);}
};}var spaceRe=/^\s*$/;function isWhitespace(string){return spaceRe.test(string);}var trim;if(_trim){trim=function(string){return string==null?"":_trim.call(string);};}else{var trimLeft,trimRight;if(isWhitespace("\xA0")){trimLeft=/^\s+/;trimRight=/\s+$/;}else{trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"");};}var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;'};function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s;});}function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end);var c;for(var i=0,len=context.length;i<len;++i){c=i+start+1;context[i]=(c===line?" >> ":"    ")+context[i];}e.template=template;e.line=line;e.file=file;e.message=[file+":"+line,context.join("\n"),"",e.message].join
("\n");return e;}function lookup(name,stack,defaultValue){if(name==="."){return stack[stack.length-1];}var names=name.split(".");var lastIndex=names.length-1;var target=names[lastIndex];var value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0);context=stack[--i];j=0;while(j<lastIndex){context=context[names[j++]];if(context==null){break;}localStack.push(context);}if(context&&typeof context==="object"&&target in context){value=context[target];break;}}if(typeof value==="function"){value=value.call(localStack[localStack.length-1]);}if(value==null){return defaultValue;}return value;}function renderSection(name,stack,callback,inverted){var buffer="";var value=lookup(name,stack);if(inverted){if(value==null||value===false||(isArray(value)&&value.length===0)){buffer+=callback();}}else if(isArray(value)){forEach(value,function(value){stack.push(value);buffer+=callback();stack.pop();});}else if(typeof value==="object"){stack.push(value);buffer+=callback();stack.pop();}else
if(typeof value==="function"){var scope=stack[stack.length-1];var scopedRender=function(template){return render(template,scope);};buffer+=value.call(scope,callback(),scopedRender)||"";}else if(value){buffer+=callback();}return buffer;}function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1];var code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var spaces=[],hasTag=!1,nonSpace=!1;var stripSpace=function(){if(hasTag&&!nonSpace&&!options.space){while(spaces.length){code.splice(spaces.pop(),1);}}else{spaces=[];}hasTag=!1;nonSpace=!1;};var sectionStack=[],updateLine,nextOpenTag,nextCloseTag;var setTags=function(source){tags=trim(source).split(/\s+/);nextOpenTag=tags[0];nextCloseTag=tags[tags.length-1];};var includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];','\nif (partial) {',
'\n  buffer += render(partial,stack[stack.length - 1],partials);','\n}','\nbuffer += "');};var openSection=function(source,inverted){var name=trim(source);if(name===""){throw debug(new Error("Section name may not be empty"),template,line,options.file);}sectionStack.push({name:name,inverted:inverted});code.push('";',updateLine,'\nvar name = "'+name+'";','\nvar callback = (function () {','\n  return function () {','\n    var buffer = "";','\nbuffer += "');};var openInvertedSection=function(source){openSection(source,true);};var closeSection=function(source){var name=trim(source);var openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName){throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);}var section=sectionStack.pop();code.push('";','\n    return buffer;','\n  };','\n})();');if(section.inverted){code.push("\nbuffer += renderSection(name,stack,callback,true);");}else{code.push(
"\nbuffer += renderSection(name,stack,callback);");}code.push('\nbuffer += "');};var sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(source)+'",stack,"");','\nbuffer += "');};var sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "');};var line=1,c,callback;for(var i=0,len=template.length;i<len;++i){if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length;c=template.substr(i,1);updateLine='\nline = '+line+';';nextOpenTag=openTag;nextCloseTag=closeTag;hasTag=!0;switch(c){case"!":i++;callback=null;break;case"=":i++;closeTag="="+closeTag;callback=setTags;break;case">":i++;callback=includePartial;break;case"#":i++;callback=openSection;break;case"^":i++;callback=openInvertedSection;break;case"/":i++;callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++;nonSpace=!0;callback=sendPlain;break;default:nonSpace=!0;callback=sendEscaped;}var end=template.
indexOf(closeTag,i);if(end===-1){throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);}var source=template.substring(i,end);if(callback){callback(source);}var n=0;while(~(n=source.indexOf("\n",n))){line++;n++;}i=end+closeTag.length-1;openTag=nextOpenTag;closeTag=nextCloseTag;}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=!0;code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length);code.push("\\n");stripSpace();line++;break;default:if(isWhitespace(c)){spaces.push(code.length);}else{nonSpace=!0;}code.push(c);}}}if(sectionStack.length!=0){throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);}stripSpace();code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");if(options.debug){if(typeof console!="undefined"&&console.log){console.log(body);}else if(
typeof print==="function"){print(body);}}return body;}function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render";var body=parse(template,options);var fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render);}catch(e){throw debug(e.error,template,e.line,options.file);}};}var _cache={};function clearCache(){_cache={};}function compile(template,options){options=options||{};if(options.cache!==false){if(!_cache[template]){_cache[template]=_compile(template,options);}return _cache[template];}return _compile(template,options);}function render(template,view,partials){return compile(template)(view,partials);}})(Mustache);(function(context){context.Mustache=Mustache;if(context.define&&context.define.amd){context.define('wikia.mustache',Mustache);}}(window));;define('wikia.browserDetect',['wikia.window'],function(win){'use strict';var
appName=win.navigator.appName,userAgent=win.navigator.userAgent,browser=null,operatingSystem=null;function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);}function isIE(){var bool=!1;if(appName==='Microsoft Internet Explorer'||(appName==='Netscape'&&userAgent.indexOf('Trident/')!==-1)){bool=!0;}return bool;}function isEdge(){return userAgent.indexOf('Edge')!==-1;}function isFirefox(){return userAgent.toLowerCase().indexOf('firefox')>-1;}function isChrome(){return userAgent.toLowerCase().indexOf('chrome')>-1;}function isIPad(){var bool=!1;if(userAgent.match(/iPad/i)!==null){bool=!0;}return bool;}function isIOS7orLower(){return!!userAgent.match(/iPad.+OS.[6,7].\d.+like.Mac.OS.+Safari/i);}function isAndroid(){return userAgent.toLowerCase().indexOf('android')>-1;}function getOS(){if(null!==operatingSystem){return operatingSystem;}operatingSystem='unknown';if(userAgent.indexOf('Win')!==-1){operatingSystem='Windows';}if(userAgent.
indexOf('Mac')!==-1){operatingSystem='OSX';}if(userAgent.indexOf('Linux')!==-1){operatingSystem='Linux';}if(userAgent.indexOf('Android')!==-1){operatingSystem='Android';}if(userAgent.indexOf('like Mac')!==-1){operatingSystem='iOS';}return operatingSystem;}function getBrowser(){if(null!==browser){return browser;}var appVersion=win.navigator.appVersion,temp,matches=userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(matches[1])){temp=/\brv[ :]+(\d+)/g.exec(userAgent)||[];browser='IE '+(temp[1]||'');return browser;}if(matches[1]==='Chrome'){temp=userAgent.match(/\b(OPR|Edge)\/(\d+)/);if(temp!==null){browser=temp.slice(1).join(' ').replace('OPR','Opera');return browser;}}matches=matches[2]?[matches[1],matches[2]]:[appName,appVersion,'-?'];temp=userAgent.match(/version\/(\d+)/i);if(temp!==null){matches.splice(1,1,temp[1]);}browser=matches.join(' ');return browser;}function getBrowserVersion(){var browserStringParts=getBrowser().split(' ');
return parseInt(browserStringParts[1],10);}return{getBrowser:getBrowser,getBrowserVersion:getBrowserVersion,getOS:getOS,isChrome:isChrome,isIE:isIE,isFirefox:isFirefox,isIPad:isIPad,isIOS7orLower:isIOS7orLower,isAndroid:isAndroid,isMobile:isMobile,isEdge:isEdge};});;(function(mw,$){function cat(pre,val,post,raw){if(val===undefined||val===null||val===''){return'';}return pre+(raw?val:mw.Uri.encode(val))+post;}var parser={strict:/^(?:([^:\/?#]+):)?(?:\/\/(?:(?:([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?([^:\/?#]*)(?::(\d*))?)?((?:[^?#\/]*\/)*[^?#]*)(?:\?([^#]*))?(?:#(.*))?/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?(?:(?:([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?([^:\/?#]*)(?::(\d*))?((?:\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?[^?#\/]*)(?:\?([^#]*))?(?:#(.*))?/},properties=['protocol','user','password','host','port','path','query','fragment'];mw.UriRelative=function(documentLocation){var defaultUri;function Uri(uri,options){options=typeof options==='object'?options:{strictMode:!!
options};options=$.extend({strictMode:!1,overrideKeys:!1},options);if(uri!==undefined&&uri!==null&&uri!==''){if(typeof uri==='string'){this.parse(uri,options);}else if(typeof uri==='object'){for(var prop in uri){if(uri.hasOwnProperty(prop)){if($.isArray(uri[prop])||$.isPlainObject(uri[prop])){this[prop]=$.extend(true,{},uri[prop]);}else{this[prop]=uri[prop];}}}if(!this.query){this.query={};}}}else{return defaultUri.clone();}if(!this.protocol){this.protocol=defaultUri.protocol;}if(!this.host){this.host=defaultUri.host;if(!this.port){this.port=defaultUri.port;}}if(this.path&&this.path.charAt(0)!=='/'){throw new Error('Bad constructor arguments');}if(!(this.protocol&&this.host&&this.path)){throw new Error('Bad constructor arguments');}}Uri.encode=function(s){return encodeURIComponent(s).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');};Uri.decode=function(s){return decodeURIComponent(s.replace(/\+/g,'%20'));}
;Uri.prototype={parse:function(str,options){var q,uri=this,matches=parser[options.strictMode?'strict':'loose'].exec(str);$.each(properties,function(i,property){uri[property]=matches[i+1];});q={};if(uri.query){uri.query.replace(/(?:^|&)([^&=]*)(?:(=)([^&]*))?/g,function($0,$1,$2,$3){var k,v;if($1){k=Uri.decode($1);v=($2===''||$2===undefined)?null:Uri.decode($3);if(options.overrideKeys||q[k]===undefined){q[k]=v;}else{if(typeof q[k]==='string'){q[k]=[q[k]];}if($.isArray(q[k])){q[k].push(v);}}}});}this.query=q;},getUserInfo:function(){return cat('',this.user,cat(':',this.password,''));},getHostPort:function(){return this.host+cat(':',this.port,'');},getAuthority:function(){return cat('',this.getUserInfo(),'@')+this.getHostPort();},getQueryString:function(){var args=[];$.each(this.query,function(key,val){var k=Uri.encode(key),vals=$.isArray(val)?val:[val];$.each(vals,function(i,v){if(v===null){args.push(k);}else if(k==='title'){args.push(k+'='+mw.util.wikiUrlencode(v));}else{args.push(k+'='
+Uri.encode(v));}});});return args.join('&');},getRelativePath:function(){return this.path+cat('?',this.getQueryString(),'',true)+cat('#',this.fragment,'');},toString:function(){return this.protocol+'://'+this.getAuthority()+this.getRelativePath();},clone:function(){return new Uri(this);},extend:function(parameters){$.extend(this.query,parameters);return this;}};defaultUri=new Uri(documentLocation);return Uri;};if(document&&document.location&&document.location.href){mw.Uri=mw.UriRelative(document.location.href);}}(mediaWiki,jQuery));;(function(window,$,mustache){'use strict';var templates={bannerNotification:'<div class="wds-banner-notification {{typeClassName}}">'+'<div class="wds-banner-notification__icon">'+'{{{icon}}}</div>'+'<span class="wds-banner-notification__text">{{{content}}}</span>'+'<svg class="wds-icon wds-icon-tiny wds-banner-notification__close" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">'+
'<path d="M6 4.554L2.746 1.3C2.346.9 1.7.9 1.3 1.3c-.4.4-.4 1.046 0 1.446L4.554 6 1.3 9.254c-.4.4-.4 1.047 0 1.446.4.4 1.046.4 1.446 0L6 7.446 9.254 10.7c.4.4 1.047.4 1.446 0 .4-.4.4-1.046 0-1.446L7.446 6 10.7 2.746c.4-.4.4-1.047 0-1.446-.4-.4-1.046-.4-1.446 0L6 4.554z" fill-rule="evenodd"/>'+'</svg></div>',notifyIcon:'<svg class="wds-icon wds-icon-small" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M8.1 16.5l-7-13C.9 3 1 2.4 1.5 2.1c.5-.2 1.1-.1 1.4.4l7 13c.2.5.1 1.1-.4 1.4-.5.2-1.1.1-1.4-.4zM17 6.7c-2.8 2.5-6.2-.6-8.3 3.1L5.5 4.1C7.6.4 11 3.5 13.7 1L17 6.7z"/></svg>',confirmIcon:
'<svg class="wds-icon wds-icon-small" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill-rule="evenodd" d="M9 17A8 8 0 1 1 9 1a8 8 0 0 1 0 16zm-1.083-5a.73.73 0 0 0 .52-.22l4.33-4.403c.3-.305.312-.81.024-1.13a.722.722 0 0 0-1.062-.026l-3.83 3.895L6.25 8.563a.72.72 0 0 0-1.06.068.835.835 0 0 0 .063 1.13l2.165 2.04a.725.725 0 0 0 .5.2z"/></svg>',errorIcon:'<svg class="wds-icon wds-icon-small" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill-rule="evenodd" d="M10.414 9l1.417-1.416a1.003 1.003 0 0 0-.002-1.412.996.996 0 0 0-1.412-.003L9 7.585 7.584 6.17a1.003 1.003 0 0 0-1.412.002.996.996 0 0 0-.003 1.412L7.585 9 6.17 10.416a1.003 1.003 0 0 0 .002 1.412.996.996 0 0 0 1.412.003L9 10.415l1.416 1.417a1.003 1.003 0 0 0 1.412-.002.996.996 0 0 0 .003-1.412L10.415 9zm1.9-8L17 5.686v6.628L12.314 17H5.686L1 12.314V5.686L5.686 1h6.628z"/></svg>',warnIcon:
'<svg class="wds-icon wds-icon-small" width="18" height="16" viewBox="0 0 18 16" xmlns="http://www.w3.org/2000/svg"><path d="M17.928 15.156c.1.178.096.392-.013.565a.603.603 0 0 1-.515.28H.6a.607.607 0 0 1-.515-.28.544.544 0 0 1-.013-.564L8.472.278c.21-.37.847-.37 1.056 0l8.4 14.878zM8 5.99v4.02A1 1 0 0 0 9 11c.556 0 1-.444 1-.99V5.99A1 1 0 0 0 9 5c-.556 0-1 .444-1 .99zM8 13c0 .556.448 1 1 1 .556 0 1-.448 1-1 0-.556-.448-1-1-1-.556 0-1 .448-1 1z" fill-rule="evenodd"/></svg>'},defaultTimeout=10000,types={notify:{className:'wds-message',svg:templates.notifyIcon},confirm:{className:'wds-success',svg:templates.confirmIcon},error:{className:'wds-alert',svg:templates.errorIcon},warn:{className:'wds-warning',svg:templates.warnIcon}},classes=Object.keys(types).join(' '),closeImageSource=window.stylepath+'/oasis/images/icon_close.png',$container,$header,modal,fadeTime=400,wrapperClass='wds-banner-notification__container',wrapperSelector='.'+wrapperClass,notificationSelector=
'.wds-banner-notification',transparentBannerClass='wds-is-transparent';function BannerNotification(content,type,$parent,timeout){if(content instanceof jQuery&&content.hasClass('wds-banner-notification')){this.content=content.find('.msg').html();this.$element=content;this.$parent=content.parent();this.hidden=!1;}else{this.content=content;this.$element=null;this.$parent=$parent;this.hidden=!0;this.type=type;this.timeout=timeout;}this.onCloseHandler=Function.prototype;}BannerNotification.prototype.show=function(){if(!this.hidden){return this;}if(!this.$element){this.$element=createMarkup(this.content,this.type);}this.setType(this.type);setUpClose(this);if(isModalShown()&&typeof this.timeout!=='number'){this.timeout=defaultTimeout;}addToDOM(this.$element,this.$parent);this.hidden=!1;handleScrolling();if(typeof this.timeout==='number'){setTimeout(function(){this.hide();}.bind(this),this.timeout);}return this;};BannerNotification.prototype.hide=function(){if(!this.hidden){fadeOut(
this.$element,removeFromDOM);this.$element=null;this.hidden=!0;}return this;};BannerNotification.prototype.setType=function(type){if(type!==this.type&&types.hasOwnProperty(type)){this.type=type;if(this.$element){this.$element.removeClass(classes).addClass(type);}}return this;};BannerNotification.prototype.setContent=function(content){if(content&&content!==this.content){this.content=content;if(this.$element){this.$element.find('.msg').html(content);}}return this;};BannerNotification.prototype.showConnectionError=function(){return this.setType('error').setContent(window.mw.message('bannernotifications-general-ajax-failure').escaped()).show();};BannerNotification.prototype.onClose=function(callback){if(typeof callback==='function'){this.onCloseHandler=callback;}return this;};function init(){$header=$('#globalNavigation');$container=getContainer();if(window.skin!=='monobook'){require(['wikia.onScroll'],function(onScroll){onScroll.bind(handleScrolling);});}updatePlaceholderHeight();if(mw.
config.get('wgVisualEditor')&&mw.config.get('wgIsArticle')){mw.hook('ve.activationComplete').add(function(){$(notificationSelector).fadeOut(fadeTime);updatePlaceholderHeight();});mw.hook('ve.deactivate').add(function(){$(notificationSelector).fadeIn(fadeTime);updatePlaceholderHeight();});}createBackendNotifications();}function updatePlaceholderHeight(){if(window.skin!=='monobook'){$container.height($container.find(wrapperSelector).height());}}function createBackendNotifications(){$(notificationSelector).each(function(){var backendNotification=new BannerNotification($(this));setUpClose(backendNotification);});}function handleScrolling(){var containerTop,notificationWrapper=$container.children(wrapperSelector),headerBottom;if(!$container.length||!notificationWrapper.length){return;}containerTop=$container.get(0).getBoundingClientRect().top;headerBottom=$header.length>0?$header.get(0).getBoundingClientRect().bottom:0;if(containerTop<headerBottom){if(!notificationWrapper.hasClass('float'))
{notificationWrapper.addClass('float');if(!notificationWrapper.prop('style').top){notificationWrapper.css('top',headerBottom);}}}else{notificationWrapper.removeClass('float');}}function getContainer(){if($container&&$container.length){return $container;}else if(window.skin==='monobook'){$container=$('#content');}else{$container=$('.banner-notifications-placeholder');}return $container;}function createMarkup(content,type){type=type||'notify';return $(mustache.render(templates.bannerNotification,{imageSource:closeImageSource,content:content,icon:types[type].svg,typeClassName:types[type].className,})).addClass(type+' '+transparentBannerClass);}function addToDOM($element,$parentElement){var $parent=$parentElement||(isModalShown()?modal:getContainer()),$bannerNotificationsWrapper=$parent.find(wrapperSelector);if(!$bannerNotificationsWrapper.length){$bannerNotificationsWrapper=$('<div></div>').addClass(wrapperClass);$parent.prepend($bannerNotificationsWrapper);}$bannerNotificationsWrapper.
prepend($element);setTimeout(function(){$element.removeClass(transparentBannerClass);},0);}function setUpClose(notification){notification.$element.find('.wds-banner-notification__close').on('click',function(event){notification.hide();notification.onCloseHandler(event);});}function isModalShown(){modal=$('.modalWrapper, .yui-panel, .modal');return modal.is(':visible');}function fadeOut($element,callback){if($element.length){$element.animate({'height':0,'padding':0,'opacity':0},fadeTime,function(){callback($element);});}}function removeFromDOM($element){var $parent=$element.parent();if($parent.hasClass(wrapperSelector)&&$parent.children().length===1){$parent.remove();}else{$element.remove();}updatePlaceholderHeight();}$(init);window.BannerNotification=BannerNotification;define('BannerNotification',function(){return BannerNotification;});})(window,$,window.Mustache);;(function(context){'use strict';function nirvana($){var allowedFormats=['json','html','jsonp'];function getUrl(options){var
dataParams=options.data||{},format=(options.format||'json').toLowerCase(),i,key,sortedDict={},sortedKeys=[],urlParams,url=options.scriptPath||context.wgScriptPath;if((typeof options.controller==='undefined')||(typeof options.method==='undefined')){throw'controller and method are required';}urlParams={controller:options.controller.replace(/Controller$/,''),method:options.method};if(typeof dataParams==='string'){dataParams+='&format='+format;}else{dataParams.format=format;}if(typeof dataParams!=='string'){for(key in dataParams){sortedKeys[sortedKeys.length]=key;}sortedKeys.sort();for(i=0;i<sortedKeys.length;i++){sortedDict[sortedKeys[i]]=dataParams[sortedKeys[i]];}dataParams=$.param(sortedDict);}return url+'/wikia.php?'+$.param(urlParams)+'&'+dataParams;}function sendRequest(attr){var type=(attr.type||'POST').toUpperCase(),format=(attr.format||'json').toLowerCase(),data={},callback=attr.callback||function(){},onErrorCallback=attr.onErrorCallback||function(){},url;if(allowedFormats.
indexOf(format)===-1){throw'Only Json,Jsonp and Html format are allowed';}if(type==='POST'&&typeof attr.data!=='undefined'){data=attr.data;delete attr.data;}url=getUrl(attr);var settings={url:url,dataType:format,type:type,data:data,success:callback,error:onErrorCallback};if(typeof attr.contentType!='undefined'){settings.contentType=attr.contentType;}if(typeof attr.processData!='undefined'){settings.processData=attr.processData;}return $.ajax(settings);}return{sendRequest:sendRequest,getUrl:getUrl,getJson:function(controller,method,data,callback,onErrorCallback){if(typeof data==='function'){onErrorCallback=callback;callback=data;data={};}return sendRequest({controller:controller,method:method,data:data,type:'GET',callback:callback,onErrorCallback:onErrorCallback});},postJson:function(controller,method,data,callback,onErrorCallback){if(typeof data==='function'){onErrorCallback=callback;callback=data;data={};}return sendRequest({controller:controller,method:method,data:data,callback:
callback,onErrorCallback:onErrorCallback});}};}if(context.define&&context.define.amd){context.define('wikia.nirvana',['jquery'],nirvana);}if(context.jQuery){context.jQuery.nirvana=nirvana(context.jQuery);}}(this));;define('wikia.ui.factory',['wikia.nirvana','wikia.window','wikia.loader','wikia.ui.component','jquery'],function uifactory(nirvana,window,loader,UIComponent,$){'use strict';function getComponentsConfig(components){var deferred=new $.Deferred(),data={components:components,cb:window.wgStyleVersion};nirvana.getJson('Wikia\\UI\\UIFactoryApi','getComponentsConfig',data,function(data){deferred.resolve(data);},function(xhrObject){deferred.reject(JSON.parse(xhrObject.responseText));});return deferred.promise();}function getComponentInstance(){return new UIComponent();}function arrayUnique(array){var o={},uniqueArray=[],i;for(i=0;i<array.length;i++){if(o.hasOwnProperty(array[i])){continue;}uniqueArray.push(array[i]);o[array[i]]=1;}return uniqueArray;}function init(componentName){var
deferred=new $.Deferred(),components=[],dependencyObjects={};if(!(componentName instanceof Array)){componentName=[componentName];}getComponentsConfig(componentName).done(function(data){var jsAssets=[],cssAssets=[],createComponent=function(element){var component=getComponentInstance(),templateVarsConfig=element.templateVarsConfig,assets=element.assets,templates=element.templates,dependencies=element.dependencies,dependencyList={};if(typeof dependencies==='object'){dependencies.forEach(function(name){if(typeof dependencyObjects[name]!=='undefined'){dependencyList[name]=dependencyObjects[name];}else{deferred.reject();throw new Error('Sub component '+name+' not found');}});}if(assets){jsAssets=jsAssets.concat(assets.js);cssAssets=cssAssets.concat(assets.css);}if(templateVarsConfig&&templates){component.setComponentsConfig({name:element.name,jsWrapperModule:element.jsWrapperModule,templates:templates,templateVarsConfig:templateVarsConfig,dependencies:dependencyList});}return component;};if(
data.dependencies){Object.keys(data.dependencies).forEach(function(name){dependencyObjects[name]=createComponent(data.dependencies[name]);});}data.components.forEach(function(element){components.push(createComponent(element));});jsAssets=arrayUnique(jsAssets);cssAssets=arrayUnique(cssAssets);loader({type:loader.CSS,resources:cssAssets});function resolveDeferred(){deferred.resolve.apply(null,components);}if(jsAssets.length>0){loader({type:loader.JS,resources:jsAssets}).done(resolveDeferred);}else{resolveDeferred();}}).fail(function(data){if(data.error){throw new Error(data.error+': '+data.message);}deferred.reject();});return deferred.promise();}return{init:init};});;define('wikia.ui.component',['wikia.mustache'],function uicomponent(mustache){'use strict';function validateComponent(componentConfig,componentType,componentVars){var supportedTypes=componentConfig.templates,variables,requiredVars,missingVars=[];if(!supportedTypes.hasOwnProperty(componentType)){throw new Error(
'Requested component type is not supported!');}requiredVars=componentConfig.templateVarsConfig[componentType].required;missingVars=[];requiredVars.forEach(function(element){if(!componentVars.hasOwnProperty(element)){missingVars.push(element);}});if(missingVars.length>0){variables=missingVars.join(', ');throw new Error('Missing required mustache variables: '+variables+'!');}}function UIComponent(){if(!(this instanceof UIComponent)){return new UIComponent();}var componentConfig={},componentType,componentVars;this.render=function(params){componentType=params.type;componentVars=params.vars;validateComponent(componentConfig,componentType,componentVars);return mustache.render(componentConfig.templates[componentType],componentVars);};this.setComponentsConfig=function(config){componentConfig=config;};this.createComponent=function(params,callback){var that=this;if(componentConfig.jsWrapperModule){require([componentConfig.jsWrapperModule],function(object){callback(object.createComponent(params,
that));});}else{callback(that,params);}};this.getSubComponent=function(componentName){if(typeof componentConfig.dependencies[componentName]!=='undefined'){return componentConfig.dependencies[componentName];}throw new Error('Dependency '+componentName+' not found.');};}return UIComponent;});;

jQuery.fn.placeholder=function(){var hasNativeSupport='placeholder'in document.createElement('input');return this.each(function(){if(hasNativeSupport){return;}var input=$(this);var text=input.attr('placeholder');if(input.val()==''){input.addClass('placeholder').val(text);}input.focus(function(){if(input.val()==text){input.val('');}input.removeClass('placeholder');});input.blur(function(){if(input.val()==''){input.addClass('placeholder').val(text);}});input.closest('form').submit(function(){if(input.val()==text){input.val('');}});});};$(function(){$('input[placeholder], textarea[placeholder]').placeholder();});;(function(){'use strict';if(!Array.prototype.indexOf){Array.prototype.indexOf=function(val,fromIndex){var i,l;fromIndex=fromIndex||0;for(i=fromIndex,l=this.length;i<l;i++){if(this[i]===val){return i;}}return-1;};}if(!Array.prototype.filter){Array.prototype.filter=function(fun,t){var i,l,res=[];for(i=0,l=this.length;i<l;i++){if(fun.call(t,this[i],i,this)){res[res.length]=this[i];}
}return res;};}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(searchElement){"use strict";if(this==null)throw new TypeError();var t=Object(this);var len=t.length>>>0;if(len===0)return-1;var n=len;if(arguments.length>1){n=Number(arguments[1]);if(n!=n)n=0;else if(n!=0&&n!=(1/0)&&n!=-(1/0))n=(n>0||-1)*Math.floor(Math.abs(n));}var k=n>=0?Math.min(n,len-1):len-Math.abs(n);for(;k>=0;k--){if(k in t&&t[k]===searchElement)return k;}return-1;};}}());;(function(window,document,jQuery){var head=document.getElementsByTagName('head')[0],loadedCompleteRegExp=/loaded|complete/,callbacks={},callbacksNb=0,timer;jQuery.getCSS=function(url,options,callback){if(jQuery.isFunction(options)){callback=options;options={};}var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.media=options.media||'screen';link.href=url;if(options.charset){link.charset=options.charset;}if(options.title){callback=(function(callback){return function(){link.title=options.title
;callback(link,"success");};})(callback);}if(link.readyState){link.onreadystatechange=function(){if(loadedCompleteRegExp.test(link.readyState)){link.onreadystatechange=null;callback(link,"success");}};}else if(link.onload===null&&link.all){link.onload=function(){link.onload=null;callback(link,"success");};}else{callbacks[link.href]=function(){callback(link,"success");};if(!callbacksNb++){timer=window.setInterval(function(){var callback,stylesheet,stylesheets=document.styleSheets,href,i=stylesheets.length;while(i--){stylesheet=stylesheets[i];if((href=stylesheet.href)&&(callback=callbacks[href])){try{callback.r=stylesheet.cssRules;throw'SECURITY';}catch(e){if(/SECURITY/.test(e)||/SECURITY/i.test(e.name)){callback(link,"success");delete callbacks[href];if(!--callbacksNb){timer=window.clearInterval(timer);}}}}}},13);}}head.appendChild(link);};})(this,this.document,this.jQuery);;var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{};jaaulde.utils.cookies=(function(){var cookies=[];
var defaultOptions={hoursToLive:null,path:'/',domain:null,secure:!1};var resolveOptions=function(options){var returnValue;if(typeof options!=='object'||options===null){returnValue=defaultOptions;}else{returnValue={hoursToLive:(typeof options.hoursToLive==='number'&&options.hoursToLive!==0?options.hoursToLive:defaultOptions.hoursToLive),path:(typeof options.path==='string'&&options.path!==''?options.path:defaultOptions.path),domain:(typeof options.domain==='string'&&options.domain!==''?options.domain:defaultOptions.domain),secure:(typeof options.secure==='boolean'&&options.secure?options.secure:defaultOptions.secure)};}return returnValue;};var expiresGMTString=function(hoursToLive){var dateObject=new Date();dateObject.setTime(dateObject.getTime()+(hoursToLive*60*60*1000));return dateObject.toGMTString();};var assembleOptionsString=function(options){options=resolveOptions(options);return((typeof options.hoursToLive==='number'?'; expires='+expiresGMTString(options.hoursToLive):'')+
'; path='+options.path+(typeof options.domain==='string'?'; domain='+options.domain:'')+(options.secure===true?'; secure':''));};var splitCookies=function(){cookies={};var pair,name,value,separated=document.cookie.split(';');for(var i=0;i<separated.length;i=i+1){pair=separated[i].split('=');name=pair[0].replace(/^\s*/,'').replace(/\s*$/,'');value=decodeURIComponent(pair[1]);cookies[name]=value;}return cookies;};var constructor=function(){};constructor.prototype.get=function(cookieName){var returnValue;splitCookies();if(typeof cookieName==='string'){returnValue=(typeof cookies[cookieName]!=='undefined')?cookies[cookieName]:null;}else if(typeof cookieName==='object'&&cookieName!==null){returnValue={};for(var item in cookieName){if(typeof cookies[cookieName[item]]!=='undefined'){returnValue[cookieName[item]]=cookies[cookieName[item]];}else{returnValue[cookieName[item]]=null;}}}else{returnValue=cookies;}return returnValue;};constructor.prototype.filter=function(cookieNameRegExp){var
returnValue={};splitCookies();if(typeof cookieNameRegExp==='string'){cookieNameRegExp=new RegExp(cookieNameRegExp);}for(var cookieName in cookies){if(cookieName.match(cookieNameRegExp)){returnValue[cookieName]=cookies[cookieName];}}return returnValue;};constructor.prototype.set=function(cookieName,value,options){if(typeof value==='undefined'||value===null){if(typeof options!=='object'||options===null){options={};}value='';options.hoursToLive=-8760;}var optionsString=assembleOptionsString(options);document.cookie=cookieName+'='+encodeURIComponent(value)+optionsString;};constructor.prototype.del=function(cookieName,options){var allCookies={};if(typeof options!=='object'||options===null){options={};}if(typeof cookieName==='boolean'&&cookieName===true){allCookies=this.get();}else if(typeof cookieName==='string'){allCookies[cookieName]=!0;}for(var name in allCookies){if(typeof name==='string'&&name!==''){this.set(name,null,options);}}};constructor.prototype.test=function(){var returnValue
=!1,testName='cT',testValue='data';this.set(testName,testValue);if(this.get(testName)===testValue){this.del(testName);returnValue=!0;}return returnValue;};constructor.prototype.setOptions=function(options){if(typeof options!=='object'){options=null;}defaultOptions=resolveOptions(options);};return new constructor();})();(function(){if(window.jQuery){(function($){$.cookies=jaaulde.utils.cookies;var extensions={cookify:function(options){return this.each(function(){var i,resolvedName=!1,resolvedValue=!1,name='',value='',nameAttrs=['name','id'],nodeName,inputType;for(i in nameAttrs){if(!isNaN(i)){name=$(this).attr(nameAttrs[i]);if(typeof name==='string'&&name!==''){resolvedName=!0;break;}}}if(resolvedName){nodeName=this.nodeName.toLowerCase();if(nodeName!=='input'&&nodeName!=='textarea'&&nodeName!=='select'&&nodeName!=='img'){value=$(this).html();resolvedValue=!0;}else{inputType=$(this).attr('type');if(typeof inputType==='string'&&inputType!==''){inputType=inputType.
toLowerCase();}if(inputType!=='radio'&&inputType!=='checkbox'){value=$(this).val();resolvedValue=!0;}}if(resolvedValue){if(typeof value!=='string'||value===''){value=null;}$.cookies.set(name,value,options);}}});},cookieFill:function(){return this.each(function(){var i,resolvedName=!1,name='',value,nameAttrs=['name','id'],iteration=0,nodeName;for(i in nameAttrs){if(!isNaN(i)){name=$(this).attr(nameAttrs[i]);if(typeof name==='string'&&name!==''){resolvedName=!0;break;}}}if(resolvedName){value=$.cookies.get(name);if(value!==null){nodeName=this.nodeName.toLowerCase();if(nodeName==='input'||nodeName==='textarea'||nodeName==='select'){$(this).val(value);}else{$(this).html(value);}}}iteration=0;});},cookieBind:function(options){return this.each(function(){$(this).cookieFill().change(function(){$(this).cookify(options);});});}};$.each(extensions,function(i){$.fn[i]=this;});})(window.jQuery);}})();;(function($){function distance(date){return(new Date().getTime()-date.getTime());}function
inWords(date){return $t.inWords(distance(date));}function refresh(){var data=prepareData(this);if(!isNaN(data.datetime)){$(this).text(inWords(data.datetime));}return this;}function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if(text.length>0){element.attr("title",text);}}return element.data("timeago");}$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp);}else if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp));}else{return inWords($.timeago.datetime(timestamp));}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:!0,strings:window.wgTimeAgoi18n||{}},inWords:function(distanceMillis){var $l=this.settings.strings,isFuture=!1;if(this.settings.allowFuture){if(distanceMillis<0){isFuture=!0;}distanceMillis=Math.abs(distanceMillis);}var seconds=distanceMillis/1000;var minutes=seconds/60;var
hours=minutes/60;var days=hours/24;var years=days/365;function substitute(key,number){var string=$l[isFuture?(key+'-from-now'):key]||'';return string.replace(/%d/i,number);}var words=(seconds<45&&substitute('seconds',Math.round(seconds)))||(seconds<90&&substitute('minute',1))||(minutes<45&&substitute('minutes',Math.round(minutes)))||(minutes<90&&substitute('hour',1))||(hours<24&&substitute('hours',Math.round(hours)))||(hours<48&&substitute('day',1))||(days<30&&substitute('days',Math.floor(days)))||(days<60&&substitute('month',1))||(days<365&&substitute('months',Math.floor(days/30)))||(years<2&&substitute('year',1))||substitute('years',Math.floor(years));return words;},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d\d\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(s);},datetime:function(elem){var node=$(elem);var isTime=node.get(0).tagName.toLowerCase()==="time";var
iso8601=isTime?node.attr("datetime"):node.attr("title");return $t.parse(iso8601);}});$.fn.timeago=function(){var self=this;self.each(refresh);var $s=$t.settings;if($s.refreshMillis>0){setInterval(function(){self.each(refresh);},$s.refreshMillis);}return self;};document.createElement("abbr");document.createElement("time");}(jQuery));;(function($){$.store=function(driver,serializers){var that=this;this.encoders=[];this.decoders=[];if(typeof driver=='string'){if($.store.drivers[driver]){this.driver=$.store.drivers[driver];}else{throw new Error('Unknown driver '+driver);}}else if(typeof driver=='object'){var invalidAPI=!$.isFunction(driver.init)||!$.isFunction(driver.get)||!$.isFunction(driver.set)||!$.isFunction(driver.del)||!$.isFunction(driver.flush);if(invalidAPI){throw new Error('The specified driver does not fulfill the API requirements');}this.driver=driver;}else{$.each($.store.drivers,function(){if(!$.isFunction(this.available)||!this.available()){return true;}that.driver=this;if(
that.driver.init()===false){that.driver=null;return true;}return false;});}if(!serializers){serializers=$.store.serializers;}this.serializers={};$.each(serializers,function(key,serializer){if(!$.isFunction(this.init)){return true;}that.serializers[key]=this;that.serializers[key].init(that.encoders,that.decoders);});};$.extend($.store.prototype,{get:function(key){var value=this.driver.get(key);return this.driver.encodes?value:this.unserialize(value);},set:function(key,value){this.driver.set(key,this.driver.encodes?value:this.serialize(value));},del:function(key){this.driver.del(key);},flush:function(){this.driver.flush();},driver:undefined,serialize:function(value){var that=this;$.each(this.encoders,function(){var serializer=that.serializers[this+""];if(!serializer||!serializer.encode){return true;}try{value=serializer.encode(value);}catch(e){}});return value;},unserialize:function(value){var that=this;if(!value){return value;}$.each(this.decoders,function(){var serializer=that.
serializers[this+""];if(!serializer||!serializer.decode){return true;}value=serializer.decode(value);});return value;}});$.store.drivers={'localStorage':{ident:"$.store.drivers.localStorage",scope:'browser',available:function(){try{return!!window.localStorage;}catch(e){return false;}},init:$.noop,get:function(key){return window.localStorage.getItem(key);},set:function(key,value){try{window.localStorage.setItem(key,value);}catch(error){}},del:function(key){window.localStorage.removeItem(key);},flush:function(){window.localStorage.clear();}},'userData':{ident:"$.store.drivers.userData",element:null,nodeName:'userdatadriver',scope:'browser',initialized:!1,available:function(){try{return!!(document.documentElement&&document.documentElement.addBehavior);}catch(e){return false;}},init:function(){if(this.initialized){return;}try{this.element=document.createElement(this.nodeName);document.documentElement.insertBefore(this.element,document.getElementsByTagName('title')[0]);this.element.
addBehavior("#default#userData");this.initialized=!0;}catch(e){return false;}},get:function(key){this.element.load(this.nodeName);return this.element.getAttribute(key);},set:function(key,value){this.element.setAttribute(key,value);this.element.save(this.nodeName);},del:function(key){this.element.removeAttribute(key);this.element.save(this.nodeName);},flush:function(){this.element.expires=(new Date()).toUTCString();this.element.save(this.nodeName);}},'windowName':{ident:"$.store.drivers.windowName",scope:'window',cache:{},encodes:!0,available:function(){return true;},init:function(){this.load();},save:function(){window.name=$.store.serializers.json.encode(this.cache);},load:function(){this.cache=$.store.serializers.json.decode(window.name+"");},get:function(key){return this.cache[key];},set:function(key,value){this.cache[key]=value;this.save();},del:function(key){try{delete this.cache[key];}catch(e){this.cache[key]=undefined;}this.save();},flush:function(){window.name="{}";}}};$.
store.serializers={'json':{ident:"$.store.serializers.json",init:function(encoders,decoders){encoders.push("json");decoders.push("json");},encode:function(data){try{return JSON.stringify(data);}catch(e){return'';}},decode:function(data){try{return JSON.parse(data);}catch(e){return{};}}}};})(jQuery);$.storage=new $.store();;(function(window,undefined){'$:nomunge';var $=window.jQuery||window.Cowboy||(window.Cowboy={}),jq_throttle;$.throttle=jq_throttle=function(delay,no_trailing,callback,debounce_mode){var timeout_id,last_exec=0;if(typeof no_trailing!=='boolean'){debounce_mode=callback;callback=no_trailing;no_trailing=undefined;}function wrapper(){var that=this,elapsed=+new Date()-last_exec,args=arguments;function exec(){last_exec=+new Date();callback.apply(that,args);};function clear(){timeout_id=undefined;};if(debounce_mode&&!timeout_id){exec();}timeout_id&&clearTimeout(timeout_id);if(debounce_mode===undefined&&elapsed>delay){exec();}else if(no_trailing!==true){timeout_id=setTimeout(
debounce_mode?clear:exec,debounce_mode===undefined?delay-elapsed:delay);}};if($.guid){wrapper.guid=callback.guid=callback.guid||$.guid++;}return wrapper;};$.debounce=function(delay,at_begin,callback){return callback===undefined?jq_throttle(delay,at_begin,false):jq_throttle(delay,callback,at_begin!==false);};})(this);;(function($,window){'use strict';var win=$(window),elems=$([]),current,previous,scroller=$('<div id="floating-scrollbar"><div/></div>'),scrollerInner=scroller.children();function setState(state){scroller.toggle(!!state);}function scrollCurrent(){if(current){scroller.scrollLeft(current.scrollLeft());}}function update(){previous=current;current=null;elems.each(function(){var elem=$(this),top=elem.offset().top,bottom=top+elem.height(),viewportBottom=win.scrollTop()+win.height()-$.floatingScrollbarOptions.bottom,topOffset=30;if(top+topOffset<viewportBottom&&bottom>viewportBottom){current=elem;return false;}});if(!current){setState();return;}var scroll=current.scrollLeft(),
scrollMax=current.scrollLeft(90019001).scrollLeft(),widthOuter=current.innerWidth(),widthInner=widthOuter+scrollMax;current.scrollLeft(scroll);if(widthInner<=widthOuter){setState();return;}setState(true);if(!previous||previous[0]!==current[0]){if(previous){previous.unbind('scroll',scrollCurrent);}current.scroll(scrollCurrent).after(scroller);}scroller.css({bottom:$.floatingScrollbarOptions.bottom,left:current.offset().left-win.scrollLeft(),width:widthOuter}).scrollLeft(scroll);scrollerInner.width(widthInner);}scroller.hide().css({position:'fixed',bottom:0,height:'30px',overflowX:'auto',overflowY:'hidden'}).scroll(function(){if(current){current.scrollLeft(scroller.scrollLeft());}});scrollerInner.css({border:'1px solid #fff',opacity:0.01});$.fn.floatingScrollbar=function(state){if(state===false){elems=elems.not(this);this.unbind('scroll',scrollCurrent);if(!elems.length){scroller.detach();win.unbind('resize scroll',update);}}else if(this.length){if(!elems.length){win.resize(update).scroll
(update);}elems=elems.add(this);}update();return this;};$.floatingScrollbarUpdate=update;$.floatingScrollbarOptions={bottom:0};})(jQuery,this);;(function(window,$){'use strict';var getAssetManagerUrl=function(elements,params,requesttype){if(typeof elements==='string'){elements=[elements];}params=params||{};if(window.debug===true){params.minify=0;}return wgCdnRootUrl+wgAssetsManagerQuery.replace('%1$s',requesttype).replace('%2$s',elements.join(',')).replace('%3$s',$.isEmptyObject(params)?'-':encodeURIComponent($.param(params))).replace('%4$d',wgStyleVersion);};$.getSassURL=function(rootURL,scssFilePath,params){return rootURL+wgAssetsManagerQuery.replace('%1$s','sass').replace('%2$s',scssFilePath).replace('%3$s',encodeURIComponent($.param(params||window.sassParams))).replace('%4$d',wgStyleVersion);};$.getSassCommonURL=function(scssFilePath,params){return $.getSassURL(wgCdnRootUrl,scssFilePath,params);};$.getSassLocalURL=function(scssFilePath,params){return $.getSassURL('',scssFilePath,
params);};$.getAssetManagerGroupUrl=function(groups,params){return getAssetManagerUrl(groups,params,'groups');};$.getSassesURL=function(sasses,params){return getAssetManagerUrl(sasses,params,'sasses');};$.ajaxSetup({cache:!0});$.getScript=function(url,callback,failureFn){return $.ajax({type:'GET',url:url,success:function(xhr){if(typeof callback==='function'){try{callback();}catch(e){eval(xhr);callback();$().log('eval() fallback applied for '+url,'getScript');}}},error:(typeof failureFn==='function'?failureFn:$.noop),dataType:'script'});};$.fn.log=function(msg,group){Wikia.log(msg,Wikia.log.levels.info,group);return this;};$.fn.exists=function(){return this.length>0;};$.fn.getModal=function(url,id,options){$.get(url,function(html){$('body').append(html);if(typeof options=='object'&&typeof options.callbackBefore==='function'){options.callbackBefore();}if(typeof id==='string'){$(id).makeModal(options);$().log('getModal: '+id+' modal made');}if(typeof options=='object'&&typeof options.
callback==='function'){options.callback();}});};$.showModal=function(title,content,options){options=(typeof options!=='object')?{}:options;var header=$('<h1>').text(title),dialog=$('<div>'),wrapper;if(typeof options.rawHTML!=='undefined'&&options.rawHTML===true){dialog.get(0).innerHTML=content;}else{dialog.html(content);}dialog.prepend(header).appendTo('body');if(typeof options.callbackBefore==='function'){options.callbackBefore();}wrapper=dialog.makeModal(options);if(typeof options.callback==='function'){options.callback(wrapper);}return wrapper;};$.confirm=function(options){var dialog;options=(typeof options!=='object')?{}:options;options.id='WikiaConfirm';var html='';if(options.title){html+='<h1>'+options.title+'</h1>';}html+='<p>'+(options.content||'')+'</p>'+'<div class="neutral modalToolbar">'+'<button id="WikiaConfirmCancel" class="wikia-button secondary">'+(options.cancelMsg||$.msg('cancel'))+'</button>'+'<button id="WikiaConfirmOk" class="wikia-button">'+(options.okMsg||$.msg(
'ok'))+'</button>'+'</div>';dialog=$('<div>').appendTo('body').html(html).attr('title',options.title||'');if(typeof options.callbackBefore==='function'){options.callbackBefore();}$('#WikiaConfirmOk').click(function(){$('#WikiaConfirm').closeModal();if(typeof options.onOk==='function'){options.onOk();}});$('#WikiaConfirmCancel').click(function(){$('#WikiaConfirm').closeModal();if(typeof options.onCancel==='function'){options.onCancel();}});dialog.makeModal(options);if(typeof options.callback==='function'){options.callback();}};$.showCustomModal=function(title,content,options){var buttons='',buttonNo,button,dialog,modal;options=(typeof options!=='object')?{}:options;if(options.buttons){buttons=$('<div class="neutral modalToolbar"></div>');for(buttonNo=0;buttonNo<options.buttons.length;buttonNo++){button='<a id="'+options.buttons[buttonNo].id+'" class="wikia-button'+(options.buttons[buttonNo].defaultButton?'':' secondary')+'">'+options.buttons[buttonNo].message+'</a>';$(button).bind(
'click',options.buttons[buttonNo].handler).appendTo(buttons);}}dialog=$('<div>').html(content).attr('title',title).append(buttons);$('body').append(dialog);if(typeof options.callbackBefore==='function'){options.callbackBefore();}modal=dialog.makeModal(options);if(typeof options.callback==='function'){options.callback(modal);}return modal;};$.postJSON=function(u,d,callback){return $.post(u,d,callback,'json');};$.extend({_urlVars:null,getUrlVars:function(){if($._urlVars===null){var i,j,hash,hashes=window.location.search.slice(window.location.search.indexOf('?')+1).split('&');$._urlVars={};for(i=0,j=hashes.length;i<j;i++){hash=hashes[i].split('=');$._urlVars[hash[0]]=hash[1];}}return $._urlVars;},getUrlVar:function(name){return $.getUrlVars()[name];}});$.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments);};$.fn.isChrome=function(){if($.browser.webkit&&!$.browser.opera&&!$.browser.msie&&!$.browser.mozilla){var userAgent=navigator.userAgent.toLowerCase();if(
userAgent.indexOf('chrome')>-1){return true;}}return false;};$.fn.hasParent=function(selector){return this.first().parent().closest(selector).exists();}
$.fn.startThrobbing=function(){return this.append('<div class="wikiaThrobber"></div>');};$.fn.stopThrobbing=function(){this.find('.wikiaThrobber').remove();return this;};$.preloadThrobber=function(){var img=new Image();img.src=stylepath+'/common/images/ajax.gif';};$.thumbUrl2ThumbUrl=function(url,type,width,height){return Wikia.Thumbnailer.getThumbURL(url,type,width,height);}
$.htmlentities=function(s){return String(s).replace(/\&/g,'&'+'amp;').replace(/</g,'&'+'lt;').replace(/>/g,'&'+'gt;').replace(/\'/g,'&'+'apos;').replace(/\"/g,'&'+'quot;');};$.createClass=function(sc,o){var constructor=o.constructor;if(typeof constructor!=='function'||constructor==Object.prototype.constructor){constructor=function(){sc.apply(this,arguments);};}var bc=constructor;var f=function(){};f.prototype=sc.prototype||{};bc.prototype=new f();if(typeof o.statics=='object'){bc=$.extend(bc,o.statics);delete o.statics;}for(var m in o){bc.prototype[m]=o[m];}bc.prototype.constructor=bc;bc.superclass=sc.prototype;return bc;};$.proxyBind=function(fn,thisObject,baseArgs){return function(){var args=baseArgs.slice(0).concat(Array.prototype.call(arguments,0));return fn.apply(thisObject,args);}};var Observable=$.createClass(Object,{constructor:function(){Observable.superclass.constructor.apply(this,arguments);this.events={};},bind:function(e,cb,scope){if(typeof e=='object'){scope=cb;for(var i
in e){if(i!=='scope'){this.bind(i,e[i],e.scope||scope);}}}else if($.isArray(cb)){for(var i=0;i<cb.length;i++){this.bind(e,cb[i],scope);}}else{scope=scope||this;this.events[e]=this.events[e]||[];this.events[e].push({fn:cb,scope:scope});}return true;},unbind:function(e,cb,scope){if(typeof e=='object'){scope=cb;var ret=!1;for(var i in e){if(i!=='scope'){ret=this.unbind(i,e[i],e.scope||scope)||ret;}}return ret;}else if($.isArray(cb)){var ret=!1;for(var i=0;i<cb.length;i++){ret=this.unbind(e,cb[i],scope)||ret;}return ret;}else{if(!this.events[e]){return false;}scope=scope||this;for(var i in this.events[e]){if(this.events[e][i].fn==cb&&this.events[e][i].scope==scope){delete this.events[e][i];return true;}}return false;}},on:function(e,cb){this.bind.apply(this,arguments);},un:function(e,cb){this.unbind.apply(this,arguments);},relayEvents:function(o,e,te){te=te||e;o.bind(e,function(){var a=[te].concat(arguments);this.fire.apply(this,a);},this);},fire:function(e){var a=Array.prototype.
slice.call(arguments,1);if(!this.events[e])return true;var ee=this.events[e];for(var i=0;i<ee.length;i++){if(typeof ee[i].fn=='function'){var scope=ee[i].scope||this;if(ee[i].fn.apply(scope,a)===false){return false;}}}return true;},proxy:function(func){return $.proxy(func,this);},debugEvents:function(list){var fns=list?list:['bind','unbind','fire','relayEvents'];for(var i=0;i<fns.length;i++){(function(fn){if(typeof this['nodebug-'+fn]=='undefined'){var f=this['nodebug-'+fn]=this[fn];this[fn]=function(){window.console&&console.log&&console.log(this,fn,arguments);return f.apply(this,arguments);}}}).call(this,fns[i]);}}});var GlobalTriggers=(function(){var GlobalTriggersClass=$.createClass(Observable,{fired:null,constructor:function(){GlobalTriggersClass.superclass.constructor.apply(this);this.fired={};},bind:function(e,cb,scope){GlobalTriggersClass.superclass.bind.apply(this,arguments);if(typeof e=='object'||$.isArray(cb)){return;}if(typeof this.fired[e]!='undefined'){var a=this.fired[e]
.slice(0);setTimeout(function(){for(i=0;i<a.length;i++){cb.apply(scope||window,a[i]);}},10);}},fire:function(e){var a=Array.prototype.slice.call(arguments,1);this.fired[e]=this.fired[e]||[];this.fired[e].push(a);GlobalTriggersClass.superclass.fire.apply(this,arguments);}});return new GlobalTriggersClass();})();var Timer=$.createClass(Object,{callback:null,timeout:1000,timer:null,constructor:function(callback,timeout){this.callback=callback;this.timeout=(typeof timeout=='number')?timeout:this.timeout;},run:function(){this.callback.apply(window);},start:function(timeout){this.stop();timeout=(typeof timeout=='number')?timeout:this.timeout;this.timer=setTimeout(this.callback,timeout);},stop:function(){if(this.timer!=null){clearTimeout(this.timer);this.timer=null;}}});$.extend(Timer,{create:function(callback,timeout){var timer=new Timer(callback,timeout);return timer;},once:function(callback,timeout){var timer=Timer.create(callback,timeout);timer.start();return timer;}});$(function(){if(
typeof wgNow!='undefined'){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('DOM ready after '+loadTime+' ms',window.skin);}window.wgWikiaDOMReady=!0;if(typeof $.fn.timeago!='undefined'){$('.timeago').timeago();}});var $window=$(window);$window.bind('load',function(){if(typeof wgNow!='undefined'){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('window onload after '+loadTime+' ms',window.skin);}});$window.on('scroll',$.debounce(100,function(event){$window.trigger('scrollstop',[event]);}));$.toJSON=JSON.stringify;$.evalJSON=$.secureEvalJSON=JSON.parse;window.GlobalTriggers=GlobalTriggers;window.Observable=Observable;window.Timer=Timer;})(window,jQuery);;(function($,window){$.fn.carousel=function(options){var $this=$(this);var defaults={transitionSpeed:500,itemsShown:3,activeIndex:0,nextClass:"next",prevClass:"previous",attachBlindImages:!1,itemClick:!1,trackProgress:!1,beforeMove:!1,afterMove:!1};options=$.extend(defaults,options);var dom={wrapper
:$this,carousel:$this.find('.carousel'),items:$this.find('.carousel > li'),container:$this.children('div:first'),next:$this.siblings('.'+options.nextClass),previous:$this.siblings('.'+options.prevClass)};var constants={viewPortWidth:$this.outerWidth(),itemWidth:getItemWidth(),carouselWidth:0,minLeft:0};var states={browsing:!1,enable_next:!1,enable_previous:!1,currIndex:0,left:0};function nextImage(){if(states.browsing==false&&states.enable_next==true){states.browsing=!0;moveToIndex(states.currIndex+options.itemsShown);}return false;}function previousImage(){if(states.browsing==false&&states.enable_previous==true){states.browsing=!0;moveToIndex(states.currIndex-1);}return false;}function moveToIndex(idx){if(!isVisible(idx)){if(idx>(dom.items.length-options.itemsShown)){idx=dom.items.length-options.itemsShown;}if(states.currIndex>idx){var leftmost=idx-options.itemsShown+1;if(leftmost<0){leftmost=0;}idx=leftmost;}var left=constants.itemWidth*idx*-1;states.currIndex=idx;doMove
(left);}else{afterMove();}}function doMove(left){states.left=left;if(typeof options.beforeMove=='function'){options.beforeMove();}dom.carousel.animate({left:left},options.transitionSpeed,function(){states.browsing=!1;afterMove();});}function afterMove(){updateArrows();lazyLoadImages();if(typeof options.trackProgress=='function'){trackProgress(options.trackProgress);}if(typeof options.afterMove=='function'){options.afterMove(states.currIndex+options.itemsShown);}}function isVisible(idx){return idx>=states.currIndex&&idx<(states.currIndex+options.itemsShown);}function setAsActive(idx){if(idx>-1){dom.items.removeClass('active');dom.items.eq(idx).addClass('active');moveToIndex(idx);}else{updateArrows();}}function trackProgress(callback){var total=dom.items.length,idx1=Math.floor(states.currIndex)+1,idx2=Math.floor(states.currIndex)+(options.itemsShown>total?total:options.itemsShown);if(idx2>total){idx2=total;}callback(idx1,idx2,total);}function updateArrows(){if(dom.items.length<=
options.itemsShown){disableNext();disablePrevious();return;}var left=parseInt(dom.carousel.css('left'));if(isNaN(left)){left=0;}if(left<constants.minLeft+constants.itemWidth/2){disableNext();enablePrevious();}else if(left==0){disablePrevious();enableNext();}else{enablePrevious();enableNext();}}function lazyLoadImages(){var idx1=states.currIndex-options.itemsShown,idx2=states.currIndex,idx3=states.currIndex+options.itemsShown*2;idx1=idx1<0?0:idx1;var firstImages=dom.items.slice(idx2,idx3).find('img[data-src]'),lastImages=dom.items.slice(idx1,idx2).find('img[data-src]');doImageLoad(firstImages);doImageLoad(lastImages);}function doImageLoad(images){images.each(function(){var image=$(this);image.attr('src',image.attr('data-src')).removeAttr('data-src');});}function setCarouselWidth(){if(!constants.itemWidth){constants.itemWidth=getItemWidth();}var width=constants.itemWidth*dom.items.length;dom.carousel.css('width',width);var minLeft=(width-constants.viewPortWidth)*-1;constants.
carouselWidth=width;constants.minLeft=minLeft;}function attachBlindImages(){if(dom.carousel.find('li').length==5){dom.carousel.append("<li class='blind'></li>");}else if(dom.carousel.find('li').length==4){dom.carousel.append("<li class='blind'></li>");dom.carousel.append("<li class='blind'></li>");}dom.carousel.find('li').first().addClass("first-image");dom.carousel.find('li').last().addClass("last-image");}function disableNext(){states.enable_next=!1;dom.next.addClass('disabled');}function enableNext(){states.enable_next=!0;dom.next.removeClass('disabled');}function disablePrevious(){states.enable_previous=!1;dom.previous.addClass('disabled');}function enablePrevious(){states.enable_previous=!0;dom.previous.removeClass('disabled');}function getItemWidth(){return dom.items.first().outerWidth(true);}this.updateCarouselItems=function(){dom.items=dom.carousel.find('li');lazyLoadImages();};this.updateCarouselWidth=function(){setCarouselWidth();};this.updateCarouselArrows=function
(){updateArrows();};this.resetPosition=function(){dom.carousel.css('left',0);states.currIndex=0;}
return this.each(function(){if(typeof options.attachBlindImages=='function'){attachBlindImages();}dom.next.click(nextImage);dom.previous.click(previousImage);setCarouselWidth();setAsActive(options.activeIndex);if(options.itemClick){dom.carousel.on('click','li',function(e){setAsActive($(this).index());options.itemClick.call(this,e);});}lazyLoadImages();});}})(jQuery,this);;$.fn.extend({getModalTopOffset:function(){var top=Math.max((($(window).height()-this.outerHeight())/2),20);var opts=this.data('settings');if(opts&&typeof opts.topMaximum=="number"){top=Math.min(top,opts.topMaximum);}return $(window).scrollTop()+top;},makeModal:function(options){var settings={showCloseButton:!0,width:400,height:"auto",tabsOutsideContent:!1,topOffset:50,escapeToClose:!0},calculatedZIndex,modalWidth,mainContent;if(options){$.extend(settings,options);}var ts=Math.round((new Date()).getTime()/1000),id=settings.id||($(this).attr('id')||ts)+'Wrapper',wrapper;if(skin==='oasis'||settings.appendToBody){
wrapper=$('<section>',{'class':'modalWrapper','id':id}).append($('<section>',{'class':'modalContent'}).append(this)).appendTo('body');}else{this.wrap('<div class="modalWrapper" id="'+id+'"></div>');wrapper=this.closest(".modalWrapper");wrapper.appendTo('#positioned_elements');}if(settings.className){wrapper.addClass(settings.className);}var zIndex=settings.zIndex?parseInt(settings.zIndex):(5001101+($('body').children('.blackout').length)*2);calculatedZIndex=zIndex+1;wrapper.data('settings',settings);if(!settings.noHeadline){var headline=wrapper.find("h1:first");if(headline.exists()){headline.remove();}else{headline=$('<h1>').html($(this).attr('title')||'');}headline.prependTo(wrapper);}if(settings.tabsOutsideContent||skin==='oasis'){var modalTabs=wrapper.find('.modal-tabs');if(modalTabs.exists()){modalTabs.insertBefore(wrapper.find('.modalContent'));}}if(skin==='oasis'){if(settings.width!=='auto'){if(settings.width!==undefined){modalWidth=settings.width+40;}else{mainContent=$(
"#WikiaMainContent");if(mainContent.length>0){modalWidth=mainContent.width();}}}else{modalWidth='auto';}wrapper.width(modalWidth).css({left:'50%',height:settings.height,'margin-left':-wrapper.outerWidth(false)/2,top:$(window).scrollTop()+settings.topOffset,zIndex:calculatedZIndex});}else if(settings.suppressDefaultStyles){wrapper.css({zIndex:calculatedZIndex,top:$(window).scrollTop()+settings.topOffset});}else{wrapper.width(settings.width).css({marginLeft:-wrapper.outerWidth(false)/2,top:wrapper.getModalTopOffset(),zIndex:calculatedZIndex}).fadeIn("fast");}if(settings.showCloseButton){wrapper.prepend('<button class="close wikia-chiclet-button"><img src="'+stylepath+'/oasis/images/icon_close.png"></button>');}wrapper.log('makeModal: #'+id);this.removeAttr('title');var persistent=(typeof settings.persistent=='boolean')?settings.persistent:!1;var onClose=(typeof settings.onClose=='function')?settings.onClose:!1;var closeOnBlackoutClick=(typeof settings.closeOnBlackoutClick==
'boolean')?settings.closeOnBlackoutClick:!0;wrapper.find('.close').bind("click",function(){var wrapper=$(this).closest('.modalWrapper');var settings=wrapper.data('settings');if(typeof settings.onClose=='function'){if(settings.onClose({click:1})==false){return;}}if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}});if(settings.escapeToClose){$(window).bind("keydown.modal"+id,function(event){if(event.keyCode==27){if(typeof settings.onClose=='function'){if(settings.onClose({keypress:1})==false){return;}}if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}return false;}});}$(window).bind("resize.modal",function(){if(window.skin=='oasis'||!settings.resizeModal){return;}wrapper.css("top",wrapper.getModalTopOffset());$(".blackout:last").height($(document).height());});var blackoutOpacity=0.65;if(settings.blackoutOpacity){blackoutOpacity=settings.blackoutOpacity;}var blackout=$('<div>').addClass('blackout').attr('data-opacity',blackoutOpacity);blackout.css({zIndex:
zIndex}).fadeTo("fast",blackoutOpacity).bind("click",function(){if(!closeOnBlackoutClick){return;}if(typeof settings.onClose=='function'){if(settings.onClose({click:1})==false){return;}}if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}});if(skin=='oasis'||settings.appendToBody){blackout.appendTo("body");}else{blackout.appendTo("#positioned_elements");}wrapper.data('blackout',blackout);if(typeof settings.onCreate=='function'){settings.onCreate(this,wrapper);}$(document.body).addClass('modalShown');return wrapper;},closeModal:function(){$(window).unbind(".modal"+this.attr('id'));this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).remove();});var blackout=$(this).data('blackout'),settings=$(this).data('settings');blackout.fadeOut("fast",function(){$(this).remove();var callback=settings&&settings.onAfterClose;if($.isFunction(callback)){callback();}});$(document.body).removeClass('modalShown');},hideModal:function(){var blackout=$(this).data(
'blackout'),settings=$(this).data('settings');blackout.fadeOut("fast").addClass('blackoutHidden');this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).hide();var callback=settings&&settings.onAfterClose;if($.isFunction(callback)){callback();}});$(document.body).removeClass('modalShown');},showModal:function(){var wrapper=this.closest(".modalWrapper");var zIndex=5001101+($('body').children('.blackout').length)*2;var blackout=$(this).data('blackout');var blackoutOpacity=blackout.attr('data-opacity');if(!blackoutOpacity){blackoutOpacity=0.65;}blackout.css({display:'block',opacity:blackoutOpacity,zIndex:zIndex}).removeClass('blackoutHidden');wrapper.css({top:wrapper.getModalTopOffset(),zIndex:zIndex+1,opacity:1,display:"block"}).log('showModal: #'+this.attr('id'));$(document.body).addClass('modalShown');},resizeModal:function(width){width=parseInt(width);var wrapper=this.closest(".modalWrapper");wrapper.width(width).css('marginLeft',-wrapper.outerWidth(false)>>1)
.log('resizeModal: #'+this.attr('id')+' resized to '+width+'px');},isModalShown:function(){return $(document.body).hasClass('modalShown');},getModalWrapper:function(){return $('.modalWrapper');}});;$.expiryStorage=new $.store();$.expiryStorage.get=function(key){var value=this.driver.get(key);if(!value){return;}var data=this.driver.encodes?value:this.unserialize(value);value=null;var d=new Date();if(data.expires>=d.getTime()){value=data.value;}else{this.del(key);}return value;};$.expiryStorage.set=function(key,value,expires){var d;if(typeof expires=='number'){d=new Date();d.setTime(d.getTime()+(expires));}else if(typeof expires=='object'&&expires.toUTCString){d=expires;}else{throw'expires is not in a valid form';}var data={value:value,expires:d.getTime()};this.driver.set(key,this.driver.encodes?data:this.serialize(data));};;(function($){$.fn.focusNoScroll=function(){var x=$(window).scrollLeft(),y=$(window).scrollTop();$(this).focus();$(window).scrollLeft(x).scrollTop(y);return this;};})
(jQuery);;(function(window,$){'use strict';var getResources=(function(){var rAssetManagerGroup=new RegExp(window.wgAssetsManagerQuery.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&').replace(/\//g,'\\/').replace('%1\\$s','groups?').replace(/%\d\\\$(?:s|d)/g,'(.*)')),rAssetManagerGroupType=/(js|s?css)/,rExtension=/\.(js|s?css)$/;return function(resources,success,failure){var l,n,matches,remaining,complete,dfd=new $.Deferred(),resource,type;complete=function(){remaining--;if(remaining<1){if(typeof success==='function'){success();}dfd.resolve();}};if(!$.isArray(resources)){resources=[resources];}if(!(l=remaining=resources.length)){complete();}for(n=0;n<l;n++){resource=resources[n];type=typeof resource;if(type==='object'){if(resource.type&&resource.url){type=resource.type;resource=resource.url;}}else if(type==='string'){matches=resource.match(rAssetManagerGroup);matches=matches?matches[3].match(rAssetManagerGroupType):resource.match(rExtension);type=matches?matches[1]:'unknown';}if(type===
'js'){$.getScript(resource,complete).fail(failure);}else if(type==='css'||type==='scss'){$.getCSS(resource,complete);}else if(type==='function'){resource.call($,complete);}else{$().log('getResources: unknown type '+resource);dfd.reject({error:'Unknown type',resource:resource});}}return dfd.promise();};}());$.getResources=$.getResource=getResources;})(window,jQuery);;(function($){'use strict';$.loadLibrary=function(name,files,typeCheck,callback,failureFn){var dfd=new jQuery.Deferred();if(typeCheck==='undefined'){$().log('loading '+name,'loadLibrary');files=(typeof files==='string')?[files]:files;$.getResources(files,function(){$().log(name+' loaded','loadLibrary');if(typeof callback==='function'){callback();}},failureFn).then(function(){dfd.resolve();}).fail(function(){dfd.reject();});}else{$().log(name+' already loaded','loadLibrary');if(typeof callback==='function'){callback();}dfd.resolve();}return dfd.promise();};$.loadYUI=function(callback){return mw.loader.using('wikia.yui').done(
callback);};$.loadModalJS=function(callback){if(typeof callback==='function'){callback();}};$.loadJQueryUI=function(callback){return mw.loader.using('wikia.jquery.ui').done(callback);};$.loadJQueryAutocomplete=function(callback){return mw.loader.using('jquery.autocomplete').done(callback);};$.loadJQueryAIM=function(callback){return mw.loader.using('wikia.aim').done(callback);};$.loadMustache=function(callback){return mw.loader.using('jquery.mustache').done(callback);};$.loadHandlebars=function(callback){return mw.loader.using('wikia.handlebars').done(callback);};$.loadGoogleMaps=function(callback){var dfd=new jQuery.Deferred(),onLoaded=function(){if(typeof callback==='function'){callback();}dfd.resolve();};if(typeof(window.google&&window.google.maps)!=='undefined'){onLoaded();}else{window.onGoogleMapsLoaded=function(){delete window.onGoogleMapsLoaded;onLoaded();};$.loadLibrary('GoogleMaps',[{url:'https://maps.googleapis.com/maps/api/js?sensor=false&callback=onGoogleMapsLoaded',type:
'js'}],typeof(window.google&&window.google.maps)).fail(function(){dfd.reject();});}return dfd.promise();};$.loadGooglePlusAPI=function(callback){return $.loadLibrary('Google Plus API','//apis.google.com/js/plusone.js',typeof(window.gapi&&window.gapi.plusone),callback);};$.loadTwitterAPI=function(callback){return $.loadLibrary('Twitter API','//platform.twitter.com/widgets.js',typeof(window.twttr&&window.twttr.widgets),callback);};})(jQuery);;(function($){'use strict';function loadExternalLibrary(name,url,typeCheck){var $deferred=$.Deferred();if(window.wgNoExternals){$deferred.reject();}else if(typeCheck==='undefined'){addScriptToPage(url,$deferred);}else{Wikia.log(name+' already loaded',Wikia.log.levels.feedback,'loadExternalLibrary');$deferred.resolve();}return $deferred;}function addScriptToPage(url,$deferred){var firstScriptTag=document.getElementsByTagName('script')[0],scriptTag=document.createElement('script');scriptTag.src=url;scriptTag.onload=function(){$deferred.resolve();};
scriptTag.onerror=function(){$deferred.reject();};firstScriptTag.parentNode.insertBefore(scriptTag,firstScriptTag);}$.loadReCaptcha=function(){var url='https://www.google.com/recaptcha/api.js?hl='+window.wgUserLanguage;return loadExternalLibrary('ReCaptcha',url,typeof window.grecaptcha);};})(jQuery);;(function(window){'use strict';window.Wikia=window.Wikia||{};Wikia.isTouchScreen=function(){return('ontouchstart'in window);};if(Wikia.isTouchScreen()){$.getResources([$.getSassCommonURL('/skins/oasis/css/touchScreen.scss'),window.stylepath+'/oasis/js/touchScreen.js']);}})(window);;jQuery(function($){'use strict';var $article=$('#WikiaArticle'),$tables=$article.find('table'),$wikiaBarWrapper=$('#WikiaBarWrapper'),template='<div class="table-wrapper table-is-wide">'+'<div class="table-scrollable"></div>'+'</div>';function scan(){$tables.each(function(){var $table=$(this),$scrollable=$table.parent('.table-scrollable'),isWide=$table.width()>$article.width();if(isWide&&!$scrollable.length){
$table.wrap(template);$scrollable=$table.parent('.table-scrollable');}else if(!isWide&&$scrollable.length){$table.unwrap().unwrap();}$scrollable.floatingScrollbar(isWide);});}function updateFloatingScrollbar(){var bottom=$wikiaBarWrapper.length&&!$wikiaBarWrapper.hasClass('hidden')?$wikiaBarWrapper.height():0;$('#floating-scrollbar').css('bottom',bottom);$.floatingScrollbarOptions.bottom=bottom;}scan();$(window).on('resize',$.debounce(50,scan)).on('wikiaTabClicked WideTablesScan',scan).on('WikiaBarStateChanged WikiaBarReady UpdateFloatingScrollbar',updateFloatingScrollbar);});;define('wikia.backgroundchanger',function(){'use strict';var loadedCss=[];function load(options){var imagePreload=new Image(),optionsForSass={'background-dynamic':options.backgroundDynamic||!1,'background-image':options.skinImage||'','background-image-width':options.skinImageWidth||0,'background-image-height':options.skinImageHeight||0,'color-body':options.backgroundColor,'color-body-middle':options.
backgroundMiddleColor||options.backgroundColor},settings=$.extend({},window.wgSassParams,optionsForSass),settingsBreakpoints=$.extend({},settings,{widthType:0}),sassUrl=window.wgOasisBreakpoints?$.getSassCommonURL('/skins/oasis/css/core/breakpoints-background.scss',settingsBreakpoints):$.getSassCommonURL('/skins/oasis/css/core/background.scss',settings);imagePreload.src=options.skinImage;var onCssLoadCallBack=function(){if(options.skinImage!==''&&options.skinImageWidth>0&&options.skinImageHeight>0){if((options.backgroundFixed===undefined)||!!options.backgroundFixed){$('body').addClass('background-fixed');}else{$('body').removeClass('background-fixed');}if((options.backgroundTiled!==undefined)&&!!options.backgroundTiled){$('body').removeClass('background-not-tiled');}else{$('body').addClass('background-not-tiled');}if((options.backgroundDynamic===undefined)||!!options.backgroundDynamic){$('body').addClass('background-dynamic');}else{$('body').removeClass('background-dynamic');}if(!!
options.ten64){$('.background-image-gradient').addClass('no-gradients');}}else{$('body').removeClass('background-dynamic background-not-tiled background-fixed');}};var nodeIndex=loadedCss.indexOf(sassUrl);if(nodeIndex>-1){$('link[data-background-changer]').attr('disabled',true);$('link[data-background-changer="'+sassUrl+'"]').attr('disabled',false);onCssLoadCallBack();}else{$.getCSS(sassUrl,function(link){loadedCss.push(sassUrl);$(link).attr('data-background-changer',sassUrl);onCssLoadCallBack();});}}return{load:load};});;define('SearchAbTest.DomUpdater',['jquery','wikia.log'],function($,log){'use strict';var searchPaginationLinksSelector='.wikia-paginator a.paginator-page, .search-tabs a, a.paginator-next, a.paginator-prev',searchFormsSelector='form.WikiaSearch';return{linkUpdater:{update:function(params){if(!params){return;}var self=this;$(searchPaginationLinksSelector).each(function(){var originalLink=$(this).attr('href');if(!!originalLink){var modifiedLink=self.modifyLink(
originalLink,params);log('Modifying link: "'+originalLink+'" to "'+modifiedLink+'"',log.levels.debug,'search');$(this).attr('href',modifiedLink);}});},modifyLink:function(originalLink,params){params=params||{};var modifiedLink=originalLink;var joinCharacter="?";if(originalLink.indexOf('?')>-1){joinCharacter="&";}if(originalLink.indexOf('?')==originalLink.length-1){joinCharacter='';}for(var paramName in params){modifiedLink=modifiedLink+joinCharacter+paramName+'='+params[paramName];joinCharacter="&";}return modifiedLink;}},formUpdater:{update:function(params){if(!params){return;}var $searchForms=$(searchFormsSelector);for(var paramName in params){var newInput='<input type="hidden" name="'+paramName+'" value="'+params[paramName]+'">';$searchForms.append(newInput);log('Add new input: '+newInput,log.levels.debug,'search');}}}};});;define('SearchAbTest.Context',['wikia.window','wikia.log','wikia.querystring'],function(window,log,querystring){'use strict';if(!window||!window.Wikia||!window.
Wikia.AbTest){log('AbTest is not present. Fallback to dummy SearchAbTest.GroupProvider',log.levels.debug,'search');return{getAbTestGroups:function(){return[];},getAbTestParameters:function(){return{};},getQueryParameters:function(){return{};}};}var AbTest=window.Wikia.AbTest;function findSearchRelatedExperiments(){var searchExperiments=[];var experiments=AbTest.getExperiments();for(var i=0;i<experiments.length;i++){var experiment=experiments[i];if(experiment&&experiment.name&&experiment.name.toUpperCase().indexOf('SEARCH')===0){searchExperiments.push(experiment);}}return searchExperiments;}return{getAbTestGroups:function(){var searchRelatedExperiments=findSearchRelatedExperiments();var groupIds=[];for(var i=0;i<searchRelatedExperiments.length;i++){if(searchRelatedExperiments[i].group){groupIds.push(searchRelatedExperiments[i].group.id);}}log('Found A/B groups: '+groupIds.join(','),log.levels.debug,'search');return groupIds;},getQueryParameters:function(){var str=querystring(window.
location.url);return str.getVals();},getAbTestParameters:function(){var parameters={};var allParameters=this.getQueryParameters();for(var parameterName in allParameters){if(parameterName.indexOf('AbTest.')===0||parameterName=='ab'){parameters[parameterName]=allParameters[parameterName];}}return parameters;}};});;require(['wikia.window','SearchAbTest.Context','SearchAbTest.DomUpdater','wikia.log'],function(window,context,domUpdater,log){'use strict';var abGroupParameterName='ab';if(window.Wikia&&window.Wikia.AbTest){log('AbTest is present. Enable Search A/B testing.',log.levels.debug,'search');var updaters=[domUpdater.linkUpdater,domUpdater.formUpdater];var groups=context.getAbTestGroups();var parametersToEnforce={};if(groups.length){parametersToEnforce[abGroupParameterName]=groups.join(',');}var abTestingParameters=context.getAbTestParameters();for(var parameterName in abTestingParameters){parametersToEnforce[parameterName]=abTestingParameters[parameterName];}for(var i=0;i<updaters.
length;i++){updaters[i].update(parametersToEnforce);}}});;require(['jquery','wikia.window','wikia.tracker'],function($,win,tracker){'use strict';var ARTICLE_LENGTH_THRESHOLD=800,SCALE=100,WIDTH_SAMPLING_RATIO=1,$article,labelPrefix,trackFunction,windowWidth;if(Math.random()*100<WIDTH_SAMPLING_RATIO&&win.wgIsArticle){$article=$('.WikiaArticle');trackFunction=tracker.buildTrackingFunction({action:tracker.ACTIONS.IMPRESSION,category:'articleContentLengthTest',trackingMethod:'analytics'});windowWidth=Math.floor($(win).width()/SCALE);if($article.height()>ARTICLE_LENGTH_THRESHOLD){labelPrefix='long-';}else{labelPrefix='short-';}trackFunction({label:labelPrefix+windowWidth})}});;$(function(){'use strict';function getParamsFromUrl(){var params={},paramVal,qs=Wikia.Querystring(),i=0,paramsToPreserve=['noexternals','noads','uselang','mcache','rebuildmessages'],paramsToPreserveLength=paramsToPreserve.length;for(i=0;i<paramsToPreserveLength;i++){paramVal=qs.getVal(paramsToPreserve[i]);if(paramVal
!==undefined){params[paramsToPreserve[i]]=paramVal;}}return params;}var rail=$('#WikiaRail'),LAZY_LOADING_SAMPLING_RATIO=10,params={},lazyLoadingTime;rail.trigger('beginLoad.rail');if(rail.find('.loading').exists()){params={'articleTitle':window.wgTitle,'namespace':window.wgNamespaceNumber,'cb':window.wgStyleVersion};if(typeof wgSassLoadedScss!=='undefined'){params.excludeScss=window.wgSassLoadedScss;}$.extend(params,getParamsFromUrl());$.nirvana.sendRequest({controller:'RailController',method:(window.wgUserName)?'lazy':'lazyForAnons',data:params,type:'get',format:'json',callback:function(data){var loadRailContents=function(data){rail.addClass('loaded').find('.loading').remove().end().append(data.railLazyContent+data.js);if(LAZY_LOADING_SAMPLING_RATIO>=Math.floor((Math.random()*100+1))){lazyLoadingTime=(new Date())-(window.wgNow||0);Wikia.Tracker.track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:'right-rail',label:'lazy-loaded',trackingMethod:'analytics',value:lazyLoadingTime});}
if(window.ChatWidget&&typeof window.wgWikiaChatUsers!=='undefined'){window.ChatWidget.init();}if(typeof $.fn.timeago!=='undefined'){rail.find('.timeago').timeago();}if(window.Wikia&&window.Wikia.initRailTracking){Wikia.initRailTracking();}require(['wikia.window',require.optional('ext.wikia.adEngine.adContext'),require.optional('ext.wikia.adEngine.slot.floatingMedrec'),],function(win,adContext,floatingMedrec){if(!adContext){return;}if(floatingMedrec){win.wgAfterContentAndJS.push(floatingMedrec.init);}});if(window.wgEnableLightboxExt){window.LightboxLoader.init();}rail.trigger('afterLoad.rail');};if(data.css.length===0){loadRailContents(data);}else{require(['wikia.loader'],function(loader){loader({type:loader.CSS,resources:data.css}).done(function(){loadRailContents(data);});});}}});}});;define('wikia.pageShare',['wikia.window','wikia.tracker','wikia.log','jquery'],function(win,tracker,log,$){'use strict';var trackFunc=tracker.buildTrackingFunction({action:win.Wikia.Tracker.ACTIONS.CLICK
,category:'social-share',trackingMethod:'analytics'});function shareLinkClickHandler(event){event.stopPropagation();event.preventDefault();var service=$(event.target).closest('a'),url=service.prop('href'),title=service.prop('title'),h=Math.floor(win.innerHeight/2),w=Math.floor(win.innerWidth/2);trackFunc({label:service.data('share-service')});win.open(url,title,'width='+w+',height='+h);}function prepareSocialLinks(data){if(data.socialIcons){var url=encodeURIComponent(win.location.origin+win.location.pathname),title=encodeURIComponent(win.document.title),description=encodeURIComponent($('meta[property="og:description"]').attr('content'));data.socialIcons=data.socialIcons.replace(/\$url/g,url).replace(/\$title/g,title).replace(/\$description/g,description);return data;}}function loadShareIcons(){var mCacheQueryStringParam=$.getUrlVar('mcache'),requestData={lang:getShareLang($.getUrlVar('uselang')),isTouchScreen:win.Wikia.isTouchScreen()?1:0,title:win.wgPageName};if(mCacheQueryStringParam
){requestData.mcache=mCacheQueryStringParam;}return $.nirvana.sendRequest({type:'GET',controller:'PageShare',method:'getShareIcons',data:requestData}).then(prepareSocialLinks);}function getShareLang(useLangQueryStringParam){if(useLangQueryStringParam){return useLangQueryStringParam;}else if(win.wgUserName){return win.wgUserLanguage;}else if(win.navigator.languages){return win.navigator.languages[0].substr(0,2);}else if(win.navigator.language){return win.navigator.language.substr(0,2);}else if(win.navigator.userLanguage){return win.navigator.userLanguage.substr(0,2);}else{log('Couldn\'t pick a language for Page Share extension.',log.levels.debug,'PageShare');return null;}}return{loadShareIcons:loadShareIcons,getShareLang:getShareLang,shareLinkClickHandler:shareLinkClickHandler};});;require(['wikia.pageShare','wikia.ui.factory','jquery'],function(pageShare,uiFactory,$){'use strict';$('#ShareEntryPoint').click(function(){$.when(uiFactory.init(['modal']),pageShare.loadShareIcons()).then(
function(uiModal,modalData){uiModal.createComponent({vars:{id:'PageShareModalDialog',classes:['page-share-modal-dialog'],size:'small',title:modalData.modalTitle,content:modalData.socialIcons,}},function(pageShareModal){pageShareModal.$element.find('#PageShareToolbar').on('click','a',pageShare.shareLinkClickHandler);pageShareModal.show();});});});});;window.Wikia=window.Wikia||{};window.Wikia.getMultiTypePackage=function(options){var request={},templates=options.templates,fieldsToCopy=['styles','scripts','messages','mustache','handlebars'],callback=options.callback,params=options.params,send=!1;$.each(fieldsToCopy,function(){if(typeof options[this]==='string'){request[this]=options[this];send=!0;}});if(typeof templates!='undefined'){request.templates=(typeof templates==='object')?JSON.stringify(templates):templates;send=!0;}if(typeof params==='object'){request=$.extend(request,params);}if(send){request.cb=wgStyleVersion;return $.nirvana.getJson('AssetsManagerController',
'getMultiTypePackage',request,function(resources){if(resources.messages){wgMessages=$.extend(wgMessages,resources.messages);}if(typeof callback==='function'){callback(resources);}});}else{throw'No resources to load specified';}};window.Wikia.processScript=function(js){var script=document.createElement('script'),head=document.head||document.getElementsByTagName('head')[0];script.type='text/javascript';script.text=js;head.appendChild(script);};window.Wikia.processStyle=function(css){var style=document.createElement('style'),head=document.head||document.getElementsByTagName('head')[0];style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(document.createTextNode(css));}head.appendChild(style);};window.Wikia.getAMgroups=function(groups,callback){return $.getScript($.getAssetManagerGroupUrl(groups),callback);};;(function(context){var shift=Array.prototype.shift,join=Array.prototype.join;function JSMessages(nirvana,$,window){var JSMessages=function(){
var key=(shift.call(arguments)||'').trim(),ret=key;if(window.wgMessages){ret=window.wgMessages[key]||ret;ret=Plurals.process(ret,arguments,window.wgUserLanguage);if(ret!==key&&arguments.length){for(var i=0,l=arguments.length;i<l;i++){ret=ret.replace(new RegExp('\\$'+(i+1),'g'),arguments[i]);}}}return ret;};JSMessages.get=function(packages,callback,language){var dfd=$.Deferred();if(typeof packages!='string'){packages=join.call(packages,',');}language=language||window.wgUserLanguage;nirvana.sendRequest({type:'GET',controller:'JSMessages',method:'getMessages',data:{packages:packages,uselang:language,cb:window.wgJSMessagesCB}}).then(function(result){window.wgMessages=$.extend(window.wgMessages||{},result.messages);if(typeof callback=='function'){callback();}dfd.resolve();}).fail(function(){dfd.reject();});return dfd.promise();};JSMessages.getForContent=function(packages,callback){return JSMessages.get(packages,callback,window.wgContentLanguage);};return JSMessages;}var Plurals={
defaultPluralRule:function(n){return(n!=1)?1:0;},pluralRules:{'ay bo cgg dz fa id ja jbo ka kk km ko ky lo ms su th tr tt ug uz vi wo zh zh-hans zh-hant zh-tw':function(){return 0;},'ach ak am arn br fil fr gun ln mfe mg mi nso oc pt-br ti wa':function(n){return(n>1)?1:0;},'cs sk':function(n){return(n==1)?0:((n>=2&&n<=4)?1:2);},'be bs ru sr uk':function(n){return(n%10==1&&n%100!=11)?0:((n%10>=2&&n%10<=4&&(n%100<10||n%100>=20))?1:2);},'jv':function(n){return(n!=0)?1:0;},'mk':function(n){return(n==1||n%10==1)?0:1;},'mnk':function(n){return(n==0)?0:n==1?1:2;},'lv':function(n){return(n%10==1&&n%100!=11)?0:((n!=0)?1:2);},'kw':function(n){return(n==1)?0:((n==2)?1:((n==3)?2:3));},'ro':function(n){return(n==1)?0:((n==0||(n%100>0&&n%100<20))?1:2);},'ga':function(n){return(n==1)?0:((n==2)?1:((n<7)?2:((n<11)?3:4)));},'gd':function(n){return(n==1||n==11)?0:(n==2||n==12)?1:(n>2&&n<20)?2:3;},'sl':function(n){return(n%100==1)?0:((n%100==2)?1:((n%100==3||n%100==4)?2:3));},'pl':function(n){return(n==1)
?0:((n%10>=2&&n%10<=4&&(n%100<10||n%100>=20))?1:2);},'csb':function(n){return(n==1)?0:((n%10>=2&&n%10<=4&&(n%100<10||n%100>=20))?1:2);},'lt':function(n){return(n%10==1&&n%100!=11)?0:((n%10>=2&&(n%100<10||n%100>=20))?1:2);},'cy':function(n){return(n==0)?0:((n==1)?1:((n==2)?2:((n==3)?3:((n==6)?4:5))));},'hr':function(n){return(n%10==1&&n%100!=11)?0:((n%10>=2&&n%10<=4&&(n%100<10||n%100>=20))?1:2);},'mt':function(n){return(n==1)?0:((n==0||(n%100>1&&n%100<11))?1:((n%100>10&&n%100<20)?2:3));},'ar':function(n){return(n==0)?0:((n==1)?1:((n==2)?2:((n%100>=3&&n%100<=10)?3:((n%100>=11&&n%100<=99)?4:5))));}},getPluralRuleFunction:function(lang){if(typeof Plurals.pluralRules[lang]==="undefined"){var ruleFunction=Plurals.defaultPluralRule,langs=[lang],mainLanguage=lang.split('-'),i;if(mainLanguage.length>1){langs.push(mainLanguage[0]);}for(i=0;(i<langs.length)&&(ruleFunction===Plurals.defaultPluralRule);i++){var langRegexp=new RegExp('(?:^| )'+langs[i]+'(?: |$)');for(var langKey in Plurals.
pluralRules){if(Plurals.pluralRules.hasOwnProperty(langKey)){if(langRegexp.test(langKey)){ruleFunction=Plurals.pluralRules[langKey];break;}}}}Plurals.pluralRules[lang]=ruleFunction;}return Plurals.pluralRules[lang];},getPlural:function(forms,ruleFunction,n){var plural=isNaN(n)?-1:ruleFunction(n);if((plural<0)||(plural>=forms.length)){plural=forms.length-1;}return forms[plural];},process:function(msg,msgArguments,language){msg=msg.replace(/\{\{PLURAL:\$(\d+)\|([^\{\}]+)\}\}/gi,function(wholeMsg,variable,forms){var cardinality=NaN;if((variable>0)&&(variable<=msgArguments.length)){cardinality=msgArguments[variable-1];if(typeof cardinality!=="number"){cardinality=parseInt(cardinality);}}return Plurals.getPlural(forms.split('|'),Plurals.getPluralRuleFunction(language),cardinality);});return msg;}};if(jQuery){var msg=JSMessages(jQuery.nirvana,jQuery,context);jQuery.extend(jQuery,{msg:msg,getMessages:msg.get,getMessagesForContent:msg.getForContent})}if(context.define&&context.define.amd){
context.define('JSMessages',['wikia.nirvana','jquery','wikia.window'],JSMessages);}})(this);;(function(window,$,mw){var action=window.wgAction,wgCategorySelect=window.wgCategorySelect;if(!wgCategorySelect||(action!='view'&&action!='purge')){return;}$(function(){var articleId=window.wgArticleId,loaded=!1,namespace='categorySelectView',$wrapper=$('#articleCategories');if(!$wrapper.hasClass('userCanEdit')){return;}$wrapper.on('click.'+namespace,'.add',function(){$wrapper.addClass('editMode').find('.input').focus();if(!loaded){loaded=!0;$.when(mw.loader.using('jquery.ui.autocomplete'),mw.loader.using('jquery.ui.sortable'),$.getResources([wgResourceBasePath+'/resources/wikia/libraries/mustache/mustache.js',wgResourceBasePath+'/extensions/wikia/CategorySelect/js/CategorySelect.js',wgResourceBasePath+'/resources/wikia/modules/uifactory.js',wgResourceBasePath+'/resources/wikia/modules/uicomponent.js'])).done(function(response){$wrapper.categorySelect({placement:'right',popover:{hint:!0}
,sortable:{axis:!1,forcePlaceholderSize:!0,items:'.new',revert:200}}).on('add',function(event,cs,data){$wrapper.find('.last').before(data.element);}).on('click.'+namespace,'.cancel',function(){track({label:'cancel-edit'});$wrapper.removeClass('editMode').trigger('reset').find('.category.new').remove();}).on('click.'+namespace,'.save',function(){track({label:'submit-save'});var $container=$wrapper.find('.container').startThrobbing();$(this).attr('disabled',true);$.nirvana.sendRequest({controller:'CategorySelectController',data:{articleId:articleId,categories:$wrapper.data('categorySelect').getData('.new'),token:mw.user.tokens.get('editToken')},method:'save'}).done(function(response){$container.stopThrobbing();if(response.error){throw'Saving error: '+response.error;}else{$wrapper.removeClass('editMode').find('.category').remove();$wrapper.find('.last').before(response.html);$wrapper.find('.input').val('');}}).fail(function(response){$container.stopThrobbing();throw'Saving error: '+
response.responseText});}).on('update',function(){var modified=$wrapper.find('.category.new').length>0;$wrapper.toggleClass('modified',modified).find('.save').prop('disabled',!modified);});});}});var track=Wikia.Tracker.buildTrackingFunction(Wikia.trackEditorComponent,{action:Wikia.Tracker.ACTIONS.CLICK,category:'category-tool',trackingMethod:'analytics'})});})(window,window.jQuery,window.mw);;(function(){'use strict';var WikiaForm=function(el){this.el=$(el);this.form=this.el.is('form')?this.el:this.el.find('form');if(!this.form.length){Wikia.log('WikiaForm with selector "'+this.el.selector+'" doesn\'t include a form element',Wikia.log.levels.error,'WikiaForm');}this.initGenericError();this.initGenericSuccess();this.setInputs();this.inputGroups={};this.el.find('[rel=tooltip]').tooltip();};WikiaForm.prototype.initGenericError=function(){this.genericError=this.el.find('.general-errors');if(this.genericError.length===0){this.el.find('fieldset').prepend(
'<div class="input-group general-errors error"><div class="error-msg"></div></div>');this.genericError=this.el.find('.general-errors');this.genericError.hide();this.genericErrorMsg=this.genericError.find('.error-msg');}};WikiaForm.prototype.initGenericSuccess=function(){this.genericSuccess=this.el.find('.general-success');if(this.genericSuccess.length===0){this.el.find('fieldset').prepend('<div class="input-group general-success success"><div class="success-msg"></div></div>');this.genericSuccess=this.el.find('.general-success');this.genericSuccess.hide();this.genericSuccessMsg=this.genericSuccess.find('.success-msg');}};WikiaForm.prototype.setInputs=function(){var inputs,$input,i,name;this.inputs={};inputs=this.el.find('input, select, textarea');for(i=0;i<inputs.length;i++){$input=$(inputs[i]);name=$input.attr('name');if(name){this.inputs[name]=$input;}}};WikiaForm.prototype.showGenericError=function(msg){this.genericError.show();this.showErrorMsg(this.genericError,msg);};WikiaForm.
prototype.showGenericSuccess=function(msg){this.genericSuccess.show();this.showSuccessMsg(this.genericSuccess,msg);};WikiaForm.prototype.getInputGroup=function(name){var input,inputGroup=this.inputGroups[name];if(!inputGroup){inputGroup=this.inputs[name].closest('.input-group');if(!inputGroup.length){input=this.el.find('input[name='+name+']');if(input.length!==0){inputGroup=input.closest('.input-group');}}if(inputGroup.length!==0){this.inputGroups[name]=inputGroup;}}return inputGroup;};WikiaForm.prototype.showInputError=function(name,msg){var inputGroup=this.getInputGroup(name);if(inputGroup){inputGroup.addClass('error').removeClass('success');this.showErrorMsg(inputGroup,msg);}};WikiaForm.prototype.clearInputError=function(name){var inputGroup=this.getInputGroup(name);inputGroup.removeClass('error').addClass('success');this.clearErrorMsg(inputGroup);};WikiaForm.prototype.showErrorMsg=function(inputGroup,msg){var errorMsg=inputGroup.find('.error-msg');if(!errorMsg.length){errorMsg=
'<div class="error-msg"></div>';inputGroup.append(errorMsg);errorMsg=inputGroup.find('.error-msg');}errorMsg.html(msg);};WikiaForm.prototype.showSuccessMsg=function(inputGroup,msg){var successMsg=inputGroup.find('.success-msg');if(!successMsg.length){successMsg='<div class="success-msg"></div>';inputGroup.append(successMsg);successMsg=inputGroup.find('.success-msg');}successMsg.text(msg);};WikiaForm.prototype.clearErrorMsg=function(inputGroup){inputGroup.find('.error-msg').remove();};WikiaForm.prototype.clearSuccessMsg=function(inputGroup){inputGroup.find('.success-msg').remove();};WikiaForm.prototype.clearGenericError=function(inputGroup){inputGroup.hide().find('.error-msg').remove();};WikiaForm.prototype.clearGenericSuccess=function(inputGroup){inputGroup.hide().find('.success-msg').remove();};WikiaForm.prototype.clearAllInputErrors=function(){for(var key in this.inputGroups){this.clearInputError(key);}};WikiaForm.prototype.disableAll=function(){$.each(this.inputs,function(){this.
attr('disabled',true);});};window.WikiaForm=WikiaForm;})();;define('wikia.csspropshelper',['wikia.document'],function(document){'use strict';var prefixArray=['Moz','webkit','ms','O'],prefixArrayLength=prefixArray.length;function checkForSupportedProp(propArray){var root=document.documentElement,i,length=propArray.length;for(i=0;i<length;i++){var prop=propArray[i];if(prop in root.style){return prop;}}return false;}function createPropArray(prop){var i,result=[prop],formattedProp=prop.charAt(0).toUpperCase()+prop.slice(1);for(i=0;i<prefixArrayLength;i++){var str=prefixArray[i]+formattedProp;result.push(str);}return result;}function formatName(prop){var i,tempArray=prop.split('-'),length=tempArray.length,result=[tempArray[0]];for(i=1;i<length;i++){var tempStr=tempArray[i],str=tempStr.charAt(0).toUpperCase()+tempStr.slice(1);result.push(str)}return result.join('');}function getSupportedProp(prop){var formattedProp=formatName(prop),prefixedPropArray=createPropArray(formattedProp),
supportedProp=checkForSupportedProp(prefixedPropArray);if(supportedProp===false){throw new Error('Requested CSS property - '+prop+' is not supported by your browser!');}return supportedProp;}return{formatName:formatName,getSupportedProp:getSupportedProp}});;define('wikia.fluidlayout',function(){'use strict';var WIDTH_OUTSIDE_MIN=768,WIDTH_OUTSIDE_MAX=1300,WIDTH_OUTSIDE=1030,WIDTH_GUTTER=20,ARTICLE_BORDER_WIDTH=1,WIDTH_ADSKIN=170,BREAKPOINT_SMALL=1023,RIGHT_RAIL_WIDTH=300;function getMinArticleWidth(){return WIDTH_OUTSIDE_MIN;}function getMaxArticleWidth(){return WIDTH_OUTSIDE_MAX;}function getWidthGutter(){return WIDTH_GUTTER;}function getArticleBorderWidth(){return ARTICLE_BORDER_WIDTH;}function getWidthPadding(){return WIDTH_GUTTER/2;}function getBreakpointSmall(){return BREAKPOINT_SMALL;}function getBreakpointContent(){return WIDTH_OUTSIDE;}function getBreakpointFluid(){return WIDTH_OUTSIDE+2*WIDTH_ADSKIN;}function getAdSkinWidth(){return WIDTH_ADSKIN;}function getBreakpointMin(){
return WIDTH_OUTSIDE_MIN;}function getBreakpointMax(){return WIDTH_OUTSIDE_MAX+2*WIDTH_ADSKIN;}function getRightRailWidth(){return RIGHT_RAIL_WIDTH;}return{getMinArticleWidth:getMinArticleWidth,getMaxArticleWidth:getMaxArticleWidth,getWidthGutter:getWidthGutter,getArticleBorderWidth:getArticleBorderWidth,getWidthPadding:getWidthPadding,getBreakpointSmall:getBreakpointSmall,getBreakpointContent:getBreakpointContent,getBreakpointFluid:getBreakpointFluid,getBreakpointMin:getBreakpointMin,getBreakpointMax:getBreakpointMax,getRightRailWidth:getRightRailWidth,getAdSkinWidth:getAdSkinWidth};});;define('wikia.breakpointsLayout',function(){'use strict';var WIDTH_OUTSIDE_MIN=768,CONTENT_BORDER=1,BREAKPOINT_LARGE_CONTENT_WIDTH=1238,BREAKPOINT_LARGE_PADDING_WIDTH=30,BREAKPOINT_MEDIUM_CONTENT_WIDTH=1064,BREAKPOINT_MEDIUM_PADDING_WIDTH=20,BREAKPOINT_MIN_CONTENT_WIDTH=768,BREAKPOINT_MIN_PADDING_WIDTH=24,RIGHT_RAIL_WIDTH_PLUS_SPACING=320;function getArticleContentMaxWidth(isWidePage){var articleWidth=
BREAKPOINT_LARGE_CONTENT_WIDTH-2*BREAKPOINT_LARGE_PADDING_WIDTH;return isWidePage?articleWidth:articleWidth-RIGHT_RAIL_WIDTH_PLUS_SPACING;}function getArticleContentMediumWidth(isWidePage){var articleWidth=BREAKPOINT_MEDIUM_CONTENT_WIDTH-2*BREAKPOINT_MEDIUM_PADDING_WIDTH;return isWidePage?articleWidth:articleWidth-RIGHT_RAIL_WIDTH_PLUS_SPACING;}function getArticleContentMinWidth(){return BREAKPOINT_MIN_CONTENT_WIDTH-2*(BREAKPOINT_MIN_PADDING_WIDTH+CONTENT_BORDER);}function getArticlePadding(){return BREAKPOINT_MEDIUM_PADDING_WIDTH;}function getRailWidthWithSpacing(){return RIGHT_RAIL_WIDTH_PLUS_SPACING;}function getLargeContentWidth(){return BREAKPOINT_LARGE_CONTENT_WIDTH;}function getArticleWidth(breakpoint,isWidePage){switch(breakpoint){case'current':return getArticleContentMediumWidth(isWidePage);case'max':return getArticleContentMaxWidth(isWidePage);case'min':return getArticleContentMinWidth();default:return getArticleContentMinWidth();}}function getArticleMinWidth(){return WIDTH_OUTSIDE_MIN
;}return{getArticleMinWidth:getArticleMinWidth,getArticlePadding:getArticlePadding,getArticleWidth:getArticleWidth,getLargeContentWidth:getLargeContentWidth,getRailWidthWithSpacing:getRailWidthWithSpacing};});;!function($){"use strict";var Tooltip=function(element,options){this.init('tooltip',element,options)}
Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut
this.type=type
this.$element=$(element)
this.options=this.getOptions(options)
this.enabled=!0
if(this.options.trigger!='manual'){eventIn=this.options.trigger=='hover'?'mouseenter':'focus'
eventOut=this.options.trigger=='hover'?'mouseleave':'blur'
this.$element.on(eventIn,this.options.selector,$.proxy(this.enter,this))
this.$element.on(eventOut,this.options.selector,$.proxy(this.leave,this))}this.options.selector?(this._options=$.extend({},this.options,{trigger:'manual',selector:''})):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,options,this.$element.data())
if(options.delay&&typeof options.delay=='number'){options.delay={show:options.delay,hide:options.delay}}return options},enter:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type)
if(!self.options.delay||!self.options.delay.show)return self.show()
clearTimeout(this.timeout)
self.hoverState='in'
this.timeout=setTimeout(function(){if(self.hoverState=='in')self.show()},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type)
if(this.timeout)clearTimeout(this.timeout)
if(!self.options.delay||!self.options.delay.hide)return self.hide()
self.hoverState='out'
this.timeout=setTimeout(function(){if(self.hoverState=='out')self.hide()},self.options.delay.hide)},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp
if(this.hasContent()&&this.enabled){$tip=this.tip()
this.setContent()
if(this.options.animation){$tip.addClass('fade')}placement=typeof this.options.placement=='function'?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement
inside=/in/.test(placement)
$tip.remove().css({top:0,left:0,display:'block'}).appendTo(inside?this.$element:document.body)
if(this.options&&this.options['z-index']){$tip.css('z-index',this.options['z-index']);}pos=this.getPosition(inside)
actualWidth=$tip[0].offsetWidth
actualHeight=$tip[0].offsetHeight
switch(inside?placement.split(' ')[1]:placement){case'bottom':tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}
break
case'top':tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}
break
case'left':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}
break
case'right':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}
break
case'wikiaBar':tp={top:pos.top-actualHeight,right:0}
break
case'wikiaBarMessage':tp={top:pos.top-actualHeight,right:0}
break}$tip.css(tp).addClass(placement).addClass('in')}},isHTML:function(text){return typeof text!='string'||(text.charAt(0)==="<"&&text.charAt(text.length-1)===">"&&text.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(text)},setContent:function(){var $tip=this.tip(),title=this.getTitle()
$tip.find('.tooltip-inner')[this.isHTML(title)?'html':'text'](title)
$tip.removeClass('fade in top bottom left right')},hide:function(){var that=this,$tip=this.tip()
$tip.removeClass('in')
function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).remove()},500)
$tip.one($.support.transition.end,function(){clearTimeout(timeout)
$tip.remove()})}$.support.transition&&this.$tip.hasClass('fade')?removeWithAnimation():$tip.remove()
return this;},fixTitle:function(){var $e=this.$element
if($e.attr('title')||typeof($e.attr('data-original-title'))!='string'){$e.attr('data-original-title',$e.attr('title')||'').removeAttr('title')}},hasContent:function(){return this.getTitle()},getPosition:function(inside){return $.extend({},(inside?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var title,$e=this.$element,o=this.options
title=$e.attr('data-original-title')||(typeof o.title=='function'?o.title.call($e[0]):o.title)
return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide()
this.$element=null
this.options=null}},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass('in')?'hide':'show']()}}
$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data('tooltip'),options=typeof option=='object'&&option
if(!data)$this.data('tooltip',(data=new Tooltip(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.tooltip.Constructor=Tooltip
$.fn.tooltip.defaults={animation:!0,placement:'top',selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:'hover',title:'',delay:0}}(window.jQuery);;!function($){"use strict";var Popover=function(element,options){this.init('popover',element,options)}
Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent()
$tip.find('.popover-title')[this.isHTML(title)?'html':'text'](title)
$tip.find('.popover-content')[this.isHTML(content)?'html':'text'](content)
$tip.removeClass('fade top bottom left right in')},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var content,$e=this.$element,o=this.options
content=$e.attr('data-content')||(typeof o.content=='function'?o.content.call($e[0]):o.content)
return content},tip:function(){if(!this.$tip){this.$tip=$(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off('.'+this.type).removeData(this.type)}})
$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data('popover'),options=typeof option=='object'&&option
if(!data)$this.data('popover',(data=new Popover(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.popover.Constructor=Popover
$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:'right',content:'',template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"></div></div></div>'})}(window.jQuery);;WikiaSearchApp=(function(){function WikiaSearchApp(id){this.id=id;this.searchForm=$(id);this.positionRight=this.searchForm.innerWidth()-this.searchForm.children('input:first-child').outerWidth()+4;this.searchField=this.searchForm.children('input[placeholder]');this.ads=$("[id$='TOP_RIGHT_BOXAD']");if(!this.searchForm.hasClass('noautocomplete')){this.searchField.bind({'suggestShow':$.proxy(this.hideAds,this),'suggestHide':$.proxy(this.showAds,this)});this.searchField.one('focus',$.proxy(this.initSuggest,this));}}WikiaSearchApp.prototype.track=Wikia.Tracker.buildTrackingFunction({trackingMethod:'internal'});WikiaSearchApp.prototype.hideAds=function(){this.ads.each(function(){$(this).children().css('margin-left','-9999px');})
;};WikiaSearchApp.prototype.showAds=function(){this.ads.each(function(){$(this).children().css('margin-left','auto');});};WikiaSearchApp.prototype.initSuggest=function(){$.when($.loadJQueryAutocomplete()).then($.proxy(function(){this.searchField.autocomplete({serviceUrl:wgScript+'?action=ajax&rs=getLinkSuggest&format=json',onSelect:$.proxy(function(value,data,event){var valueEncoded=encodeURIComponent(value.replace(/ /g,'_')),location=wgArticlePath.replace(/\$1/,valueEncoded).replace(encodeURIComponent('/'),'/');this.track({eventName:'search_start_suggest',sterm:valueEncoded,rver:0});if(event.button===1||event.metaKey||event.ctrlKey){window.open(location);return false;}else{window.location.href=location;}},this),appendTo:this.id,deferRequestBy:400,minLength:3,maxHeight:1000,selectedClass:'selected',width:'100%',positionRight:this.positionRight+'px',skipBadQueries:!0});if(window.Wikia.newSearchSuggestions){window.Wikia.newSearchSuggestions.setAsMainSuggestions('search');}},this));};
return WikiaSearchApp;})();$(function(){new WikiaSearchApp('#WikiaSearch');new WikiaSearchApp('#HeaderWikiaSearch');});;var WikiaFooterApp={init:function(){'use strict';if(window.wgEnableWikiaBarExt){this.footer=$('#WikiaBarWrapper').find('.wikia-bar');}else{this.footer=$('#WikiaFooter');}this.toolbar=this.footer.children('.toolbar');this.windowObj=$(window);this.originalWidth=this.toolbar.width();if(this.toolbar.exists()){if(!(navigator.platform in{'iPad':'','iPhone':'','iPod':''}||(navigator.userAgent.match(/android/i)!==null))){this.addScrollEvent();this.addResizeEvent();}this.tcToolbar=new ToolbarCustomize.Toolbar(this.footer.find('.tools'));}},addScrollEvent:function(){'use strict';WikiaFooterApp.windowObj.off('scroll.FooterAp');WikiaFooterApp.windowObj.on('scroll.FooterAp',WikiaFooterApp.resolvePosition).triggerHandler('scroll');},addResizeEvent:function(){'use strict';WikiaFooterApp.windowObj.on('resize',WikiaFooterApp.centerBar).triggerHandler('resize');},centerBar:function(){
'use strict';var w=WikiaFooterApp.windowObj.width();if(w<WikiaFooterApp.originalWidth&&WikiaFooterApp.footer.hasClass('float')){WikiaFooterApp.toolbar.css('width',w+10);if(!WikiaFooterApp.toolbar.hasClass('small')){WikiaFooterApp.toolbar.addClass('small');}}else if(WikiaFooterApp.toolbar.hasClass('small')){WikiaFooterApp.toolbar.css('width',WikiaFooterApp.originalWidth);WikiaFooterApp.toolbar.removeClass('small');}WikiaFooterApp.resolvePosition();},resolvePosition:function(){'use strict';if(window.wgIsEditPage){return;}var scrollTop=WikiaFooterApp.windowObj.scrollTop(),scroll=scrollTop+WikiaFooterApp.windowObj.height(),line=0;if(WikiaFooterApp.footer.offset()){line=WikiaFooterApp.footer.offset().top+WikiaFooterApp.toolbar.outerHeight();}if(scroll>line&&WikiaFooterApp.footer.hasClass('float')){WikiaFooterApp.footer.removeClass('float');WikiaFooterApp.centerBar();}else if(scroll<line&&!WikiaFooterApp.footer.hasClass('float')){WikiaFooterApp.footer.addClass('float');WikiaFooterApp.
centerBar();}}};(function(){'use strict';window.ToolbarCustomize=window.ToolbarCustomize||{};var TC=window.ToolbarCustomize;TC.MenuGroup=$.createClass(window.Observable,{showTimer:!1,hideTimer:!1,showTimeout:300,hideTimeout:350,showing:!1,visible:!1,constructor:function(){TC.MenuGroup.superclass.constructor.call(this);this.showTimer=window.Timer.create($.proxy(this.show,this),this.showTimeout);this.hideTimer=window.Timer.create($.proxy(this.hide,this),this.hideTimeout);},add:function(el){var e=$(el);e.unbind('.menugroup').bind('mouseenter.menugroup',$.proxy(this.delayedShow,this)).bind('mouseleave.menugroup',$.proxy(this.delayedHide,this)).children('a','img').unbind('.menugroup').bind('click.menugroup',$.proxy(this.showOnClick,this));},remove:function(el){$(el).unbind('.menugroup').children('a','img').unbind('.menugroup');},show:function(){this.hideTimer.stop();this.showTimer.stop();if(!this.showing||this.visible===this.showing){return;}if(this.visible){this.hide();}if(this
.showing){this.visible=this.showing;this.showing=!1;this.fire('menushow',this,this.visible,this.visible.children('ul'));this.visible.children('ul').show();}},delayedShow:function(evt){this.showing=$(evt.currentTarget);if(this.visible){this.show(evt);}else{this.hideTimer.stop();this.showTimer.start();}},showOnClick:function(evt){evt.preventDefault();this.showing=$(evt.currentTarget).parent();this.show(evt);},hide:function(){this.hideTimer.stop();this.showTimer.stop();if(this.visible){this.fire('menuhide',this,this.visible,this.visible.children('ul'));this.visible.children('ul').hide();this.visible=!1;}},delayedHide:function(){this.hideTimer.stop();if(this.visible){this.hideTimer.start();}else if(this.showing){this.showing=!1;this.showTimer.start();}}});TC.Toolbar=$.createClass(Object,{el:!1,more:!1,menuGroup:!1,constructor:function(el){TC.Toolbar.superclass.constructor.call(this);this.el=el;this.menuGroup=new TC.MenuGroup();this.menuGroup.bind('menushow',this.
onShowMenu,this);this.initialize();},initialize:function(){this.el.find('.tools-customize').click($.proxy(this.openConfiguration,this));this.menuGroup.add(this.el.find('li.menu'));var that=this;$('body').on('userToolsItemAdded',function(event,data){that.load(data);});require(['wikia.fluidlayout'],function(fluidlayout){that.handleOverflowMenu(fluidlayout.getBreakpointSmall(),2*fluidlayout.getAdSkinWidth(),window.wgOasisResponsive?false:fluidlayout.getBreakpointSmall());});},openConfiguration:function(evt){evt.preventDefault();require(['wikia.toolsCustomization'],function(TC){new TC.ToolsCustomization(this).show();return false;});},buildOveflowItem:function(){return this.el.find('.overflow-menu');},generateMediaQuery:function(moreable,minWidth,breakpoint,gapWidth,nonResponsiveBreakpoint){var firstMediaJSQuery=!0,mediaJSQueries='',moreableCount=moreable.length,alreadyAdded=(minWidth>=breakpoint),lastMediaQuery=!1;moreable.each(function(i,v){var elemWidth=$(v).outerWidth(true);if(
nonResponsiveBreakpoint!==false&&(minWidth+elemWidth>nonResponsiveBreakpoint)){lastMediaQuery=!0;}if(!alreadyAdded&&((minWidth+elemWidth)>=breakpoint)){alreadyAdded=!0;elemWidth+=gapWidth;}mediaJSQueries+='@media screen ';if(!firstMediaJSQuery){mediaJSQueries+='and (min-width:'+minWidth+'px) ';}if(!lastMediaQuery){mediaJSQueries+='and (max-width:'+(minWidth+elemWidth)+'px) ';}mediaJSQueries+='{ .WikiaBarWrapper .tools > .overflow:nth-of-type(n + '+(i+1)+') { display:none; } '+'.WikiaBarWrapper .tools .overflow-menu {  display: block; }'+'.WikiaBarWrapper .tools .overflow-menu .overflow:nth-of-type(-n + '+(moreableCount-i)+') { display:block; }} ';if(lastMediaQuery){return false;}minWidth+=elemWidth;firstMediaJSQuery=!1;});return mediaJSQueries;},getMinWidth:function(all){var arrow=this.el.parents('.wikia-bar:first').find('.arrow'),minWidth=parseInt(this.el.css('padding-left'),10)+parseInt(this.el.css('padding-right'),10)+arrow.outerWidth(true),notMoreable=all.filter(
':not(.overflow)');notMoreable.each(function(i,v){minWidth+=$(v).outerWidth(true);});return minWidth;},generateSubMenu:function(moreable){var where=moreable.last().next(),liMore=this.buildOveflowItem(),more=liMore.children('ul').empty();if(where.exists()){where.before(liMore);}else{this.el.append(liMore);}moreable.each(function(i,v){$(v).clone().prependTo(more);});this.menuGroup.add(liMore,$.proxy(this.onShowMenu,this));},addStyles:function(mediaJsQueries){var id='WikiaFooterMediaQueries',styles='<style id="'+id+'" type"text/css">'+mediaJsQueries+'</style>';$('#'+id).remove();$('head').append(styles);},handleOverflowMenu:function(breakpoint,gapWidth,nonResponsiveBreakpoint){var all=this.el.children('li'),moreable=all.filter('.overflow'),minWidth=this.getMinWidth(all);this.addStyles(this.generateMediaQuery(moreable,minWidth,breakpoint,gapWidth,nonResponsiveBreakpoint));this.generateSubMenu(moreable);},onShowMenu:function(mgroup,li,ul){ul.css('left',(li.offset().left-this.el.offset().
left)+'px');ul.css('right','auto');},load:function(html){this.el.children('li').remove();this.el.prepend($(html));this.initialize();}});})();$(function(){'use strict';WikiaFooterApp.init();});;var WikiaButtons={settings:{delay:350},init:function(limit){if(typeof limit=='object'){WikiaButtons.menuButtons=$(".wikia-menu-button",limit);}else{WikiaButtons.menuButtons=$(".wikia-menu-button");}WikiaButtons.timer=null;WikiaButtons.add(WikiaButtons.menuButtons);},add:function(e,opts){var defaults={click:WikiaButtons.click};var s=$.extend({},defaults,opts||{});e.unbind('.wikiabutton').one("mouseover.wikiabutton",WikiaButtons.setup).bind('mouseenter.wikiabutton',WikiaButtons.mouseover).bind('mouseleave.wikiabutton',WikiaButtons.mouseout);e.filter('.combined').bind('click.wikiabutton',s.click);e.not('.combined').find('.drop').bind('click.wikiabutton',s.click);},setup:function(){$(this).data('menu',$(this).find("ul"));},click:function(event){var button=$(this).closest('.wikia-menu-button');if(!
button.attr('disabled')){if(event.target.tagName!=='A'){var width=button.outerWidth();if(width!==button.data('prevWidth')){button.data('prevWidth',width);var menu=button.data('menu');width=width-(parseInt(menu.css('padding-left'))+parseInt(menu.css('padding-right'))+parseInt(menu.css('border-left-width'))+parseInt(menu.css('border-right-width')));menu.css("min-width",width);}button.toggleClass("active");}}else{event.preventDefault();return false;}},mouseover:function(){clearTimeout(WikiaButtons.timer);},mouseout:function(event){var dalay=$(event.target).closest('.wikia-menu-button').attr('data-delay');if((typeof dalay)!='string'){dalay=WikiaButtons.settings.delay;}WikiaButtons.timer=setTimeout(function(){$(event.currentTarget).removeClass("active");},dalay);}};$(function(){WikiaButtons.init();});;var WikiaNotificationsApp={purgeCurrentPage:function(){$.post(wgScript,{action:'purge',title:wgPageName});},track:Wikia.Tracker.buildTrackingFunction({category:'sitewidemessages',
trackingMethod:'analytics'}),init:function(){var self=this,notifications=$('#WikiaNotifications');notifications.find('.close-notification').click(function(ev){var notification=$(this).parent();var notificationType=parseInt(notification.attr('data-type'));switch(notificationType){case 1:$.post(wgScript,{action:'ajax',rs:'wfDismissWikiaNewtalks'},WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;case 2:$.post(wgScript,{action:'ajax',rs:'CommunityMessagesAjax',method:'dismissMessage'},WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;case 5:var messageId=parseInt(notification.attr('id').substr(4));var nextNotification=notification.next();$.post(wgScript,{title:'Special:SiteWideMessages',action:'dismiss',mID:messageId},WikiaNotificationsApp.purgeCurrentPage);self.track({action:Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,browserEvent:ev,label:'swm-dismiss',value:messageId});notification.remove();nextNotification.css("display","block");if(
nextNotification.length){var nextMessageId=parseInt(nextNotification.attr('id').substr(4));self.track({action:Wikia.Tracker.ACTIONS.IMPRESSION,label:'swm-impression',value:nextMessageId});}break;case 10:$.post($(this).attr('data-url'),WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;default:notification.parent().remove();break;}});}};$(function(){WikiaNotificationsApp.init();});;(function($){var FirefoxFindFix={scrollThreshold:30,lastScroll:0,init:function(){$(window).scroll($.proxy(this.analyze,this)).mousedown($.proxy(this.cancelTimer,this));},analyze:function(){if(window.getSelection().toString()){var currentScroll=$(window).scrollTop();if(currentScroll>this.lastScroll+this.scrollThreshold){this.adjust();}this.lastScroll=currentScroll;}},adjust:function(){$(window).scrollTop($(window).scrollTop()+this.scrollThreshold);this.anchorOffset=window.getSelection().anchorOffset;if(!this.timer){this.timer=setInterval(this.monitorHighlight,250);}},monitorHighlight:
function(){if(window.getSelection().anchorOffset!=this.anchorOffset){if(this.timer){this.adjust();}}},cancelTimer:function(){if(this.timer){clearInterval(this.timer);this.timer=null;}}};if($.browser.mozilla){$(function(){if($("#WikiaFooter .toolbar").exists()){FirefoxFindFix.init();}});}}(jQuery));;jQuery(function($){$('body').on('click','.tabs a',function(evt){if($(this).parent().hasClass('disabled')){return;}var newTabName=$(this).parent().data('tab');if($('[data-tab-body="'+newTabName+'"]').length>0){evt.preventDefault();var previousTabName=$(this).closest('ul').find('.selected').removeClass('selected').data('tab');$(this).closest('li').addClass('selected');$('[data-tab-body="'+previousTabName+'"]').removeClass('selected');$('[data-tab-body="'+newTabName+'"]').addClass('selected');$(window).trigger('wikiaTabClicked',[newTabName]);}else{$().log("Tried to switch to tab but could not find data-tab-body: \""+newTabName+"\"");}});});;jQuery(function($){'use strict';var $body=$('body'),
$wikiaArticle=$('#WikiaArticle'),$wikiaRail=$('#WikiaRail'),$interlang=$('.WikiaArticleInterlang'),rHrefDiff=/&diff=\d+/,rHrefHistory=/&action=history/,track,trackWithEventData,trackEditorComponent;track=Wikia.Tracker.buildTrackingFunction({action:Wikia.Tracker.ACTIONS.CLICK,trackingMethod:'analytics'});trackWithEventData=function(event){if(window.veTrack&&event.data.label==='section-edit'){veTrack({action:($('#ca-ve-edit').exists()?'ve-section-edit':'other-section-edit')+'-click'});}if(event.type==='mousedown'&&event.which!==1){return;}track({browserEvent:event},event.data);};trackEditorComponent=(function(){var slice=Array.prototype.slice;return function(){var wikiaEditor=window.WikiaEditor&&WikiaEditor.getInstance(),track=Wikia.Tracker.track;if(wikiaEditor&&(!wikiaEditor.config.isMiniEditor||wikiaEditor.plugins.MiniEditor.hasFocus)){track=WikiaEditor.track;}track.apply(track,slice.call(arguments));};})();(function(){var category='article';if($body.hasClass('ns-special')){return;}
$wikiaArticle.on('mousedown','a',function(event){var label,el=$(event.currentTarget);if(event.which!==1){return;}if(el.hasClass('video')){label='video';}else if(el.hasClass('image')){label='image';}else if(el.parents('.infobox, .wikia-infobox').length>0){label='infobox';}else if(el.hasClass('external')){label='link-external';}else if(el.hasClass('wikia-photogallery-add')){label='add-photo-to-gallery';}else if(el.prop('className')===''){label='link-internal';}if(label!==undefined){track({browserEvent:event,category:category,label:label});}}).on('mousedown','.editsection a',{category:category,label:'section-edit'},trackWithEventData);$('#articleCategories').on('mousedown','a',{category:category,label:'category-name'},trackWithEventData).on('mousedown','.add',{category:category,label:'add-category'},trackWithEventData);})();(function(){var category='category';$wikiaArticle.on('mousedown','.category-gallery a',{category:category,label:'category-gallery'},trackWithEventData);$('#mw-pages').
on('mousedown','a',{category:category,label:'category-item'},trackWithEventData);})();(function(){var alliance=$('.alliance-module',$wikiaArticle),category='Alliance',label,suffix;if(alliance.length){alliance.on('mousedown','a',function(event){suffix='-click';if($(this).attr('href').indexOf('http://www.wikia.com/Alliance')!==-1){suffix='-logo-click';}label=$(event.delegateTarget).attr('data-label');if(label!==undefined){label+=suffix;track({category:category,label:label});}});alliance.each(function(){suffix='-impression';label=$(this).attr('data-label');if(label!==undefined){label+=suffix;track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:category,label:label});}});}})();if($body.hasClass('page-Special_RecentChanges')){$wikiaArticle.on('mousedown','a',function(event){var $el=$(event.target),label=$el.attr('data-action'),href=$el.attr('href');if(event.which!==1){return;}if(!label){if(rHrefDiff.test(href)){label='diff';}else if(rHrefHistory.test(href)){label='history';}else if($el.
hasClass('mw-userlink')){label='username';}else if(!$el.parent().is('span')){label='title';}}if(label!==undefined){track({browserEvent:event,category:'recent-changes',label:label});}});}$wikiaArticle.find('.diff-header').on('mousedown','a',function(e){var $el=$(e.target),action=$el.attr('data-action');if(action){track({browserEvent:e,category:'oasis-diff',label:action});}});(function(){var category='search',suggestionShowed=!1,$topModule=$('.top-wiki-articles'),$exactWikiMatchModule=$('.exact-wiki-match'),$fandomStoriesModule=$('.fandom-stories'),$categoryModule=$('.category-articles'),$wikiaSearch=$('.search-tracking'),$noResults=$('.results-wrapper .no-result');if($body.hasClass('page-Special_Search')){category='special-search';}$wikiaSearch.on('mousedown','.autocomplete',{category:category,label:'search-suggest'},trackWithEventData).on('mousedown','.wikia-button',function(event){if(event.which===1&&event.clientX>0){var label=!suggestionShowed?'search-button':
'search-after-suggest-button';track({category:category,label:label});}}).on('keypress','[name=search]',function(event){if(event.which===13&&$(this).is(':focus')){var label=!suggestionShowed?'search-enter':'search-after-suggest-enter';track({category:category,label:label});}}).on('suggestEnter',{category:category,label:'search-suggest-enter'},trackWithEventData).one('suggestShow',{action:Wikia.Tracker.ACTIONS.VIEW,category:category,label:'search-suggest-show'},function(event){suggestionShowed=!0;trackWithEventData(event);});if($body.hasClass('page-Special_Search')){if($noResults.length){track({action:Wikia.Tracker.ACTIONS.VIEW,category:category,label:'empty-page'});}$wikiaSearch.on('mousedown','.search-tabs a',function(event){track({browserEvent:event,category:category,label:'sidebar-'+$(event.currentTarget).prop('className')});}).on('mousedown','.Results .result-link',function(event){var el=$(event.currentTarget),label='result-'+(el.data('event')==='search_click_match'?'push-top':
'item-'+el.data('pos'));track({browserEvent:event,category:category,label:label});}).on('mousedown','.Results .wiki-thumb-tracking',function(event){var el=$(event.currentTarget),label='result-item-'+el.data('pos')+'-image'+(el.data('event')==='search_click_wiki-no-thumb'?'-placeholder':'');track({browserEvent:event,category:category,label:label});}).on('mousedown','.thumb-tracking',function(event){var el=$(event.currentTarget),label='result-item-'+'image-'+(el.data('event')==='search_click_match'?'push-top':el.data('pos'));track({browserEvent:event,category:category,label:label});}).on('mousedown','.image',function(event){var $currentTarget=$(event.currentTarget),label='result-'+($currentTarget.hasClass('video')?'video':'photo')+(($currentTarget.parents('.video-addon-results').length>0)?'-video-addon':'');track({browserEvent:event,category:category,label:label});}).on('mousedown','.video-addon-seach-video',function(event){track({browserEvent:event,category:category,label:
'video-addon-results-header'});});}if($exactWikiMatchModule.length){track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:category,label:'exact-wiki-match'});$exactWikiMatchModule.on('mousedown','a',function(event){var el=$(event.currentTarget);track({browserEvent:event,category:category,label:'exact-wiki-match-'+el.data('event')});});}if($fandomStoriesModule.length){track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:category,label:'fandom-stories'});$fandomStoriesModule.on('mousedown','.fandom-story-link',function(event){track({browserEvent:event,category:category,label:'fandom-story-link-'+$(event.currentTarget).data('pos')});}).on('mousedown','.fandom-story-image',function(event){track({browserEvent:event,category:category,label:'fandom-story-image-'+$(event.currentTarget).data('pos')});});}if($topModule.length){track({action:Wikia.Tracker.ACTIONS.IMPRESSION,category:category,label:'top-wiki-articles'});$topModule.on('mousedown','.top-wiki-article-link',function(event){track(
{browserEvent:event,category:category,label:'top-wiki-article-link-'+$(event.currentTarget).data('pos')});}).on('mousedown','.top-wiki-article-image',function(event){track({browserEvent:event,category:category,label:'top-wiki-article-image-'+$(event.currentTarget).data('pos')});});}if($categoryModule.length){$categoryModule.on('mousedown','.category-articles-thumb a',function(event){var el=$(event.currentTarget);track({browserEvent:event,category:category,label:'category-module-thumb-'+el.data('pos')});}).on('mousedown','.category-articles-text a',function(event){var el=$(event.currentTarget);track({browserEvent:event,category:category,label:'category-module-title-'+el.data('pos')});});}})();$('#RelatedForumDiscussion').on('mousedown','a',function(event){var label,el=$(event.target);if(event.which!==1){return;}if(el.hasClass('forum-thread-title')){label='title';}else if(el.hasClass('forum-new-post')){label='start-discussion';}else if(el.parent().hasClass('forum-see-more')){label=
'see-more';}if(label!==undefined){track({browserEvent:event,category:'thread-module',label:label});}});$('#WikiaBarWrapper').on('mousedown','.toolbar a',function(event){var label,el=$(event.target),name=el.data('name');if(event.which!==1){return;}switch(name){case'customize':case'follow':case'history':case'whatlinkshere':label=name;break;default:label='custom';break;}if(label!==undefined){track({browserEvent:event,category:'toolbar',label:label});}});(function(){var category='top-nav';$('#wall-notifications-markasread').on('mousedown','span',function(event){var label,el=$(event.target),id=el.attr('id');if(event.which!==1){return;}switch(id){case'wall-notifications-markasread-this-wiki':case'wall-notifications-markasread-all-wikis':label=id;break;}if(label!==undefined){track({browserEvent:event,category:category,label:label});}});})();if($body.hasClass('page-Special_WikiActivity')){$wikiaArticle.find('.activityfeed').on('mousedown','a',function(event){var label,type,el=$(event.target),
parent=el.parent();if(event.which!==1){return;}if(el.hasClass('title')){label='title';}else if(el.hasClass('username')||el.hasClass('real-name')||parent.hasClass('wall-owner')||parent.hasClass('subtle')){label='username';}else if(parent.hasClass('activityfeed-diff')){label='diff';}else{type=el.closest('tr').data('type');if(type==='inserted-image'){label='thumbnail-photo';}else if(type==='inserted-video'){label='thumbnail-video';}}if(label!==undefined){track({browserEvent:event,category:'wiki-activity',label:label});}});}$interlang.on('click','a',function(){var data=$(this).data('tracking');track({category:'interwiki-links',label:data});});function initRailTracking(){$wikiaRail.find('.chat-module').on('mousedown','.start-a-chat-button',{category:'chat-module',label:'chat-join'},trackWithEventData);$wikiaRail.find('#ForumRelatedThreadsModule').on('mousedown','a',function(event){var label=event.target.getAttribute('data-tracking');if(event.which!==1){return;}if(label){track({browserEvent:
event,category:'related-threads-module',label:label});}});$wikiaRail.find('#ForumActivityModule').on('mousedown','a',function(event){var label=event.target.getAttribute('data-tracking');if(event.which!==1){return;}if(label){track({browserEvent:event,category:'forum-activity-module',label:label});}});$wikiaRail.find('#wikia-recent-activity .page-title-link, #wikia-recent-activity .edit-info-user').on('mousedown',function(event){var label=event.target.getAttribute('data-tracking');if(event.which!==1){return;}if(label){track({browserEvent:event,category:'recent-wiki-activity-module',label:label});}});}Wikia.trackEditorComponent=trackEditorComponent;Wikia.initRailTracking=initRailTracking;});;define('wikia.onScroll',['jquery','wikia.window'],function($,window){'use strict';var handlers=[],delay=5;function bind(handler){if(typeof handler==='function'){handlers.push(handler);}}function unbind(handler){var index=handlers.indexOf(handler);if(index>-1){handlers.splice(index,1);}}function trigger
(event){handlers.forEach(function(handler){handler(event);});}function init(){window.addEventListener('scroll',$.throttle(delay,trigger));}return{bind:bind,unbind:unbind,init:init};});require(['wikia.onScroll'],function(onScroll){'use strict';onScroll.init();});;define('wikia.toolsCustomization',['wikia.window','wikia.browserDetect','jquery','wikia.ui.factory','mw','BannerNotification'],function(win,browserDetect,$,uiFactory,mw,BannerNotification){'use strict';win.ToolbarCustomize=win.ToolbarCustomize||{};var TC=win.ToolbarCustomize,isIPad=!1,wgBlankImgUrl=win.wgBlankImgUrl,bannerNotification=new BannerNotification().setType('error');isIPad=browserDetect.isIPad();TC.OptionsTree=$.createClass(win.Observable,{constructor:function(el){TC.OptionsTree.superclass.constructor.call(this);this.el=el;if(!isIPad){this.el.sortable({axis:'y',handle:'.drag',opacity:0.8,update:$.proxy(this.updateLevels,this)});}},updateLevels:function(){var $all=this.el.children('li'),level=0,$ind;$all.removeClass
('list-item-indent-1');$all.each(function(index,element){if($(element).hasClass('list-item-menu')){level++;}else if(level>0){$(element).addClass('list-item-indent-'+level);}});this.el.find('.tree-visual').remove();$ind=this.el.children('li.list-item-indent-1');$ind.prepend('<span class="tree-visual tree-line"></span><span class="tree-visual tree-dash"></span>');$ind.last().find('.tree-visual').remove();$ind.last().prepend('<span class="tree-visual tree-line-last"></span><span class="tree-visual tree-dash"></span>');this.fire('update',this);},buildItem:function(item,level){var type=(item.id.substr(0,5)==='Menu:')?'menu':'item',cl=level?'list-item-indent-'+level:'',html,itemEl;if(type==='menu'){cl+=' list-item-menu';}html='<li'+' data-tool-id="'+$.htmlentities(item.id)+'"'+' data-default-caption="'+$.htmlentities(item.defaultCaption)+'"'+' data-caption="'+$.htmlentities(item.caption)+'"'+(cl?' class="'+cl+'"':'')+'>';if(type==='menu'){html+='<img src="'+wgBlankImgUrl+
'" class="folder-icon" height="16" width="16" />';}html+='<span class="name">'+$.htmlentities(item.caption)+'</span>';if(type==='item'){html+=this.addIcons();}html+='</li>';itemEl=$(html);this.fire('itembuild',this,item,itemEl);return itemEl;},addIcons:function(){var html=['<img src="'+wgBlankImgUrl+'" class="sprite edit-pencil">','<img src="'+wgBlankImgUrl+'" class="sprite trash">'];if(!isIPad){html.push('<img src="'+wgBlankImgUrl+'" class="sprite drag">');}return html.join('');},loadLevel:function(els,level){var i;for(i=0;i<els.length;i++){this.el.append(this.buildItem(els[i],level));if(els[i].items){this.loadLevel(els[i].items,level+1);}}},load:function(data){this.el.empty();this.loadLevel(data,0);this.updateLevels();},save:function(){var $all=this.el.children('li'),stack=[[]],level=0;$all.each(function(index,element){element=$(element);var o={id:element.attr('data-tool-id'),defaultCaption:element.attr('data-default-caption'),caption:element.attr('data-caption')};stack[level].push(o
);if(element.hasClass('list-item-menu')){level=1;o.items=[];o.isMenu=!0;stack[level]=o.items;}});return stack[0];},update:function(){this.updateLevels();},add:function(item,level){var itemEl=this.buildItem(item,level||0),$mytools;if(level===0){$mytools=this.el.children('.list-item-menu');if($mytools){$mytools.before(itemEl);}else{this.el.append(itemEl);}}else{this.el.append(itemEl);}this.scrollToItem(itemEl);this.updateLevels();},scrollToItem:function(itemEl){var scroll=this.el.scrollTop(),delta=itemEl.offset().top-this.el.offset().top,max=this.el.innerHeight()-itemEl.outerHeight(),move=0;if(delta>max){move=delta-max;}if(delta<0){move=delta;}if(move!==0){this.el.scrollTop(scroll+move);}}});TC.OptionLinks=$.createClass(win.Observable,{constructor:function(el){TC.OptionLinks.superclass.constructor.call(this);this.el=el;},onItemClick:function(event){event.preventDefault();this.fire('itemclick',this,$(event.target).attr('data-tool-id'));return false;},buildItem:function(item){var html=
'<li>'+'<a href="#" data-tool-id="'+$.htmlentities(item.id)+'">'+$.htmlentities(item.defaultCaption)+'</a></li>',itemEl=$(html);itemEl.find('a').click($.proxy(this.onItemClick,this));return itemEl;},load:function(els){var i;this.el.empty();for(i=0;i<els.length;i++){this.el.append(this.buildItem(els[i]));}}});TC.Toggle=$.createClass(Object,{constructor:function(target,buttons,cls){this.target=target;this.buttons=buttons;this.cls=cls;this.state=!1;this.hide();this.buttons.bind('click.toggle',$.proxy(this.toggle,this));},hide:function(){this.target.hide();this.buttons.hide();this.buttons.filter('.'+this.cls).show();},show:function(){this.target.show();this.buttons.hide();this.buttons.not('.'+this.cls).show();},toggle:function(event){if($(event.currentTarget).hasClass(this.cls)){this.show();}else{this.hide();}}});TC.Configuration=$.createClass(Object,{toolbar:!1,data:!1,w:!1,tree:!1,popular:!1,toggle:!1,constructor:function(toolbar){TC.Configuration.superclass.
constructor.call(this);this.toolbar=toolbar;},show:function(){$.when($.loadJQueryAutocomplete(),$.loadJQueryUI(),$.getResources([$.getSassCommonURL('extensions/wikia/UserTools/styles/UserTools.scss')]),$.nirvana.sendRequest({controller:'UserTools',method:'ToolbarConfiguration',callback:$.proxy(this.onDataLoaded,this)})).done($.proxy(this.checkLoad,this)).fail($.proxy(this.onLoadFailure,this));},onDataLoaded:function(data){this.data=data;},onLoadFailure:function(req,textStatus,errorThrown){bannerNotification.setContent(errorThrown).show();},checkLoad:function(){var self=this;uiFactory.init(['modal']).then(function(uiModal){var messages=self.data.messages,toolsConfigurationConfig={vars:{id:'MyToolsConfigurationWrapper',size:'small',content:self.data.configurationHtml,title:messages['user-tools-edit-title'],buttons:[{vars:{value:messages['user-tools-edit-save'],classes:['button','primary'],data:[{key:'event',value:'save'}]}},{vars:{value:messages['user-tools-edit-cancel'],data:[{key:
'event',value:'close'}]}}]}};uiModal.createComponent(toolsConfigurationConfig,function(toolsConfigModal){self.w=toolsConfigModal.$content;self.modal=toolsConfigModal;var $optionList=self.w.find('.options-list'),$group=self.w.find('.popular-tools-group'),$searchInput=self.w.find('.search');self.tree=new TC.OptionsTree($optionList);if(isIPad){$optionList.addClass('on-ipad');}else{$optionList.addClass('no-ipad');}self.tree.on('itembuild',$.proxy(self.initItem,self));self.tree.load(self.data.options);self.w.find('.reset-defaults a').click($.proxy(self.loadDefaults,self));$searchInput.placeholder();$searchInput.pluginAutocomplete({lookup:self.getAutocompleteData(),onSelect:$.proxy(self.addItemFromSearch,self),selectedClass:'selected',appendTo:self.w.find('.search-box'),width:'300px',maxHeight:'auto'});self.w.find('.advanced-tools a').attr('target','_blank');self.popular=new TC.OptionLinks(self.w.find('.popular-list'));self.popular.load(self.data.popularOptions);self.popular.on('itemclick',$
.proxy(self.addPopularOption,self));self.toggle=new TC.Toggle($group.children('.popular-list'),$group.children('.popular-toggle'),'toggle-1');self.w.find('.popular-toggle').click($.proxy(self.togglePopular,self));toolsConfigModal.bind('save',function(event){event.preventDefault();toolsConfigModal.deactivate();self.save(toolsConfigModal);});toolsConfigModal.show();});});},getAutocompleteData:function(){var suggestions=[],data=[],length=this.data.allOptions.length,i;for(i=0;i<length;i++){suggestions.push(this.data.allOptions[i].caption);data.push(this.data.allOptions[i].id);}return{suggestions:suggestions,data:data};},findOptionByName:function(id){var length=this.data.allOptions.length,i;for(i=0;i<length;i++){if(this.data.allOptions[i].id===id){return this.data.allOptions[i];}}return false;},findOptionByCaption:function(caption){var length=this.data.allOptions.length,i;for(i=0;i<length;i++){if(this.data.allOptions[i].caption===caption){return this.data.allOptions[i];}}return false;},
addItemFromSearch:function(value,data){var item=this.findOptionByName(data);if(item){this.tree.add(item,0);}this.w.find('.search').val('');},addPopularOption:function(popular,id){var item=this.findOptionByName(id);if(item){this.tree.add(item,0);}return false;},loadDefaults:function(){this.tree.load(this.data.defaultOptions);return false;},initItem:function(tree,item,el){if(isIPad){el.click(function(event){tree.el.children().removeClass('hover');$(event.currentTarget).addClass('hover');});}el.find('.edit-pencil').click($.proxy(this.renameItem,this));el.find('.trash').click($.proxy(this.deleteItem,this));},renameItem:function(event){var self=this,$item=$(event.currentTarget).closest('li');event.preventDefault();uiFactory.init(['modal']).then(function(uiModal){var messages=self.data.messages,renameItemConfig={vars:{id:'MyToolsRenameItem',size:'small',content:self.data.renameItemHtml,title:messages['user-tools-edit-rename'],buttons:[{vars:{value:messages['user-tools-edit-save'],classes:[
'button','primary'],data:[{key:'event',value:'save'}]}},{vars:{value:messages['user-tools-edit-cancel'],data:[{key:'event',value:'close'}]}}]}};uiModal.createComponent(renameItemConfig,function(renameItemModal){var $inputBox=renameItemModal.$content.find('.input-box');$inputBox.val($item.data('caption'));renameItemModal.bind('save',function(event){event.preventDefault();var value=$inputBox.val();$item.attr('data-caption',value);$item.find('.name').text(value);renameItemModal.trigger('close');});renameItemModal.show();});});return false;},deleteItem:function(event){$(event.currentTarget).closest('li').remove();this.tree.update();return false;},save:function(toolsConfigModal){var toolbar=this.tree.save();$.nirvana.sendRequest({controller:'UserTools',method:'ToolbarSave',data:{title:win.wgPageName,toolbar:toolbar,token:mw.user.tokens.get('editToken')},callback:$.proxy(function(data,status){this.afterSave(toolsConfigModal,data,status);},this)});},afterSave:function(toolsConfigModal,data,
status){toolsConfigModal.activate();if(status==='success'){$('body').trigger('userToolsItemAdded',[data.toolbar]);this.modal.trigger('close');}else{bannerNotification.setContent(status).show();}}});win.ToolbarCustomize=TC;return{ToolsCustomization:TC.Configuration};});;var WeppyImpl;(function(WeppyImpl){var protocolVersion=3,pathDelimiter='.',namespaceDelimiter='::',active=!1,options={"host":'/weppy',"transport":'url',"active":!0,"sample":0.01,"aggregationInterval":1000,"maxInterval":5000,"decimalPrecision":3,"page":'index',"context":{},"debug":!1},initTime=+(new Date),queue,aggregationTimeout,maxTimeout,sentPerformanceData,now=function(){return window.performance&&window.performance.now?window.performance.now():+(new Date);},log=function(){if(options.debug){if(typeof options.debug==='function'){options.debug.apply(window,arguments);}else{window.console&&window.console.log&&window.console.log.apply?window.console.log.apply(window.console,arguments):void 0;}}},logError=function(
){window.console&&window.console.error&&window.console.error.apply&&window.console.error.apply(window.console,arguments);};function round(num,precision){if(precision===void 0){precision=options.decimalPrecision;}return Math.round(num*Math.pow(10,precision))/Math.pow(10,precision);}function buildPath(path,subpath,glue){if(glue===void 0){glue=pathDelimiter;}return path+((path!=''&&subpath!='')?glue:'')+subpath;}function updateActive(){active=options.active&&Math.random()<options.sample;}function extend(first,second){var key;if(first&&second){for(key in second){if(second.hasOwnProperty(key)){first[key]=second[key];}}}return first||second;}function sortedJson(obj){var keys=Object.keys(obj).sort(),i,ret={};for(i=0;i<keys.length;i++){ret[keys[i]]=obj[keys[i]];}return JSON.stringify(ret);}(function(MetricType){MetricType[MetricType["Counter"]=0]="Counter";MetricType[MetricType["Gauge"]=1]="Gauge";MetricType[MetricType["Timer"]=2]="Timer";})(WeppyImpl.MetricType||(WeppyImpl.MetricType={}));var
MetricType=WeppyImpl.MetricType;var Queue=(function(){function Queue(){this.clear();}Queue.prototype.clear=function(){this.all={};this._empty=!0;};Queue.prototype.empty=function(){return this._empty;};Queue.prototype.add=function(name,value,rollingAverage,annotations){var data=this.find(name,annotations);if(rollingAverage){data.count=data.count||0;data.count++;data.value+=(value-data.value)/data.count;data.rollingAverage=!0;}else{data.value+=value;}this._empty=!1;};Queue.prototype.find=function(name,annotations){var serializedAnnotations=annotations?sortedJson(annotations):!1,scope=this.all[name]=this.all[name]||{},data;if(serializedAnnotations){scope=scope.annotated=scope.annotated||{};scope=scope[serializedAnnotations]=scope[serializedAnnotations]||{};}data=scope.data=scope.data||{value:0};return data;};Queue.prototype.get=function(){var measurements={},value,measurement,names,data,annotated,i,k;function addMeasurement(name,data,annotations){if(data){value=data.value;if(
data.rollingAverage){value=round(value);}measurement=[value];if(annotations){measurement.push(annotations);}measurements[name].push(measurement);}}names=Object.keys(this.all);for(i=0;i<names.length;i++){measurements[names[i]]=[];data=this.all[names[i]].data;annotated=this.all[names[i]].annotated;if(data){addMeasurement(names[i],data,null);}if(annotated){for(k in annotated){if(annotated.hasOwnProperty(k)){addMeasurement(names[i],annotated[k].data,JSON.parse(k));}}}}return measurements;};return Queue;})();queue=new Queue();function enqueue(type,name,value,annotations){var rollingAverage;if(!active){return;}rollingAverage=type!=0;queue.add(name,value,rollingAverage,annotations);scheduleSending();}function scheduleSending(){clearTimeout(aggregationTimeout);aggregationTimeout=setTimeout(sendQueue,options.aggregationInterval);if(!maxTimeout){maxTimeout=setTimeout(sendQueue,options.maxInterval);}}function clearSchedule(){clearTimeout(aggregationTimeout);clearTimeout(maxTimeout);
aggregationTimeout=null;maxTimeout=null;}function sendQueue(){var allMeasurements,allData;clearSchedule();if(queue.empty()){return;}if(!active){log("Weppy: would send queue but inactive");return;}if(!window.JSON||!JSON.stringify){queue.clear();return;}allMeasurements=queue.get();queue.clear();allData={context:options.context,data:allMeasurements};log('Weppy: sending',allData);sendData(allData);}function sendData(data){var url;if(typeof options.transport=='function'){options.transport(data);return;}url=options.host+'/v'+protocolVersion+'/send';if(options.transport=='url'){url+='?p='+encodeURIComponent(JSON.stringify(data));sendRequest(url,null);}else if(options.transport=='post'){sendRequest(url,JSON.stringify(data));}}function sendRequest(url,data){var corsSupport=window.XMLHttpRequest&&(XMLHttpRequest['defake']||(new XMLHttpRequest()).withCredentials),sameOrigin=!0,match,req,contentType;match=/^(https?:\/\/[^\/]+)/i.exec(url);if(match&&match[1]!=document.location.protocol+'//'+
document.location.host){sameOrigin=!1;}if(!sameOrigin&&!corsSupport&&window.XDomainRequest){req=new XDomainRequest();}else{req=new XMLHttpRequest();}contentType=data==null?'text/plain':'application/json';req.weppy=req.bucky={track:!1};req.open('POST',url,true);req.setRequestHeader('Content-Type',contentType);req.send(data);return req;}var Namespace=(function(){function Namespace(_root,_path){this._root=_root;this._path=_path;this.timer=new NamespaceTimer(this);}Namespace.prototype.namespace=function(root,path){return new Namespace(root,path||'');};Namespace.prototype.into=function(subpath){return new Namespace(this._root,buildPath(this._path,subpath));};Namespace.prototype.key=function(name){return buildPath(this._root,buildPath(this._path,name),namespaceDelimiter);};Namespace.prototype.send=function(type,name,value,annotations){name=this.key(name);enqueue(type,name,value,annotations);log('Weppy: queued',{type:MetricType[type],name:name,value:value,annotations:annotations});};
Namespace.prototype.count=function(name,value,annotations){if(value===void 0){value=1;}this.send(0,name,value,annotations);};Namespace.prototype.store=function(name,value,annotations){this.send(1,name,value,annotations);};Namespace.prototype.flush=function(){sendQueue();};Namespace.prototype.setOptions=function(opts){var key;for(key in opts){if(opts.hasOwnProperty(key)){options[key]=opts[key];}}if('sample'in opts||'active'in opts){updateActive();}};Namespace.prototype.sendPagePerformance=function(){var self,readyState,timing,start,key,time,data={},name;if(!window.performance||!window.performance.timing||sentPerformanceData){return false;}self=this;readyState=document.readyState;if(readyState=='uninitialized'||readyState=='loading'){if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){self.sendPagePerformance();},false);}return false;}sentPerformanceData=!0;timing=window.performance.timing;start=timing.navigationStart;for(key in timing){time=timing[key
];if(time&&typeof time=='number'){data[key]=(time-start);}}delete data['navigationStart'];name=options.page;self.namespace('PAGELOAD').timer.send(name,start,data);return true;};return Namespace;})();WeppyImpl.Namespace=Namespace;var NamespaceTimer=(function(){function NamespaceTimer(_namespace){this._namespace=_namespace;this.PARTIALS={};}NamespaceTimer.prototype.send=function(name,duration,annotations){this._namespace.send(2,name,duration,annotations);};NamespaceTimer.prototype.start=function(name,annotations){this.PARTIALS[name]=[now(),annotations];return new Timer(this,name);};NamespaceTimer.prototype.stop=function(name,annotations){var duration;if(!this.PARTIALS[name]){logError("Timer "+name+" ended without having been started");return;}duration=now()-this.PARTIALS[name][0];annotations=extend(annotations,this.PARTIALS[name][1]);this.PARTIALS[name]=!1;this.send(name,duration,annotations);};NamespaceTimer.prototype.annotate=function(name,annotations){if(!this.PARTIALS[name]){
logError("Timer "+name+" received annotation without having been started");return;}this.PARTIALS[name][1]=annotations;};NamespaceTimer.prototype.time=function(name,action,scope,args,annotations){var self=this,done=function(annotations){self.stop(name,annotations);};this.start(name,annotations);args=args?args.slice(0):[];args.splice(0,0,done);return action.apply(scope,args);};NamespaceTimer.prototype.timeSync=function(name,action,scope,args,annotations){var ret;this.start(name,annotations);ret=action.apply(scope,args);this.stop(name);return ret;};NamespaceTimer.prototype.wrap=function(name,action,scope,annotations){var _this=this;var self=this;return function(){return self.timeSync(name,action,scope||_this,arguments,annotations);};};NamespaceTimer.prototype.mark=function(name,annotations){this.send(name,now()-this.navigationStart(),annotations);};NamespaceTimer.prototype.navigationStart=function(){return(window.performance&&window.performance.timing&&window.performance.timing.
navigationStart)||initTime;};return NamespaceTimer;})();WeppyImpl.NamespaceTimer=NamespaceTimer;var Timer=(function(){function Timer(_timer,name){this._timer=_timer;this.name=name;}Timer.prototype.stop=function(annotations){this._timer.stop(this.name,annotations);};Timer.prototype.annotate=function(annotations){this._timer.annotate(this.name,annotations);};return Timer;})();WeppyImpl.Timer=Timer;function bindNamespaceFunction(fn,scope,callWrapNamespace){return callWrapNamespace?function(){return wrapNamespaceObject(fn.apply(scope,arguments));}:function(){return fn.apply(scope,arguments);};}function wrapNamespaceObject(obj){var weppyObject=(function(subpath){return subpath?weppyObject.into(subpath):weppyObject;}),k;for(k in obj){if(typeof obj[k]=='function'){weppyObject[k]=bindNamespaceFunction(obj[k],obj,k=='into'||k=='namespace');}else{weppyObject[k]=obj[k];}}return weppyObject;}function getRootObject(){return wrapNamespaceObject(new Namespace('',''));}WeppyImpl.getRootObject=
getRootObject;updateActive();})(WeppyImpl||(WeppyImpl={}));var Weppy=WeppyImpl.getRootObject();;(function(context){'use strict';context.Bucky=context.Weppy;if(context.define&&context.define.amd){context.define('bucky',[],function(){return context.Weppy;});context.define('weppy',[],function(){return context.Weppy;});}$(function(){var config=$.extend({},context.wgWeppyConfig,{'context':context.wgTransactionContext});Weppy.setOptions(config);$(context).on('load',function(){setTimeout(function(){Weppy.sendPagePerformance();},0);});});})(window);;define('bucky.resourceTiming',['jquery','wikia.window','wikia.log','bucky'],function($,window,log,bucky){'use strict';var assetIdx=0,wikiaAssetRegex=/^https?:\/\/([^\/]+)(\.wikia-dev\.(us|pl|com)|\.wikia\.com|\.wikia\.nocookie\.net)\//;function isSupported(){return('performance'in window)&&(typeof window.performance.getEntriesByType==='function');}function isWikiaAsset(url){return wikiaAssetRegex.test(url);}function getDomain(url){var matches=url.
match(/\/\/([^/]+)/);return!!matches&&matches[1].split('.').slice(-2).join('.');}function debug(msg,data){log(msg+': '+JSON.stringify(data),log.levels.debug,'ResourceTiming');}function getResourcesStats(resources){var dnsTime,domain,len,res,stats={};function initStatsEntry(type){stats[type]={count:0,time:0};}function initStatsEntryIfEmpty(type){if(typeof stats[type]==='undefined'){initStatsEntry(type);}}function addStatsEntry(type,time){if(typeof stats[type]!=='undefined'){stats[type].count++;stats[type].time+=time;}}['total','cached','dns','dns-cached','3rdparty','css','link','iframe','img','script','xmlhttprequest'].map(function(item){initStatsEntry(item);});for(len=resources.length;assetIdx<len;assetIdx++){res=resources[assetIdx];if(isWikiaAsset(res.name)){addStatsEntry(res.initiatorType,res.duration);dnsTime=res.domainLookupStart?res.domainLookupEnd-res.domainLookupStart:!1;if(dnsTime!==false){if(dnsTime===0){addStatsEntry('dns-cached',dnsTime);}else{addStatsEntry('dns',dnsTime)
;}debug('DNS',{dnsTime:dnsTime,url:res.name});}if(res.duration===0){addStatsEntry('cached',0);}}else{addStatsEntry('3rdparty',res.duration);domain=getDomain(res.name);if(domain){debug(domain,res.duration);initStatsEntryIfEmpty('domain-'+domain);addStatsEntry('domain-'+domain,res.duration);}}addStatsEntry('total',res.duration);}return stats;}function reportToBucky(eventName){var key,value,subkey,sink,stats;stats=getResourcesStats(window.performance.getEntriesByType('resource')||[]);sink=bucky('resource_timing::'+eventName);debug('Sending stats',eventName);sink.flush();for(key in stats){for(subkey in stats[key]){value=Math.round(stats[key][subkey]);if(value>=0){sink.store(key+'.'+subkey,value);debug(key+'.'+subkey,value);}}}}return{isSupported:isSupported,isWikiaAsset:isWikiaAsset,getDomain:getDomain,reportToBucky:reportToBucky};});;require(['jquery','wikia.geo','wikia.window','bucky.resourceTiming'],function($,geo,window,resourceTiming){'use strict';$(function(){var wgTransactionContext
=window.wgTransactionContext||{};wgTransactionContext.country=geo.getCountryCode();wgTransactionContext.url=window.location.href.split('#')[0];wgTransactionContext.userAgent=window.navigator.userAgent;wgTransactionContext.os=window.navigator.platform;wgTransactionContext.bodySize=document.getElementsByTagName('body')[0].innerHTML.length;});if(!resourceTiming.isSupported()){return;}$(function(){resourceTiming.reportToBucky('DomReady');});$(window).on('load',function(){resourceTiming.reportToBucky('WindowLoad');setTimeout(function(){resourceTiming.reportToBucky('AfterWindowLoad');},5000);});});;define('wikia.scrollToLink',['wikia.window','wikia.querystring','wikia.history','jquery'],function(win,qs,hist,$){'use strict';function getOffsetTop(element){var offsetTop=$(element).offset().top;return offsetTop|0;}function scrollToElement(element,offsetToScroll){var targetOffset=getOffsetTop(element);win.setTimeout(function(){win.scrollTo(win.pageXOffset,targetOffset+offsetToScroll);},1);}
function handleScrollTo(href,offsetToScroll){offsetToScroll=offsetToScroll||0;var sanitizedHref=qs().sanitizeHref(href),doc=win.document,target;if(!!sanitizedHref){target=doc.getElementById(sanitizedHref);if(!!target){scrollToElement(target,offsetToScroll);return hist.pushState({},doc.title,win.location.pathname+'#'+sanitizedHref);}}return false;}return{handleScrollTo:handleScrollTo,scrollToElement:scrollToElement};});;$(function($){'use strict';var globalNavigationTracker=Wikia.Tracker.buildTrackingFunction({action:Wikia.Tracker.ACTIONS.CLICK,category:'navigation',trackingMethod:'analytics'}),globalFooterTracker=Wikia.Tracker.buildTrackingFunction({action:Wikia.Tracker.ACTIONS.CLICK,category:'footer',trackingMethod:'analytics'});function addTrackingToSelector(selector,tracker){$(selector).click(function(event){var label=$(event.target).closest('a, button').data('tracking-label')||!1;if(label!==false){tracker({label:label});}});}addTrackingToSelector('.wds-global-navigation',
globalNavigationTracker);addTrackingToSelector('.wds-global-footer',globalFooterTracker);});;$(function($){'use strict';var className='is-clicked',dropdownsSelector='.wds-dropdown, .wds-dropdown-level-2';if(window.Wikia.isTouchScreen()){$('body').on('click',dropdownsSelector,function(event){if(!$(this).hasClass(className)){event.preventDefault();}}).on('mouseenter',dropdownsSelector,function(){var $this=$(this);setTimeout(function(){$this.addClass(className);},0);}).on('mouseleave',dropdownsSelector,function(){$(this).removeClass(className);});}});;require(['wikia.scrollToLink','wikia.window','jquery','wikia.browserDetect'],function(scrollToLink,win,$,browserDetect){'use strict';var offset=0;function scrollToAnchor(event){if(scrollToLink.handleScrollTo(win.location.hash,offset)||browserDetect.isIOS7orLower()){event.preventDefault();return false;}}win.GlobalNavigationScrollToElement=function(element){scrollToLink.scrollToElement(element,offset);};$(function(){var $win=$(win),
spacingBelowGlobalNav=10,globalNavigationHeight=$('#globalNavigation').outerHeight(true);offset=-(globalNavigationHeight+spacingBelowGlobalNav);$win.on('hashchange load',scrollToAnchor);});});;$(function($){'use strict';function onAuthSuccess(){var redirect=this.url.replace(/.*?redirect=([^&]+).*/,'$1');window.location.href=decodeURIComponent(redirect);}$('#global-navigation-anon-sign-in, #global-navigation-anon-register').click(function(event){var url=event.currentTarget.href;if(event.which!==1||event.shiftKey||event.altKey||event.metaKey||event.ctrlKey){return;}event.preventDefault();$(event.currentTarget).closest('.wds-dropdown').removeClass('wds-is-active');window.wikiaAuthModal.load({url:url,origin:'global-nav',onAuthSuccess:onAuthSuccess.bind({url:url})});});});;$(function($){'use strict';var $globalNav=$('.wds-global-navigation'),$searchInput=$globalNav.find('.wds-global-navigation__search-input'),$searchSubmit=$globalNav.find('.wds-global-navigation__search-submit'),
placeholderText=$searchInput.attr('placeholder'),activeSearchClass='wds-search-is-active';function activateSearch(){if(!$globalNav.hasClass(activeSearchClass)){$globalNav.addClass(activeSearchClass);$searchInput.attr('placeholder',$searchInput.data('active-placeholder'));$(this).click();}}function deactivateSearch(){$searchSubmit.prop('disabled',true);$globalNav.removeClass(activeSearchClass);$searchInput.attr('placeholder',placeholderText).val('');}$searchInput.on('focus',activateSearch);$searchInput.on('input',function(){var textLength=this.value.length;if(textLength>0&&$searchSubmit.prop('disabled')){$searchSubmit.prop('disabled',false);}else if(textLength===0){$searchSubmit.prop('disabled',true);}});$searchInput.on('keydown',function(event){if(event.which===27){this.blur();deactivateSearch();}});$globalNav.find('.wds-global-navigation__search-close').on('click',deactivateSearch);if($searchInput.is(':focus')){activateSearch();}if($searchInput.val().length===0){$searchSubmit.prop(
'disabled',true);}});;$(function(){'use strict';var $searchInput=$('#searchInput'),$searchInputWrapper=$('#searchInputWrapper'),searchSuggestionsUrl=$searchInput.data('suggestions-url');function initSuggestions(){mw.loader.using('jquery.autocomplete').then(function(){var autocompleteReEscape=new RegExp('(\\'+['/','.','*','+','?','|','(',')','[',']','{','}','\\'].join('|\\')+')','g');$searchInput.on({suggestShow:function(){$searchInputWrapper.addClass('wds-is-active');},suggestHide:function(){$searchInputWrapper.removeClass('wds-is-active');}}).autocomplete({serviceUrl:searchSuggestionsUrl,queryParamName:$searchInput.data('suggestions-param-name'),appendTo:'.wds-global-navigation__search-input-wrapper',deferRequestBy:200,minLength:3,maxHeight:1000,onSelect:function(value,data,event){var valueEncoded=encodeURIComponent(value.replace(/ /g,'_')),location=window.wgArticlePath.replace(/\$1/,valueEncoded).replace(encodeURIComponent('/'),'/');window.Wikia.Tracker.track({eventName:
'search_start_suggest',sterm:valueEncoded,rver:0,trackingMethod:'internal'});if(event.button===1||event.metaKey||event.ctrlKey){window.open(location);return false;}else{window.Wikia.Tracker.track({action:Wikia.Tracker.ACTIONS.CLICK,category:'navigation',trackingMethod:'analytics',label:$searchInput.data('suggestions-tracking-label')});window.location.href=location;}},selectedClass:'wds-is-selected',skipBadQueries:!0,setPosition:!1,suggestionWrapperElement:'li',fnContainerMarkup:function(mainContainerId,autocompleteElId){return'<div id="'+mainContainerId+'" class="wds-dropdown__content wds-global-navigation__search-suggestions">'+'<ul id="'+autocompleteElId+'" class="wds-list wds-has-ellipsis wds-is-linked"></ul>'+'</div>';},fnFormatResult:function(value,data,currentValue){var pattern='('+currentValue.replace(autocompleteReEscape,'\\$1')+')';return'<a class="wds-global-navigation__dropdown-link">'+value.replace(new RegExp(pattern,'gi'),'<strong>$1<\/strong>')+'</a>';}});});}if(
searchSuggestionsUrl){$searchInput.one('focus',initSuggestions);if($searchInput.is(':focus')){initSuggestions();}}});;(function(exports){'use strict';var factory=function($){function Ellipses($el,opts){this.$el=$el;if(opts){$.extend(this.settings,opts);}this.cleanUp();this.render();}Ellipses.prototype={settings:{marginLeft:-3,maxLines:2,wordsHidden:1},cleanUp:function(){this.$el.find('.ellipses').remove();},render:function(){var oText=this.$el.text(),words=oText.split(' '),len=words.length,i,$spans,lineCount=0,maxLines=this.settings.maxLines,$tar,spanTop=null,currSpanTop,self;self=this;for(i=0;i<len;i++){words[i]='<span>'+words[i]+'</span>';}this.$el.html(words.join(' '));$spans=this.$el.find('span');for(i=0;i<$spans.length;i++){$tar=$($spans[i]);currSpanTop=$tar.offset().top;if(spanTop===null){spanTop=currSpanTop;}else if(lineCount===maxLines){$tar.hide();}else{if(spanTop!==currSpanTop){lineCount+=1;spanTop=currSpanTop;}if(lineCount===maxLines){$tar.hide().prevUntil(':nth-child( '+(i-
self.settings.wordsHidden)+' )').hide().eq(0).before('<span class="ellipses" style="">...</span>');self.trim();}}}},trim:function(){var $ellipses,$prev;$ellipses=this.$el.find('.ellipses');$prev=$ellipses.prev('span');$ellipses.css({marginLeft:this.settings.marginLeft});if($prev.text()==='-'){$prev.hide();}}};$.fn.ellipses=function(opts){return this.each(function(){var $this=$(this);$this.data('ellipses',new Ellipses($this,opts));});};};factory(exports.jQuery);})(this);;var CreatePage={pageLayout:null,options:{},loading:!1,context:null,wgArticlePath:mw.config.get('wgArticlePath'),redlinkParam:'',flowName:'',canUseVisualEditor:function(){return mw.libs&&mw.libs.ve?mw.libs.ve.canCreatePageUsingVE():!1;},checkTitle:function(title,trackingCategory){'use strict';$.getJSON(CreatePage.context.wgScript,{action:'ajax',rs:'wfCreatePageAjaxCheckTitle',title:title},function(response){var articlePath;var flowParam=(CreatePage.flowName==='')?'':'&flow='+CreatePage.flowName;if(response.result
==='ok'){CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.SUCCESS,label:'open-editor'});if(CreatePage.canUseVisualEditor()&&mw.libs.ve.isInValidNamespace(title)){articlePath=CreatePage.wgArticlePath.replace('$1',encodeURIComponent(title));location.href=articlePath+'?veaction=edit'+CreatePage.redlinkParam+flowParam;}else{location.href=CreatePage.options[CreatePage.canUseVisualEditor()?'blank':CreatePage.pageLayout].submitUrl.replace('$1',encodeURIComponent(title))+CreatePage.redlinkParam+flowParam;}CreatePage.flowName='';}else{CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.ERROR,label:response.error});CreatePage.displayError(response.msg,trackingCategory);}});},requestDialog:function(e,titleText){'use strict';var rs,dialogCallback;if(Boolean(window.WikiaEnableNewCreatepage)===false){return;}if(e&&e.which===2){return;}if(e&&e.preventDefault){e.preventDefault();}if(CreatePage.canUseVisualEditor()&&$(e.target).hasClass('createboxButton')){
CreatePage.checkTitle(titleText);return;}if(false===CreatePage.loading){CreatePage.loading=!0;if(CreatePage.canUseVisualEditor()&&titleText){rs='wfCreatePageAjaxGetVEDialog';dialogCallback=CreatePage.openVEDialog;}else{rs='wfCreatePageAjaxGetDialog';dialogCallback=CreatePage.openDialog;}$.getJSON(CreatePage.context.wgScript,{action:'ajax',rs:rs,article:titleText},dialogCallback);}},openVEDialog:function(data){var trackingCategory='redlink-page-create-title-modal';require(['wikia.ui.factory'],function(uiFactory){uiFactory.init(['modal']).then(function(uiModal){var createPageModalConfig={vars:{id:'CreatePageModalDialog',size:'small',title:data.title,content:data.html,classes:['modalContent'],buttons:[{vars:{value:data.addPageLabel,classes:['normal','primary'],data:[{key:'event',value:'create'}]}},{vars:{value:data.cancelLabel,classes:['normal','secondary'],data:[{key:'event',value:'cancel'}]}}]}};uiModal.createComponent(createPageModalConfig,function(createPageModal){CreatePage.track({
category:trackingCategory,action:Wikia.Tracker.ACTIONS.IMPRESSION,label:'modal'});createPageModal.bind('create',function(){CreatePage.submitDialog(trackingCategory);});createPageModal.bind('cancel',function(event){event.stopPropagation();CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.CLICK,label:'cancel'});createPageModal.trigger('close');});createPageModal.$blackout.add(createPageModal.$close).on('click',function(event){if(event.target===event.delegateTarget){CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.CLOSE,label:'close'});}});CreatePage.loading=!1;createPageModal.show();});});});},openDialog:function(data){var trackingCategory='page-create-title-modal';require(['wikia.ui.factory'],function(uiFactory){uiFactory.init(['modal']).then(function(uiModal){var createPageModalConfig={vars:{id:'CreatePageModalDialog',size:'medium',title:data.title,content:data.html,classes:['modalContent'],buttons:[{vars:{value:data.addPageLabel,
classes:['normal','primary'],data:[{key:'event',value:'create'}]}}]}};uiModal.createComponent(createPageModalConfig,function(createPageModal){var idToken,elm,onElementClick,name,titleText,inputChangeTracked=!1,redLinks;CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.IMPRESSION,label:'modal'});redLinks=createPageModal.$element.find('.create-page-dialog__proposals .new');if(redLinks.length){CreatePage.track({category:'page-create-title-modal',action:Wikia.Tracker.ACTIONS.IMPRESSION,label:'redlinks'});redLinks.on('click',function(){CreatePage.track({category:'page-create-title-modal',action:Wikia.Tracker.ACTIONS.CLICK,label:'redlink'});});}createPageModal.bind('create',function(event){event.preventDefault();inputChangeTracked=!1;CreatePage.submitDialog(trackingCategory);});createPageModal.bind('cancel',function(event){event.stopPropagation();CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.CLICK,label:'cancel'});createPageModal.
trigger('close');});onElementClick=function(){CreatePage.setPageLayout($(this).data('optionName'));};for(name in CreatePage.options){idToken=name.charAt(0).toUpperCase()+name.substring(1);elm=$('#CreatePageDialog'+idToken+'Container');elm.data('optionName',name);elm.click(onElementClick);}titleText=data.article;if(typeof titleText==='number'){titleText=titleText.toString();}if(titleText){$('#wpCreatePageDialogTitle').val(decodeURIComponent(titleText));}CreatePage.setPageLayout(data.defaultOption);$('#wpCreatePageDialogTitle').focus().on('change type keypress',function(){if(!inputChangeTracked){inputChangeTracked=!0;CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.KEYPRESS,label:'title'});}});if(CreatePage.canUseVisualEditor()){$('#CreatePageDialogChoose, #CreatePageDialogChoices').hide();}CreatePage.loading=!1;createPageModal.show();});});});},submitDialog:function(trackingCategory){'use strict';CreatePage.track({category:trackingCategory,action:Wikia.
Tracker.ACTIONS.SUBMIT,label:'submit'});CreatePage.checkTitle($('#wpCreatePageDialogTitle').val(),trackingCategory);},displayError:function(errorMsg,trackingCategory){'use strict';var box=$('#CreatePageDialogTitleErrorMsg');box.html('<span id="createPageErrorMsg">'+errorMsg+'</span>');box.find('a').click(function(){CreatePage.track({category:trackingCategory,action:Wikia.Tracker.ACTIONS.CLICK,label:'conflict-link'});});box.removeClass('hiddenStructure');},setPageLayout:function(layout){'use strict';CreatePage.pageLayout=layout;var idToken=layout.charAt(0).toUpperCase()+layout.substring(1);$('#CreatePageDialog'+idToken).attr('checked','checked');$('#CreatePageDialogChoices').children('li').removeClass('accent');$('#CreatePageDialog'+idToken+'Container').addClass('accent');},getTitleFromUrl:function(url){'use strict';var uri=new mw.Uri(url);return uri.path.replace(CreatePage.wgArticlePath.replace('$1',''),'').replace(/_/g,' ');},redLinkClick:function(e,titleText){'use strict';var title=
new mw.Title.newFromText(decodeURIComponent(titleText)),namespace=title.getNamespacePrefix().replace(':',''),visualEditorActive=$('html').hasClass('ve-activated'),redLinkFlowName=CreatePage.getRedLinkFlowName();CreatePage.redlinkParam='&redlink=1';CreatePage.flowName=redLinkFlowName;if(CreatePage.canUseVisualEditor()){CreatePage.track({category:'article',action:Wikia.Tracker.ACTIONS.CLICK,label:'ve-redlink-click'});}if(visualEditorActive||mw.config.get('wgNamespaceIds')[namespace.toLowerCase()]&&window.ContentNamespacesText&&window.ContentNamespacesText.indexOf(title[0])===-1){return false;}else{CreatePage.requestDialog(e,titleText);}},init:function(context){'use strict';CreatePage.context=context;$('.createpage').click(function(){CreatePage.trackCreatePageStart(window.wgFlowTrackingFlows.CREATE_PAGE_CONTRIBUTE_BUTTON);CreatePage.flowName=window.wgFlowTrackingFlows.CREATE_PAGE_CONTRIBUTE_BUTTON;});if(window.WikiaEnableNewCreatepage){$().log('init','CreatePage');if(!window.
WikiaDisableDynamicLinkCreatePagePopup){$('#dynamic-links-write-article-link, #dynamic-links-write-article-icon').click(function(e){CreatePage.requestDialog(e,null);});$('.noarticletext a[href*="redlink=1"]').click(function(e){CreatePage.requestDialog(e,CreatePage.context.wgPageName);return false;});}$('.createpage').click(CreatePage.requestDialog);var addRecipeTab=$('#add_recipe_tab'),addRecipeLink;if(addRecipeTab.exists()){addRecipeLink=addRecipeTab.find('a');if(addRecipeLink.attr('href').match(/CreatePage$/)){addRecipeLink.click(CreatePage.requestDialog);}}$('#WikiaArticle').on('click','a.new',function(e){CreatePage.redLinkClick(e,CreatePage.getTitleFromUrl(this.href));});$('.createboxButton').bind('click',function(e){var form=$(e.target).parent(),prefix,field,preloadField;if(form.attr('class')==='createboxForm'){prefix=form.children('input[name=\'prefix\']').val()||'';field=form.children('.createboxInput');preloadField=form.children('input[name=\'preload\']');if((typeof preloadField
.val()==='undefined')||(preloadField.val()==='')){CreatePage.flowName=window.wgFlowTrackingFlows.CREATE_PAGE_CREATE_BOX;CreatePage.requestDialog(e,prefix+field.val());}else{return true;}}});}},getRedLinkFlowName:function(){return mw.config.get('wgNamespaceNumber')===-1?window.wgFlowTrackingFlows.CREATE_PAGE_SPECIAL_REDLINK:window.wgFlowTrackingFlows.CREATE_PAGE_ARTICLE_REDLINK;},trackCreatePageStart:function(flowName){require(['wikia.flowTracking'],function(flowTrack){flowTrack.beginFlow(flowName,{});});},track:function(data){var defaultData;if(Wikia.Tracker&&data.category){defaultData={trackingMethod:'analytics'};$.extend(defaultData,data);Wikia.Tracker.track(defaultData);}}};jQuery(function(){'use strict';CreatePage.init(window);});;define('wikia.videoBootstrap',['wikia.loader','wikia.nirvana','wikia.log','wikia.tracker'],function videoBootstrap(loader,nirvana,log,tracker){'use strict';var trackingTimeout=0;function VideoBootstrap(element,json,clickSource){var self=this,init=json.
init,html=json.html,scripts=json.scripts,jsParams=json.jsParams;this.element=element;this.clickSource=clickSource;this.title=json.title;this.provider=json.provider;this.width=json.width;this.height=json.height;function insertHtml(){if(html&&!json.htmlPreloaded){element.innerHTML=html;}}function loadFromScriptsCallback(){insertHtml();if(init){require([init],function(init){self.clearTimeoutTrack();init(jsParams,self);});}}function loadFromScripts(){var i,args=[];for(i=0;i<scripts.length;i++){args.push({type:loader.JS,resources:scripts[i]});}loader.apply(loader,args).done(loadFromScriptsCallback);}if(scripts){loadFromScripts();}else{insertHtml();}if(!init){self.timeoutTrack();}}VideoBootstrap.prototype={reload:function(title,width,autoplay,clickSource){var element=this.element,fileTitle=title||this.title,fileClickSource=clickSource||this.clickSource,fileWidth=width||this.width;this.clearTimeoutTrack();nirvana.getJson('VideoHandler','getEmbedCode',{fileTitle:fileTitle,width:fileWidth,
autoplay:autoplay?1:0}).done(function(data){return new VideoBootstrap(element,data.embedCode,fileClickSource);});},track:function(action){log('tracking '+action,3,'VideoBootstrap');tracker.track({action:action,category:'video-player-stats',label:this.provider,trackingMethod:'analytics',value:0},{title:this.title,clickSource:this.clickSource});},timeoutTrack:function(){var self=this;this.clearTimeoutTrack();trackingTimeout=setTimeout(function(){self.track('content-begin');},3000);},clearTimeoutTrack:function(){log('clearing tracking timeout',3,'VideoBootstrap');clearTimeout(trackingTimeout);},timeStampId:function(id){var container=document.getElementById(id),newId=id+'-'+new Date().getTime();if(container){container.id=newId;}return newId;},destroy:function(){this.element.innerHTML='';}};return VideoBootstrap;});;(function(window,$){'use strict';var LightboxLoader,LightboxTracker,bucky;LightboxLoader={cache:{articleMedia:[],wikiPhotos:[],videosModule:[],details:{},share:{},to:0},
inlineVideoLinks:$(),lightboxLoading:!1,inlineVideoLoading:[],videoInstance:null,pageAds:$('#TOP_RIGHT_BOXAD'),reloadOnClose:!1,lightboxSettings:{id:'LightboxModal',className:'LightboxModal',width:970,noHeadline:!0,topOffset:25,height:628,videoHeight:360,onClose:function(){$(window).off('.Lightbox');Lightbox.openModal.find('.video-media').children().remove();LightboxLoader.lightboxLoading=!1;Lightbox.updateUrlState(true);Lightbox.current.thumbs=[];Lightbox.current.thumbTypesAdded=[];Lightbox.to=LightboxLoader.cache.to;LightboxLoader.pageAds.css('visibility','visible');Lightbox.clearTrackingTimeouts();if(LightboxLoader.videoInstance){LightboxLoader.videoInstance.clearTimeoutTrack();}if(LightboxLoader.reloadOnClose){window.location.reload();}}},videoThumbWidthThreshold:400,init:function(customSettings){var self=this,$article,$comments,$footer,$videosModule,$videoHomePage,$recommendations;bucky=window.Bucky('LightboxLoader');bucky.timer.start('init');$article=$('#WikiaArticle')
;$comments=$('#WikiaArticleComments');$footer=$('#WikiaArticleFooter');$videosModule=$('.videos-module-rail');$videoHomePage=$('#latest-videos-wrapper');$recommendations=$('#recommendations');$.extend(self.lightboxSettings,customSettings);$article.add($footer).add($videosModule).add($recommendations).off('.lightbox').on('click.lightbox','.lightbox, a.image',function(e){var $this=$(this),$thumb=$this.find('img').first(),fileKey=$thumb.attr('data-image-key')||$thumb.attr('data-video-key'),$parent,isVideo,trackingInfo,$slideshowImg,clickSource;if(!LightboxLoader.hasLightbox($this,$thumb,e)){return;}e.preventDefault();if($this.closest($videoHomePage).length){$parent=$videoHomePage;}else if($this.closest($article).length){$parent=$article;}else if($this.closest($comments).length){$parent=$comments;}else if($this.closest($recommendations).length){$parent=$recommendations;}else if($this.closest('#videosModule').length){$parent=$('#videosModule');}trackingInfo={target:$this,parent:$parent};if(
$this.hasClass('wikia-slideshow-popout')){$slideshowImg=$this.parents('.wikia-slideshow-toolbar').siblings('.wikia-slideshow-images-wrapper').find('li:visible').find('img').first();fileKey=$slideshowImg.attr('data-image-name')||$slideshowImg.attr('data-video-name');}if(!fileKey){fileKey=$this.attr('data-image-name')||$this.attr('data-video-name');fileKey=fileKey?fileKey.replace(/ /g,'_'):fileKey;}if(!fileKey){Wikia.log('No file key found on this image or video',3,'LightboxLoader');return;}isVideo=$this.children('.play-circle').length;if(isVideo&&$thumb.width()>=self.videoThumbWidthThreshold&&!$this.hasClass('force-lightbox')){clickSource=window.wgWikiaHubType?LightboxTracker.clickSource.HUBS:LightboxTracker.clickSource.EMBED;LightboxLoader.displayInlineVideo($this,$thumb,fileKey,clickSource);return;}self.loadLightbox(fileKey,trackingInfo);});$article.off('.slideshowLightbox').on('click.slideshowLightbox',
'.wikia-slideshow-images .thumbimage, .wikia-slideshow-images .wikia-slideshow-image',function(e){var $this=$(this);if(LightboxLoader.hasLightbox($this,null,e)){e.preventDefault();$this.closest('.wikia-slideshow-wrapper').find('.wikia-slideshow-popout').click();}});bucky.timer.stop('init');setTimeout(LightboxLoader.loadFromURL,0);},loadLightbox:function(mediaTitle,trackingInfo){var openModal,lightboxParams,deferredList,resources,deferredTemplate;bucky.timer.start('loadLightbox');LightboxLoader.removeInlineVideos();LightboxLoader.lightboxLoading=!0;LightboxLoader.pageAds.css('visibility','hidden');openModal=$('<div>').makeModal(LightboxLoader.lightboxSettings);openModal.find('.modalContent').startThrobbing();lightboxParams={key:mediaTitle,modal:openModal};$.extend(lightboxParams,trackingInfo);deferredList=[];if(!LightboxLoader.assetsLoaded){deferredList.push($.loadMustache());resources=[$.getSassCommonURL('/extensions/wikia/Lightbox/styles/Lightbox.scss'),window.wgExtensionsPath+
'/wikia/Lightbox/scripts/Lightbox.js'];deferredList.push($.getResources(resources));deferredTemplate=$.Deferred();$.nirvana.sendRequest({controller:'Lightbox',method:'lightboxModalContent',type:'GET',format:'html',data:{lightboxVersion:window.wgStyleVersion,userLang:window.wgUserLanguage},callback:function(html){LightboxLoader.templateHtml=html;deferredTemplate.resolve();}});deferredList.push(deferredTemplate);}deferredList.push(LightboxLoader.getMediaDetailDeferred({fileTitle:mediaTitle}));$.when.apply(this,deferredList).done(function(){LightboxLoader.assetsLoaded=!0;Lightbox.initialFileDetail=arguments[arguments.length-1];Lightbox.makeLightbox(lightboxParams);bucky.timer.stop('loadLightbox');});},displayInlineVideo:function(target,targetChildImg,mediaTitle,clickSource){var self=this;if($.inArray(mediaTitle,LightboxLoader.inlineVideoLoading)>-1){return;}LightboxLoader.inlineVideoLoading.push(mediaTitle);LightboxLoader.getMediaDetail({fileTitle:mediaTitle,isInline:!0,height:
targetChildImg.height(),width:targetChildImg.width()},function(json){var embedCode=json.videoEmbedCode,inlineDiv=$('<div class="inline-video"></div>').insertAfter(target.hide()),videoIndex;target.closest('.article-thumb').addClass('inline-video-playing');require(['wikia.videoBootstrap'],function(VideoBootstrap){self.videoInstance=new VideoBootstrap(inlineDiv[0],embedCode,clickSource);});LightboxLoader.inlineVideoLinks=target.add(LightboxLoader.inlineVideoLinks);LightboxTracker.inlineVideoTrackingTimeout=setTimeout(function(){LightboxTracker.track(Wikia.Tracker.ACTIONS.VIEW,'video-inline',null,{title:json.title,provider:json.providerName,clickSource:clickSource});},1000);videoIndex=$.inArray(mediaTitle,LightboxLoader.inlineVideoLoading);LightboxLoader.inlineVideoLoading.splice(videoIndex,1);},true);},removeInlineVideos:function(){clearTimeout(LightboxTracker.inlineVideoTrackingTimeout);LightboxLoader.inlineVideoLinks.show().parent().removeClass('inline-video-playing').end().next().
remove();},getMediaDetail:function(mediaParams,callback,nocache){var title=mediaParams.fileTitle;if(!nocache&&LightboxLoader.cache.details[title]){callback(LightboxLoader.cache.details[title]);}else{bucky.timer.start('getMediaDetail.request');$.nirvana.sendRequest({controller:'Lightbox',method:'getMediaDetail',type:'get',format:'json',data:mediaParams,callback:function(json){bucky.timer.stop('getMediaDetail.request');if(!nocache){LightboxLoader.cache.details[title]=json;}callback(json);}});}},getMediaDetailDeferred:function(mediaParams){var deferred=$.Deferred();LightboxLoader.getMediaDetail(mediaParams,function(json){deferred.resolve(json);});return deferred;},loadFromURL:function(){var fileTitle=window.Wikia.Querystring().getVal('file'),openModal=$('#LightboxModal'),trackingInfo;if(fileTitle){if(openModal.length){LightboxLoader.getMediaDetail({fileTitle:fileTitle},function(data){Lightbox.current.key=data.title.replace(/ /g,'_');Lightbox.current.type=data.mediaType;Lightbox.
setCarouselIndex();Lightbox.openModal.carousel.find('li').eq(Lightbox.current.index).click();});}else{trackingInfo={parent:$('#WikiaArticle'),clickSource:LightboxTracker.clickSource.SHARE};LightboxLoader.loadLightbox(fileTitle,trackingInfo);}}else{if(openModal.length){openModal.closeModal();}}},hasLightbox:function($link,$thumb,event){var modalPadding=40;return!($(window).width()<LightboxLoader.lightboxSettings.width+modalPadding||$link.hasClass('link-internal')||$link.hasClass('link-external')||$thumb&&$thumb.attr('data-shared-help')||$link.hasClass('no-lightbox')||event.metaKey||event.ctrlKey);}};LightboxTracker={inlineVideoTrackingTimeout:0,track:function(action,label,value,data){Wikia.Tracker.track({action:action,category:'lightbox',label:label||'',trackingMethod:'analytics',value:value||0},data);},clickSource:{EMBED:'embed',SEARCH:'search',SV:'specialVideos',LB:'lightbox',SHARE:'share',HUBS:'hubs',OTHER:'other',VIDEOS_MODULE_RAIL:'railVideosModule',VIDEO_HOME_PAGE:'videoHomePage'}
};$(function(){if(window.wgEnableLightboxExt){LightboxLoader.init();}});window.LightboxLoader=LightboxLoader;window.LightboxTracker=LightboxTracker;})(window,jQuery);;define('wikia.ImgLzy',['jquery','wikia.window'],function($,window){'use strict';var ImgLzy;ImgLzy={prefetchDistance:700,loadQueue:[],init:function(){var proxy=this.onScroll.bind(this),throttled=$.throttle(250,proxy);this.loadQueue=Array.prototype.slice.call(document.querySelectorAll('img.lzy'));this.onScroll();$(window).on('scroll',throttled);document.addEventListener('tablesorter_sortComplete',proxy);},load:function(image){var dataSrc=image.getAttribute('data-src');image.onload=function(){};if(dataSrc){image.src=dataSrc;}image.classList.remove('lzy','lzyPlcHld');},isVisibleInViewport:function(element){if(!element.offsetParent){return false;}var boundingClientRect=element.getBoundingClientRect();return boundingClientRect.top-this.prefetchDistance<window.innerHeight&&boundingClientRect.bottom+this.prefetchDistance>0;},
onScroll:function(){var self=this;this.loadQueue=this.loadQueue.filter(function(image){if(!self.isVisibleInViewport(image)){return true;}image.onload=self.onImageLoaded;var dataSrc=image.getAttribute('data-src');if(dataSrc){image.src=dataSrc;}image.classList.add('lzyTrns');image.classList.remove('lzy');return false;});},onImageLoaded:function(){this.classList.add('lzyLoaded');}};return ImgLzy;});;require(['jquery','wikia.ImgLzy','wikia.browserDetect'],function($,ImgLzy,browserDetect){'use strict';window.ImgLzy=ImgLzy;$(function(){ImgLzy.init();if(browserDetect.isIPad()){window.addEventListener('pageshow',function(){window.setTimeout(ImgLzy.onScroll.bind(ImgLzy),0);});}});});;(function(window,$,undefined){if(window.wgIsEditPage){return;}var MiniEditor={assetsLoaded:!1,loadingAssets:!1,wrapperSelector:'.MiniEditorWrapper',initTime:0,initTimer:null,loadTime:0,loadTimer:null,ckeditorEnabled:!1,editorSuite:'mweditorsuite',editorIsLoading:!1,config:{animations:{},isMiniEditor:
!0,mode:'source',toolbars:{tabs:[],toolbar:['FormatMiniEditorSource','InsertMiniEditor'],rail:[]}},plugins:['MiniEditor','loadingstatus'],configure:function(){if(!this.assetsLoaded){return;}if(typeof RTE!='undefined'){this.ckeditorEnabled=!0;this.editorSuite='ckeditorsuite';this.config.mode=window.RTEInitMode||'wysiwyg';this.config.toolbars.toolbar=['ModeSwitch','FormatMiniEditor'].concat(this.config.toolbars.toolbar);RTE.config.contentsCss.push($.getSassLocalURL('extensions/wikia/MiniEditor/css/core/content.scss'));RTE.overlayNode.bind('click.MiniEditor',function(){RTE.overlayNode.data('wikiaEditor').setAsActiveInstance();});}this.plugins.unshift(this.editorSuite);this.config.uiElements=window.wgEditorExtraButtons||{};GlobalTriggers.fire('MiniEditorReady');},loadAssets:function(callback){var self=this;if(this.loadingAssets||this.assetsLoaded){if($.isFunction(callback)){callback();}return;}this.loadTimer=new Date();$().log('Start resource loading','MiniEditor');this.loadingAssets=
!0;$.nirvana.sendRequest({controller:'MiniEditorController',method:'makeGlobalVariables',data:{'useeditor':$.getUrlVar('useeditor')},type:'POST',callback:function(data){var assets=window.wgMiniEditorAssets;for(var v in data){window[v]=data[v];}if(typeof assets!='undefined'&&$.isArray(assets)){$.each(assets,function(i,path){assets[i]=window.wgResourceBasePath+path;});assets=window.wgMiniEditorAssets=data.wgMiniEditorAssets.concat(assets);}$.getResources(assets,$.proxy(function(){this.loadTime=(new Date().getTime()-this.loadTimer.getTime());$().log('End resource loading ('+this.loadTime+'ms)','MiniEditor');this.assetsLoaded=!0;this.loadingAssets=!1;this.configure();if($.isFunction(callback)){callback();}},self),function(jqXHR,status,error){$().log(arguments,'MiniEditor');});}});},loading:function(element,preloading){$(element).closest(this.wrapperSelector).addClass(preloading?'preloading':'loading');this.editorIsLoading=!0;},initEditor:function(element,options,event){var $element
=$(element),$wrapper=$element.closest(this.wrapperSelector),preloading=event&&event.target&&event.target!=$element.get(0);if(this.loadingAssets){return;}if(!this.assetsLoaded){this.loading($element,preloading);return this.loadAssets($.proxy(function(){this.initEditor(element,options);},this));}var wikiaEditor=$element.data('wikiaEditor');if(wikiaEditor&&wikiaEditor.ready){wikiaEditor.fire('editorActivated',(wikiaEditor.event=event));}else if((wikiaEditor||(wikiaEditor=WikiaEditor.getInstance()))&&!wikiaEditor.ready){this.loading($element,preloading);wikiaEditor.fire('editorBeforeReady',(wikiaEditor.event=event));}else{this.initTimer=new Date();$().log('Start initialization','MiniEditor');options=$.extend(true,{},$.fn.miniEditor.options,options);var self=this,events=$.extend({},options.events);this.loading($element,preloading);events.editorReady=function(){self.editorIsLoading=!1;if($.isFunction(options.events.editorReady)){options.events.editorReady.apply(self,arguments);}}
$element.bind(events);if(options.content!==undefined){$element.html(options.content);}wikiaEditor=WikiaEditor.create(this.plugins,$.extend(true,{},this.config,{body:$element,element:$wrapper.addClass(this.editorSuite),minHeight:$element.data('min-height')||200,mode:$.isArray(options.edgeCases)&&options.edgeCases.length?'source':this.config.mode,maxHeight:$element.data('max-height')||400,startupFocus:!preloading},options.config),event);if(window.wgEnableMiniEditorLinkSuggest){if(this.config.editorSuite==='ckeditor'){wikiaEditor.on('ck-mode',function(){if(wikiaEditor.ck.mode!=='wysiwyg'){MiniEditor.initLinkSuggest($wrapper,'textarea.cke_source');}});}else{this.initLinkSuggest($wrapper,'#'+wikiaEditor.instanceId);}}$element.addClass('wikiaEditor').triggerHandler('editorInit',[wikiaEditor,event]);}},initLinkSuggest:function($wrapper,selector){mw.loader.using('ext.wikia.LinkSuggest',function(){$wrapper.find(selector).linksuggest();});},getStartupMode:function(element){var $element=$(element
);if($element.length){var wikiaEditor=$element.data('wikiaEditor');if(wikiaEditor){return wikiaEditor.mode;}}return this.config.mode;},getLoadConversionFormat:function(element){return WikiaEditor.modeToFormat(this.getStartupMode(element))=='richtext'?'richtext':'';},getSaveConversionFormat:function(element){return this.getLoadConversionFormat(element)=='richtext'?'wikitext':'';}};$.fn.miniEditor=function(options,event){return this.each(function(){MiniEditor.initEditor(this,options,event);});};$.fn.miniEditor.options={config:{},events:{}};$(function(){if(!window.wgMiniEditorLoadOnDemand){MiniEditor.assetsLoaded=!0;MiniEditor.configure();}});window.MiniEditor=MiniEditor;})(this,jQuery);;(function(window,$){'use strict';if(!window.wgIsArticle){return;}var $window=$(window),ArticleComments;ArticleComments={animations:{},processing:!1,mostRecentCount:0,messagesLoaded:!1,miniEditorEnabled:window.wgEnableMiniEditorExt,loadOnDemand:window.wgArticleCommentsLoadOnDemand,initCompleted:
!1,wrapperSelector:'#WikiaArticleComments',bucky:window.Bucky('ArticleComments'),init:function(){ArticleComments.bucky.timer.start('init');var $articleComments=$('#article-comments'),$articleCommFbMonit=$('#article-comm-fbMonit'),$fbCommentMessage=$('#fbCommentMessage'),newComment;mw.hook('wikipage.content').fire($articleComments);if(!ArticleComments.$wrapper){ArticleComments.$wrapper=$(ArticleComments.wrapperSelector);}ArticleComments.$commentsList=$('#article-comments-ul');ArticleComments.$actionButtons=ArticleComments.$wrapper.find('.actionButton');if(ArticleComments.miniEditorEnabled){newComment=$('#article-comm');newComment.bind('focus',function(){ArticleComments.editorInit(this);});if(newComment.is(':focus')){ArticleComments.editorInit(newComment);}}if(window.wgDisableAnonymousEditing&&!window.wgUserName){$('.article-comm-reply').hide();}else{$articleComments.on('click','.article-comm-edit',ArticleComments.actionProxy(ArticleComments.edit));$articleComments.on('click',
'.article-comm-reply',ArticleComments.actionProxy(ArticleComments.reply));$('#article-comm-submit').on('click',{source:'#article-comm'},ArticleComments.actionProxy(ArticleComments.postComment));}$articleCommFbMonit.mouseenter(function(){$fbCommentMessage.fadeIn('slow');});$articleCommFbMonit.mouseleave(function(){$fbCommentMessage.fadeOut('slow');});ArticleComments.addHover();ArticleComments.initCompleted=!0;ArticleComments.bucky.timer.stop('init');},actionProxy:function(callback){return function(e){e.preventDefault();if(ArticleComments.miniEditorEnabled&&MiniEditor.editorIsLoading){$().log('Event cancelled because editor is loading: ',e);return true;}callback.apply(this,arguments);};},edit:function(e){e.preventDefault();if(ArticleComments.processing){return;}if(ArticleComments.miniEditorEnabled&&!MiniEditor.assetsLoaded){MiniEditor.loadAssets(makeRequest);}else{makeRequest();}function makeRequest(){ArticleComments.bucky.timer.start('edit.makeRequest');var commentId=e.target.id.
replace(/^comment/,''),$textfield=$('#article-comm-textfield-'+commentId);$.getJSON(wgScript,{action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getLoadConversionFormat($textfield),id:commentId,method:'axEdit',rs:'ArticleCommentsAjax',useskin:window.skin},function(json){if(!json.error){var $buttons=$(e.target).closest('.buttons'),divFormSelector='#article-comm-div-form-'+json.id,textfieldSelector='#article-comm-textfield-'+json.id,$commentTextDiv=$('#comm-text-'+json.id).hide(),$editDivForm=$(divFormSelector),$blockquote=$commentTextDiv.parent(),$editTemplate=$(json.text).hide(),content=$editTemplate.find(textfieldSelector).val(),$textfield;if(!$editDivForm.length){$blockquote.append($editTemplate.attr('id',divFormSelector.substr(1)));$editDivForm=$(divFormSelector);}$textfield=$(textfieldSelector);if(ArticleComments.miniEditorEnabled){ArticleComments.editorInit($textfield,content,json.edgeCases);}else{$textfield.val(content);}$editDivForm.show();$buttons.hide();$(
'#article-comm-submit-'+json.id).bind('click',{id:json.id,emptyMsg:json.emptyMsg},ArticleComments.actionProxy(ArticleComments.saveEdit));$('#article-comm-edit-cancel-'+json.id).bind('click',{id:json.id,target:e.target,text:json.text},ArticleComments.actionProxy(ArticleComments.cancelEdit));}ArticleComments.processing=!1;ArticleComments.bucky.timer.stop('edit.makeRequest');});}ArticleComments.processing=!0;},cancelEdit:function(e){var commentId=e.data.id;e.preventDefault();if(ArticleComments.miniEditorEnabled){$('#article-comm-textfield-'+commentId).data('wikiaEditor').fire('editorDeactivated');}$('#article-comm-div-form-'+commentId).hide();$(e.data.target).closest('.buttons').show();$('#comm-text-'+commentId).show();},saveEdit:function(e){var commentId,commentFormDiv,$throbber,$submitButton,$textfield,content;ArticleComments.bucky.timer.start('saveEdit');e.preventDefault();if(ArticleComments.processing){return;}commentId=e.data.id;commentFormDiv=$('#article-comm-form-'+commentId);
if(commentFormDiv.length){$throbber=$(e.target).siblings('.throbber');$submitButton=$('#article-comm-submit-'+commentId);$textfield=$('#article-comm-textfield-'+commentId);content=ArticleComments.getContent($textfield);$submitButton.parent().find('.info').remove();if($.trim(content)===''){$submitButton.after($('<span>').addClass('info').html(e.data.emptyMsg));return;}$('#article-comm-info').html('');$throbber.css('visibility','visible');$textfield.attr('readonly','readonly');$.postJSON(wgScript,{action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getSaveConversionFormat($textfield),id:commentId,method:'axSave',rs:'ArticleCommentsAjax',title:wgPageName,wpArticleComment:content,token:window.mw.user.tokens.get('editToken')},function(json){$throbber.css('visibility','hidden');if(!json.error){if(json.commentId&&json.commentId!==0){var comment=$('#comm-'+json.commentId),commentText=comment.find('.article-comm-text'),saveTemplate=$(json.text),saveTemplateText=saveTemplate.find(
'.article-comm-text');$('#article-comm-div-form-'+json.commentId).hide();if(ArticleComments.miniEditorEnabled){$textfield.data('wikiaEditor').fire('editorReset');}commentText.html(saveTemplateText.html()).show();mw.hook('wikipage.content').fire(commentText);comment.find('.edited-by').html(saveTemplate.find('.edited-by').html());}}else{$('#article-comm-info').html(json.msg);}$textfield.removeAttr('readonly');ArticleComments.processing=!1;ArticleComments.bucky.timer.stop('saveEdit');});ArticleComments.processing=!0;}},reply:function(e){ArticleComments.bucky.timer.start('reply');e.preventDefault();if(ArticleComments.processing){return;}$.getJSON(wgScript,{action:'ajax',article:wgArticleId,id:$(this).closest('.comment').attr('id').replace(/^comm-/,''),method:'axReply',rs:'ArticleCommentsAjax',title:wgPageName,useskin:window.skin},function(json){var $blockquote=$('#comm-text-'+json.id).parent(),$editbox=$blockquote.find('.article-comm-edit-box'),$buttons=$blockquote.find('.buttons').
hide(),$textfield;$blockquote.find('.info').remove();if($editbox.length){$editbox.show();}else if(!json.error){$blockquote.append(json.html);$('#article-comm-reply-submit-'+json.id).bind('click',{source:'#article-comm-reply-textfield-'+json.id,parentId:json.id},ArticleComments.actionProxy(ArticleComments.postComment));}else if(json.error===2){$blockquote.find('.tools').after($('<span>').addClass('info').html(json.msg));}else{require(['wikia.ui.factory'],function(uiFactory){uiFactory.init(['modal']).then(function(uiModal){var moduleConfig={vars:{id:'general_error',size:'small',content:json.msg}};uiModal.createComponent(moduleConfig,function(errorModal){errorModal.show();});});});}$textfield=$('#article-comm-reply-textfield-'+json.id);if(ArticleComments.miniEditorEnabled){ArticleComments.editorInit($textfield,{editorActivated:function(){$blockquote.find('.article-comm-edit-box').show();},editorDeactivated:function(event,wikiaEditor){if(!wikiaEditor.getContent()){$blockquote.find(
'.article-comm-edit-box').hide();$buttons.show();}}});}else{$textfield.focus();}ArticleComments.processing=!1;ArticleComments.bucky.timer.stop('reply');});ArticleComments.processing=!0;},postComment:function(e){var $source,$target,$throbber,content,showall,data;e.preventDefault();if(ArticleComments.processing){return;}$source=$(e.data.source);content=ArticleComments.getContent($source);if($.trim(content)===''){return;}$target=$(e.target);$throbber=$target.siblings('.throbber');showall=$.getUrlVar('showall');$throbber.css('visibility','visible');$source.attr('readonly','readonly');$target.attr('disabled',true);data={action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getSaveConversionFormat($source),method:'axPost',rs:'ArticleCommentsAjax',title:wgPageName,wpArticleComment:content,useskin:window.skin,token:window.mw.user.tokens.get('editToken')};if(e.data.parentId){data.parentId=e.data.parentId;data.page=$('.article-comments-pagination-link-active').eq(0).attr('page')
;}if(showall){data.showall=1;}function requestCallback(json){var $parent,$subcomments,parentId,nodes;ArticleComments.bucky.timer.start('postComment.requestCallback');$throbber.css('visibility','hidden');if(ArticleComments.miniEditorEnabled){$source.data('wikiaEditor').fire('editorReset');}else{$source.val('');}if(!json.error){parentId=json.parentId;nodes=$(json.text);mw.hook('wikipage.content').fire(nodes);if(parentId){$parent=$('#comm-'+parentId);$subcomments=$parent.next();if(!$subcomments.hasClass('sub-comments')){$parent.after($subcomments=$('<ul class="sub-comments"></ul>'));}$subcomments.append(nodes);$parent.find('.article-comm-edit-box').hide();$parent.find('.buttons').show();}else{nodes.prependTo(ArticleComments.$commentsList);}if(window.skin==='oasis'){$('#WikiaUserPagesHeader').find('.commentsbubble').html(json.counter);if(!parentId){ArticleComments.mostRecentCount=ArticleComments.mostRecentCount?ArticleComments.mostRecentCount+1:ArticleComments.$commentsList.children('li').
length;$('#article-comments-counter-recent').html($.msg('oasis-comments-showing-most-recent',ArticleComments.mostRecentCount));}}ArticleComments.addHover();}else{new BannerNotification(json.msg,'error').show();}$source.removeAttr('readonly');$target.removeAttr('disabled');ArticleComments.processing=!1;ArticleComments.bucky.timer.stop('postComment.requestCallback');}function makeRequest(){$.postJSON(wgScript,data,requestCallback);ArticleComments.processing=!0;}if(!ArticleComments.messagesLoaded){$.getMessages('ArticleCommentsCounter',function(){ArticleComments.messagesLoaded=!0;makeRequest();});}else{makeRequest();}},setPage:function(e){ArticleComments.bucky.timer.start('setPage');var page=parseInt($(this).attr('page'));e.preventDefault();ArticleComments.$commentsList.addClass('loading');$.getJSON(wgScript+'?action=ajax&rs=ArticleCommentsAjax&method=axGetComments',{article:wgArticleId,order:$('#article-comm-order').attr('value'),page:page,useskin:window.skin},function(json){
ArticleComments.$commentsList.removeClass('loading');if(!json.error){ArticleComments.$commentsList.html(json.text);var $articleCommentsPagination=$('.article-comments-pagination');if($articleCommentsPagination.exists()){$articleCommentsPagination.html(json.pagination);}ArticleComments.addHover();}ArticleComments.processing=!1;ArticleComments.bucky.timer.stop('setPage');});},addHover:function(){var linkSelectors=['.article-comments-pagination-link-active','#article-comments-pagination-link-prev','#article-comments-pagination-link-next'];$('.article-comments-pagination-link').bind('click',ArticleComments.setPage).not(linkSelectors.join(', ')).hover(function(){$(this).addClass('accent');},function(){$(this).removeClass('accent');});},editorInit:function(element,events,content,edgeCases){ArticleComments.bucky.timer.start('editorInit');var $element=$(element),wikiaEditor=$element.data('wikiaEditor'),editorActivated,hasEdgeCases;if(typeof events==='string'){edgeCases=content;content=
events;events={};}hasEdgeCases=$.isArray(edgeCases)&&edgeCases.length;function initEditor(){events=events||{};editorActivated=events.editorActivated;events.editorActivated=function(){ArticleComments.$actionButtons.removeClass('disabled').removeAttr('disabled');if($.isFunction(editorActivated)){editorActivated.apply(this,arguments);}};$element.miniEditor({config:{animations:MiniEditor.Wall.Animations,mode:hasEdgeCases?'source':MiniEditor.config.mode},events:events});}if(wikiaEditor){wikiaEditor.fire('editorActivated');if(content!==undefined){if(hasEdgeCases){wikiaEditor.ck.setMode('source');}wikiaEditor.setContent(content);}}else{ArticleComments.$actionButtons.addClass('disabled').attr('disabled',true);if(content!==undefined){$element.val(content);}if(!MiniEditor.assetsLoaded){MiniEditor.loading($element);MiniEditor.loadAssets(initEditor);}else{initEditor();}}ArticleComments.bucky.timer.stop('editorInit');},getContent:function(element){return ArticleComments.miniEditorEnabled?element.
data('wikiaEditor').getContent():element.val();},getLoadConversionFormat:function(element){return ArticleComments.miniEditorEnabled?MiniEditor.getLoadConversionFormat(element):'';},getSaveConversionFormat:function(element){return ArticleComments.miniEditorEnabled?MiniEditor.getSaveConversionFormat(element):'';},scrollToElement:function(element){var $element=$(element),docViewTop=$window.scrollTop(),docViewBottom=docViewTop+$window.height(),elementTop=$element.offset().top;$element.find('blockquote').addClass('current');if($('#globalNavigation').css('position')==='fixed'){window.GlobalNavigationScrollToElement(element);}else{if(elementTop<docViewTop||elementTop>docViewBottom){$('html, body').animate({scrollTop:elementTop},1);}}},showMoreComments:function(){var $nodesToHide=this.$wrapper.find('.comments').children().slice(3),$pagination=$('.article-comments-pagination',this.$wrapper),showMoreButton=this.$wrapper.find('.comments-show-more');if($nodesToHide.length===0){return;}$nodesToHide
.hide();$pagination.hide();showMoreButton.css('display','block');showMoreButton.click(function(){$nodesToHide.show();$pagination.show();showMoreButton.hide();});}};if(ArticleComments.loadOnDemand){$(function(){var content,hash,permalink,styleAssets=[],belowTheFold,loadAssets;ArticleComments.$wrapper=$(ArticleComments.wrapperSelector);if(!ArticleComments.$wrapper.length){return;}hash=window.location.hash;permalink=/^#comm-/.test(hash);styleAssets.push($.getSassCommonURL('skins/oasis/css/core/ArticleComments.scss'));belowTheFold=function(){return ArticleComments.$wrapper.offset().top>=($window.scrollTop()+$window.height());};if(ArticleComments.miniEditorEnabled){styleAssets.push($.getSassCommonURL('extensions/wikia/MiniEditor/css/MiniEditor.scss'));styleAssets.push($.getSassCommonURL('extensions/wikia/MiniEditor/css/ArticleComments/ArticleComments.scss'));}loadAssets=function(){ArticleComments.bucky.timer.start('loadAssets');$.when($.getResources(styleAssets),$.nirvana.sendRequest({
controller:'ArticleCommentsController',method:'Content',format:'html',type:'GET',data:{articleId:window.wgArticleId,page:ArticleComments.$wrapper.data('page'),useskin:window.skin},callback:function(response){content=response;}})).then(function(){ArticleComments.$wrapper.removeClass('loading').html(content);ArticleComments.init();if(permalink){ArticleComments.scrollToElement(hash);}ArticleComments.bucky.timer.stop('loadAssets');});};if(!permalink&&belowTheFold()){$window.on('scrollstop.ArticleCommentsLoadOnDemand',function(){if(!belowTheFold()){ArticleComments.$wrapper.addClass('loading');$window.off('scrollstop.ArticleCommentsLoadOnDemand');loadAssets();}});}else{loadAssets();}});}else{wgAfterContentAndJS.push(ArticleComments.init);}window.ArticleComments=ArticleComments;})(this,jQuery);;var GlobalModal={init:function(){var modal=$.getUrlVar('modal');if(modal){var f=GlobalModal['show'+modal];if(typeof f==='function'){f();}}},showUploadImage:function(){if(!wgUserName){$('.ajaxLogin').
trigger('click');}else{$('.upphotos').trigger('click');}},showAddPage:function(){if(!wgUserName){$('.ajaxLogin').trigger('click');}else{$('.createpage').trigger('click');}},showLogin:function(){if(!wgUserName){$('.ajaxLogin').trigger('click');}},showAdopt:function(){$.when($.getResources([$.getSassCommonURL('/extensions/wikia/AutomaticWikiAdoption/css/AutomaticWikiAdoption.scss')]),$.nirvana.sendRequest({controller:'AutomaticWikiAdoption',method:'AdoptWelcomeDialog',format:'html',type:'get',data:{cb:wgCurRevisionId}})).then(function(sass,nirvanaData){var html=nirvanaData[0];$(html).makeModal({width:500,height:400});});}}
$(function(){GlobalModal.init();});;(function(){'use strict';var UserLogin={forceLoggedIn:!1,refreshIfAfterForceLogin:function(){if(this.forceLoggedIn){Wikia.Querystring().addCb().goTo();}},rteForceLogin:function(){window.onbeforeunload=function(){};window.wikiaAuthModal.load({forceLogin:!0,origin:'editor',onAuthSuccess:function(){if(window.WikiaEditor){WikiaEditor.reloadEditor();}}});},isForceLogIn:function(){if(window.wgUserName===null){window.onbeforeunload=function(){};window.wikiaAuthModal.load({forceLogin:!0,origin:'editor'});return true;}return false;}};window.UserLogin=UserLogin;})();;var WikiaBar={WIKIA_BAR_STATE_ANON_ML_KEY:'AnonMainLangWikiaBar_0.0001',WIKIA_BAR_STATE_ANON_NML_KEY:'AnonNotMainLangWikiaBar_0.0001',WIKIA_BAR_HIDDEN_ANON_ML_TTL:24*60*1000,WIKIA_BAR_HIDDEN_ANON_NML_TTL:180*24*60*1000,WIKIA_BAR_STATE_USER_KEY_SUFFIX:'UserWikiaBar_1.0004',WIKIA_BAR_MAX_MESSAGE_PARTS:5,WIKIA_BAR_SAMPLING_RATIO:10,WIKIA_BAR_SHOWN_STATE_VALUE:'shown',
WIKIA_BAR_HIDDEN_STATE_VALUE:'hidden',cutMessagePrecision:20,messageConfig:{index:0,container:null,attributeName:'wikiabarcontent',content:null,speed:500,delay:10000,prevMsgNumber:-1,doTrackImpression:!1},wikiaBarHidden:!0,wikiaBarWrapperObj:null,wikiaBarCollapseWrapperObj:null,isSampledEvent:function(){return this.WIKIA_BAR_SAMPLING_RATIO>=Math.floor((Math.random()*100+1));},bindTracking:function(){this.wikiaBarWrapperObj.click($.proxy(this.clickTrackingHandler,this));this.wikiaBarCollapseWrapperObj.click($.proxy(this.clickTrackingHandler,this));},init:function(){this.$window=$(window);this.wikiaBarWrapperObj=$('#WikiaBarWrapper');this.wikiaBarCollapseWrapperObj=$('.WikiaBarCollapseWrapper');this.bindTracking();var wikiaBarWrapperArrow=this.wikiaBarWrapperObj.find('.arrow');wikiaBarWrapperArrow.click($.proxy(this.onShownClick,this));this.wikiaBarCollapseWrapperObj.find('.wikia-bar-collapse').click($.proxy(this.onHiddenClick,this));if(!this.isUserAnon()){this.
handleLoggedInUsersWikiaBar();}else if(this.isUserAnon()&&this.hasAnonHiddenWikiaBar()===false){this.handleLoggedOutUsersWikiaBar();}wikiaBarWrapperArrow.popover({placement:"wikiaBar",content:wikiaBarWrapperArrow.data('tooltip')});$('.wikia-bar-collapse').popover({placement:"wikiaBar",content:wikiaBarWrapperArrow.data('tooltipshow')});this.$window.triggerHandler('WikiaBarReady');return true;},getAdIfNeeded:function(){var isEnabled=window.ads&&window.ads.context&&window.ads.context.opts&&window.ads.context.opts.showAds&&window.wgEnableWikiaBarAds;if(isEnabled){window.Wikia.reviveQueue=window.Wikia.reviveQueue||[];window.Wikia.reviveQueue.push({zoneId:28,slotName:'WIKIA_BAR_BOXAD_1'});}},cutMessageIntoSmallPieces:function(messageArray,container,cutMessagePrecision){var returnArray=[],currentMessageArray,originalMessageArray,originalCurrentDiffArray,messageArrayText,messageLoops=0;for(var i=0,length=messageArray.length;i<length;i++){messageArrayText=messageArray[i].text;if(typeof
messageArrayText=='string'){originalMessageArray=messageArrayText.split('');do{currentMessageArray=this.checkMessageWidth(originalMessageArray,container,cutMessagePrecision);originalCurrentDiffArray=originalMessageArray.slice(currentMessageArray.length,originalMessageArray.length);returnArray.push({'anchor':$.trim(currentMessageArray.join('')),'href':messageArray[i].href,'messageNumber':i});originalMessageArray=originalCurrentDiffArray;messageLoops++;}while(originalCurrentDiffArray.length>0&&messageLoops<this.WIKIA_BAR_MAX_MESSAGE_PARTS);}}container.text('');return returnArray;},checkMessageWidth:function(messageArray,container,cutMessagePrecision){var tempMessage='',tempMessageObject,tempMessageArray,cutIndex=-1;for(var j=0,length=messageArray.length;j<length;j+=cutMessagePrecision){tempMessage=tempMessage+messageArray.join("").substr(j,cutMessagePrecision);tempMessageObject=$('<span></span>').text(tempMessage);container.html(tempMessageObject);if(tempMessageObject.width()>=this.
messageConfig.container.width()){cutIndex=j-cutMessagePrecision;break;}}if(cutIndex==-1){tempMessageArray=messageArray;}else{tempMessageArray=messageArray.slice(0,cutIndex);var lastIndexOfSpace=tempMessageArray.lastIndexOf(" ");if((lastIndexOfSpace>-1)&&(lastIndexOfSpace<cutIndex)){tempMessageArray=messageArray.slice(0,lastIndexOfSpace);}}return tempMessageArray;},messageFadeIn:function(){var currentMsgIndex=this.messageConfig.index,messageConfig=this.messageConfig;if(currentMsgIndex==(messageConfig.content.length-1)){this.messageConfig.index=0;}else{this.messageConfig.index++;}setTimeout($.proxy(this.messageSlideShow,this),messageConfig.delay);return true;},messageSlideShow:function(){var messageData=this.messageConfig.content[this.messageConfig.index],messageContainer=this.messageConfig.container,link=$('<a></a>').attr('href',messageData.href).data('index',messageData.messageNumber).text(messageData.anchor);messageContainer.fadeOut(this.messageConfig.speed,$.proxy(function(){
messageContainer.html(link);if(this.messageConfig.prevMsgNumber!=messageData.messageNumber){this.messageConfig.prevMsgNumber=messageData.messageNumber;this.messageConfig.doTrackImpression=!0;}else{this.messageConfig.doTrackImpression=!1;}messageContainer.fadeIn(this.messageConfig.speed,$.proxy(this.messageFadeIn,this));},this));return true;},startSlideShow:function(){this.messageConfig.content=this.cutMessageIntoSmallPieces(this.messageConfig.container.data(this.messageConfig.attributeName),this.messageConfig.container,this.cutMessagePrecision);if(typeof this.messageConfig.content=='object'){this.messageConfig.container.popover({placement:"wikiaBarMessage",content:this.messageConfig.container.data('messagetooltip')});this.messageSlideShow();}},show:function(){$('#WikiaNotifications').removeClass('hidden');this.wikiaBarCollapseWrapperObj.addClass('hidden');this.wikiaBarWrapperObj.removeClass('hidden');this.wikiaBarHidden=!1;this.toggleVisibilityClassOnBody(true);},hide:function(
){$('#WikiaNotifications').addClass('hidden');this.wikiaBarCollapseWrapperObj.removeClass('hidden');this.wikiaBarWrapperObj.addClass('hidden');this.wikiaBarHidden=!0;this.toggleVisibilityClassOnBody(false);},isWikiaBarHidden:function(){return this.wikiaBarHidden;},showContainer:function(){$('#WikiaBar').show();this.toggleVisibilityClassOnBody(true);},hideContainer:function(){$('#WikiaBar').hide();this.toggleVisibilityClassOnBody(false);},toggleVisibilityClassOnBody:function(state){if(this.wikiaBarWrapperObj.length){$('body').toggleClass('wikia-bar-visible',state);}},isContainerHidden:function(){return $('#WikiaBar').is(":visible");},onShownClick:function(e){this.changeBarStateData();e.preventDefault();},onHiddenClick:function(e){this.changeBarStateData();e.preventDefault();},changeBarStateData:function(){if(this.isUserAnon()){this.changeAnonBarStateData();}else{this.changeLoggedInUserStateBar();}this.$window.triggerHandler('WikiaBarStateChanged');},changeAnonBarStateData:function(){
var isHidden=this.hasAnonHiddenWikiaBar();if(isHidden===false){this.setCookieData(true);this.hide();}else{this.setCookieData(false);this.getAdIfNeeded();this.show();}},hasAnonHiddenWikiaBar:function(){return this.getAnonData();},handleLoggedOutUsersWikiaBar:function(){this.show();this.messageConfig.container=this.wikiaBarWrapperObj.find('.message');var dataContent=this.messageConfig.container.data(this.messageConfig.attributeName);if(this.messageConfig.container.exists()&&dataContent&&(typeof dataContent=='object')&&(dataContent.length>0)){this.startSlideShow();}this.getAdIfNeeded();},handleLoggedInUsersWikiaBar:function(){var cachedState=this.getLocalStorageData();if(cachedState===null){this.getLoggedInUserStateBarAndChangeLocalStorage();}else{this.doWikiaBarAnimationDependingOnState(cachedState);}},getLoggedInUserStateBarAndChangeLocalStorage:function(){$.nirvana.sendRequest({controller:'WikiaUserPropertiesController',method:'performPropertyOperation',data:{handlerName:
'WikiaBarUserPropertiesHandler',methodName:'getWikiaBarState'},type:'get',format:'json',callback:$.proxy(this.onGetLoggedInUserStateBarAndChangeLocalStorage,this),onErrorCallback:$.proxy(this.onGetLoggedInUserStateBarAndChangeLocalStorageError,this)});},changeLoggedInUserStateBar:function(){var changeState=this.isWikiaBarHidden()?this.WIKIA_BAR_SHOWN_STATE_VALUE:this.WIKIA_BAR_HIDDEN_STATE_VALUE;this.doWikiaBarAnimationDependingOnState(changeState);this.setLocalStorageData(changeState);$.nirvana.sendRequest({controller:'WikiaUserPropertiesController',method:'performPropertyOperation',data:{handlerName:'WikiaBarUserPropertiesHandler',methodName:'changeWikiaBarState',callParams:{changeTo:changeState}},type:'post',format:'json'});},onGetLoggedInUserStateBarAndChangeLocalStorage:function(response){var state=response.results.propertyValue||this.WIKIA_BAR_SHOWN_STATE_VALUE;this.setLocalStorageData(state);this.doWikiaBarAnimationDependingOnState(state);},
onGetLoggedInUserStateBarAndChangeLocalStorageError:function(){},doWikiaBarAnimationDependingOnState:function(state){if(state===this.WIKIA_BAR_SHOWN_STATE_VALUE){this.show();}else{this.hide();}if(window.wgAction=='edit'&&!window.wgEnableCodePageEditor){var WE=window.WikiaEditor=window.WikiaEditor||(new Observable()),editorInstance=WE.getInstance();if(typeof(editorInstance)!=='undefined'){editorInstance.fire('sizeChanged');}}},getLocalStorageDataKey:function(){var key=undefined;if(window.wgUserName){key=window.wgUserName+'_'+this.WIKIA_BAR_STATE_USER_KEY_SUFFIX;}else{$().log('WikiaBar notice: No user name found');}return key;},getLocalStorageData:function(){return $.storage.get(this.getLocalStorageDataKey());},setLocalStorageData:function(state){$.storage.set(this.getLocalStorageDataKey(),state);},getAnonData:function(defaultState){var key=this.getCookieKey(),data=$.cookie(key),hidden=null;if(data===null&&!this.isMainWikiaBarLang()){hidden=(typeof defaultState!=='undefined')?
defaultState:!0;}else if(data===null&&this.isMainWikiaBarLang()){hidden=(typeof defaultState!=='undefined')?defaultState:!1;}else{hidden=(data==='true');}return hidden;},setCookieData:function(hiddenState){var key=this.getCookieKey(),now=new Date(),expireDate=new Date(now.getTime()+this.WIKIA_BAR_HIDDEN_ANON_ML_TTL),cookieData={expires:expireDate,path:'/',domain:window.wgCookieDomain};if(this.isUserAnon()&&!this.isMainWikiaBarLang()){cookieData.expires=this.WIKIA_BAR_HIDDEN_ANON_NML_TTL;}else if(!this.isUserAnon){cookieData.expires=this.WIKIA_BAR_HIDDEN_USER_TTL;}$.cookie(key,hiddenState,cookieData);},getCookieKey:function(){var key=this.WIKIA_BAR_STATE_ANON_ML_KEY;if(this.isUserAnon()&&!this.isMainWikiaBarLang()){key=this.WIKIA_BAR_STATE_ANON_NML_KEY;}return key;},isUserAnon:function(){return(window.wgUserName===null);},isMainWikiaBarLang:function(){var result=-1;if(window.wgContentLanguage&&window.wgWikiaBarMainLanguages){result=$.inArray(window.wgContentLanguage,window.
wgWikiaBarMainLanguages);}return(result>=0);},getWikiaBarOffset:function(){var wikiaBarHeight=$("#WikiaBarWrapper").outerHeight(true)||0;return(this.wikiaBarHidden)?0:wikiaBarHeight;},trackClick:function(category,action,label,value,params,event){if(this.isSampledEvent()){Wikia.Tracker.track({action:action,category:category,label:label,trackingMethod:'analytics',value:value},params);}},clickTrackingHandler:function(e){var node=$(e.target),parent=node.parent(),startTime=new Date();if(node.hasClass('arrow')){this.trackClick('wikia-bar',Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,'arrow-hide',null,{},e);}else if(node.hasClass('wikia-bar-collapse')){this.trackClick('wikia-bar',Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,'arrow-show',null,{},e);}else if(parent.hasClass('wikiabar-button')){var buttonIdx=parent.data('index');this.trackClick('wikia-bar',Wikia.Tracker.ACTIONS.CLICK_LINK_BUTTON,'wikiabar-button-'+buttonIdx,null,{},e);}else if(parent.hasClass('message')){var messageIdx=node.data('index');
this.trackClick('wikia-bar',Wikia.Tracker.ACTIONS.CLICK_LINK_TEXT,'message-'+messageIdx+'-clicked',null,{},e);}$().log('tracking took '+(new Date()-startTime)+' ms');}};if(window.wgEnableWikiaBarExt){$(function(){WikiaBar.init();});};var ChatWidget={loading:!1,chatLaunchModal:null,bindComplete:!1,isWideChat:null,widgetUserElementTemplate:'',wideChatThreshold:280,resizeDebounceTime:1000,init:function(){if(!ChatWidget.bindComplete){$('body').on('click','.WikiaChatLink, .chat-module .start-a-chat-button, .chat-module .more-users-count',this.openChat);ChatWidget.bindComplete=!0;}if($('.chat-module').not('.rail-module').length){if(!ChatWidget.loading){ChatWidget.loading=!0;ChatWidget.loadDataAndInitializeModules();}}ChatWidget.initializeChatModules();},openChat:function(event){event.preventDefault();event.stopPropagation();ChatWidget.onClickChatButton(this.href);},loadDataAndInitializeModules:function(){$.when(ChatWidget.loadChatUsers(),ChatWidget.loadWidgetUserElementTemplate()).
then(function(usersData,templateData){if(usersData[1]==='success'&&templateData[1]==='success'){var users=usersData[0].users,hasUsers=usersData[0].hasUsers;ChatWidget.widgetUserElementTemplate=templateData[0].mustache[0];if(users.length){ChatWidget.updateUsersList(users,hasUsers);}ChatWidget.users=users;}});},loadChatUsers:function(){return $.nirvana.sendRequest({controller:'ChatRailController',method:'GetUsers',type:'GET',format:'json'});},loadWidgetUserElementTemplate:function(){return Wikia.getMultiTypePackage({mustache:'extensions/wikia/Chat2/templates/widgetUserElement.mustache'});},updateUsersList:function(users,hasUsers){var output=Mustache.render(ChatWidget.widgetUserElementTemplate,{viewedUsersInfo:users,hasUsers:hasUsers,blankImageUrl:window.wgBlankImageUrl}),$chatModule=$('.chat-module');if(hasUsers){$chatModule.find('.chat-contents.chat-room-empty').each(function(){$(this).eq(0).removeClass('chat-room-empty').addClass('chat-room-active');});}$chatModule.find(
'.wds-avatar-stack').each(function(){$(this).get(0).innerHTML=output;});},initializeChatModules:function(){$('.ChatModuleUninitialized').each(function(){var $module=$(this);ChatWidget.isWideChat=ChatWidget.computeIsWideChat($module.width());ChatWidget.processModuleTemplate($module);$module.removeClass('ChatModuleUninitialized');$(window).resize($.debounce(ChatWidget.resizeDebounceTime,function(){ChatWidget.afterResize($module);}));});},afterResize:function($module){var wideAfterResize=ChatWidget.computeIsWideChat($module.width());if(wideAfterResize!==ChatWidget.isWideChat){ChatWidget.isWideChat=wideAfterResize;ChatWidget.processModuleTemplate($module);}},computeIsWideChat:function(width){return width>ChatWidget.wideChatThreshold;},processModuleTemplate:function($t){ChatWidget.initPopover($t);$t.find('[data-msg-id]').each(function(){var $e=$(this);$e.text(mw.message($e.data('msg-id'),$e.data('msg-param')).text());});},initPopover:function($el){var popoverTimeout=0;function
setPopoverTimeout(elem){popoverTimeout=setTimeout(function(){elem.popover('hide');},300);}$el.find('.chatter').popover({trigger:'manual',placement:'bottom',content:function(){var userStatsMenu=$el.find('.UserStatsMenu').eq($(this).index());return userStatsMenu.clone().wrap('<div>').parent().html();}}).on('mouseenter',function(){clearTimeout(popoverTimeout);$('body > .popover').remove();$el.find('.UserStatsMenu img[data-src]').each(function(){var image=$(this);image.attr('src',image.attr('data-src')).removeAttr('data-src');});$(this).popover('show');}).on('mouseleave',function(){var $this=$(this);setPopoverTimeout($this);$('.popover').mouseenter(function(){clearTimeout(popoverTimeout);}).mouseleave(function(){setPopoverTimeout($this);});});},onClickChatButton:function(linkToSpecialChat){'use strict';if(window.wgUserName){window.open(linkToSpecialChat,'wikiachat',window.wgWikiaChatWindowFeatures);}else{window.wikiaAuthModal.load({forceLogin:!0,origin:'chat',onAuthSuccess:ChatWidget.
onSuccessfulLogin});}},onSuccessfulLogin:function(){$.nirvana.sendRequest({controller:'ChatRail',method:'AnonLoginSuccess',type:'GET',format:'html',callback:ChatWidget.onJoinChatFormLoaded});},onJoinChatFormLoaded:function(html){require(['wikia.ui.factory'],function(uiFactory){uiFactory.init('modal').then(function(uiModal){var joinModalConfig={vars:{id:'JoinChatModal',size:'small',content:html,title:mw.message('chat-start-a-chat').escaped()}};uiModal.createComponent(joinModalConfig,function(joinModal){joinModal.bind('chat',function(event){ChatWidget.launchChatWindow(event,joinModal);});joinModal.bind('close',function(){ChatWidget.reloadPage();});joinModal.show();});});});},reloadPage:function(){Wikia.Querystring().addCb().goTo();},launchChatWindow:function(event,chatLaunchModal){var pageLink=$('#modal-join-chat-button').data('chat-page');window.open(pageLink,'wikiachat',window.wgWikiaChatWindowFeatures);if(chatLaunchModal){chatLaunchModal.trigger('close');}ChatWidget.reloadPage();}};if
(typeof wgWikiaChatUsers!=='undefined'){$(function(){ChatWidget.init();});};(function(window,$){'use strict';if(window.vetLoader){return;}var resourcesLoaded=!1,modalOnScreen=!1,vetLoader={},template='';function loadResources(){var deferredList=[];deferredList.push($.nirvana.sendRequest({controller:'VideoEmbedToolController',method:'modal',type:'get',format:'html'}));deferredList.push($.getResources([$.getAssetManagerGroupUrl('VET_js'),$.getSassCommonURL('/extensions/wikia/VideoEmbedTool/css/VET.scss'),$.getSassCommonURL('/extensions/wikia/WikiaStyleGuide/css/Dropdown.scss')]));deferredList.push($.getMessages('VideoEmbedTool'));return deferredList;}vetLoader.load=function(options,$elem){var resourceList=[];$elem=$elem||$();if(window.wgUserName===null&&!window.UserLogin.forceLoggedIn&&window.wgAction==='edit'){window.UserLogin.rteForceLogin();$elem.stopThrobbing();return;}else if(window.wgUserName===null&&!window.UserLogin.forceLoggedIn){window.wikiaAuthModal.load({forceLogin:!0
,origin:'vet',onAuthSuccess:function(){window.UserLogin.forceLoggedIn=!0;vetLoader.load(options);}});$elem.stopThrobbing();return;}if(modalOnScreen){$elem.stopThrobbing();return;}modalOnScreen=!0;if(!resourcesLoaded){resourceList=loadResources();}$.when.apply($,resourceList).done(function(templateResp){if(!resourcesLoaded){template=templateResp[0];}$elem.stopThrobbing();require(['wikia.vet'],function(vet){vetLoader.modal=$(template).makeModal({width:939,onClose:function(){vet.close();},onAfterClose:function(){modalOnScreen=!1;}});vet.show(options);resourcesLoaded=!0;});});};$.fn.addVideoButton=function(options){$.preloadThrobber();return this.each(function(){var $this=$(this);$this.off('click.VETLoader').on('click.VETLoader',function(e){e.preventDefault();$this.startThrobbing();vetLoader.load(options,$this);});});};window.vetLoader=vetLoader;})(window,jQuery);;define('thumbnails.templates.mustache',[],function(){'use strict';return{"Thumbnail_articleBlock":
'<figure class="article-thumb {{figureClass}}" style="width: {{width}}px">{{{thumbnail}}}<figcaption><a href="{{url}}" class="sprite details" title="{{thumbnailMore}}"></a>{{#title}}<p class="title">{{title}}</p>{{/title}}{{#caption}}<p class="caption">{{{caption}}}</p>{{/caption}}{{#addedBy}}<p class="attribution">{{{addedBy}}}</p>{{/addedBy}}</figcaption></figure>',"Thumbnail_title":'{{{thumbnail}}}<div class="title" title="{{title}}"><a href="{{url}}">{{title}}</a></div>',"done":"true"};});;window.JSSnippets=(function(){'use strict';var stack,fullUrlRegex=new RegExp('^(http|https):\\/\\/','i'),extensionRegex=new RegExp('\\.([^.]+)$'),cacheBusterRegex=new RegExp('\\?cb=[0-9]+$','i'),slashRegex=new RegExp('^\\/'),debugMode=window.mw&&mw.config?mw.config.get('debug'):window.debug;function init(){if(!window.JSSnippetsStack||!JSSnippetsStack.length){window.JSSnippetsStack=[];afterInit();return;}stack=JSSnippetsStack;var dependencies=[],callbacks={},options={},entry,x,len=stack.length;for
(x=0;x<len;x++){entry=stack[x];if(entry.dependencies){pushDependencies(dependencies,entry);}if(typeof entry.getLoaders==='function'){pushLoaders(dependencies,entry);}if(dependencies.length===0){continue;}if(typeof entry.callback==='function'){callbacks[entry.id]=entry.callback;options[entry.id]=options[entry.id]||[];options[entry.id].push(entry.options);}}if(dependencies.length===0){afterInit();return;}dependencies=unique(dependencies);require(['wikia.loader','wikia.log'],function(loader,log){loader.apply(loader,dependencies).done(function(){try{for(var id in callbacks){for(x=0,len=options[id].length;x<len;x++){callbacks[id](options[id][x]);}}}catch(e){log('Skipping running callback, cause: '+e,log.levels.error);}});});afterInit();}function afterInit(){clearStack();updatePush();}function unique(origArr){var newArr=[],origLen=origArr.length,found,x,y,l,elm;for(x=0;x<origLen;x++){found=undefined;elm=origArr[x].url||origArr[x];for(y=0,l=newArr.length;y<l;y++){if(elm===(newArr[y].url?
newArr[y].url:newArr[y])){found=!0;break;}}if(!found){newArr.push(origArr[x]);}}return newArr;}function clearStack(){window.JSSnippetsStack.length=0;}function updatePush(){window.JSSnippetsStack.push=function(callback){Array.prototype.push.apply(JSSnippetsStack,[callback]);init();};}function formatDependency(dependency){var ext;if(fullUrlRegex.test(dependency)||cacheBusterRegex.test(dependency)){return dependency;}ext=dependency.match(extensionRegex);if(ext&&ext.length>0){if(ext[1]==='scss'){dependency=$.getSassCommonURL(dependency);}else if(slashRegex.test(dependency)){if(debugMode){dependency=wgResourceBasePath+dependency;}else{dependency=wgCdnRootUrl+wgAssetsManagerQuery.replace('%1$s','one').replace('%2$s',dependency.replace(slashRegex,'')).replace('%3$s','-').replace('%4$d',wgStyleVersion);}}}return dependency;}function pushDependencies(dependencies,entry){var dependency,y,len=entry.dependencies.length;for(y=0;y<len;y++){dependency=entry.dependencies[y];if(typeof dependency===
'string'&&dependency!==''){dependency=formatDependency(dependency);}dependencies.push(dependency);}}function pushLoaders(dependencies,entry){var loaders=entry.getLoaders(),loaderFn,y,len=loaders.length;for(y=0;y<len;y++){loaderFn=loaders[y];if(typeof loaderFn==='function'){dependencies.push(loaderFn);}}}$(init);return{init:init,clear:clearStack};})();;(function(context){'use strict';function nirvana($){var allowedFormats=['json','html','jsonp'];function getUrl(options){var dataParams=options.data||{},format=(options.format||'json').toLowerCase(),i,key,sortedDict={},sortedKeys=[],urlParams,url=options.scriptPath||context.wgScriptPath;if((typeof options.controller==='undefined')||(typeof options.method==='undefined')){throw'controller and method are required';}urlParams={controller:options.controller.replace(/Controller$/,''),method:options.method};if(typeof dataParams==='string'){dataParams+='&format='+format;}else{dataParams.format=format;}if(typeof dataParams!=='string'){for(key in
dataParams){sortedKeys[sortedKeys.length]=key;}sortedKeys.sort();for(i=0;i<sortedKeys.length;i++){sortedDict[sortedKeys[i]]=dataParams[sortedKeys[i]];}dataParams=$.param(sortedDict);}return url+'/wikia.php?'+$.param(urlParams)+'&'+dataParams;}function sendRequest(attr){var type=(attr.type||'POST').toUpperCase(),format=(attr.format||'json').toLowerCase(),data={},callback=attr.callback||function(){},onErrorCallback=attr.onErrorCallback||function(){},url;if(allowedFormats.indexOf(format)===-1){throw'Only Json,Jsonp and Html format are allowed';}if(type==='POST'&&typeof attr.data!=='undefined'){data=attr.data;delete attr.data;}url=getUrl(attr);var settings={url:url,dataType:format,type:type,data:data,success:callback,error:onErrorCallback};if(typeof attr.contentType!='undefined'){settings.contentType=attr.contentType;}if(typeof attr.processData!='undefined'){settings.processData=attr.processData;}return $.ajax(settings);}return{sendRequest:sendRequest,getUrl:getUrl,getJson:function(
controller,method,data,callback,onErrorCallback){if(typeof data==='function'){onErrorCallback=callback;callback=data;data={};}return sendRequest({controller:controller,method:method,data:data,type:'GET',callback:callback,onErrorCallback:onErrorCallback});},postJson:function(controller,method,data,callback,onErrorCallback){if(typeof data==='function'){onErrorCallback=callback;callback=data;data={};}return sendRequest({controller:controller,method:method,data:data,callback:callback,onErrorCallback:onErrorCallback});}};}if(context.define&&context.define.amd){context.define('wikia.nirvana',['jquery'],nirvana);}if(context.jQuery){context.jQuery.nirvana=nirvana(context.jQuery);}}(this));;define('wikia.ui.factory',['wikia.nirvana','wikia.window','wikia.loader','wikia.ui.component','jquery'],function uifactory(nirvana,window,loader,UIComponent,$){'use strict';function getComponentsConfig(components){var deferred=new $.Deferred(),data={components:components,cb:window.wgStyleVersion};nirvana.
getJson('Wikia\\UI\\UIFactoryApi','getComponentsConfig',data,function(data){deferred.resolve(data);},function(xhrObject){deferred.reject(JSON.parse(xhrObject.responseText));});return deferred.promise();}function getComponentInstance(){return new UIComponent();}function arrayUnique(array){var o={},uniqueArray=[],i;for(i=0;i<array.length;i++){if(o.hasOwnProperty(array[i])){continue;}uniqueArray.push(array[i]);o[array[i]]=1;}return uniqueArray;}function init(componentName){var deferred=new $.Deferred(),components=[],dependencyObjects={};if(!(componentName instanceof Array)){componentName=[componentName];}getComponentsConfig(componentName).done(function(data){var jsAssets=[],cssAssets=[],createComponent=function(element){var component=getComponentInstance(),templateVarsConfig=element.templateVarsConfig,assets=element.assets,templates=element.templates,dependencies=element.dependencies,dependencyList={};if(typeof dependencies==='object'){dependencies.forEach(function(name){if(typeof
dependencyObjects[name]!=='undefined'){dependencyList[name]=dependencyObjects[name];}else{deferred.reject();throw new Error('Sub component '+name+' not found');}});}if(assets){jsAssets=jsAssets.concat(assets.js);cssAssets=cssAssets.concat(assets.css);}if(templateVarsConfig&&templates){component.setComponentsConfig({name:element.name,jsWrapperModule:element.jsWrapperModule,templates:templates,templateVarsConfig:templateVarsConfig,dependencies:dependencyList});}return component;};if(data.dependencies){Object.keys(data.dependencies).forEach(function(name){dependencyObjects[name]=createComponent(data.dependencies[name]);});}data.components.forEach(function(element){components.push(createComponent(element));});jsAssets=arrayUnique(jsAssets);cssAssets=arrayUnique(cssAssets);loader({type:loader.CSS,resources:cssAssets});function resolveDeferred(){deferred.resolve.apply(null,components);}if(jsAssets.length>0){loader({type:loader.JS,resources:jsAssets}).done(resolveDeferred);}else{
resolveDeferred();}}).fail(function(data){if(data.error){throw new Error(data.error+': '+data.message);}deferred.reject();});return deferred.promise();}return{init:init};});;define('wikia.ui.component',['wikia.mustache'],function uicomponent(mustache){'use strict';function validateComponent(componentConfig,componentType,componentVars){var supportedTypes=componentConfig.templates,variables,requiredVars,missingVars=[];if(!supportedTypes.hasOwnProperty(componentType)){throw new Error('Requested component type is not supported!');}requiredVars=componentConfig.templateVarsConfig[componentType].required;missingVars=[];requiredVars.forEach(function(element){if(!componentVars.hasOwnProperty(element)){missingVars.push(element);}});if(missingVars.length>0){variables=missingVars.join(', ');throw new Error('Missing required mustache variables: '+variables+'!');}}function UIComponent(){if(!(this instanceof UIComponent)){return new UIComponent();}var componentConfig={},componentType,componentVars;
this.render=function(params){componentType=params.type;componentVars=params.vars;validateComponent(componentConfig,componentType,componentVars);return mustache.render(componentConfig.templates[componentType],componentVars);};this.setComponentsConfig=function(config){componentConfig=config;};this.createComponent=function(params,callback){var that=this;if(componentConfig.jsWrapperModule){require([componentConfig.jsWrapperModule],function(object){callback(object.createComponent(params,that));});}else{callback(that,params);}};this.getSubComponent=function(componentName){if(typeof componentConfig.dependencies[componentName]!=='undefined'){return componentConfig.dependencies[componentName];}throw new Error('Dependency '+componentName+' not found.');};}return UIComponent;});;

define('usersignup.marketingOptIn',['wikia.geo'],function(geo){'use strict';function init(wikiaForm){var $optInField=wikiaForm.inputs.wpMarketingOptIn,$optInGroup=wikiaForm.getInputGroup('wpMarketingOptIn'),isEurope=geo.getContinentCode()==='EU',isCanada=geo.getCountryCode()==='CA',isJapan=geo.getCountryCode()==='JP';if(!$optInField.length||!$optInGroup.length){throw'Wikia Form must contain a field called wpMarketingOptIn';}if(!isCanada&&!isJapan){$optInField.attr('checked',true);}if(isEurope||isCanada||isJapan){$optInGroup.add($optInField).removeClass('hidden');}}return{init:init};});;(function(){'use strict';var UserBaseAjaxForm=function(el,options){if(!(el instanceof HTMLElement||el instanceof jQuery||typeof el==='string')){throw new Error('This module requires an element or selector as its first argument');}this.el=$(el);this.options=options||{};this.init();};UserBaseAjaxForm.prototype.init=function(){this.wikiaForm=new WikiaForm(this.el.find('form'));this.inputs=this.wikiaForm.
inputs;this.cacheDOM();this.bindEvents();if(!this.options.skipFocus){this.inputs.username.focus();}};UserBaseAjaxForm.prototype.cacheDOM=function(){this.form=this.wikiaForm.form;this.forgotPasswordLink=this.form.find('.forgot-password');this.submitButton=this.el.find('input[type=submit]');};UserBaseAjaxForm.prototype.bindEvents=function(){this.form.on('submit',this.submitLogin.bind(this));};UserBaseAjaxForm.prototype.submitLogin=function(e){$(window).trigger('UserLoginSubmit');this.submitButton.attr('disabled','disabled');if(this.options.ajaxLogin){e.preventDefault();this.ajaxLogin();}};UserBaseAjaxForm.prototype.ajaxLogin=function(){$.nirvana.postJson('UserLoginSpecial','login',{loginToken:this.loginToken,username:this.inputs.username.val(),password:this.inputs.password.val(),keeploggedin:this.inputs.keeploggedin.is(':checked')},this.submitLoginHandler.bind(this));};UserBaseAjaxForm.prototype.submitLoginHandler=function(json){this.resetValidation();if(json.result==='ok'){this.
onOkayResponse(json);}else if(json.result==='error'){this.onErrorResponse(json);}else if(json.result==='unconfirm'){this.onUnconfirmedEmailResponse();}};UserBaseAjaxForm.prototype.resetValidation=function(){this.form.find('.error-msg').remove();this.form.find('.input-group').removeClass('error');};UserBaseAjaxForm.prototype.onOkayResponse=function(json){var callback=this.options.callback||'';window.wgUserName=json.wgUserName;if(callback&&typeof callback==='function'){callback.bind(this,json)();}else{this.reloadPage();}};UserBaseAjaxForm.prototype.onErrorResponse=function(json){this.submitButton.removeAttr('disabled');this.errorValidation(json);};UserBaseAjaxForm.prototype.onUnconfirmedEmailResponse=function(){$.get(window.wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'getUnconfirmedUserRedirectUrl',format:'json',username:this.inputs.username.val()},function(json){window.location=json.redirectUrl;});};UserBaseAjaxForm.prototype.errorValidation=function(json){if(json.
errParam){this.wikiaForm.showInputError(json.errParam,json.msg);}else{this.wikiaForm.showGenericError(json.msg);}};UserBaseAjaxForm.prototype.reloadPage=function(){require(['wikia.querystring'],function(QuerySring){var qs=new QuerySring();qs.addCb().goTo();});};window.UserBaseAjaxForm=UserBaseAjaxForm;})();;(function(){'use strict';var UserSignupMixin=function(){this.initOptIn=function(wikiaForm){require(['usersignup.marketingOptIn'],function(optIn){optIn.init(wikiaForm);});};this.setCountryValue=function(wikiaForm){var country=Wikia.geo.getCountryCode();wikiaForm.inputs.wpRegistrationCountry.val(country);};};window.UserSignupMixin=UserSignupMixin;})();;(function(){'use strict';var UserSignupAjaxValidation=function(options){this.wikiaForm=options.wikiaForm;this.submitButton=$(options.submitButton);this.deferred=!1;this.passwordInputName=options.passwordInputName||'password';};UserSignupAjaxValidation.prototype.validateInput=function(e){var $el=$(e.target),data={},inputName=$el.attr(
'name'),value=$el.val(),usernameAlias='userloginext01';if(inputName===this.passwordInputName){this.validatePassword(value);}else{if(inputName==='username'){data.field=usernameAlias;data[usernameAlias]=value;}else{data.field=inputName;data[inputName]=value;}this.sendValidationRequest(data).done(this.validationHandler.bind(this,inputName));}};UserSignupAjaxValidation.prototype.validatePassword=function(password){var pwLength=password.length,msg='',inputName=this.passwordInputName,response={};if(pwLength<wgMinimalPasswordLength){msg=mw.message('userlogin-error-wrongpasswordempty').escaped();}else if(pwLength>wgWikiaMaxNameChars){msg=mw.message('usersignup-error-password-length').escaped();}if(msg!==''){response.msg=msg;response.result='error';}else{response.result='ok';}this.validationHandler(inputName,response);};UserSignupAjaxValidation.prototype.validateBirthdate=function(e){var $el,inputName,data;if(this.deferred&&typeof this.deferred.reject==='function'){this.deferred.reject();}$el=$
(e.target);inputName=$el.attr('name');data={field:'birthdate',birthyear:this.wikiaForm.inputs.birthyear.val(),birthmonth:this.wikiaForm.inputs.birthmonth.val(),birthday:this.wikiaForm.inputs.birthday.val()};this.deferred=this.sendValidationRequest(data).done(this.validationHandler.bind(this,inputName));};UserSignupAjaxValidation.prototype.validationHandler=function(inputName,response){if(response.result==='ok'){this.wikiaForm.clearInputError(inputName);}else{this.wikiaForm.showInputError(inputName,response.msg);}};UserSignupAjaxValidation.prototype.sendValidationRequest=function(data){return $.nirvana.sendRequest({controller:'UserSignupSpecial',method:'formValidation',type:'GET',data:data});};window.UserSignupAjaxValidation=UserSignupAjaxValidation;})();;(function(){'use strict';var UserLoginAjaxForm=function(el,options){UserBaseAjaxForm.call(this,el,options);};UserLoginAjaxForm.prototype=Object.create(UserBaseAjaxForm.prototype);UserLoginAjaxForm.prototype.init=function(){
UserBaseAjaxForm.prototype.init.call(this);this.retrieveLoginToken();};UserLoginAjaxForm.prototype.submitLoginHandler=function(json){var result=json.result;UserBaseAjaxForm.prototype.submitLoginHandler.call(this,json);if(result==='resetpass'){this.onResetPasswordResponse(json);}else if(result==='closurerequested'){this.onAccountClosureRequestResponse();}else{this.onErrorResponse();}};UserLoginAjaxForm.prototype.onResetPasswordResponse=function(){$.nirvana.sendRequest({controller:'UserLoginSpecial',method:'changePassword',format:'html',data:{username:this.inputs.username.val(),password:this.inputs.password.val(),loginToken:this.inputs.loginToken.val(),returnto:this.inputs.returnto.val(),fakeGet:1},callback:this.setupChangePasswordForm.bind(this)});};UserLoginAjaxForm.prototype.setupChangePasswordForm=function(html){var content,form,heading,modal,contentBlock,duration;content=$('<div>').hide().append(html);duration=400;if(this.options.modal){heading=content.find('h1');modal=this.options.
modal;contentBlock=modal.$element.find('.UserLoginModal');modal.setTitle(heading.text());heading.remove();contentBlock.slideUp(duration,function(){contentBlock.html('').html(content);content.show();contentBlock.slideDown(duration);});}else{form=this.form;form.slideUp(duration,(function(){var newForm=content.find('form');form.replaceWith(content);content.slideDown(duration);newForm.on('submit',this.submitLoginAfterResetPass.bind(this));this.wikiaForm=new WikiaForm(newForm);this.inputs=this.wikiaForm.inputs;}).bind(this));}};UserLoginAjaxForm.prototype.onAccountClosureRequestResponse=function(){$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'getCloseAccountRedirectUrl',format:'json'},function(data){window.location=data.redirectUrl;});};UserLoginAjaxForm.prototype.retrieveLoginToken=function(params){params=params||{};if(!this.loginToken||params.clearCache){this.loginToken='retrieving';$.nirvana.postJson('UserLoginSpecial','retrieveLoginToken',function(res){this.
loginToken=res.loginToken;this.inputs.loginToken.val(res.loginToken);}.bind(this));}};UserLoginAjaxForm.prototype.submitLoginAfterResetPass=function(e){this.submitButton.attr('disabled','disabled');if(this.options.ajaxLogin){e.preventDefault();this.ajaxLoginAfterResetPass();}};UserLoginAjaxForm.prototype.ajaxLoginAfterResetPass=function(){$.nirvana.postJson('UserLoginSpecial','loginForm',{loginToken:this.loginToken,username:this.inputs.username.val(),password:this.inputs.password.val(),newpassword:this.inputs.newpassword.val(),retype:this.inputs.retype.val(),action:this.inputs.action.val(),editToken:this.inputs.editToken.val()},this.submitLoginHandler.bind(this));};window.UserLoginAjaxForm=UserLoginAjaxForm;})();;(function(){'use strict';var UserLoginModal={loginAjaxForm:!1,isInitializationStarted:!1,uiFactory:!1,packagesData:!1,$modal:!1,bucky:window.Bucky('UserLoginModal'),initModal:function(options){var self=this;this.bucky.timer.start('initModal');require([
'wikia.tracker'],function(tracker){self.trackerActions=tracker.ACTIONS;self.track=tracker.buildTrackingFunction({category:'force-login-modal',trackingMethod:'analytics'});});$.when(Wikia.getMultiTypePackage({templates:[{controller:'UserLoginSpecial',method:'modal',params:{uselang:window.wgUserLanguage}}],styles:'/extensions/wikia/UserLogin/css/UserLoginModal.scss',messages:'UserLogin'})).done(function(packagesData){require(['wikia.ui.factory','wikia.loader'],function(uiFactory,loader){loader.processStyle(packagesData.styles);self.uiFactory=uiFactory;self.packagesData=packagesData;self.buildModal(options);self.bucky.timer.stop('initModal');});});},buildModal:function(options){var self=this,origin='',clickAction=this.trackerActions.CLICK;this.bucky.timer.start('buildModal');this.uiFactory.init('modal').then(function(uiModal){var modalTemplateName='UserLoginSpecial_modal',modalConfig={type:'default',vars:{id:'userForceLoginModal',size:'medium',content:self.packagesData.templates[
modalTemplateName],title:$.msg('userlogin-login-heading'),closeButton:!0}};uiModal.createComponent(modalConfig,function(loginModal){UserLoginModal.$modal=loginModal;var $loginModal=loginModal.$element;UserLoginModal.loginAjaxForm=new window.UserLoginAjaxForm($loginModal,{ajaxLogin:!0,modal:loginModal,callback:function(res){window.wgUserName=res.username;var callback=options.callback;if(callback&&typeof callback==='function'){if(!options.persistModal){UserLoginModal.$modal.trigger('close');}callback();}else{this.reloadPage();}}});if(options.modalInitCallback&&typeof options.modalInitCallback==='function'){options.modalInitCallback();}if(options.origin){origin=options.origin;}self.track({action:self.trackerActions.OPEN,label:'from-'+origin});$loginModal.on('click','.forgot-password',function(){self.track({action:clickAction,label:'forgot-password'});}).on('click','input.keep-logged-in',function(){self.track({action:clickAction,label:'keep-me-logged-in'});}).on('click',
'.get-account a',function(){self.track({action:clickAction,label:'sign-up-from-'+origin});}).on('click','input.login-button',function(){self.track({action:clickAction,label:'login-from-'+origin});});self.bucky.timer.stop('buildModal');});});},show:function(options){options=options||{};options.modalInitCallback=$.proxy(function(){this.$modal.show();},this);this.initModal(options);return true;},isPreventingForceLogin:function(element){if(!(element.closest('span').hasClass('drop'))&&!(element.closest('ul').hasClass('WikiaMenuElement'))){return false;}return true;},init:function(){var editpromptable=$('#te-editanon, .loginToEditProtectedPage, .upphotoslogin');if(window.wgDisableAnonymousEditing){editpromptable=editpromptable.add('.editsection');}editpromptable.click($.proxy(function(ev){ev.stopPropagation();if(!this.isPreventingForceLogin($(ev.target))&&window.UserLogin.isForceLogIn()){ev.preventDefault();}},this));$('body').delegate('.ajaxLogin','click',function(e){UserLoginModal.show();e
.preventDefault();});}};window.UserLoginModal=UserLoginModal;$(function(){UserLoginModal.init();});})();;var LatestActivity={wikiaRecentActivityContainer:null,init:function(){this.wikiaRecentActivityContainer=$('#wikia-recent-activity');if(this.wikiaRecentActivityContainer.exists()){this.lazyLoadContent();}},lazyLoadContent:function(){$.nirvana.sendRequest({controller:'LatestActivity',method:'Index',format:'html',type:'GET',callback:$.proxy(function(html){if($.browser.msie){this.wikiaRecentActivityContainer.empty().append($(html).children());}else{this.wikiaRecentActivityContainer.replaceWith(html);}},this)});}};$(window).load(function(){$('.WikiaRail').on('afterLoad.rail',function(){LatestActivity.init();});});;

var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(exports){exports.name="mustache.js";exports.version="0.5.0-dev";exports.tags=["{{","}}"];exports.parse=parse;exports.compile=compile;exports.render=render;exports.clearCache=clearCache;exports.to_html=function(template,view,partials,send){var result=render(template,view,partials);if(typeof send==="function"){send(result);}else{return result;}};var _toString=Object.prototype.toString;var _isArray=Array.isArray;var _forEach=Array.prototype.forEach;var _trim=String.prototype.trim;var isArray;if(_isArray){isArray=_isArray;}else{isArray=function(obj){return _toString.call(obj)==="[object Array]";};}var forEach;if(_forEach){forEach=function(obj,callback,scope){return _forEach.call(obj,callback,scope);};}else{forEach=function(obj,callback,scope){for(var i=0,len=obj.length;i<len;++i){callback.call(scope,obj[i],i,obj);}};}var spaceRe=/^\s*$/;function isWhitespace(string){return spaceRe.test(string);}var trim;if(_trim){trim
=function(string){return string==null?"":_trim.call(string);};}else{var trimLeft,trimRight;if(isWhitespace("\xA0")){trimLeft=/^\s+/;trimRight=/\s+$/;}else{trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}trim=function(string){return string==null?"":String(string).replace(trimLeft,"").replace(trimRight,"");};}var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":'&#39;'};function escapeHTML(string){return String(string).replace(/&(?!\w+;)|[<>"']/g,function(s){return escapeMap[s]||s;});}function debug(e,template,line,file){file=file||"<template>";var lines=template.split("\n"),start=Math.max(line-3,0),end=Math.min(lines.length,line+3),context=lines.slice(start,end);var c;for(var i=0,len=context.length;i<len;++i){c=i+start+1;context[i]=(c===line?" >> ":"    ")+context[i];}e.template=template;e.line=line;e.file=file;e.message=[file+":"+line,context.join("\n"),"",e.message].join("\n");return e;}function lookup(name,stack,defaultValue){if(name==="."){return stack[stack.length-1];}
var names=name.split(".");var lastIndex=names.length-1;var target=names[lastIndex];var value,context,i=stack.length,j,localStack;while(i){localStack=stack.slice(0);context=stack[--i];j=0;while(j<lastIndex){context=context[names[j++]];if(context==null){break;}localStack.push(context);}if(context&&typeof context==="object"&&target in context){value=context[target];break;}}if(typeof value==="function"){value=value.call(localStack[localStack.length-1]);}if(value==null){return defaultValue;}return value;}function renderSection(name,stack,callback,inverted){var buffer="";var value=lookup(name,stack);if(inverted){if(value==null||value===false||(isArray(value)&&value.length===0)){buffer+=callback();}}else if(isArray(value)){forEach(value,function(value){stack.push(value);buffer+=callback();stack.pop();});}else if(typeof value==="object"){stack.push(value);buffer+=callback();stack.pop();}else if(typeof value==="function"){var scope=stack[stack.length-1];var scopedRender=function(template){
return render(template,scope);};buffer+=value.call(scope,callback(),scopedRender)||"";}else if(value){buffer+=callback();}return buffer;}function parse(template,options){options=options||{};var tags=options.tags||exports.tags,openTag=tags[0],closeTag=tags[tags.length-1];var code=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var spaces=[],hasTag=!1,nonSpace=!1;var stripSpace=function(){if(hasTag&&!nonSpace&&!options.space){while(spaces.length){code.splice(spaces.pop(),1);}}else{spaces=[];}hasTag=!1;nonSpace=!1;};var sectionStack=[],updateLine,nextOpenTag,nextCloseTag;var setTags=function(source){tags=trim(source).split(/\s+/);nextOpenTag=tags[0];nextCloseTag=tags[tags.length-1];};var includePartial=function(source){code.push('";',updateLine,'\nvar partial = partials["'+trim(source)+'"];','\nif (partial) {','\n  buffer += render(partial,stack[stack.length - 1],partials);','\n}','\nbuffer += "');};var openSection=function(source,inverted){var name=trim(
source);if(name===""){throw debug(new Error("Section name may not be empty"),template,line,options.file);}sectionStack.push({name:name,inverted:inverted});code.push('";',updateLine,'\nvar name = "'+name+'";','\nvar callback = (function () {','\n  return function () {','\n    var buffer = "";','\nbuffer += "');};var openInvertedSection=function(source){openSection(source,true);};var closeSection=function(source){var name=trim(source);var openName=sectionStack.length!=0&&sectionStack[sectionStack.length-1].name;if(!openName||name!=openName){throw debug(new Error('Section named "'+name+'" was never opened'),template,line,options.file);}var section=sectionStack.pop();code.push('";','\n    return buffer;','\n  };','\n})();');if(section.inverted){code.push("\nbuffer += renderSection(name,stack,callback,true);");}else{code.push("\nbuffer += renderSection(name,stack,callback);");}code.push('\nbuffer += "');};var sendPlain=function(source){code.push('";',updateLine,'\nbuffer += lookup("'+trim(
source)+'",stack,"");','\nbuffer += "');};var sendEscaped=function(source){code.push('";',updateLine,'\nbuffer += escapeHTML(lookup("'+trim(source)+'",stack,""));','\nbuffer += "');};var line=1,c,callback;for(var i=0,len=template.length;i<len;++i){if(template.slice(i,i+openTag.length)===openTag){i+=openTag.length;c=template.substr(i,1);updateLine='\nline = '+line+';';nextOpenTag=openTag;nextCloseTag=closeTag;hasTag=!0;switch(c){case"!":i++;callback=null;break;case"=":i++;closeTag="="+closeTag;callback=setTags;break;case">":i++;callback=includePartial;break;case"#":i++;callback=openSection;break;case"^":i++;callback=openInvertedSection;break;case"/":i++;callback=closeSection;break;case"{":closeTag="}"+closeTag;case"&":i++;nonSpace=!0;callback=sendPlain;break;default:nonSpace=!0;callback=sendEscaped;}var end=template.indexOf(closeTag,i);if(end===-1){throw debug(new Error('Tag "'+openTag+'" was not closed properly'),template,line,options.file);}var source=template.substring(i,end);
if(callback){callback(source);}var n=0;while(~(n=source.indexOf("\n",n))){line++;n++;}i=end+closeTag.length-1;openTag=nextOpenTag;closeTag=nextCloseTag;}else{c=template.substr(i,1);switch(c){case'"':case"\\":nonSpace=!0;code.push("\\"+c);break;case"\r":break;case"\n":spaces.push(code.length);code.push("\\n");stripSpace();line++;break;default:if(isWhitespace(c)){spaces.push(code.length);}else{nonSpace=!0;}code.push(c);}}}if(sectionStack.length!=0){throw debug(new Error('Section "'+sectionStack[sectionStack.length-1].name+'" was not closed properly'),template,line,options.file);}stripSpace();code.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var body=code.join("").replace(/buffer \+= "";\n/g,"");if(options.debug){if(typeof console!="undefined"&&console.log){console.log(body);}else if(typeof print==="function"){print(body);}}return body;}function _compile(template,options){var args="view,partials,stack,lookup,escapeHTML,renderSection,render";var body=
parse(template,options);var fn=new Function(args,body);return function(view,partials){partials=partials||{};var stack=[view];try{return fn(view,partials,stack,lookup,escapeHTML,renderSection,render);}catch(e){throw debug(e.error,template,e.line,options.file);}};}var _cache={};function clearCache(){_cache={};}function compile(template,options){options=options||{};if(options.cache!==false){if(!_cache[template]){_cache[template]=_compile(template,options);}return _cache[template];}return _compile(template,options);}function render(template,view,partials){return compile(template)(view,partials);}})(Mustache);(function(context){context.Mustache=Mustache;if(context.define&&context.define.amd){context.define('wikia.mustache',Mustache);}}(window));;define('wikia.toc',function(){'use strict';function getData(headers,createSection,checkHeader){var toc={sections:[]},levels=[toc.sections],headersLength=headers.length,hToLevel=[],level=-1,lastHeader=-1,headerLevel,i,obj,header;for(i=0;i<
headersLength;i++){header=headers[i];headerLevel=parseInt(header.nodeName.slice(1),10);if(checkHeader){header=checkHeader(header);}if(!header){continue;}if(headerLevel>lastHeader){level+=1;}else if(headerLevel<lastHeader&&level>0){level=0;if(typeof hToLevel[headerLevel]!=='undefined'){level=hToLevel[headerLevel];}}obj=createSection(header,level+1);hToLevel[headerLevel]=level;lastHeader=headerLevel;levels[level].push(obj);levels[level+1]=obj.sections;}return toc;}return{getData:getData};});;require(['jquery','wikia.toc','wikia.mustache',require.optional('wikia.toc.mustache')],function($,toc,mustache,tocTemplate){'use strict';var containerHasTOC={},cacheKey='TOCAssets';function wrapper(){return function(text,render){if(text!==''){return'<ol>'+render(text)+'</ol>';}else{return false;}};}function getHeader(rawHeader){rawHeader=$(rawHeader).children('.mw-headline');if(rawHeader.length===0||rawHeader.is(':hidden')){return false;}rawHeader=rawHeader.clone();rawHeader.find('noscript').remove()
;return rawHeader;}function createTOCSection(header,tocLevel){return{title:header.text(),id:header.attr('id'),class:'toclevel-'+tocLevel,sections:[]};}function loadTemplate(){var dfd=new $.Deferred();require(['wikia.loader','wikia.cache'],function(loader,cache){var template=cache.getVersioned(cacheKey);if(template){dfd.resolve(template);}else{require(['wikia.throbber'],function(throbber){var toc=$('#toc');throbber.show(toc);loader({type:loader.MULTI,resources:{mustache:'extensions/wikia/TOC/templates/TOC_articleContent.mustache'}}).done(function(data){template=data.mustache[0];dfd.resolve(template);cache.setVersioned(cacheKey,template,604800);throbber.remove(toc);});});}});return dfd.promise();}function renderTOC($target){var $tocContainer=$target.parents('#toc'),$container=$tocContainer.children('ol'),$contentContainer=getContentContainer($target),$headers=$contentContainer.find('h1, h2, h3, h4, h5, h6'),data=toc.getData($headers,createTOCSection,getHeader);function render(template){
$container.append(mustache.render(template,data));$tocContainer.trigger('afterLoad.toc').data('loaded',true);setHasTOC($target,true);}data.wrapper=wrapper;if(tocTemplate){render(tocTemplate);}else{loadTemplate().done(render);}}function setTOCCookie(isHidden){$.cookie('mw_hidetoc',isHidden,{expires:30,path:'/'});}function showHideTOC($target){var tocWrapper=$target.parents('#toc'),targetLabel,tocCookie;tocWrapper.toggleClass('show');if(tocWrapper.hasClass('show')){targetLabel=$target.data('hide');tocCookie=null;}else{targetLabel=$target.data('show');tocCookie=1;}$target.text(targetLabel);$target.attr('title',targetLabel);setTOCCookie(tocCookie);}function isNewTOC(){return $('#toc').is('nav');}function initTOC(){var $showLink=$('#togglelink');if(!hasTOC($showLink)){renderTOC($showLink);}showHideTOC($showLink);}function hasTOC($target){var containerIdentifier=getContainerIdentifier($target);return typeof containerHasTOC[containerIdentifier]!=='undefined'&&containerHasTOC[
containerIdentifier];}function setHasTOC($target,value){var containerIdentifier=getContainerIdentifier($target);containerHasTOC[containerIdentifier]=value;}function getContentContainer($target){return $target.parents('.tabBody, #mw-content-text').first();}function getContainerIdentifier($target){return getContentContainer($target).data('tab-body')||'main';}$(function(){$('body').on('click','#togglelink',function(event){event.preventDefault();if(isNewTOC()){var $target=$(event.target);if(!hasTOC($target)){renderTOC($target);}showHideTOC($target);}});$(window).on('EditPageAfterRenderPreview',function(){containerHasTOC={};if(isNewTOC()&&window.wgUserName!==null){initTOC();}});if(isNewTOC()&&window.wgUserName!==null&&$.cookie('mw_hidetoc')===null){initTOC();}});});;

define('wikia.browserDetect',['wikia.window'],function(win){'use strict';var appName=win.navigator.appName,userAgent=win.navigator.userAgent,browser=null,operatingSystem=null;function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);}function isIE(){var bool=!1;if(appName==='Microsoft Internet Explorer'||(appName==='Netscape'&&userAgent.indexOf('Trident/')!==-1)){bool=!0;}return bool;}function isEdge(){return userAgent.indexOf('Edge')!==-1;}function isFirefox(){return userAgent.toLowerCase().indexOf('firefox')>-1;}function isChrome(){return userAgent.toLowerCase().indexOf('chrome')>-1;}function isIPad(){var bool=!1;if(userAgent.match(/iPad/i)!==null){bool=!0;}return bool;}function isIOS7orLower(){return!!userAgent.match(/iPad.+OS.[6,7].\d.+like.Mac.OS.+Safari/i);}function isAndroid(){return userAgent.toLowerCase().indexOf('android')>-1;}function getOS(){if(null!==operatingSystem){return operatingSystem;}operatingSystem=
'unknown';if(userAgent.indexOf('Win')!==-1){operatingSystem='Windows';}if(userAgent.indexOf('Mac')!==-1){operatingSystem='OSX';}if(userAgent.indexOf('Linux')!==-1){operatingSystem='Linux';}if(userAgent.indexOf('Android')!==-1){operatingSystem='Android';}if(userAgent.indexOf('like Mac')!==-1){operatingSystem='iOS';}return operatingSystem;}function getBrowser(){if(null!==browser){return browser;}var appVersion=win.navigator.appVersion,temp,matches=userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(matches[1])){temp=/\brv[ :]+(\d+)/g.exec(userAgent)||[];browser='IE '+(temp[1]||'');return browser;}if(matches[1]==='Chrome'){temp=userAgent.match(/\b(OPR|Edge)\/(\d+)/);if(temp!==null){browser=temp.slice(1).join(' ').replace('OPR','Opera');return browser;}}matches=matches[2]?[matches[1],matches[2]]:[appName,appVersion,'-?'];temp=userAgent.match(/version\/(\d+)/i);if(temp!==null){matches.splice(1,1,temp[1]);}browser=matches.join(' ');return browser
;}function getBrowserVersion(){var browserStringParts=getBrowser().split(' ');return parseInt(browserStringParts[1],10);}return{getBrowser:getBrowser,getBrowserVersion:getBrowserVersion,getOS:getOS,isChrome:isChrome,isIE:isIE,isFirefox:isFirefox,isIPad:isIPad,isIOS7orLower:isIOS7orLower,isAndroid:isAndroid,isMobile:isMobile,isEdge:isEdge};});;define('wikia.iframeWriter',['wikia.document','wikia.log'],function(doc,log){'use strict';var logGroup='wikia.iframeWriter',iframeStyle='<style>* {margin: 0; padding: 0;}</style>',iframeHeader='<html><body>',iframeFooter='</body></html>';function getIframe(params){log(['getIframe',params],'debug',logGroup);var code=iframeHeader+iframeStyle+params.code+iframeFooter,loaded=!1,iframe=doc.createElement('iframe');iframe.frameBorder='no';iframe.scrolling='no';iframe.width=params.width;iframe.height=params.height;if(params.classes){iframe.className=params.classes;}iframe.onload=function(){if(loaded){return;}loaded=!0;iframe.contentWindow.document.
write(code);iframe.contentWindow.document.close();};return iframe;}return{getIframe:getIframe};});;define('wikia.scriptwriter',['wikia.document','wikia.lazyqueue','wikia.log','wikia.window','wikia.loader'],function(doc,lazyQueue,log,win,loader){'use strict';var logGroup='wikia.scriptwriter',library='ghostwriter',queue=[],loading=!1;function gwFlushLoadHandlersAndCall(callback){return function(){win.ghostwriter.flushloadhandlers();callback();};}function noop(){return;}function processItem(params){log(['processItem',library,params],'debug',logGroup);var text=params.gwScriptText||'document.write('+JSON.stringify(params.html)+');';win.ghostwriter(params.element,{insertType:'append',script:{text:text},done:gwFlushLoadHandlersAndCall(params.callback)});}function processQueue(){log('processQueue','debug',logGroup);lazyQueue.makeQueue(queue,processItem);queue.start();}function loadLibrary(){var url;if(loading){return;}loading=!0;log(['loadLibrary',library],'debug',logGroup);url=
'/resources/wikia/libraries/ghostwriter/gw.min.js';loader(url).done(processQueue);}function getElement(elementOrElementId){if(elementOrElementId&&elementOrElementId.getElementsByTagName){return elementOrElementId;}if(typeof elementOrElementId==='string'){var el=doc.getElementById(elementOrElementId);if(el){return el;}}throw'wikia.scriptwriter: Not a valid element or element id '+elementOrElementId;}function queueHtmlInjection(params){log(['queueHtmlInjection',params],'debug',logGroup);queue.push(params);loadLibrary();}function escapeHtml(str){return str.replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}function injectHtml(elementOrElementId,html,callback){queueHtmlInjection({element:getElement(elementOrElementId),html:html,callback:callback||noop});}function injectScriptByUrl(elementOrElementId,url,callback){queueHtmlInjection({element:getElement(elementOrElementId),html:'<script src="'+escapeHtml(url)+'"></script>',callback:callback||noop});}function injectScriptByText
(elementOrElementId,text,callback){queueHtmlInjection({element:getElement(elementOrElementId),html:'<script src="data:text/javascript,'+encodeURIComponent(text)+'"></script>',gwScriptText:text,callback:callback||noop});}return{injectHtml:injectHtml,injectScriptByUrl:injectScriptByUrl,injectScriptByText:injectScriptByText};});;define('ext.wikia.adEngine.adDecoratorLegacyParamFormat',['wikia.log'],function(log){'use strict';var logGroup='ext.wikia.adEngine.adDecoratorLegacyParamFormat';function convertSimpleParamsForFillInSlot(slot){if(slot instanceof Array){slot=slot[0];}if(typeof slot==='string'){slot={slotName:slot};}if(slot&&slot.slotName){return slot;}}function decorator(fillInSlot){function enhancedFillInSlot(slot){var param=convertSimpleParamsForFillInSlot(slot);if(param){fillInSlot(param);}else{log(['Incorrect fillInSlot param:',param],'error',logGroup);}}return enhancedFillInSlot;}return decorator;});;define('ext.wikia.adEngine.adDecoratorPageDimensions',[
'ext.wikia.adEngine.adLogicPageDimensions','wikia.log'],function(adLogicPageDimensions,log){'use strict';var logGroup='ext.wikia.adEngine.adDecoratorPageDimensions';function decorator(fillInSlot){log(['decorator',fillInSlot],'debug',logGroup);return function(slot){log(['decorated',slot],'debug',logGroup);var slotname=slot.slotName;if(adLogicPageDimensions.isApplicable(slotname)){adLogicPageDimensions.addSlot(slotname,function(){fillInSlot(slot);});log(['decorated',slot,'deferred'],'debug',logGroup);return function(){return;};}log(['decorated',slot,'return same'],'debug',logGroup);return fillInSlot(slot);};}return decorator;});;define('ext.wikia.adEngine.adEngine',['ext.wikia.adEngine.adDecoratorLegacyParamFormat','ext.wikia.adEngine.utils.eventDispatcher','ext.wikia.adEngine.slot.adSlot','ext.wikia.adEngine.slot.service.slotRegistry','ext.wikia.adEngine.slotTracker','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.tracking.viewabilityTracker','ext.wikia.adEngine.utils.hooks',
'wikia.document','wikia.lazyqueue','wikia.log'],function(adDecoratorLegacyParamFormat,eventDispatcher,adSlot,slotRegistry,slotTracker,slotTweaker,viewabilityTracker,registerHooks,doc,lazyQueue,log){'use strict';var logGroup='ext.wikia.adEngine.adEngine';function decorate(func,decorators){log(['decorate',func,decorators],log.levels.debug,logGroup);var i,len;if(decorators&&decorators.length){for(i=0,len=decorators.length;i<len;i+=1){func=decorators[i](func);}}return func;}function cleanProviderContainers(slotName){var slotContainer=doc.getElementById(slotName),containers,i;if(!slotContainer){return;}containers=slotContainer.childNodes;for(i=containers.length-1;i>=0;i-=1){if(containers[i].tagName!=='SCRIPT'){slotContainer.removeChild(containers[i]);}}}function prepareAdProviderContainer(providerName,slotName){var providerContainerId=providerName+'_'+slotName,adContainer=doc.getElementById(slotName),providerContainer=doc.getElementById(providerContainerId);if(!providerContainer&&
adContainer){providerContainer=doc.createElement('div');providerContainer.classList.add('provider-container');providerContainer.id=providerContainerId;adContainer.appendChild(providerContainer);}log(['prepareAdProviderContainer',providerName,slotName,providerContainer],log.levels.debug,logGroup);return providerContainer;}function initializeProviderOnce(provider){if(!provider.fillInSlotQueue){provider.fillInSlotQueue=[];lazyQueue.makeQueue(provider.fillInSlotQueue,function(args){provider.fillInSlot.apply(provider,args);});if(provider.initialize){provider.initialize(provider.fillInSlotQueue.start);}else{provider.fillInSlotQueue.start();}}}function createSlot(queuedSlot,container,callbacks){var slot=adSlot.create(queuedSlot.slotName,container,callbacks);registerHooks(slot,['success','collapse','hop','renderEnded','viewed']);slot.post('success',queuedSlot.onSuccess);return slot;}function run(adConfig,adslots,queueName){log(['run',adslots,queueName],log.levels.debug,logGroup);function
fillInSlotUsingProvider(queuedSlot,provider,nextProvider){log(['fillInSlotUsingProvider',provider.name,queuedSlot],log.levels.debug,logGroup);var slotName=queuedSlot.slotName,container=prepareAdProviderContainer(provider.name,slotName),tracker=slotTracker(provider.name,slotName,queueName),slot=createSlot(queuedSlot,container,{success:function(adInfo){log(['success',provider.name,slotName,adInfo],log.levels.debug,logGroup);slotTweaker.show(slotName);eventDispatcher.dispatch('adengine.slot.status',{slot:slot,status:'success',adInfo:adInfo});tracker.track('success',adInfo);slot.container.setAttribute('data-slot-result','success');},collapse:function(adInfo){log(['collapse',provider.name,slotName,adInfo],log.levels.debug,logGroup);slotTweaker.hide(slotName);eventDispatcher.dispatch('adengine.slot.status',{slot:slot,status:'collapse',adInfo:adInfo});tracker.track('collapse',adInfo);slot.container.setAttribute('data-slot-result','collapse');},hop:function(adInfo){log(['hop',provider.name,
slotName,adInfo],log.levels.debug,logGroup);slotTweaker.hide(container.id);eventDispatcher.dispatch('adengine.slot.status',{slot:slot,status:'hop',adInfo:adInfo});tracker.track('hop',adInfo);slot.container.setAttribute('data-slot-result','hop');nextProvider();},renderEnded:function(){log(['renderEnded',provider.name,slotName],log.levels.debug,logGroup);if(!slot.container.getAttribute('data-slot-result')){slot.container.setAttribute('data-slot-result','loading');}},viewed:function(){log(['viewed',provider.name,slotName],log.levels.debug,logGroup);slot.container.setAttribute('data-slot-viewed','true');viewabilityTracker.track(slot);}});slot.post('viewed',function(){slot.isViewed=!0;});if(slotTweaker.isTopLeaderboard(slotName)){slot.pre('collapse',function(){slotTweaker.hide('TOP_BUTTON_WIDE');});}slotRegistry.add(slot,provider.name);initializeProviderOnce(provider);provider.fillInSlotQueue.push([slot]);}function fillInSlot(slot){log(['fillInSlot',slot],log.levels.debug,logGroup);var
slotName=slot.slotName,providerList=adConfig.getProviderList(slotName).slice();log(['fillInSlot',slot,'provider list',JSON.stringify(providerList)],log.levels.debug,logGroup);function handleNoAd(){log(['handleNoAd',slot],log.levels.debug,logGroup);slotTweaker.hide(slotName);if(typeof slot.onError==='function'){slot.onError(slot);}}function nextProvider(){var provider;do{provider=providerList.shift();if(!provider){handleNoAd();return;}if(provider.canHandleSlot(slotName)){fillInSlotUsingProvider(slot,provider,nextProvider);return;}log(['fillInSlot',slot,'skipping provider, cannot handle slot',provider],log.levels.debug,logGroup);}while(provider);}slotRegistry.reset(slotName);cleanProviderContainers(slotName);nextProvider();}var decorators=adConfig.getDecorators()||[];if(adDecoratorLegacyParamFormat){decorators.push(adDecoratorLegacyParamFormat);}log(['run','initializing lazyQueue on the queue'],log.levels.debug,logGroup);lazyQueue.makeQueue(adslots,decorate(fillInSlot,decorators));log([
'run','launching queue on adslots ('+adslots.length+')'],log.levels.debug,logGroup);adslots.start();log(['run','initial queue handled'],log.levels.debug,logGroup);}return{run:run};});;define('ext.wikia.adEngine.adEngineRunner',['ext.wikia.adEngine.adEngine','ext.wikia.adEngine.adTracker','wikia.instantGlobals','wikia.log','wikia.window',require.optional('ext.wikia.adEngine.lookup.a9'),require.optional('ext.wikia.adEngine.lookup.prebid'),require.optional('ext.wikia.aRecoveryEngine.adBlockRecovery')],function(adEngine,adTracker,instantGlobals,log,win,a9,prebid,adBlockRecovery){'use strict';var logGroup='ext.wikia.adEngine.adEngineRunner',supportedModules=[a9,prebid,adBlockRecovery],timeout=instantGlobals.wgAdDriverDelayTimeout||2000;function delayRun(runAdEngine){var modulesQueue=[],enabledModules=[],startedByModules=!1;function markModule(name){log(name+' responded',log.levels.debug,logGroup);if(modulesQueue.indexOf(name)===-1){modulesQueue.push(name);}if(modulesQueue.length===
enabledModules.length){log('All modules responded',log.levels.info,logGroup);startedByModules=!0;adTracker.measureTime('adengine_runner/modules_responded',modulesQueue.join(',')).track();runAdEngine();}}function registerModules(){log(['Register modules',enabledModules.length],log.levels.debug,logGroup);enabledModules.forEach(function(module){var name=module.getName();module.addResponseListener(function(){markModule(name);});});}function getTimeoutModules(){var timeoutModules=[];enabledModules.forEach(function(enabledModule){var enabledModuleName=enabledModule.getName();if(modulesQueue.indexOf(enabledModuleName)===-1){timeoutModules.push(enabledModuleName);}});return timeoutModules.join(',');}supportedModules.forEach(function(module){if(module&&module.wasCalled()){enabledModules.push(module);}});if(enabledModules.length===0){log('All modules are disabled',log.levels.info,logGroup);runAdEngine();}else{registerModules();win.setTimeout(function(){if(!startedByModules){log([
'Timeout exceeded',timeout],log.levels.info,logGroup);adTracker.measureTime('adengine_runner/modules_timeout',getTimeoutModules()).track();runAdEngine();}},timeout);}}function run(config,slots,queueName,delayEnabled){var engineStarted=!1;function runAdEngine(){if(engineStarted){return;}engineStarted=!0;log('Running AdEngine',log.levels.info,logGroup);adTracker.measureTime('adengine.init',queueName).track();adEngine.run(config,slots,queueName);}if(delayEnabled){delayRun(runAdEngine);}else{log('Run AdEngine without delay',log.levels.info,logGroup);runAdEngine();}}return{run:run};});;define('ext.wikia.adEngine.adLogicDartSubdomain',['wikia.geo'],function(Geo){'use strict';function getSubdomain(){switch(Geo.getContinentCode()){case'AF':case'EU':return'ad-emea';case'AS':switch(Geo.getCountryCode()){case'AE':case'CY':case'BH':case'IL':case'IQ':case'IR':case'JO':case'KW':case'LB':case'OM':case'PS':case'QA':case'SA':case'SY':case'TR':case'YE':return'ad-emea';default:return'ad-apac';}case
'OC':return'ad-apac';default:return'ad';}}return{getSubdomain:getSubdomain};});;define('ext.wikia.adEngine.adLogicPageDimensions',['ext.wikia.adEngine.slotTweaker','wikia.document','wikia.log','wikia.throttle','wikia.window'],function(slotTweaker,doc,log,throttle,win){'use strict';var logGroup='ext.wikia.adEngine.adLogicPageDimensions',initCalled=!1,wrappedAds={},slotsToHideOnMediaQuery={TOP_RIGHT_BOXAD:'oneColumn',INCONTENT_BOXAD_1:'oneColumn'},mediaQueriesToCheck={twoColumns:'screen and (min-width: 1024px)',oneColumn:'screen and (max-width: 1023px)',noTopButton:'screen and (max-width: 1063px)',},mediaQueriesMet,matchMedia;function matchMediaMoz(query){return win.matchMedia(query).matches;}function matchMediaIe(query){return win.styleMedia.matchMedium(query);}matchMedia=win.matchMedia&&matchMediaMoz;matchMedia=matchMedia||(win.styleMedia&&win.styleMedia.matchMedium&&matchMediaIe);matchMedia=matchMedia||(win.media&&win.media.matchMedium);if(!matchMedia){log(
'No working matchMedia implementation found','user',logGroup);}function shouldBeShown(slotname){var wideEnough=!1,conflictingMediaQuery;if(mediaQueriesMet){if(slotsToHideOnMediaQuery[slotname]){conflictingMediaQuery=slotsToHideOnMediaQuery[slotname];wideEnough=!mediaQueriesMet[conflictingMediaQuery];}else{wideEnough=!0;}}return wideEnough;}function refresh(ad){if(shouldBeShown(ad.slotname)){if(ad.state==='none'||ad.state==='ready'){log(['Loading ad in slot '+ad.slotname,ad],'info',logGroup);slotTweaker.show(ad.slotname,true);ad.loadCallback();ad.state='shown';}else if(ad.state==='hidden'){log(['Reshowing slot '+ad.slotname,ad],'info',logGroup);slotTweaker.show(ad.slotname,true);ad.state='shown';}}else{if(ad.state==='none'){log(['Hiding empty slot '+ad.slotname,ad],'info',logGroup);slotTweaker.hide(ad.slotname);slotTweaker.hackChromeRefresh(ad.slotname);ad.state='ready';}else if(ad.state==='shown'){log(['Hiding slot '+ad.slotname,ad],'info',logGroup);slotTweaker.hide(ad.slotname);
slotTweaker.hackChromeRefresh(ad.slotname);ad.state='hidden';}}}function updateVars(){var mediaQueryIndex;if(win.wgOasisResponsive||win.wgOasisBreakpoints){if(matchMedia){mediaQueriesMet={};for(mediaQueryIndex in mediaQueriesToCheck){if(mediaQueriesToCheck.hasOwnProperty(mediaQueryIndex)){mediaQueriesMet[mediaQueryIndex]=matchMedia(mediaQueriesToCheck[mediaQueryIndex]);}}}}else{mediaQueriesMet={};for(mediaQueryIndex in mediaQueriesToCheck){if(mediaQueriesToCheck.hasOwnProperty(mediaQueryIndex)){mediaQueriesMet[mediaQueryIndex]=!1;}}}}function refreshAll(){var slotname;for(slotname in wrappedAds){if(wrappedAds.hasOwnProperty(slotname)){refresh(wrappedAds[slotname]);}}}function onResize(){updateVars();refreshAll();}function init(){log('init','debug',logGroup);if(win.addEventListener){win.addEventListener('orientationchange',throttle(onResize,100));win.addEventListener('resize',throttle(onResize,100));}else{log('No support for addEventListener. No dimension-dependent ads will be shown'
,'error',logGroup);}initCalled=!0;}function add(slotname,loadCallback){log(['add',slotname,loadCallback],'debug',logGroup);if(!initCalled){init();}updateVars();wrappedAds[slotname]={slotname:slotname,state:'none',loadCallback:loadCallback};refresh(wrappedAds[slotname]);}function isApplicable(slotname){log(['isApplicable',slotname],'debug',logGroup);return!!slotsToHideOnMediaQuery[slotname];}return{addSlot:add,isApplicable:isApplicable,shouldBeShown:shouldBeShown};});;define('ext.wikia.adEngine.adLogicPageParams',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.utils.adLogicZoneParams','wikia.document','wikia.geo','wikia.location','wikia.log','wikia.window',require.optional('wikia.abTest'),require.optional('wikia.krux')],function(adContext,zoneParams,doc,geo,loc,log,win,abTest,krux){'use strict';var context={},logGroup='ext.wikia.adEngine.adLogicPageParams',runtimeParams={};function updateContext(){context=adContext.getContext();}function getAb(){var experiments,experimentsNumber,i
,ab=[];if(abTest){experiments=abTest.getExperiments();experimentsNumber=experiments.length;for(i=0;i<experimentsNumber;i+=1){ab.push(experiments[i].id+'_'+experiments[i].group.id);}}return ab;}function extend(target,obj){var key;for(key in obj){if(obj.hasOwnProperty(key)){target[key]=obj[key];}}return target;}function addParam(key,value){runtimeParams[key]=value;}function decodeLegacyDartParams(dartString){var params={},kvs,kv,key,value,i,len;log(['decodeLegacyDartParams',dartString],9,logGroup);if(typeof dartString==='string'){kvs=dartString.split(';');for(i=0,len=kvs.length;i<len;i+=1){kv=kvs[i].split('=');key=kv[0];value=kv[1];if(key&&value&&key!=='esrb'){params[key]=params[key]||[];params[key].push(value);}}}return params;}function getRefParam(){var hostnameMatch,ref=doc.referrer,refHostname,searchDomains=/(google|search\.yahooo|bing|baidu|ask|yandex)/,wikiDomains=['wikia.com','ffxiclopedia.org','jedipedia.de','memory-alpha.org','uncyclopedia.org','websitewiki.de','wowwiki.com',
'yoyowiki.org'],wikiDomainsRegex=new RegExp('(^|\\.)('+wikiDomains.join('|').replace(/\./g,'\\.')+')$');if(!ref||typeof ref!=='string'){return'direct';}refHostname=ref.match(/\/\/([^\/]+)\//);if(refHostname){refHostname=refHostname[1];}hostnameMatch=refHostname===loc.hostname;if(hostnameMatch&&(ref.indexOf('search=')>-1||ref.indexOf('query=')>-1)){return'wiki_search';}if(hostnameMatch){return'wiki';}hostnameMatch=wikiDomainsRegex.test(refHostname);if(hostnameMatch&&(ref.indexOf('search=')>-1||ref.indexOf('query=')>-1||ref.indexOf('s=')>-1)){return'wikia_search';}if(hostnameMatch){return'wikia';}if(searchDomains.test(refHostname)){return'external_search';}return'external';}function getAspectRatio(){return win.innerWidth>win.innerHeight?'4:3':'3:4';}function getPageLevelParams(options){log('getPageLevelParams',9,logGroup);var params,targeting=context.targeting;options=options||{};params={s0:zoneParams.getSite(),s0v:zoneParams.getVertical(),s0c:zoneParams.getWikiCategories(),s1:zoneParams
.getName(),s2:zoneParams.getPageType(),ab:getAb(),ar:getAspectRatio(),artid:targeting.pageArticleId&&targeting.pageArticleId.toString(),cat:zoneParams.getPageCategories(),dmn:zoneParams.getDomain(),hostpre:zoneParams.getHostnamePrefix(),skin:targeting.skin,lang:zoneParams.getLanguage(),wpage:targeting.pageName&&targeting.pageName.toLowerCase(),ref:getRefParam(),esrb:targeting.esrbRating,geo:geo.getCountryCode()||'none'};if(win.pvNumber){params.pv=win.pvNumber.toString();}if(options.includeRawDbName){params.rawDbName=zoneParams.getRawDbName();}if(krux&&targeting.enableKruxTargeting){params.u=krux.getUser();params.ksgmnt=krux.getSegments();}if(targeting.wikiIsTop1000){params.top='1k';}extend(params,decodeLegacyDartParams(targeting.wikiCustomKeyValues));extend(params,runtimeParams);log(params,9,logGroup);return params;}updateContext();adContext.addCallback(updateContext);return{add:addParam,getPageLevelParams:getPageLevelParams};});;define('ext.wikia.adEngine.adLogicPageViewCounter',[
'wikia.cache','wikia.window'],function(cache,window){'use strict';var cacheKey='adEngine_pageViewCounter',cacheTtl=24*3600*1000,now=window.wgNow||new Date(),initialValue={since:now.getTime(),pvs:0};function isValidValue(val){if(!val||isNaN(val.since)||isNaN(val.pvs)){return false;}var pvs=val.pvs,age=now.getTime()-val.since;if(pvs<0||age<0||age>cacheTtl){return false;}return true;}function get(){var val=cache.get(cacheKey,now);if(!isValidValue(val)){val=initialValue;}return val.pvs;}function increment(){var val,age,ttlLeft;val=cache.get(cacheKey,now);if(!isValidValue(val)){val=initialValue;}age=now.getTime()-val.since;ttlLeft=cacheTtl-age;val.pvs+=1;cache.set(cacheKey,val,ttlLeft,now);}return{get:get,increment:increment};});;(function(){'use strict';var availableTemplates=['bfaa','bfab','floatingRail','floor','floorAdhesion','interstitial','modal','ooyala','playwire','porvata','roadblock','skin'],dependencies=['wikia.log'];function getAdModule(name,allModules){return allModules[
availableTemplates.indexOf(name)];}define('ext.wikia.adEngine.customAdsLoader',dependencies.concat(availableTemplates.map(function(templateName){return require.optional('ext.wikia.adEngine.template.'+templateName);})),function(log){var logGroup='ext.wikia.adEngine.customAdsLoader',allModules=Array.prototype.slice.call(arguments).slice(dependencies.length);function loadCustomAd(params){log('loadCustomAd: module '+params.type+' required','debug',logGroup);var adModule=getAdModule(params.type,allModules);if(adModule){log('loadCustomAd: module '+params.type+' found','debug',logGroup);return adModule.show(params);}else{log('loadCustomAd: module '+params.type+' not found','error',logGroup);}}return{loadCustomAd:loadCustomAd};});})();;define('ext.wikia.adEngine.utils.sampler',['wikia.querystring'],function(QueryString){'use strict';var qs=new QueryString(),queryStringParam='ignored_samplers';function samplerIsIgnored(name){var ignored=qs.getVal(queryStringParam,'').split(',');return ignored.
indexOf(name)>-1;}function sample(name,partToSample,all){return samplerIsIgnored(name)?true:getRandomInt(0,all)<partToSample;}function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min;}return{sample:sample};});;define('ext.wikia.adEngine.adContext',['wikia.browserDetect','wikia.cookies','wikia.document','wikia.geo','wikia.instantGlobals','ext.wikia.adEngine.utils.sampler','wikia.window','wikia.querystring'],function(browserDetect,cookies,doc,geo,instantGlobals,sampler,w,Querystring){'use strict';instantGlobals=instantGlobals||{};var context,callbacks=[],qs=new Querystring();function getContext(){return context;}function getMercuryCategories(){if(!context.targeting.mercuryPageCategories){return;}return context.targeting.mercuryPageCategories.map(function(item){return item.title;});}function isUrlParamSet(param){return!!parseInt(qs.getVal(param,'0'),10);}function isPageType(pageType){return context.targeting.pageType===pageType;}function isInstartLogicSupportedBrowser
(){return browserDetect.isChrome()&&browserDetect.getBrowserVersion()>45;}function isPageFairDetectionEnabled(){var isSupportedGeo=geo.isProperGeo(instantGlobals.wgAdDriverPageFairDetectionCountries);return isUrlParamSet('pagefairdetection')||(isSupportedGeo&&sampler.sample('pageFairDetection',1,10));}function isSourcePointDetectionDesktopEnabled(context){return context.opts.sourcePointDetectionUrl&&context.targeting.skin==='oasis'&&geo.isProperGeo(instantGlobals.wgAdDriverSourcePointDetectionCountries);}function isSourcePointDetectionMobileEnabled(context){return context.opts.sourcePointDetectionUrl&&context.targeting.skin==='mercury'&&geo.isProperGeo(instantGlobals.wgAdDriverSourcePointDetectionMobileCountries);}function updateDetectionServicesAdContext(context,noExternals){context.opts.sourcePointDetection=!noExternals&&isSourcePointDetectionDesktopEnabled(context);context.opts.sourcePointDetectionMobile=!noExternals&&isSourcePointDetectionMobileEnabled(context);context.opts.
pageFairDetection=!noExternals&&isPageFairDetectionEnabled();}function updateAdContextRecoveryServices(context,noExternals){var isRecoveryServiceAlreadyEnabled=!1,serviceCanBeEnabled=!noExternals&&context.opts.showAds!==!1;context.opts.instartLogicRecovery=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.instartLogicRecovery&&geo.isProperGeo(instantGlobals.wgAdDriverInstartLogicRecoveryCountries)&&isInstartLogicSupportedBrowser();isRecoveryServiceAlreadyEnabled|=context.opts.instartLogicRecovery;context.opts.pageFairRecovery=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.pageFairRecovery&&geo.isProperGeo(instantGlobals.wgAdDriverPageFairRecoveryCountries)&&!browserDetect.isEdge();isRecoveryServiceAlreadyEnabled|=context.opts.pageFairRecovery;context.opts.sourcePointRecovery=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.sourcePointRecovery&&geo.isProperGeo(instantGlobals.wgAdDriverSourcePointRecoveryCountries);
isRecoveryServiceAlreadyEnabled|=context.opts.sourcePointRecovery;context.opts.sourcePointMMS=serviceCanBeEnabled&&!isRecoveryServiceAlreadyEnabled&&context.opts.sourcePointMMS;context.opts.sourcePointBootstrap=context.opts.sourcePointMMS||context.opts.sourcePointRecovery;}function updateAdContextBidders(context){var hasFeaturedVideo=context.targeting.hasFeaturedVideo;context.bidders.rubiconDisplay=geo.isProperGeo(instantGlobals.wgAdDriverRubiconDisplayPrebidCountries);context.bidders.rubicon=geo.isProperGeo(instantGlobals.wgAdDriverRubiconPrebidCountries)&&!hasFeaturedVideo;context.bidders.appnexusAst=geo.isProperGeo(instantGlobals.wgAdDriverAppNexusAstBidderCountries)&&!hasFeaturedVideo;context.bidders.a9Video=geo.isProperGeo(instantGlobals.wgAdDriverA9VideoBidderCountries);}function referrerIsSonySite(){return doc&&doc.referrer&&doc.referrer.match(/info\.tvsideview\.sony\.net/);}function isMOATTrackingForFVEnabled(){var samplingForMoatFV=instantGlobals.
wgAdDriverMoatTrackingForFeaturedVideoAdSampling||1;return sampler.sample('moatTrackingForFeaturedVideo',samplingForMoatFV,100)&&geo.isProperGeo(instantGlobals.wgAdDriverMoatTrackingForFeaturedVideoAdCountries);}function setContext(newContext){var i,len,fvAdsFrequency=instantGlobals.wgAdDriverPlayAdsOnNextFVFrequency,noExternals=w.wgNoExternals||isUrlParamSet('noexternals');context=newContext;context.opts=context.opts||{};context.slots=context.slots||{};context.targeting=context.targeting||{};context.providers=context.providers||{};context.bidders=context.bidders||{};context.forcedProvider=qs.getVal('forcead',null)||context.forcedProvider||null;context.opts.noExternals=noExternals;if(referrerIsSonySite()){context.opts.showAds=!1;}if(geo.isProperGeo(instantGlobals.wgAdDriverDelayCountries)){context.opts.delayEngine=!0;}context.opts.isAdProductsBridgeEnabled=geo.isProperGeo(instantGlobals.wgAdDriverAdProductsBridgeCountries);context.opts.premiumOnly=context.targeting.
hasFeaturedVideo&&geo.isProperGeo(instantGlobals.wgAdDriverSrcPremiumCountries);context.opts.isMoatTrackingForFeaturedVideoEnabled=isMOATTrackingForFVEnabled();updateDetectionServicesAdContext(context,noExternals);updateAdContextRecoveryServices(context,noExternals);updateAdContextBidders(context);if(cookies.get('mock-ads')==='NlfdjR5xC0'){context.opts.showcase=!0;}if(context.targeting.enablePageCategories){context.targeting.pageCategories=w.wgCategories||getMercuryCategories();}if(context.providers.evolve2){context.providers.evolve2=geo.isProperGeo(instantGlobals.wgAdDriverEvolve2Countries);}if(geo.isProperGeo(instantGlobals.wgAdDriverTurtleCountries)){context.providers.turtle=!0;}context.opts.enableRemnantNewAdUnit=geo.isProperGeo(instantGlobals.wgAdDriverMEGACountries);context.slots.invisibleHighImpact=(context.slots.invisibleHighImpact&&geo.isProperGeo(instantGlobals.wgAdDriverHighImpactSlotCountries))||isUrlParamSet('highimpactslot');context.opts.kikimoraViewabilityTracking=
geo.isProperGeo(instantGlobals.wgAdDriverKikimoraViewabilityTrackingCountries);context.opts.enableAdInfoLog=geo.isProperGeo(instantGlobals.wgAdDriverKikimoraTrackingCountries);context.opts.playerTracking=geo.isProperGeo(instantGlobals.wgAdDriverKikimoraPlayerTrackingCountries);context.targeting.enableKruxTargeting=!!(context.targeting.enableKruxTargeting&&geo.isProperGeo(instantGlobals.wgAdDriverKruxCountries)&&!instantGlobals.wgSitewideDisableKrux);context.opts.floatingMedrec=!!(context.opts.showAds&&context.opts.adsInContent&&(isPageType('article')||isPageType('search'))&&!context.targeting.wikiIsCorporate);context.opts.outstreamVideoFrequencyCapping=instantGlobals.wgAdDriverOutstreamVideoFrequencyCapping;context.opts.porvataMoatTrackingEnabled=geo.isProperGeo(instantGlobals.wgAdDriverPorvataMoatTrackingCountries);context.opts.porvataMoatTrackingSampling=instantGlobals.wgAdDriverPorvataMoatTrackingSampling||0;context.opts.megaAdUnitBuilderEnabled=context.targeting.hasFeaturedVideo&&
geo.isProperGeo(instantGlobals.wgAdDriverMegaAdUnitBuilderForFVCountries);context.opts.isFVMidrollEnabled=geo.isProperGeo(instantGlobals.wgAdDriverFVMidrollCountries);context.opts.isFVPostrollEnabled=geo.isProperGeo(instantGlobals.wgAdDriverFVPostrollCountries);context.opts.replayAdsForFV=geo.isProperGeo(instantGlobals.wgAdDriverPlayAdsOnNextFVCountries);context.opts.fvAdsFrequency=fvAdsFrequency!==undefined?fvAdsFrequency:3;context.opts.disableSra=geo.isProperGeo(instantGlobals.wgAdDriverDisableSraCountries);if(w.ads&&w.ads.context){w.ads.context=context;}for(i=0,len=callbacks.length;i<len;i+=1){callbacks[i](context);}}function addCallback(callback){callbacks.push(callback);}function get(path){var isPathValid=path!==undefined&&path!=='',nextElement=getContext(),nodes=(path||'').split('.');while(isPathValid&&nodes.length>0&&typeof nextElement==='object'){nextElement=nextElement[nodes.shift()];}return nextElement;}setContext(w.ads?w.ads.context:{});return{get:get,addCallback:addCallback
,getContext:getContext,setContext:setContext};});;define('ext.wikia.adEngine.context.slotsContext',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.video.videoFrequencyMonitor','wikia.document','wikia.geo','wikia.instantGlobals','wikia.log'],function(adContext,videoFrequencyMonitor,doc,geo,instantGlobals,log){'use strict';var logGroup='ext.wikia.adEngine.context.slotsContext',slots={};function setStatus(slotName,status){log(['setStatus',slotName,status],log.levels.info,logGroup);slots[slotName]=!!status;}function isInContentApplicable(){var header=doc.querySelectorAll('#mw-content-text > h2')[1];return header&&header.offsetWidth>=header.parentNode.offsetWidth;}function setupSlots(){var context=adContext.getContext(),isHome=context.targeting.pageType==='home',isOasis=context.targeting.skin==='oasis',isIncontentEnabled=!isHome&&isOasis&&!context.targeting.hasFeaturedVideo&&isInContentApplicable()&&videoFrequencyMonitor.videoCanBeLaunched();setStatus('TOP_LEADERBOARD',true);setStatus(
'TOP_RIGHT_BOXAD',true);setStatus('BOTTOM_LEADERBOARD',true);setStatus('INCONTENT_BOXAD_1',!isHome);setStatus('INVISIBLE_HIGH_IMPACT_2',!context.targeting.hasFeaturedVideo&&geo.isProperGeo(instantGlobals.wgAdDriverHighImpact2SlotCountries));setStatus('INCONTENT_PLAYER',isIncontentEnabled);log(['Slots:',slots],log.levels.info,logGroup);}function isApplicable(slotName){return slots[slotName]!==!1;}function filterSlotMap(slotMap){var map={};if(!slotMap){return map;}Object.keys(slotMap).forEach(function(slotName){if(isApplicable(slotName)){map[slotName]=slotMap[slotName];}});return map;}setupSlots();return{filterSlotMap:filterSlotMap,isApplicable:isApplicable,setStatus:setStatus};});;define('ext.wikia.adEngine.context.uapContext',['ad-engine.bridge','ext.wikia.adEngine.utils.eventDispatcher','wikia.log'],function(adEngineBridge,eventDispatcher,log){'use strict';var context={},logGroup='ext.wikia.adEngine.context.uapContext',mainSlotName='TOP_LEADERBOARD',uapTypes=['uap','vuap'];function
setUapStateBasedOnBridge(){setUapId(adEngineBridge.UniversalAdPackage.getUapId());setType(adEngineBridge.UniversalAdPackage.getType());}function setUapId(uap){context.uapId=uap;}function getUapId(){return context.uapId;}function setType(type){context.type=type;}function getType(){return context.type;}function isUapLoaded(){var isUapType=uapTypes.indexOf(context.type)!==-1;return!!context.uapId&&isUapType;}function isBfaaLoaded(){return!!context.uapId;}function isRoadblockLoaded(){return!!context.uapId&&context.type==='ruap';}function reset(){context={};}function shouldDispatchEvent(slotName){return!context.eventDispatched&&slotName.indexOf(mainSlotName)!==-1;}function dispatchEvent(){var eventName=isUapLoaded()?'wikia.uap':'wikia.not_uap';eventDispatcher.dispatch(eventName);context.eventDispatched=!0;log(['dispatchEvent',eventName],'info',logGroup);}adEngineBridge.Context.onChange('slots.TOP_LEADERBOARD.targeting.uap',setUapStateBasedOnBridge);adEngineBridge.Context.onChange(
'slots.MOBILE_TOP_LEADERBOARD.targeting.uap',setUapStateBasedOnBridge);return{dispatchEvent:dispatchEvent,getType:getType,getUapId:getUapId,isBfaaLoaded:isBfaaLoaded,isUapLoaded:isUapLoaded,isRoadblockLoaded:isRoadblockLoaded,reset:reset,setType:setType,setUapId:setUapId,shouldDispatchEvent:shouldDispatchEvent};});;define('ext.wikia.adEngine.dartUrl',function(){'use strict';var logGroup='DartUrlUtils';function trimParam(kvs,limit){if(!limit||limit===true){limit=500;}kvs=kvs||'';kvs=kvs.substr(0,limit).replace(/;[^;]*$/,';');if(!kvs.match(/;$/)){kvs='';}return kvs;}function decorateParam(key,value){var ret='',i;if(value){if(!(value instanceof Array)){value=[value];}for(i=0;i<value.length;i+=1){if(value[i]){ret+=key+'='+encodeURIComponent(value[i]+'')+';';}}}return ret;}function urlBuilder(domain,path){var params='';function toString(){return'http://'+domain+'/'+path+';'+params;}function addString(str,limit){if(limit){str=trimParam(str,limit);}params+=str;}function addParam(key,value,
limit){addString(decorateParam(key,value),limit);}return{addParam:addParam,addString:addString,toString:toString};}return{decorateParam:decorateParam,trimParam:trimParam,urlBuilder:urlBuilder};});;define('ext.wikia.adEngine.domElementTweaker',['wikia.log','wikia.window'],function(log,win){'use strict';var hiddenElementClass='hidden',logGroup='ext.wikia.adEngine.domElementTweaker';function hide(element,useInline){if(element&&useInline){element.style.display='none';}else if(element){element.classList.add(hiddenElementClass);}}function show(element,useInline){if(element&&useInline){element.style.display='block';}else if(element){element.classList.remove(hiddenElementClass);}}function addClass(element,cls){log(['addClass '+cls,element],8,logGroup);element.classList.add(cls);}function removeClass(element,cls){log(['removeClass '+cls,element],8,logGroup);element.classList.remove(cls);}function isElement(obj){return obj instanceof win.HTMLElement;}function rewriteStylesToElement(
computedStyles,targetElement){var i,styleName;for(i=0;i<computedStyles.length;i++){styleName=computedStyles[i];targetElement.style[styleName]=computedStyles[styleName];}}function moveStylesToInline(sourceElement,targetElement,ignoredStyles){var computedStyles,tmpStyles={};if(!isElement(sourceElement)){log(['Can\'t copy styles because parameter isn\'t element',sourceElement],4,logGroup);return;}computedStyles=document.defaultView.getComputedStyle(sourceElement,'');ignoredStyles.forEach(function(styleName){tmpStyles[styleName]=targetElement.style[styleName];});if(win.CSS2Properties!==undefined&&computedStyles instanceof win.CSS2Properties){rewriteStylesToElement(computedStyles,targetElement);}else if(win.CSSStyleDeclaration!==undefined&&computedStyles instanceof win.CSSStyleDeclaration){targetElement.style.cssText=computedStyles.cssText;}else{log(['Can\'t copy styles from element',computedStyles.cssText],4,logGroup);return;}Object.keys(tmpStyles).forEach(function(key){targetElement.style
[key]=tmpStyles[key];});}function forceRepaint(domElement){return domElement.offsetWidth;}return{addClass:addClass,forceRepaint:forceRepaint,hide:hide,isElement:isElement,moveStylesToInline:moveStylesToInline,removeClass:removeClass,show:show};});;define('ext.wikia.adEngine.lookup.services',['wikia.log',require.optional('ext.wikia.adEngine.lookup.prebid'),require.optional('ext.wikia.adEngine.lookup.a9')],function(log,prebid,a9){'use strict';var logGroup='ext.wikia.adEngine.lookup.services',bidders=[a9,prebid],bidIndex={a9:{pos:2,char:'9'},prebid:{pos:4,char:'P'}},bidMarker=['x','x','x','x','x'],realSlotPrices={};function addParameters(providerName,slotName,slotTargeting){var params={},floorPrice=0,prebidPrices;if(prebid&&prebid.wasCalled()){prebidPrices=prebid.getBestSlotPrice(slotName);floorPrice=Math.max.apply(null,Object.keys(prebidPrices).filter(function(key){return!isNaN(parseFloat(prebidPrices[key]))&&parseFloat(prebidPrices[key])>0;}).map(function(key){return parseFloat(
prebidPrices[key]);}));}if(!Object.keys){return;}bidders.forEach(function(bidder){if(bidder&&bidder.wasCalled()){params=bidder.getSlotParams(slotName,floorPrice);bidder.trackState(providerName,slotName,params);Object.keys(params).forEach(function(key){slotTargeting[key]=params[key];});if(bidder.hasResponse()){bidMarker=updateBidderMarker(bidder.getName(),bidMarker);}}});slotTargeting.bid=bidMarker.join('');}function updateBidderMarker(bidderName,bidMarker){var bidder;if(!bidIndex[bidderName]){return bidMarker;}bidder=bidIndex[bidderName];bidMarker[bidder.pos]=bidder.char;return bidMarker;}function extendSlotTargeting(slotName,slotTargeting,providerName){log(['extendSlotTargeting',slotName,slotTargeting],'debug',logGroup);providerName=providerName.toLowerCase().replace('gpt','');addParameters(providerName,slotName,slotTargeting);}function getCurrentSlotPrices(slotName){var slotPrices={};bidders.forEach(function(bidder){if(bidder&&bidder.isSlotSupported(slotName)){var priceFromBidder=
bidder.getBestSlotPrice(slotName);Object.keys(priceFromBidder).forEach(function(bidderName){slotPrices[bidderName]=priceFromBidder[bidderName];});}});return slotPrices;}function storeRealSlotPrices(slotName){realSlotPrices[slotName]=getCurrentSlotPrices(slotName);}function getDfpSlotPrices(slotName){return realSlotPrices[slotName]||{};}return{extendSlotTargeting:extendSlotTargeting,getCurrentSlotPrices:getCurrentSlotPrices,storeRealSlotPrices:storeRealSlotPrices,getDfpSlotPrices:getDfpSlotPrices};});;define('ext.wikia.adEngine.messageListener',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,window){'use strict';var logGroup='ext.wikia.adEngine.messageListener',callbacks=[],unhandledMessages=[];function isInterestingMessage(msg){try{return!!JSON.parse(msg.data).hasOwnProperty('AdEngine');}catch(e){return false;}}function eventMatch(match,msg){var matching=!0,matchingFrame=!1,msgFrame;if(match.dataKey){matching=JSON.parse(msg.data).AdEngine.
hasOwnProperty(match.dataKey);}if(match.source){for(msgFrame=msg.source;msgFrame!==window;msgFrame=msgFrame.parent){if(msgFrame===match.source){matchingFrame=!0;}}matching=matching&&matchingFrame;}return matching;}function processMessage(msg){var i,len,callback;log(['Received message',msg.data],'debug',logGroup);for(i=0,len=callbacks.length;i<len;i+=1){callback=callbacks[i];if(eventMatch(callback.match,msg)){log(['Event matching',msg,callback],'debug',logGroup);callback.fn(JSON.parse(msg.data).AdEngine);if(!callback.match.infinite){callbacks.splice(i,1);}return;}}log(['Event not matching (pushed to unhandled messages)',msg],'debug',logGroup);unhandledMessages.push(msg);}function receiveMessage(msg){if(isInterestingMessage(msg)){processMessage(msg);}}function init(){log('Initialized ads message listener','debug',logGroup);window.addEventListener('message',receiveMessage);}function register(match,callback){var i,len,msg;log(['Register callback',match,callback],'debug',logGroup);for(i=0
,len=unhandledMessages.length;i<len;i+=1){msg=unhandledMessages[i];if(eventMatch(match,msg)){unhandledMessages.splice(i,1);log(['Some event matches',msg,callback],'debug',logGroup);callback(JSON.parse(msg.data).AdEngine);return;}}log(['No events matching (pushing to callbacks)',callback],'debug',logGroup);callbacks.push({match:match,fn:callback});}adContext.addCallback(function(){callbacks=[];unhandledMessages=[];});return{init:init,register:register};});;define('ext.wikia.adEngine.slotTracker',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker'],function(adContext,adTracker){'use strict';var timeCheckpoints=[2.0,5.0,8.0,20.0],context=adContext.getContext(),stats={allEvents:0,interestingEvents:0},slotTypes={INCONTENT_BOXAD_1:'medrec',INCONTENT_PLAYER:'incontent',INVISIBLE_SKIN:'pixel',MOBILE_IN_CONTENT:'mobile_content',MOBILE_PREFOOTER:'mobile_prefooter',MOBILE_TOP_LEADERBOARD:'mobile_leaderboard',TOP_LEADERBOARD:'leaderboard',TOP_RIGHT_BOXAD:'medrec'};function isInteresting
(eventName,data){if(data.provider==='Null'||data.provider==='Later'){return false;}if(data.slotname.match(/_FLUSH$/)){return false;}if(data.slotname==='TOP_BUTTON_WIDE'){return false;}if(!context.opts.trackSlotState&&eventName.match(/^state/)){return false;}return true;}function trackEvent(eventName,data,value){var slotname=data.slotname,slotType=slotTypes[slotname]||'other',extraParams=data.extraParams||{},forcedLabel=data.state,productChosen=[eventName,data.provider,slotType].join('/');extraParams.pos=data.slotname;stats.allEvents+=1;if(isInteresting(eventName,data)){stats.interestingEvents+=1;adTracker.track(productChosen,extraParams,value,forcedLabel);}}function slotTracker(provider,slotname,source){var timeStart=new Date().getTime(),eventsTracked=[],lastEventTime,i,len;function trackState(timeCheckPoint){var eventName='state/'+timeCheckPoint+'s';setTimeout(function(){trackEvent(eventName,{provider:provider,slotname:slotname,state:eventsTracked.join(',')},lastEventTime*1000);},
timeCheckPoint*1000);}function track(eventName,extraParams){var timeEnd=new Date().getTime(),timeElapsed=(timeEnd-timeStart)/1000;eventsTracked.push(eventName);lastEventTime=timeElapsed;trackEvent(eventName,{provider:provider,slotname:slotname,extraParams:extraParams},timeElapsed*1000);}track('register',{source:source});for(i=0,len=timeCheckpoints.length;i<len;i+=1){trackState(timeCheckpoints[i]);}return{track:track};}function getStats(){return stats;}slotTracker.getStats=getStats;return slotTracker;});;define('ext.wikia.adEngine.slotTweaker',['ext.wikia.adEngine.domElementTweaker','ext.wikia.adEngine.slot.adSlot','wikia.document','wikia.log','wikia.window'],function(DOMElementTweaker,adSlot,doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.slotTweaker',defaultHeightClass='default-height',standardLeaderboardSizeClass='standard-leaderboard';function hide(slotname,useInline){log('hide '+slotname+' using class hidden',6,logGroup);DOMElementTweaker.hide(doc.getElementById(slotname
),useInline);}function show(slotname){log('show '+slotname+' removing class hidden',6,logGroup);var slot=doc.getElementById(slotname);if(slot){DOMElementTweaker.removeClass(slot,'hidden');}}function removeDefaultHeight(slotname){var slot=doc.getElementById(slotname);log('removeDefaultHeight '+slotname,6,logGroup);if(slot){DOMElementTweaker.removeClass(slot,defaultHeightClass);}}function isTopLeaderboard(slotname){return slotname.indexOf('TOP_LEADERBOARD')!==-1;}function isStandardLeaderboardSize(slotname){var slot=doc.getElementById(slotname),isStandardSize;if(slot){isStandardSize=slot.offsetHeight>=90&&slot.offsetHeight<=95&&slot.offsetWidth<=728;log(['isStandardLeaderboardSize',slotname,slot.offsetWidth+'x'+slot.offsetHeight,isStandardSize],3,logGroup);return isStandardSize;}log('isStandardLeaderboardSize: '+slotname+' missing',3,logGroup);}function addDefaultHeight(slotname){var slot=doc.getElementById(slotname);log('addDefaultHeight '+slotname,6,logGroup);if(slot){slot.className+=
' '+defaultHeightClass;}}function adjustLeaderboardSize(slotname){var slot=doc.getElementById(slotname);if(isTopLeaderboard(slotname)&&isStandardLeaderboardSize(slotname)){slot.className+=' '+standardLeaderboardSizeClass;}}function removeTopButtonIfNeeded(slotname){if(isTopLeaderboard(slotname)&&isStandardLeaderboardSize(slotname)){win.Wikia.reviveQueue=win.Wikia.reviveQueue||[];win.Wikia.reviveQueue.push({zoneId:27,slotName:'TOP_BUTTON_WIDE'});}}function onReady(slotName,callback){var iframe=adSlot.getIframe(slotName);if(!iframe){log('onIframeReady - iframe does not exist','debug',logGroup);return;}if(iframe.contentWindow.document.readyState==='complete'){callback(iframe);}else{iframe.addEventListener('load',function(){callback(iframe);});}}function isBlockedElement(original){return original.style.display==='none';}function tweakRecoveredSlot(originalIframe,iframe){var original=originalIframe,target=iframe;while(isBlockedElement(original)){DOMElementTweaker.moveStylesToInline(original
,target,['paddingBottom','opacity']);target.style.display='block';original=original.parentNode;target=target.parentNode;}}function makeResponsive(slotName,aspectRatio){var slot=doc.getElementById(slotName),providerContainer=adSlot.getProviderContainer(slotName);log(['makeResponsive',slotName,aspectRatio],'info',logGroup);slot.classList.add('slot-responsive');onReady(slotName,function(iframe){log(['makeResponsive',slotName],'debug',logGroup);if(!aspectRatio){var height=iframe.contentWindow.document.body.scrollHeight,width=iframe.contentWindow.document.body.scrollWidth;aspectRatio=width/height;}log(['Slot ratio',aspectRatio],'debug',logGroup);providerContainer.style.paddingBottom=100/aspectRatio+'%';});}function adjustIframeByContentSize(slotName){onReady(slotName,function(iframe){var height=iframe.contentWindow.document.body.scrollHeight,width=iframe.contentWindow.document.body.scrollWidth;iframe.width=width;iframe.height=height;log(['adjustIframeByContentSize',slotName,width,height],
'debug',logGroup);});}function collapse(slotName,skipAnimation){var slot=doc.getElementById(slotName);if(!skipAnimation){slot.style.maxHeight=2*slot.scrollHeight+'px';DOMElementTweaker.forceRepaint(slot);}DOMElementTweaker.removeClass(slot,'expanded');DOMElementTweaker.addClass(slot,'collapsed');DOMElementTweaker.addClass(slot,'slot-animation');slot.style.maxHeight='0';}function expand(slotName){var slot=doc.getElementById(slotName);slot.style.maxHeight=slot.offsetHeight+'px';DOMElementTweaker.removeClass(slot,'hidden');DOMElementTweaker.removeClass(slot,'collapsed');DOMElementTweaker.addClass(slot,'expanded');DOMElementTweaker.addClass(slot,'slot-animation');slot.style.maxHeight=2*slot.scrollHeight+'px';}function hackChromeRefresh(slotId){var slot=doc.getElementById(slotId),parent=slot&&slot.parentElement;if(parent&&slotId.match(/^INCONTENT/)){parent.style.display='none';DOMElementTweaker.forceRepaint(parent);parent.style.display='';}}return{addDefaultHeight:addDefaultHeight,
adjustIframeByContentSize:adjustIframeByContentSize,adjustLeaderboardSize:adjustLeaderboardSize,collapse:collapse,expand:expand,hackChromeRefresh:hackChromeRefresh,hide:hide,isTopLeaderboard:isTopLeaderboard,makeResponsive:makeResponsive,onReady:onReady,removeDefaultHeight:removeDefaultHeight,removeTopButtonIfNeeded:removeTopButtonIfNeeded,show:show,tweakRecoveredSlot:tweakRecoveredSlot};});;define('ext.wikia.adEngine.sourcePointDetection',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','wikia.document','wikia.window','wikia.krux','wikia.log'],function(adContext,adTracker,doc,win,krux,log){'use strict';var logGroup='ext.wikia.adEngine.sourcePointDetection',statusTracked=!1,detectionInitialized=!1,spDetectionTime;function getClientId(){log('getClientId','info',logGroup);return'rMbenHBwnMyAMhR';}function sendKruxEvent(value){var eventId='KEa0tIof';if(krux.sendEvent(eventId,{blocking:value})){log(['sendKruxEvent',eventId,value],'debug',logGroup);}}function
trackStatusOnce(value){if(statusTracked){return;}statusTracked=!0;sendKruxEvent(value);spDetectionTime.measureDiff({},'end').track();}function loadLibrary(context){var detectionScript=doc.createElement('script'),node=doc.getElementsByTagName('script')[0];detectionScript.async=!0;detectionScript.type='text/javascript';detectionScript.src=context.opts.sourcePointDetectionUrl;detectionScript.setAttribute('data-client-id',getClientId());log('Appending detection script to head','debug',logGroup);node.parentNode.insertBefore(detectionScript,node);detectionInitialized=!0;}function initDetection(){var context=adContext.getContext();if(!context.opts.sourcePointDetection&&!context.opts.sourcePointDetectionMobile){log(['init','SourcePoint detection disabled'],'debug',logGroup);return;}if(detectionInitialized){log(['init','SourcePoint detection already initialized'],'debug',logGroup);return;}spDetectionTime=adTracker.measureTime('spDetection',{},'start');spDetectionTime.track();log('init',
'debug',logGroup);win.ads.runtime=win.ads.runtime||{};win.ads.runtime.sp=win.ads.runtime.sp||{};win._sp_=win._sp_||{};win._sp_.config=win._sp_.config||{};win._sp_.config.account_id=win._sp_.config.account_id||106;doc.addEventListener('sp.blocking',function(){win.ads.runtime.sp.blocking=!0;trackStatusOnce('yes');log('sp.blocking','info',logGroup);});doc.addEventListener('sp.not_blocking',function(){win.ads.runtime.sp.blocking=!1;trackStatusOnce('no');log('sp.not_blocking','info',logGroup);});if(!context.opts.sourcePointBootstrap){loadLibrary(context);}}return{initDetection:initDetection,getClientId:getClientId};});;define('ext.wikia.adEngine.pageFairDetection',['ext.wikia.adEngine.utils.scriptLoader','wikia.browserDetect','wikia.document','wikia.log','wikia.window'],function(scriptLoader,browserDetect,doc,log,win){'use strict';var context=null,logGroup='ext.wikia.adEngine.pageFairDetection';function isMobileSkin(){return context.targeting.skin==='mercury';}function getWebsiteCode()
{var websiteKeys={mobile:'EFB8C00E91C84764',desktop:'954076792F3C4693'};return isMobileSkin()||browserDetect.isMobile()?websiteKeys.mobile:websiteKeys.desktop;}function dispatchDetectionEvent(eventName){var event=doc.createEvent('Event');event.initEvent(eventName,true,false);doc.dispatchEvent(event);}function setRuntimeParams(isAdBlockDetected){win.ads.runtime=win.ads.runtime||{};win.ads.runtime.pf=win.ads.runtime.pf||{};win.ads.runtime.pf.blocking=isAdBlockDetected;}function detector(isAdBlockDetected){var eventName=isAdBlockDetected?'pf.blocking':'pf.not_blocking';if(!context.opts.pageFairDetection){log('PageFair disabled','debug',logGroup);return null;}log(['PageFair detection, adBlock detected:',isAdBlockDetected],'debug',logGroup);setRuntimeParams(isAdBlockDetected);dispatchDetectionEvent(eventName);}function initDetection(injectedContext){var node=doc.getElementsByTagName('script')[0];context=injectedContext;win.bm_website_code=getWebsiteCode();win.pf_notify=detector;scriptLoader
.loadAsync(context.opts.pageFairDetectionUrl,node);}return{initDetection:initDetection};});;define('ext.wikia.adEngine.dartHelper',['wikia.log','ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.dartUrl','ext.wikia.adEngine.adLogicDartSubdomain'],function(log,adLogicPageParams,dartUrl,adLogicDartSubdomain){'use strict';var logGroup='ext.wikia.adEngine.dartHelper',getUrl,ord=Math.round(Math.random()*23456787654),tile=1,categoryStrMaxLength=300;getUrl=function(params){var slotname=params.slotname,size=params.slotsize,adType=params.adType||'adj',src=params.src||'driver',localTile,localOrd=params.ord||ord,url,subdomain=params.subdomain||(adLogicDartSubdomain&&adLogicDartSubdomain.getSubdomain()),pageParams=adLogicPageParams.getPageLevelParams(),name,value;if(adType==='jwplayer'){adType='pfadx';}if(params.tile){localTile=params.tile;}else{localTile=tile;tile+=1;}log(['getUrl',slotname,size],5,logGroup);url=dartUrl.urlBuilder(subdomain+'.doubleclick.net',adType+'/'+'wka.'+pageParams.
s0+'/'+pageParams.s1+'/'+pageParams.s2);for(name in pageParams){if(pageParams.hasOwnProperty(name)){value=pageParams[name];if(value){if(name==='cat'){url.addParam(name,value,categoryStrMaxLength);}else if(name==='ksgmnt'){url.addParam(name,value,true);}else{url.addParam(name,value);}}}}url.addParam('src',src);url.addString('mtfIFPath=/extensions/wikia/AdEngine/;');url.addParam('mtfInline','true');url.addParam('pos',params.slotname);url.addParam('loc',params.loc);url.addParam('dcopt',params.dcopt);url.addParam('sz',size);url.addParam('tile',localTile);url.addString('endtag=$;');url.addString('ord='+localOrd+'?');log(url.toString(),5,logGroup);return url.toString();};return{getUrl:getUrl};});;define('ext.wikia.adEngine.config.desktop',['wikia.log','wikia.window','wikia.instantGlobals','wikia.geo','ext.wikia.adEngine.adContext','ext.wikia.adEngine.adDecoratorPageDimensions','ext.wikia.adEngine.provider.directGpt','ext.wikia.adEngine.provider.evolve2',
'ext.wikia.adEngine.provider.remnantGpt','ext.wikia.adEngine.provider.turtle'],function(log,window,instantGlobals,geo,adContext,adDecoratorPageDimensions,adProviderDirectGpt,adProviderEvolve2,adProviderRemnantGpt,adProviderTurtle){'use strict';var logGroup='ext.wikia.adEngine.adConfigLate',context=adContext.getContext(),gptEnabled=!instantGlobals.wgSitewideDisableGpt,forcedProviders={evolve2:[adProviderEvolve2],turtle:[adProviderTurtle]};function getDecorators(){return[adDecoratorPageDimensions];}function getProviderList(slotName){var providerList=[];log('getProvider',5,logGroup);log(slotName,5,logGroup);if(!context.opts.showAds){return[];}if(context.forcedProvider&&!!forcedProviders[context.forcedProvider]){log(['getProvider',slotName,context.forcedProvider+' (wgAdDriverForcedProvider)'],'info',logGroup);return forcedProviders[context.forcedProvider];}if(context.providers.turtle&&adProviderTurtle.canHandleSlot(slotName)){providerList.push(adProviderTurtle);}else if(context.providers.
evolve2&&adProviderEvolve2.canHandleSlot(slotName)){providerList.push(adProviderEvolve2);}else if(gptEnabled){providerList.push(adProviderDirectGpt);if(context.opts.premiumOnly){return providerList;}}if(gptEnabled){providerList.push(adProviderRemnantGpt);}return providerList;}return{getDecorators:getDecorators,getProviderList:getProviderList};});;define('ext.wikia.adEngine.provider.btfBlocker',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','wikia.lazyqueue','wikia.log','wikia.window'],function(adContext,uapContext,lazyQueue,log,win){'use strict';var logGroup='ext.wikia.adEngine.provider.btfBlocker',unblockedSlots=[];win.ads=win.ads||{};win.ads.runtime=win.ads.runtime||{};win.ads.runtime.disableBtf=!1;win.ads.runtime.unblockHighlyViewableSlots=!1;function unblock(slotName){log(['unblocking',slotName],log.levels.info,logGroup);unblockedSlots.push(slotName);}function isBTFDisabledByCreative(){return win.ads.runtime.disableBtf;}function decorate(fillInSlot,
config){var btfQueue=[],btfQueueStarted=!1,pendingAtfSlots=[];adContext.addCallback(function(){btfQueue=[];btfQueueStarted=!1;pendingAtfSlots=[];win.ads.runtime.disableBtf=!1;win.ads.runtime.unblockHighlyViewableSlots=!1;unblockedSlots=[];});win.addEventListener('wikia.blocking',startBtfQueue);function processBtfSlot(slot){if(uapContext.isUapLoaded()&&slot.name==='INVISIBLE_HIGH_IMPACT_2'){log(['IHI2 disabled when UAP on page'],log.levels.info,logGroup);return;}if(win.ads.runtime.unblockHighlyViewableSlots&&config.highlyViewableSlots){log(['Unblocking HiVi slots',slot.name],log.levels.info,logGroup);config.highlyViewableSlots.map(unblock);}if(unblockedSlots.indexOf(slot.name)>-1||!isBTFDisabledByCreative()){log(['Filling slot',slot.name],log.levels.info,logGroup);fillInSlot(slot);return;}slot.collapse({adType:'blocked'});}function startBtfQueue(){log('startBtfQueue',log.levels.info.debug,logGroup);if(btfQueueStarted){return;}lazyQueue.makeQueue(btfQueue,processBtfSlot);
btfQueue.start();btfQueueStarted=!0;}function onSlotResponse(slotName){log(['onSlotResponse',slotName],log.levels.info.debug,logGroup);var index=pendingAtfSlots.indexOf(slotName);if(index>-1){pendingAtfSlots.splice(index,1);log(['remove from pendingAtfSlots',pendingAtfSlots,slotName],log.levels.debug,logGroup);if(pendingAtfSlots.length===0){win.setTimeout(startBtfQueue,0);}}}function shouldDelaySlotFillIn(slotName){var shouldDelay=adContext.getContext().opts.delayBtf;log(['shouldDelaySlotFillIn',shouldDelay,slotName],log.levels.debug,logGroup);return shouldDelay;}function fillInSlotWithDelay(slot){log(['fillInSlotWithDelay',slot.name],log.levels.info.debug,logGroup);function fillInSlotOnResponse(){onSlotResponse(slot.name);}if(!shouldDelaySlotFillIn(slot.name)){fillInSlot(slot);return;}if(config.atfSlots.indexOf(slot.name)>-1){pendingAtfSlots.push(slot.name);slot.pre('renderEnded',fillInSlotOnResponse);slot.pre('collapse',fillInSlotOnResponse);slot.pre('hop',fillInSlotOnResponse);
slot.pre('success',fillInSlotOnResponse);fillInSlot(slot);return;}btfQueue.push(slot);}return fillInSlotWithDelay;}return{decorate:decorate,unblock:unblock};});;define('ext.wikia.adEngine.provider.directGpt',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.provider.factory.wikiaGpt','ext.wikia.adEngine.slot.service.kiloAdUnitBuilder','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','ext.wikia.adEngine.slotTweaker',require.optional('ext.wikia.aRecoveryEngine.instartLogic.recovery'),require.optional('ext.wikia.aRecoveryEngine.pageFair.recovery'),require.optional('ext.wikia.aRecoveryEngine.sourcePoint.recovery')],function(adContext,uapContext,factory,kiloAdUnitBuilder,megaAdUnitBuilder,slotTweaker,instartLogic,pageFair,sourcePoint){'use strict';var context=adContext.getContext(),sraEnabled=!context.opts.disableSra,atfSlots=['TOP_LEADERBOARD','GPT_FLUSH'];if(sraEnabled){atfSlots.push('TOP_RIGHT_BOXAD','INVISIBLE_SKIN');}return factory.
createProvider('ext.wikia.adEngine.provider.directGpt','DirectGpt','gpt',{BOTTOM_LEADERBOARD:{size:'728x90,970x250',loc:'footer'},GPT_FLUSH:{flushOnly:!0},INCONTENT_BOXAD_1:{size:'120x600,160x600,300x250,300x600',loc:'hivi'},INCONTENT_PLAYER:{size:'1x1',loc:'middle'},INVISIBLE_HIGH_IMPACT_2:{loc:'hivi'},INVISIBLE_SKIN:{size:'1000x1000,1x1',loc:'top'},TOP_LEADERBOARD:{size:'3x3,728x90,1030x130,1030x65,1030x250,970x365,970x250,970x90,970x66,970x180,980x150,1024x416,1440x585',loc:'top'},TOP_RIGHT_BOXAD:{size:'300x250,300x600,300x1050',loc:'top'}},{afterSuccess:function(slotName){slotTweaker.removeDefaultHeight(slotName);if(!uapContext.isBfaaLoaded()){slotTweaker.removeTopButtonIfNeeded(slotName);slotTweaker.adjustLeaderboardSize(slotName);}},isInstartLogicRecoverable:instartLogic?instartLogic.isSlotRecoverable:false,isPageFairRecoverable:pageFair?pageFair.isSlotRecoverable:false,isSourcePointRecoverable:sourcePoint?sourcePoint.isSlotRecoverable:false,sraEnabled:sraEnabled,atfSlots:
atfSlots,getAdUnitBuilder:function(){return context.opts.megaAdUnitBuilderEnabled?megaAdUnitBuilder:kiloAdUnitBuilder;},highlyViewableSlots:['INCONTENT_BOXAD_1','INCONTENT_PLAYER','INVISIBLE_HIGH_IMPACT_2','TOP_RIGHT_BOXAD'],testSrc:'test'});});;define('ext.wikia.adEngine.provider.factory.wikiaGpt',['ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.provider.gpt.helper','ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.adEngine.slot.service.slotRegistry','wikia.log',require.optional('ext.wikia.adEngine.lookup.services')],function(btfBlocker,gptHelper,defaultAdUnitBuilder,slotRegistry,log,lookups){'use strict';function rewriteExtras(slotName,extra){return{testSrc:extra.testSrc,sraEnabled:extra.sraEnabled,isInstartLogicRecoverable:extra.isInstartLogicRecoverable?extra.isInstartLogicRecoverable(slotName):false,isPageFairRecoverable:extra.isPageFairRecoverable?extra.isPageFairRecoverable(slotName):false,isSourcePointRecoverable:extra.isSourcePointRecoverable?extra.
isSourcePointRecoverable(slotName):false};}function createProvider(logGroup,providerName,src,slotMap,extra){extra=extra||{};function canHandleSlot(slotName){log(['canHandleSlot',slotName],'debug',logGroup);var ret=!!slotMap[slotName];log(['canHandleSlot',slotName,ret],'debug',logGroup);return ret;}function addHook(slot,hookName,callback){log([hookName,slot.name],'debug',logGroup);slot.post(hookName,function(adInfo){if(typeof callback==='function'){callback(slot.name,adInfo);}});}function getAdUnit(slot){if(extra.getAdUnitBuilder){return extra.getAdUnitBuilder().build(slot.name,src);}return defaultAdUnitBuilder.build(slot.name,src);}function fillInSlot(slot){log(['fillInSlot',slot.name,providerName],'debug',logGroup);var slotPath=getAdUnit(slot),slotTargeting=JSON.parse(JSON.stringify(slotMap[slot.name]));addHook(slot,'success',extra.afterSuccess);addHook(slot,'collapse',extra.afterCollapse);addHook(slot,'hop',extra.afterHop);addHook(slot,'renderEnded',extra.onSlotRendered);
slotTargeting.pos=slotTargeting.pos||slot.name;slotTargeting.src=src;slotTargeting.rv=slotRegistry.getRefreshCount(slot.name).toString();if(lookups){lookups.storeRealSlotPrices(slot.name);lookups.extendSlotTargeting(slot.name,slotTargeting,providerName);slotRegistry.storeScrollY(slot.name);}gptHelper.pushAd(slot,slotPath,slotTargeting,rewriteExtras(slot.name,extra));log(['fillInSlot',slot.name,providerName,'done'],'debug',logGroup);}return{name:providerName,canHandleSlot:canHandleSlot,fillInSlot:extra.atfSlots?btfBlocker.decorate(fillInSlot,extra):fillInSlot};}return{createProvider:createProvider};});;define('ext.wikia.adEngine.provider.gpt.adDetect',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.messageListener','ext.wikia.adEngine.slotTweaker','wikia.log','wikia.window'],function(adContext,uapContext,messageListener,slotTweaker,log,win){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.adDetect',specialAdSelector=[
'script[src*="/ads.saymedia.com/"]','script[src*="/native.sharethrough.com/"]','.celtra-ad-v3, script[src$="/mmadlib.js"]'].join(',');function isMobile(){var skin=adContext.getContext().targeting.skin;return(skin==='wikiamobile'||skin==='mercury');}function isImagePresent(document){var imgs,i,len,w,h;imgs=document.querySelectorAll('img[width], img[height]');for(i=0,len=imgs.length;i<len;i+=1){w=imgs[i].getAttribute('width');h=imgs[i].getAttribute('height');if(w>1||h>1){log(['findAdImage','found non-1x1 img'],'info',logGroup);return true;}}return false;}function findAdInIframe(slotName,iframe,adCallback,noAdCallback){var iframeHeight,iframeContentHeight,iframeDoc;try{iframeDoc=iframe.contentWindow.document;}catch(e){log(['findAdInIframe',slotName,'ad iframe not accessible (or not found): assuming success'],'error',logGroup);return adCallback();}iframeHeight=iframe.height;iframe.height=0;iframeContentHeight=iframeDoc.body.offsetHeight;iframe.height=iframeHeight;log(['findAdInIframe',
slotName,'height (iframe content)',iframeContentHeight],'info',logGroup);if(iframeContentHeight>1){log(['findAdInIframe',slotName,'height > 1, launching adCallback'],'info',logGroup);return adCallback();}if(isImagePresent(iframeDoc)){log(['findAdInIframe',slotName,'image, launching adCallback'],'info',logGroup);return adCallback();}log(['findAdInIframe',slotName,'launching noAdCallback'],'info',logGroup);noAdCallback();}function inspectIframe(slotName,iframe,adCallback,noAdCallback){if(iframe.contentWindow.document.readyState==='complete'){log(['onAdLoad',slotName,'iframe state complete'],'info',logGroup);setTimeout(function(){findAdInIframe(slotName,iframe,adCallback,noAdCallback);},0);}else{log(['onAdLoad',slotName,'binding to iframe onload'],'info',logGroup);iframe.contentWindow.addEventListener('load',function(){findAdInIframe(slotName,iframe,adCallback,noAdCallback);});}}function getIframeOk(iframe,slotName){try{return!!iframe.contentWindow.document.querySelector;}catch(e){log([
'getIframeOk',slotName,'ad iframe not accessible (or not found)'],'error',logGroup);}return false;}function getAdType(slotName,gptEvent,iframe){var status,height,gptEmpty,iframeOk;log(['getAdType',slotName],'info',logGroup);iframeOk=getIframeOk(iframe,slotName);if(iframeOk&&iframe.contentWindow.AdEngine_adType){log(['getAdType',slotName,'iframe AdEngine_adType = ',iframe.contentWindow.AdEngine_adType],'info',logGroup);return iframe.contentWindow.AdEngine_adType;}status=win.adDriver2ForcedStatus&&win.adDriver2ForcedStatus[slotName];if(status==='success'){return'forced_success';}height=gptEvent.size&&gptEvent.size[1];gptEmpty=gptEvent.isEmpty;if(gptEvent.slot&&gptEvent.slot.getOutOfPage&&gptEvent.slot.getOutOfPage()){log(['getAdType',slotName,'out of page ad','always_success'],'info',logGroup);return'always_success';}if(gptEmpty){log(['getAdType',slotName,'ad is empty (GPT event)','empty'],'info',logGroup);return'empty';}if(height<=1){log(['getAdType',slotName,'ad has no size',
'no_height'],'info',logGroup);return'no_height';}if(!isMobile()){log(['getAdType',slotName,'not mobile','always_success'],'info',logGroup);return'always_success';}if(!iframeOk){log(['getAdType',slotName,'running ad callback (!iframeOk)','always_success'],'info',logGroup);return'always_success';}if(gptEvent.creativeId===null&&gptEvent.lineItemId===null){log(['getAdType',slotName,'creativeId and lineItemId are null','always_success'],'error',logGroup);return'always_success';}if(iframe.contentWindow.document.querySelector(specialAdSelector)){log(['getAdType',slotName,'special ad'],'info',logGroup);return'always_success';}log(['getAdType',slotName,'inspect_iframe'],'info',logGroup);return'inspect_iframe';}function getAdProduct(slotName,iframe){var iframeOk=getIframeOk(iframe,slotName);if(iframeOk&&iframe.contentWindow.AdEngine_adProduct){log(['getAdProduct',slotName,'iframe AdEngine_adProduct = ',iframe.contentWindow.AdEngine_adProduct],'info',logGroup);return iframe.contentWindow.
AdEngine_adProduct;}return'other';}function isPartnerAdType(adType){return(/^partner\/[a-zA-Z0-9]{1,30}$/).test(adType);}function onAdLoad(slot,gptEvent,iframe,forcedAdType){var adProduct=getAdProduct(slot.name,iframe),adType=forcedAdType||getAdType(slot.name,gptEvent,iframe),isCollapsed=!1,shouldPollForSuccess=!1,expectAsyncCollapse=!1,expectAsyncHop=!1,expectAsyncHopWithSlotName=!1,expectAsyncSuccessWithSlotName=!1,expectAsyncSuccess=!1,successTimer;function noop(){return;}function callAdCallback(adInfo){adInfo=adInfo||{};adInfo.adType=adType;adInfo.adProduct=adProduct;clearTimeout(successTimer);slot.success(adInfo);}function callCollapseAdCallback(adInfo){adInfo=adInfo||{};adInfo.adType=adType;adInfo.adProduct=adProduct;isCollapsed=!0;clearTimeout(successTimer);slot.collapse(adInfo);}function callNoAdCallback(adInfo){adInfo=adInfo||{};adInfo.adType=adType;adInfo.adProduct=adProduct;clearTimeout(successTimer);slot.hop(adInfo);}function pollForSuccess(){if(
isCollapsed){return;}successTimer=setTimeout(function(){log(['pollForSuccess',slot.name],'info',logGroup);pollForSuccess();findAdInIframe(slot.name+' (poll)',iframe,callAdCallback,noop);},500);}function handleAsyncMessage(status,isExpected,callback){if(isExpected){callback();}else{log(['msgCallback',slot.name,status,'Got asynchronous message, while not expecting it'],'error',logGroup);}}function msgCallback(data){log(['msgCallback',slot.name,'caught message',data],'info',logGroup);switch(data.status){case'success':handleAsyncMessage('success',expectAsyncSuccess||expectAsyncSuccessWithSlotName,function(){callAdCallback(data.extra);});break;case'collapse':handleAsyncMessage('collapse',expectAsyncCollapse,function(){callCollapseAdCallback(data.extra);});break;case'hop':handleAsyncMessage('hop',expectAsyncHop||expectAsyncHopWithSlotName,function(){callNoAdCallback(data.extra);});break;}}if(uapContext.shouldDispatchEvent(slot.name)){uapContext.dispatchEvent();}if(adType==='manual'){return;}
if(['rubicon','saymedia','turtle','evolve2'].indexOf(adType)!==-1||isPartnerAdType(adType)){shouldPollForSuccess=!0;expectAsyncCollapse=!0;expectAsyncHop=!0;}if(adType==='async'){expectAsyncHop=!0;expectAsyncSuccess=!0;}if(adType==='highimpact'){expectAsyncHopWithSlotName=!0;expectAsyncSuccessWithSlotName=!0;}log(['onAdLoad',slot.name,'adType',adType],'info',logGroup);if(adType==='forced_success'||adType==='always_success'){return callAdCallback();}if(adType==='collapse'||adType==='empty'){return callCollapseAdCallback();}if(adType==='no_height'){return callNoAdCallback();}if(adType==='inspect_iframe'){return inspectIframe(slot.name,iframe,callAdCallback,callNoAdCallback);}if(shouldPollForSuccess){slotTweaker.onReady(slot.name,pollForSuccess);}if(expectAsyncHop||expectAsyncSuccess||expectAsyncCollapse){messageListener.register({source:iframe.contentWindow,dataKey:'status'},msgCallback);}if(expectAsyncHopWithSlotName||expectAsyncSuccessWithSlotName){messageListener.
register({dataKey:'slot_'+slot.name},msgCallback);}if(expectAsyncHop||expectAsyncHopWithSlotName){if(shouldPollForSuccess||expectAsyncSuccess||expectAsyncSuccessWithSlotName){return;}}log(['onAdLoad','Unknown ad type (launching starting ad callback)',adType],'error',logGroup);adType='unknown';return callAdCallback();}return{onAdLoad:onAdLoad};});;define('ext.wikia.adEngine.provider.gpt.adElement',['ext.wikia.adEngine.provider.gpt.adSizeConverter','ext.wikia.adEngine.provider.gpt.adSizeFilter','wikia.document','wikia.log'],function(adSizeConverter,adSizeFilter,doc,log){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.adElement';function AdElement(slotName,slotPath,slotTargeting){this.id='wikia_gpt'+slotPath;this.node=doc.getElementById(this.id);this.slotPath=slotPath;this.slotName=slotName;this.slotContainerId=this.id;if(!this.node){this.node=doc.createElement('div');this.node.id=this.id;}if(slotTargeting.size){this.sizes=adSizeConverter.toArray(slotTargeting.size);this.sizes=
adSizeFilter.filter(slotName,this.sizes);delete slotTargeting.size;this.node.setAttribute('data-gpt-slot-sizes',JSON.stringify(this.sizes));}else{this.node.setAttribute('data-gpt-slot-type','out-of-page');}this.slotTargeting=slotTargeting;log(['AdElement',this],'debug',logGroup);}AdElement.prototype.getId=function(){return this.id;};AdElement.prototype.getSlotContainerId=function(){return this.slotContainerId;};AdElement.prototype.setSlotContainerId=function(slotContainerId){this.slotContainerId=slotContainerId;};AdElement.prototype.getSlotName=function(){return this.slotName;};AdElement.prototype.setSlotName=function(slotName){this.slotName=slotName;};AdElement.prototype.getNode=function(){return this.node;};AdElement.prototype.getSlotPath=function(){return this.slotPath;};AdElement.prototype.getSizes=function(){return this.sizes;};AdElement.prototype.configureSlot=function(slot){return AdElement.configureSlot(slot,this.slotTargeting,this.node);};AdElement.prototype.setPageLevelParams
=function(pageLevelParams){log(['setPageLevelParams',pageLevelParams],'debug',logGroup);this.node.setAttribute('data-gpt-page-params',JSON.stringify(pageLevelParams));};AdElement.prototype.updateDataParams=function(event){this.node.setAttribute('data-gpt-line-item-id',JSON.stringify(event.lineItemId));this.node.setAttribute('data-gpt-creative-id',JSON.stringify(event.creativeId));this.node.setAttribute('data-gpt-creative-size',JSON.stringify(event.size));};AdElement.configureSlot=function(slot,targeting,node){var name,value;for(name in targeting){if(targeting.hasOwnProperty(name)){value=targeting[name];if(value){log(['setSlot','slot.setTargeting',name,value],'debug',logGroup);slot.setTargeting(name,value);}}}if(!node){log(['setSlot','HTML node not provided, trying to retrieve from slot',slot],'debug',logGroup);node=doc.getElementById(slot.getSlotElementId());}log(['setSlot',slot],'debug',logGroup);node.setAttribute('data-gpt-slot-params',JSON.stringify(targeting));};return AdElement;})
;;define('ext.wikia.adEngine.provider.gpt.adSizeFilter',['ext.wikia.adEngine.adContext','wikia.document','wikia.log','wikia.window'],function(adContext,doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.adSizeFilter',context=adContext.getContext(),minSkinWidth=1240;function getNewSizes(sizes,maxWidth,fallbackSizes){var goodSizes=(sizes||[]).filter(function(size){return size[0]<=maxWidth;});log(['getNewSizes','sizes: ',sizes,'goodSizes: ',goodSizes],'debug',logGroup);return goodSizes.length?goodSizes:fallbackSizes;}function getAdContext(){return win.Mercury?win.Mercury.Modules.Ads.getInstance().adsContext:win.ads.context;}function removeUAPForFeaturedVideoPages(slotName,slotSizes){var adContext=getAdContext();if(slotName.indexOf('TOP_LEADERBOARD')>-1&&adContext&&adContext.targeting&&adContext.targeting.hasFeaturedVideo){slotSizes.forEach(function(size,index,array){var str=size.toString();if(str==='2,2'||str==='3,3'){array.splice(index,1);}});}return slotSizes;}
function filterSizes(slotName,slotSizes){log(['filterSizes',slotName,slotSizes],'debug',logGroup);removeUAPForFeaturedVideoPages(slotName,slotSizes);switch(true){case slotName.indexOf('TOP_LEADERBOARD')>-1:return getNewSizes(slotSizes,doc.documentElement.offsetWidth,[[728,90]]);case slotName==='INVISIBLE_SKIN':return doc.documentElement.offsetWidth>=minSkinWidth?slotSizes:[[1,1]];case slotName==='BOTTOM_LEADERBOARD':return getNewSizes(slotSizes,doc.getElementById('WikiaFooter').offsetWidth,[[728,90]]);case slotName==='INCONTENT_BOXAD_1'&&context.targeting.hasFeaturedVideo:return[[300,250]];default:return slotSizes;}}return{filter:filterSizes};});;define('ext.wikia.adEngine.provider.gpt.adSizeConverter',['wikia.log'],function(log){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.adSizeConverter';function convertToArray(slotSizes){log(['convertSizeToGpt',slotSizes],'debug',logGroup);var tmp1=slotSizes.split(','),sizes=[],tmp2,i;for(i=0;i<tmp1.length;i+=1){tmp2=tmp1[i].split('x'
);sizes.push([parseInt(tmp2[0],10),parseInt(tmp2[1],10)]);}log(['convertSize',slotSizes,sizes],'debug',logGroup);return sizes;}return{toArray:convertToArray};});;define('ext.wikia.adEngine.provider.gpt.googleTag',['ext.wikia.adEngine.provider.gpt.googleSlots','ext.wikia.adEngine.slot.adSlot','ext.wikia.adEngine.slot.service.slotRegistry','ext.wikia.adEngine.slot.service.srcProvider','wikia.document','wikia.log','wikia.window'],function(googleSlots,adSlot,slotRegistry,srcProvider,doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.googleTag',slotQueue=[],pageLevelParams,initialized=!1;win.googletag=win.googletag||{};win.googletag.cmd=win.googletag.cmd||[];function dispatchEvent(event,methodName){var slot,slotName=adSlot.getShortSlotName(event.slot.getName());log(['dispatchEvent',event],log.levels.info,logGroup);slot=slotRegistry.get(slotName);if(slot&&slot[methodName]){slot[methodName](event);}else{log(['dispatchEvent',event,'Slot not registered'],log.levels.error
,logGroup);}}function push(callback){win.googletag.cmd.push(callback);}function enableServices(){log(['enableServices','push'],log.levels.info,logGroup);push(function(){win.googletag.pubads().collapseEmptyDivs();win.googletag.pubads().enableSingleRequest();win.googletag.pubads().disableInitialLoad();win.googletag.pubads().addEventListener('slotRenderEnded',function(event){dispatchEvent(event,'renderEnded');});win.googletag.pubads().addEventListener('impressionViewable',function(event){dispatchEvent(event,'viewed');});win.googletag.enableServices();log(['enableServices','push','done'],log.levels.debug,logGroup);});}function canGptBeLoaded(){return!win.googletag.apiReady;}function init(){log('init',log.levels.debug,logGroup);var gads=doc.createElement('script'),node=doc.getElementsByTagName('script')[0];if(canGptBeLoaded()){gads.async=!0;gads.type='text/javascript';gads.src='//www.googletagservices.com/tag/js/gpt.js';log('Appending GPT script to head',log.levels.debug,logGroup);node.
parentNode.insertBefore(gads,node);}initialized=!0;enableServices();}function isInitialized(){log(['isInitialized',initialized],log.levels.debug,logGroup);return initialized;}function setPageLevelParams(params){push(function(){var name,value;pageLevelParams=params;for(name in pageLevelParams){if(pageLevelParams.hasOwnProperty(name)){value=pageLevelParams[name];if(value){log(['setPageLevelParams','pubAds.setTargeting',name,value],log.levels.debug,logGroup);win.googletag.pubads().setTargeting(name,value);}}}});}function flush(){if(!isInitialized()){log(['flush','done','No slots to flush'],log.levels.info,logGroup);return;}push(function(){log(['flush','start'],log.levels.info,logGroup);log(['flush','refresh',slotQueue],log.levels.debug,logGroup);if(slotQueue.length){win.googletag.pubads().refresh(slotQueue,{changeCorrelator:!1});slotQueue=[];}log(['flush','done'],log.levels.info,logGroup);});}function updateTargetingForBlockedTraffic(){win.googletag.pubads().getSlots().forEach(
function(slot){if(slot.targeting){slot.targeting.src=[];}slot.setTargeting('src',srcProvider.getRecoverySrc());});}function addSlot(adElement){var sizes=adElement.getSizes(),slotId=adElement.getId(),slot=googleSlots.getSlot(slotId);log(['addSlot',adElement],log.levels.debug,logGroup);adElement.setPageLevelParams(pageLevelParams);if(!slot){slot=sizes?win.googletag.defineSlot(adElement.getSlotPath(),sizes,slotId):win.googletag.defineOutOfPageSlot(adElement.getSlotPath(),slotId);slot.addService(win.googletag.pubads());win.googletag.display(slotId);googleSlots.addSlot(slot);}adElement.configureSlot(slot);slotQueue.push(slot);return slot;}function refreshSlot(slot){win.googletag.pubads().refresh([slot]);}function onAdLoad(slotName,element,gptEvent,onAdLoadCallback){log(['onAdLoad',slotName],log.levels.info,logGroup);var iframe=adSlot.getIframe(slotName);onAdLoadCallback(element.getId(),gptEvent,iframe);}function isGoogleTagLoaded(){return typeof win.googletag.pubads==='function';}function
destroySlots(slotsNames){var allSlots,slotsToDestroy=[],success;if(!isInitialized()){return;}if(!isGoogleTagLoaded()){log(['destroySlots','pubads not yet available','resetting cmd'],log.levels.info,logGroup);win.googletag.cmd=[];enableServices();return;}allSlots=win.googletag.pubads().getSlots();if(!slotsNames){slotsToDestroy=allSlots;}else{allSlots.forEach(function(slot){var slotsPositionTargeting=slot.getTargeting('pos');if(!slotsPositionTargeting.length){log(['destroySlots','getTargeting doesn\'t return pos',slotsPositionTargeting,slot],log.levels.error,logGroup);}else{if(slotsNames.indexOf(slotsPositionTargeting[0])>-1){slotsToDestroy.push(slot);}}});}if(slotsToDestroy.length){push(function(){log(['destroySlots',slotsNames,slotsToDestroy],log.levels.debug,logGroup);success=win.googletag.destroySlots(slotsToDestroy);if(!success){log(['destroySlots',slotsNames,slotsToDestroy,'failed'],log.levels.error,logGroup);}googleSlots.removeSlots(slotsToDestroy);});}else{log(['destroySlots',
'no slots returned to destroy',allSlots,slotsNames],log.levels.debug,logGroup);}}function updateCorrelator(){push(function(){win.googletag.pubads().updateCorrelator();});}return{addSlot:addSlot,destroySlots:destroySlots,updateTargetingForBlockedTraffic:updateTargetingForBlockedTraffic,flush:flush,init:init,isInitialized:isInitialized,onAdLoad:onAdLoad,push:push,refreshSlot:refreshSlot,setPageLevelParams:setPageLevelParams,updateCorrelator:updateCorrelator};});;define('ext.wikia.adEngine.provider.gpt.googleSlots',['ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.window'],function(adUnitBuilder,adBlockDetection,win){'use strict';var slots={};function addSlot(slot){var slotId=slot.getSlotElementId();slots[slotId]=slot;}function removeSlots(slotsToRemove){slotsToRemove.forEach(function(slot){slots[slot.getSlotElementId()]=undefined;});}function getSlot(id){var slotId=id;if(adBlockDetection.isBlocking()&&win._sp_&&win._sp_.getElementId){slotId=win.
_sp_.getElementId(slotId);}return slots[slotId];}function getSlotByName(slotName){var adUnit=adUnitBuilder.build(slotName,'gpt');return getSlot('wikia_gpt'+adUnit);}return{addSlot:addSlot,getSlot:getSlot,getSlotByName:getSlotByName,removeSlots:removeSlots};});;define('ext.wikia.adEngine.provider.gpt.helper',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.provider.gpt.adDetect','ext.wikia.adEngine.provider.gpt.adElement','ext.wikia.adEngine.provider.gpt.googleTag','ext.wikia.adEngine.provider.gpt.googleSlots','ext.wikia.adEngine.provider.gpt.targeting','ext.wikia.adEngine.slot.service.passbackHandler','ext.wikia.adEngine.slot.service.srcProvider','ext.wikia.adEngine.slot.slotTargeting','ext.wikia.aRecoveryEngine.adBlockDetection','ext.wikia.aRecoveryEngine.adBlockRecovery','ext.wikia.adEngine.slotTweaker','wikia.document','wikia.geo','wikia.instantGlobals','wikia.log','wikia.window',require.optional(
'ext.wikia.adEngine.provider.gpt.sraHelper'),require.optional('ext.wikia.aRecoveryEngine.instartLogic.recovery'),require.optional('ext.wikia.aRecoveryEngine.pageFair.recovery')],function(adContext,adLogicPageParams,uapContext,adDetect,AdElement,googleTag,googleSlots,gptTargeting,passbackHandler,srcProvider,slotTargeting,adBlockDetection,adBlockRecovery,slotTweaker,doc,geo,instantGlobals,log,win,sraHelper,instartLogic,pageFair){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.helper',hiddenSlots=['INCONTENT_PLAYER'];function isHiddenOnStart(slotName){return hiddenSlots.indexOf(slotName)!==-1;}function isRecoverableByIL(){return instartLogic&&instartLogic.isEnabled()&&instartLogic.isBlocking();}function pushAd(slot,slotPath,slotTargetingData,extra){extra=extra||{};var element,isBlocking=adBlockDetection.isBlocking(),isRecoveryEnabled=adBlockRecovery.isEnabled(),adIsRecoverable=extra.isPageFairRecoverable||extra.isInstartLogicRecoverable,adShouldBeRecovered=isRecoveryEnabled&&
isBlocking&&adIsRecoverable,shouldPush=!isBlocking||adShouldBeRecovered,slotName=slot.name,uapId=uapContext.getUapId();log(['isRecoveryEnabled, isBlocking, adIsRecoverable',slot.name,isRecoveryEnabled,isBlocking,adIsRecoverable],log.levels.debug,logGroup);slotTargetingData=JSON.parse(JSON.stringify(slotTargetingData));if(isHiddenOnStart(slotName)){slotTweaker.hide(slotName);slot.pre('success',function(){slotTweaker.show(slotName);});}setAdditionalTargeting(slotTargetingData);element=new AdElement(slotName,slotPath,slotTargetingData);if(pageFair&&extra.isPageFairRecoverable){log(['Adding adonis-marker to slot',slot],log.levels.debug,logGroup);pageFair.addMarker(element.node);}function queueAd(){log(['queueAd',slotName,element],log.levels.debug,logGroup);slot.container.appendChild(element.getNode());googleTag.addSlot(element);}function setAdditionalTargeting(slotTargetingData){var abId;if(isRecoverableByIL()){slotTargetingData.requestSource='instartLogic';}if(slotTargetingData.src){
slotTargetingData.src=srcProvider.get(slotTargetingData.src,extra);}slotTargetingData.passback=passbackHandler.get(slotName)||'none';slotTargetingData.wsi=slotTargeting.getWikiaSlotId(slotName,slotTargetingData.src);slotTargetingData.uap=uapId?uapId.toString():'none';slotTargetingData.outstream=slotTargeting.getOutstreamData()||'none';if(adContext.get('targeting.skin')==='oasis'){slotTargetingData.rail=doc.body.scrollWidth<=1023?'0':'1';}abId=slotTargeting.getAbTestId(slotTargetingData);if(abId){slotTargetingData.abi=abId;}if(geo.isProperGeo(instantGlobals.wgAdDriverLBScrollExperimentCountires)&&instantGlobals.wgAdDriverLBScrollExperimentBucket>0){slotTargetingData.scrolltop='top_'+Math.floor(win.scrollY/instantGlobals.wgAdDriverLBScrollExperimentBucket)*instantGlobals.wgAdDriverLBScrollExperimentBucket;}}function onAdLoadCallback(slotElementId,gptEvent,iframe){setTimeout(function(){log(['onAdLoadCallback',slotElementId],log.levels.info,logGroup);adDetect.onAdLoad(slot,gptEvent,iframe,
extra.forcedAdType);},0);}function gptCallback(gptEvent){log(['gptCallback',element.getId(),gptEvent],log.levels.info,logGroup);element.updateDataParams(gptEvent);googleTag.onAdLoad(slotName,element,gptEvent,onAdLoadCallback);}if(!googleTag.isInitialized()){googleTag.init();googleTag.setPageLevelParams(adLogicPageParams.getPageLevelParams());}if(!shouldPush){log(['Push blocked',slotName],log.levels.debug,logGroup);slot.collapse();return;}log(['pushAd',slotName,slotTargetingData],log.levels.info,logGroup);if(!slotTargetingData.flushOnly){slot.pre('renderEnded',gptCallback);googleTag.push(queueAd);}if(!sraHelper||!extra.sraEnabled||sraHelper.shouldFlush(slotName)){log('flushing',log.levels.debug,logGroup);googleTag.flush();}if(slotTargetingData.flushOnly){log(['flushOnly - success',slotName],log.levels.debug,logGroup);slot.success();}}function refreshSlot(slotName){var slot=googleSlots.getSlotByName(slotName),targeting;if(slot){log(['Refresh slot',slotName,slot],log.levels.debug,logGroup
);targeting=gptTargeting.getSlotLevelTargeting(slotName);targeting.uap=uapContext.getUapId().toString();AdElement.configureSlot(slot,targeting);googleTag.refreshSlot(slot);}else{log(['Refresh slot',slotName,'does not exist'],log.levels.debug,logGroup);}}adContext.addCallback(function(){if(googleTag.isInitialized()){googleTag.setPageLevelParams(adLogicPageParams.getPageLevelParams());uapContext.reset();}});return{refreshSlot:refreshSlot,pushAd:pushAd};});;define('ext.wikia.adEngine.provider.gpt.sraHelper',['wikia.log'],function(log){'use strict';var logGroup='ext.wikia.adEngine.provider.gpt.sraHelper',flushed=!1,sraSlots=['INVISIBLE_SKIN','TOP_LEADERBOARD'];function shouldFlush(slotName){if(sraSlots.indexOf(slotName)===-1){log(['shouldFlush','Non-SRA slot',slotName],'debug',logGroup);flushed=!0;}log(['shouldFlush',slotName,flushed],'debug',logGroup);return flushed;}return{shouldFlush:shouldFlush};});;define('ext.wikia.adEngine.provider.gpt.targeting',[
'ext.wikia.adEngine.provider.gpt.googleSlots','wikia.window'],function(googleSlots,win){'use strict';function getPageLevelTargetingValue(key){var pubads;if(win.googletag&&typeof win.googletag.pubads==="function"){pubads=win.googletag.pubads();}return pubads&&typeof pubads.getTargeting==="function"&&pubads.getTargeting(key);}function getSlotLevelTargetingValue(slotName,key){var gptSlot=googleSlots.getSlotByName(slotName);if(gptSlot){return gptSlot.getTargeting(key)[0];}}function getSlotLevelTargeting(slotName){var gptSlot=googleSlots.getSlotByName(slotName),targeting={},keys;if(gptSlot){keys=gptSlot.getTargetingKeys();keys.forEach(function(key){targeting[key]=gptSlot.getTargeting(key)[0];});}return targeting;}return{getPageLevelTargetingValue:getPageLevelTargetingValue,getSlotLevelTargetingValue:getSlotLevelTargetingValue,getSlotLevelTargeting:getSlotLevelTargeting};});;define('ext.wikia.adEngine.provider.remnantGpt',['ext.wikia.adEngine.adContext',
'ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.provider.factory.wikiaGpt','ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','ext.wikia.adEngine.slotTweaker'],function(adContext,uapContext,factory,adUnitBuilder,megaAdUnitBuilder,slotTweaker){'use strict';return factory.createProvider('ext.wikia.adEngine.provider.remnantGpt','RemnantGpt','remnant',{BOTTOM_LEADERBOARD:{size:'728x90,970x250',loc:'footer'},INCONTENT_BOXAD_1:{size:'120x600,160x600,300x250,300x600',loc:'hivi'},INCONTENT_PLAYER:{size:'1x1',loc:'middle'},INVISIBLE_HIGH_IMPACT_2:{loc:'hivi'},INVISIBLE_SKIN:{size:'1000x1000,1x1',loc:'top'},TOP_LEADERBOARD:{size:'3x3,728x90,1030x130,1030x65,1030x250,970x365,970x250,970x90,970x66,970x180,980x150',loc:'top'},TOP_RIGHT_BOXAD:{size:'300x250,300x600,300x1050',loc:'top'}},{afterSuccess:function(slotName){slotTweaker.removeDefaultHeight(slotName);if(!uapContext.isBfaaLoaded()){slotTweaker.removeTopButtonIfNeeded(slotName);slotTweaker
.adjustLeaderboardSize(slotName);}},getAdUnitBuilder:function(){return adContext.getContext().opts.enableRemnantNewAdUnit?megaAdUnitBuilder:adUnitBuilder;}});});;define('ext.wikia.adEngine.provider.turtle',['wikia.log','ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.provider.gpt.helper','ext.wikia.adEngine.slotTweaker'],function(log,btfBlocker,gptHelper,slotTweaker){'use strict';var atfSlots=['INVISIBLE_SKIN','TOP_LEADERBOARD','TOP_RIGHT_BOXAD','TURTLE_FLUSH'],logGroup='ext.wikia.adEngine.provider.turtle',slotMap={INVISIBLE_SKIN:{size:'1000x1000,1x1'},TOP_LEADERBOARD:{size:'728x90,970x250,970x90'},TOP_RIGHT_BOXAD:{size:'300x250,300x600'},TURTLE_FLUSH:{flushOnly:!0}};function canHandleSlot(slotName){log(['canHandleSlot',slotName],'debug',logGroup);var ret=!!slotMap[slotName];log(['canHandleSlot',slotName,ret],'debug',logGroup);return ret;}function fillInSlot(slot){log(['fillInSlot',slot.name],'debug',logGroup);slot.pre('success',function(){slotTweaker.removeDefaultHeight(
slot.name);slotTweaker.removeTopButtonIfNeeded(slot.name);slotTweaker.adjustLeaderboardSize(slot.name);});gptHelper.pushAd(slot,'/98544404/Wikia/Nordics_RoN/'+slot.name,slotMap[slot.name],{forcedAdType:'turtle',sraEnabled:!0});log(['fillInSlot',slot,'done'],'debug',logGroup);}return{name:'Turtle',canHandleSlot:canHandleSlot,fillInSlot:btfBlocker.decorate(fillInSlot,{atfSlots:atfSlots})};});;define('ext.wikia.adEngine.slot.adSlot',['ext.wikia.adEngine.slot.adUnitBuilder','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','wikia.document','wikia.log'],function(adUnitBuilder,megaAdUnitBuilder,doc,log){'use strict';var logGroup='ext.wikia.adEngine.slot.adSlot';function create(name,container,callbacks){function registerHook(name){return function(adInfo){if(typeof callbacks[name]==='function'){callbacks[name](adInfo);}};}return{name:name,container:container,isViewed:!1,collapse:registerHook('collapse'),hop:registerHook('hop'),renderEnded:registerHook('renderEnded'),success:registerHook
('success'),viewed:registerHook('viewed')};}function getShortSlotName(slotName){if(megaAdUnitBuilder.isValid(slotName)){return megaAdUnitBuilder.getShortSlotName(slotName);}return adUnitBuilder.getShortSlotName(slotName);}function getIframe(slotName){var cssSelector='#'+slotName+' > .provider-container:not(.hidden) div[id*="_container_"] > iframe',iframe=doc.querySelector(cssSelector);log(['getIframe',slotName,iframe&&iframe.id],log.levels.debug,logGroup);return iframe;}function getProviderContainer(slotName){var slotContainer=doc.getElementById(slotName);if(slotContainer){return slotContainer.lastElementChild||null;}return null;}return{create:create,getIframe:getIframe,getProviderContainer:getProviderContainer,getShortSlotName:getShortSlotName};});;define('ext.wikia.adEngine.slot.bottomLeaderboard',['wikia.document','wikia.domCalculator','wikia.log','wikia.throttle','wikia.window'],function(doc,dom,log,throttle,win){'use strict';var slotName='BOTTOM_LEADERBOARD',threshold=100,
viewPortHeight=Math.max(doc.documentElement.clientHeight,win.innerHeight||0),logGroup='ext.wikia.adEngine.slot.bottomLeaderboard',pushed=!1,wikiaFooter=doc.getElementById('WikiaFooter'),pushSlot=throttle(function(){var scrollPosition=win.scrollY||win.pageYOffset||doc.documentElement.scrollTop,pushPos=dom.getTopOffset(wikiaFooter)-viewPortHeight-threshold;if(win.ArticleComments&&!win.ArticleComments.initCompleted){return;}if(!pushed&&pushPos<scrollPosition){pushed=!0;doc.removeEventListener('scroll',pushSlot);win.adslots2.push(slotName);log(['pushSlot','Pushed '+slotName],'debug',logGroup);}});function init(){if(!doc.getElementById(slotName)){log(['init','No '+slotName],'error',logGroup);return;}doc.addEventListener('scroll',pushSlot);}return{init:init};});;define('ext.wikia.adEngine.slot.floatingMedrec',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.slot.service.viewabilityHandler','wikia.document','wikia.log','wikia.throttle',
'wikia.window'],function(adContext,uapContext,viewabilityHandler,doc,log,throttle,win){'use strict';var logGroup='ext.wikia.adEngine.slot.floatingMedrec';function init(){var adSlot=doc.createElement('div'),context=adContext.getContext(),maxChanges=6,onScroll,placeHolderElement=doc.getElementById('WikiaAdInContentPlaceHolder'),recirculationElement=doc.getElementById('recirculation-rail'),refreshInfo={refreshAdPos:0,lastRefreshTime:new Date(),refreshNumber:0,adVisible:!0,heightScrolledThreshold:10,refreshDelay:10000},slotName='INCONTENT_BOXAD_1',startPosition=placeHolderElement.offsetTop,swapRecirculationAndAd;adSlot.className='wikia-ad';adSlot.setAttribute('id',slotName);function hasUserScrolledEnoughDistance(currentHeightPosition){var heightScrolled=Math.abs(currentHeightPosition-refreshInfo.refreshAdPos);return heightScrolled>refreshInfo.heightScrolledThreshold;}function wasItEnoughTimeSinceLastRefresh(){var timeDifference=(new Date())-refreshInfo.lastRefreshTime;return timeDifference
>refreshInfo.refreshDelay;}function isMaxNumberOfRefreshReached(){return refreshInfo.refreshNumber>=maxChanges;}function isUAPFloatingMedrecVisible(){var isAdVisible=refreshInfo.adVisible&&refreshInfo.refreshNumber!==0;return uapContext.isUapLoaded()&&isAdVisible;}function shouldSwitchModules(currentHeightPosition){return hasUserScrolledEnoughDistance(currentHeightPosition)&&wasItEnoughTimeSinceLastRefresh()&&!isMaxNumberOfRefreshReached()&&!isUAPFloatingMedrecVisible();}function updateModulesRefreshInformation(currentHeightPosition){refreshInfo.lastRefreshTime=new Date();refreshInfo.refreshAdPos=currentHeightPosition;refreshInfo.refreshNumber++;}function showRecirculation(){recirculationElement.style.display='block';}function hideRecirculation(){recirculationElement.style.display='none';}function refreshAd(){return new Promise(function(resolve,reject){viewabilityHandler.refreshOnView(slotName,0,{onSuccess:resolve});});}swapRecirculationAndAd=throttle(function(){if(shouldSwitchModules(
placeHolderElement.offsetTop)){updateModulesRefreshInformation(placeHolderElement.offsetTop);if(refreshInfo.adVisible){log(['swapRecirculationAndAd','Hide ad, show recirculation '],'debug',logGroup);adSlot.classList.add('hidden');showRecirculation();}else{log(['swapRecirculationAndAd','Show ad, hide recirculation '],'debug',logGroup);refreshAd().then(hideRecirculation);}refreshInfo.adVisible=!refreshInfo.adVisible;}});onScroll=throttle(function(){if(startPosition<placeHolderElement.offsetTop&&shouldSwitchModules(placeHolderElement.offsetTop)){updateModulesRefreshInformation(placeHolderElement.offsetTop);log(['checkAndPushAd','Enabling floating medrec'],'debug',logGroup);placeHolderElement.appendChild(adSlot);win.addEventListener('scroll',swapRecirculationAndAd);refreshInfo.refreshAdPos=placeHolderElement.offsetTop;refreshInfo.lastRefreshTime=(new Date()).getTime()+refreshInfo.refreshDelay;win.adslots2.push({slotName:slotName,onSuccess:function(){hideRecirculation();refreshInfo.
lastRefreshTime=(new Date()).getTime();}});win.removeEventListener('scroll',onScroll);}});function start(){if(!context.opts.floatingMedrec){log(['init','Floating medrec disabled: ad context returns false'],'debug',logGroup);return;}if(!win.wgIsContentNamespace){log(['init','Floating medrec disabled: $wgIsContentNamespace equals false'],'debug',logGroup);return;}if(!placeHolderElement){log(['init','Floating medrec disabled: no placeHolder'],'debug',logGroup);return;}win.addEventListener('scroll',onScroll);}start();}return{init:init};});;define('ext.wikia.adEngine.slot.highImpact',['ext.wikia.adEngine.context.slotsContext','wikia.window'],function(slotsContext,win){'use strict';var slotName='INVISIBLE_HIGH_IMPACT_2';function init(){if(slotsContext.isApplicable(slotName)){win.adslots2.push({slotName:slotName});}}return{init:init};});;define('ext.wikia.adEngine.slot.inContent',['ext.wikia.adEngine.adTracker','ext.wikia.adEngine.context.slotsContext',
'ext.wikia.adEngine.video.videoFrequencyMonitor','JSMessages','wikia.document','wikia.log','wikia.window'],function(adTracker,slotsContext,videoFrequencyMonitor,msg,doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.slot.inContent',selector='#mw-content-text > h2';function createInContentWrapper(slotName){var adHtml=doc.createElement('div'),label=msg('adengine-advertisement');adHtml.id='INCONTENT_WRAPPER';adHtml.innerHTML='<div id="'+slotName+'" class="wikia-ad hidden" data-label="'+label+'"></div>';return adHtml;}function insertSlot(header,slotName,onSuccessCallback){var wrapper=createInContentWrapper(slotName);log('insertSlot','debug',logGroup);header.parentNode.insertBefore(wrapper,header);win.adslots2.push({slotName:slotName,onSuccess:onSuccessCallback});}function init(slotName,onSuccessCallback){var header=doc.querySelectorAll(selector)[1],logMessage,logWikiData='(wikiId: '+win.wgCityId+' articleId: '+win.wgArticleId+')',slotNameGA=slotName.toLowerCase();if(!header){
logMessage='missing second section '+logWikiData;}if(!slotsContext.isApplicable(slotName)){logMessage='2nd section in the article is not full width '+logWikiData;}if(!videoFrequencyMonitor.videoCanBeLaunched()){logMessage='video frequency capping '+logWikiData;}if(logMessage){log(slotName+' not added - '+logMessage,'debug',logGroup);adTracker.track('slot/'+slotNameGA+'/failed',{'reason':logMessage});return;}insertSlot(header,slotName,onSuccessCallback);adTracker.track('slot/'+slotNameGA+'/success');}return{init:init};});;define('ext.wikia.adEngine.slot.resolvedState',['ext.wikia.adEngine.context.uapContext','wikia.cache','wikia.log','wikia.querystring','wikia.window'],function(uapContext,cache,log,QueryString,win){'use strict';var cacheKey='adEngine_resolvedStateCounter',cacheTtl=cache.CACHE_STANDARD,logGroup='ext.wikia.adEngine.slot.resolvedState',now=win.wgNow||new Date(),qs=new QueryString();function getQueryParam(){return qs.getVal('resolved_state',null);}function isForcedByURLParam
(){return[true,'true','1'].indexOf(getQueryParam())>-1;}function isBlockedByURLParam(){return[false,'blocked','false','0'].indexOf(getQueryParam())>-1;}function createCacheKey(){return cacheKey+'_'+uapContext.getUapId();}function findRecordInCache(){return cache.get(createCacheKey(),now);}function wasDefaultStateSeen(){var adId=uapContext.getUapId(),record=findRecordInCache(),seen=!!record&&record.lastSeenDate!==now.getTime();if(seen){log('Full version of uap was seen in last 24h. adId: '+adId,log.levels.debug,logGroup);}else{log('Full version of uap was not seen in last 24h. adId: '+adId,log.levels.debug,logGroup);}return seen;}function updateInformationAboutSeenDefaultStateAd(){cache.set(createCacheKey(),{adId:uapContext.getUapId(),lastSeenDate:now.getTime()},cacheTtl,now);}function setResolvedState(params){log('Resolved state is turned on',logGroup,log.levels.debug);params.aspectRatio=params.resolvedStateAspectRatio;params.image1.element.src=params.image1.resolvedStateSrc;if(params.
image2&&params.image2.resolvedStateSrc){params.image2.element.src=params.image2.resolvedStateSrc;}}function templateSupportsResolvedState(params){return!!(params.image1&&params.image1.resolvedStateSrc);}function setDefaultState(params){params.image1.element.src=params.image1.defaultStateSrc;if(params.image2&&params.image2.defaultStateSrc){params.image2.element.src=params.image2.defaultStateSrc;}}function setImage(videoSettings){var params=videoSettings.getParams();if(templateSupportsResolvedState(params)){if(videoSettings.isResolvedState()){setResolvedState(params);}else{setDefaultState(params);updateInformationAboutSeenDefaultStateAd();}}}function isResolvedState(){var showResolvedState=!isBlockedByURLParam(),defaultStateSeen=!0;if(showResolvedState){defaultStateSeen=wasDefaultStateSeen()||isForcedByURLParam();}return showResolvedState&&defaultStateSeen;}return{isResolvedState:isResolvedState,setImage:setImage};});;define('ext.wikia.adEngine.slot.service.actionHandler',[
'ext.wikia.adEngine.messageListener','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.slot.service.viewabilityHandler','wikia.abTest','wikia.log'],function(messageListener,slotTweaker,viewabilityHandler,abTest,log){'use strict';var logGroup='ext.wikia.adEngine.slot.service.actionHandler';function messageCallback(data){if(!data.slotName){return log('messageCallback: missing slot name',log.levels.debug,logGroup);}switch(data.action){case'expand':slotTweaker.expand(data.slotName);break;case'collapse':slotTweaker.collapse(data.slotName);break;case'hide':slotTweaker.hide(data.slotName);break;case'show':slotTweaker.show(data.slotName);break;case'make-responsive':slotTweaker.makeResponsive(data.slotName,data.aspectRatio);break;case'refresh-on-view':if(!abTest.getGroup('AD_MIX')||(abTest.getGroup('AD_MIX')&&abTest.getGroup('AD_MIX').indexOf('AD_MIX_1')===0)){viewabilityHandler.refreshOnView(data.slotName,data.delay);}break;default:log(['messageCallback: unknown action',data.action],log.
levels.debug,logGroup);}}function registerMessageListener(){messageListener.register({dataKey:'action',infinite:!0},messageCallback);}return{registerMessageListener:registerMessageListener};});;define('ext.wikia.adEngine.slot.service.passbackHandler',['ext.wikia.adEngine.slot.service.stateMonitor'],function(slotStateMonitor){'use strict';function get(slotName){var slotHops=slotStateMonitor.getSlotStatuses(slotName,'hop');if(slotHops.length>0){var lastHop=slotHops[slotHops.length-1];return lastHop&&lastHop.adInfo&&lastHop.adInfo.source?lastHop.adInfo.source:'unknown';}return null;}return{get:get};});;define('ext.wikia.adEngine.slot.service.slotRegistry',['ext.wikia.adEngine.adContext','wikia.window'],function(adContext,win){'use strict';var slots={},slotQueueCount={},scrollYOnDfpRequest={};function incrementSlotQueueCount(slotName){slotQueueCount[slotName]=slotQueueCount[slotName]||0;if(slots[slotName].length===0){slotQueueCount[slotName]+=1;}}function add(slot,providerName){slots[
slot.name]=slots[slot.name]||[];incrementSlotQueueCount(slot.name);slots[slot.name].push({providerName:providerName,slot:slot});}function get(slotName,providerName){var slotsCount,foundSlots;if(!slots[slotName]){return null;}slotsCount=slots[slotName].length;if(!slotsCount){return null;}if(!providerName){return slots[slotName][slotsCount-1].slot;}foundSlots=slots[slotName].filter(function(registryRow){if(registryRow.providerName===providerName){return registryRow.slot;}});if(foundSlots.length){return foundSlots[0].slot;}return null;}function getRefreshCount(slotName){return slotQueueCount[slotName]||0;}function reset(slotName){slots[slotName]=[];}adContext.addCallback(function(){slots={};slotQueueCount={};});function storeScrollY(slotName){scrollYOnDfpRequest[slotName]=win.scrollY||win.pageYOffset;}function getScrollY(slotName){return scrollYOnDfpRequest[slotName];}return{add:add,get:get,getRefreshCount:getRefreshCount,getScrollY:getScrollY,reset:reset,storeScrollY:storeScrollY};});;
define('ext.wikia.adEngine.slot.service.stateMonitor',['wikia.window'],function(win){'use strict';var slotHistoryMap={};function store(data){if(!slotHistoryMap[data.slot.name]){slotHistoryMap[data.slot.name]=[];}slotHistoryMap[data.slot.name].push(data);}function run(){win.addEventListener('adengine.slot.status',function(e){store(e.detail);});}function filterByStatus(data,status){return data.filter(function(e){return e.status===status;});}function getSlotStatuses(slotName,statusType){var result=slotHistoryMap[slotName];if(!result){return[];}return statusType?filterByStatus(result,statusType):result;}return{getSlotStatuses:getSlotStatuses,run:run};});;define('ext.wikia.adEngine.slot.service.viewabilityHandler',['ext.wikia.adEngine.provider.gpt.googleTag','ext.wikia.adEngine.slot.service.slotRegistry','wikia.log','wikia.window'],function(googleTag,slotRegistry,log,win){'use strict';var logGroup='ext.wikia.adEngine.slot.service.viewabilityHandler';function refreshSlot(slotName,delay,
options){var slotObject={slotName:slotName,onSuccess:options.onSuccess};delay=delay!==undefined?delay:1000;win.setTimeout(function(){googleTag.destroySlots([slotName]);if(win.adslots2){win.adslots2.push(slotObject);}else{win.Mercury.Modules.Ads.getInstance().pushSlotToQueue(slotObject);}},delay);}function refreshOnView(slotName,delay,options){var slot=slotRegistry.get(slotName);log(['refresh on view',slotName,slot],log.levels.debug,logGroup);options=options||{};if(slot){if(slot.isViewed){refreshSlot(slot.name,delay,options);}else{slot.post('viewed',function(){refreshSlot(slot.name,delay,options);});}}}return{refreshOnView:refreshOnView};});;define('ext.wikia.adEngine.template.bfaa',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.video.uapVideo','wikia.log',require.optional('ext.wikia.adEngine.template.bfaaDesktop'),require.optional('ext.wikia.adEngine.template.bfaaMobile')],function(adContext,uapContext,uapVideo,log,bfaaDesktop,bfaaMobile){
'use strict';var bfaa,logGroup='ext.wikia.adEngine.template.bfaa';function show(params){var uapType='uap';if(uapVideo.isEnabled(params)){uapType='vuap';}params.adProduct=params.adProduct||uapType;uapContext.setUapId(params.uap);uapContext.setType(params.adProduct);switch(adContext.getContext().targeting.skin){case'oasis':bfaa=bfaaDesktop;break;case'mercury':bfaa=bfaaMobile;break;default:return log(['show','not supported skin'],log.levels.error,logGroup);}if(!bfaa){log(['show','module is not loaded'],log.levels.error,logGroup);}bfaa.show(params);}return{show:show};});;define('ext.wikia.adEngine.template.bfaaDesktop',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.provider.gpt.googleSlots','ext.wikia.adEngine.provider.gpt.helper','ext.wikia.adEngine.slot.resolvedState','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.video.uapVideo','ext.wikia.adEngine.video.videoSettings','wikia.document','wikia.log','wikia.throttle','wikia.window',
require.optional('ext.wikia.aRecoveryEngine.tweaker')],function(adContext,btfBlocker,googleSlots,helper,resolvedState,slotTweaker,uapVideo,VideoSettings,doc,log,throttle,win,recoveryTweaker){'use strict';var breakPointWidthNotSupported=767,logGroup='ext.wikia.adEngine.template.bfaaDesktop',nav,page,slotContainer,unblockedSlots=['BOTTOM_LEADERBOARD','INCONTENT_BOXAD_1'],wrapper;function updateNavBar(height){var position=win.scrollY||win.pageYOffset;log(['updateNavBar',height,position],log.levels.info,logGroup);if(doc.body.offsetWidth<=breakPointWidthNotSupported||position<=height){nav.classList.add('bfaa-pinned');}else{nav.classList.remove('bfaa-pinned');}}function runOnReady(iframe,params,videoSettings){var spotlightFooter=doc.getElementById('SPOTLIGHT_FOOTER');nav.style.top='';page.classList.add('bfaa-template');if(!win.ads.runtime.disableCommunitySkinOverride){doc.body.classList.add('uap-skin');}log('desktopHandler::show',log.levels.info,logGroup);updateNavBar(slotContainer.
offsetHeight);doc.addEventListener('scroll',throttle(function(){updateNavBar(slotContainer.offsetHeight);},100));if(spotlightFooter){spotlightFooter.parentNode.style.display='none';}if(recoveryTweaker&&recoveryTweaker.isTweakable()){slotTweaker.removeDefaultHeight(params.slotName);recoveryTweaker.tweakSlot(params.slotName,iframe);}if(uapVideo.isEnabled(params)){uapVideo.loadVideoAd(videoSettings);}}function show(params){var medrecSlotName='TOP_RIGHT_BOXAD',videoSettings;slotContainer=doc.getElementById(params.slotName);nav=doc.getElementById('globalNavigation');page=doc.getElementsByClassName('WikiaSiteWrapper')[0];wrapper=doc.getElementById('WikiaTopAds');log(['show',page,wrapper,params],log.levels.info,logGroup);wrapper.style.opacity='0';videoSettings=VideoSettings.create(params);resolvedState.setImage(videoSettings);slotTweaker.makeResponsive(params.slotName,params.aspectRatio);slotTweaker.onReady(params.slotName,function(iframe){runOnReady(iframe,params,videoSettings);wrapper.style
.opacity='';if(!adContext.get('opts.disableSra')&&params.loadMedrecFromBTF){helper.refreshSlot(medrecSlotName);}});if(params.adProduct!=='abcd'){unblockedSlots.forEach(btfBlocker.unblock);}log(['show',params.uap],log.levels.info,logGroup);}return{show:show};});;define('ext.wikia.adEngine.template.bfab',['ext.wikia.adEngine.slot.resolvedState','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.video.uapVideo','ext.wikia.adEngine.video.videoSettings','wikia.log','wikia.document',require.optional('ext.wikia.aRecoveryEngine.tweaker')],function(resolvedState,slotTweaker,uapVideo,VideoSettings,log,doc,recoveryTweaker){'use strict';var logGroup='ext.wikia.adEngine.template.bfab';function show(params){var slot=doc.getElementById('BOTTOM_LEADERBOARD')||doc.getElementById('MOBILE_BOTTOM_LEADERBOARD'),videoSettings=VideoSettings.create(params);slot.classList.add('bfab-template');resolvedState.setImage(videoSettings);slotTweaker.makeResponsive(slot.id,params.aspectRatio);slotTweaker.onReady(slot
.id,function(iframe){if(recoveryTweaker&&recoveryTweaker.isTweakable()){recoveryTweaker.tweakSlot(slot.id,iframe);}if(uapVideo.isEnabled(params)){uapVideo.loadVideoAd(videoSettings);}});log('show','info',logGroup);}return{show:show};});;define('ext.wikia.adEngine.template.floatingRail',['ext.wikia.adEngine.adContext','jquery','wikia.log','wikia.throttle','wikia.window'],function(adContext,$,log,throttle,win){'use strict';var $medrec=$('#TOP_RIGHT_BOXAD'),$rail=$('#WikiaRail'),$railWrapper=$('#WikiaRailWrapper'),$wikiaMainContent=$('#WikiaMainContent'),$win=$(win),adsInRail=2,biggestAdSize=600,globalNavHeight=$('#globalNavigation').height(),margin=15,medrecDefaultSize=250,logGroup='ext.wikia.adEngine.template.floatingRail',railWidth=300,availableSpace,floatingSpace,scrollTop,startPosition,stopPosition,update=throttle(function(){startPosition=parseInt($railWrapper.offset().top,10)-globalNavHeight-margin;stopPosition=startPosition+floatingSpace;scrollTop=$win.scrollTop();if(scrollTop<=
startPosition||$medrec.hasClass('hidden')){$rail.css({position:'static',paddingTop:'0px',top:'0px',width:railWidth+'px'});}else if(scrollTop>startPosition&&scrollTop<stopPosition){$rail.css({position:'fixed',paddingTop:'0px',top:globalNavHeight+margin+'px',width:railWidth+'px'});}else if(scrollTop>=stopPosition){$rail.css({position:'static',paddingTop:floatingSpace+'px',top:'0px',width:railWidth+'px'});}},50);function getChildrenHeight(){var height=0;$rail.children().each(function(){height+=$(this).height();});return height;}function getAvailableSpace(){if(!availableSpace){availableSpace=$wikiaMainContent.height()-getChildrenHeight()+medrecDefaultSize-adsInRail*biggestAdSize;availableSpace=Math.max(0,availableSpace);log(['getAvailableSpace',availableSpace],'debug',logGroup);}return availableSpace;}function show(params){var offset=params.offset||0,context=adContext.getContext(),isPageSupported=context.targeting.skin==='oasis'&&context.targeting.pageType==='article';if(!isPageSupported||
getAvailableSpace()===0){return;}floatingSpace=Math.min(offset,getAvailableSpace());win.addEventListener('scroll',update);win.addEventListener('resize',update);}return{show:show};});;define('ext.wikia.adEngine.template.floor',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.slot.adSlot','ext.wikia.adEngine.provider.gpt.adDetect','wikia.log','wikia.document','wikia.iframeWriter','wikia.window'],function(adContext,adSlot,adDetect,log,doc,iframeWriter,win){'use strict';var logGroup='ext.wikia.adEngine.template.floor',floorId='ext-wikia-adEngine-template-floor',floorHtml='<div id="'+floorId+'">'+'<div class="background"></div>'+'<div class="ad"></div>'+'<a class="close" title="Close" href="#">'+'<svg role="img" class="ads-floor-close-button"><use xlink:href="#close"></use></svg>'+'</a>'+'</div>',$=win.$;function show(params){log(['show',params],'debug',logGroup);var iframe=iframeWriter.getIframe({code:params.code,width:params.width,height:params.height}),$floor=$('#'+floorId),
isFloorPresent=$floor.length>0,gptEventMock={size:{width:params.width,height:params.height}},async=params.canHop&&params.slotName,slot;function showFloor(){var skin=adContext.getContext().targeting.skin;if(skin==='oasis'){win.WikiaBar.hideContainer();}$floor.removeClass('hidden');}if(params.onClick){$(iframe).on('load',function(){var iframeDoc=iframe.contentWindow.document;$('html',iframeDoc).css('cursor','pointer').on('click',params.onClick);});}if(async){log(['show',params.slotName,'can hop'],'info',logGroup);slot=adSlot.create(params.slotName,null,{success:function(){log(['ad detect',params.slotName,'success'],'info',logGroup);win.postMessage('{"AdEngine":{"slot_'+params.slotName+'":true,"status":"success"}}','*');showFloor();},hop:function(){log(['ad detect',params.slotName,'hop'],'info',logGroup);win.postMessage('{"AdEngine":{"slot_'+params.slotName+'":true,"status":"hop"}}','*');}});$(iframe).on('load',function(){adDetect.onAdLoad(slot,gptEventMock,iframe);});}if(!isFloorPresent)
{$floor=$(floorHtml);$floor.addClass('hidden');$(doc.body).append($floor);}$floor.find('a.close').click(function(event){event.preventDefault();$floor.addClass('hidden');});$floor.find('.ad').html(iframe);if(!async){showFloor();}}adContext.addCallback(function(){var floor=doc.getElementById(floorId);if(floor){floor.parentElement.removeChild(floor);}});return{show:show};});;define('ext.wikia.adEngine.template.floorAdhesion',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.slotTweaker','wikia.log','wikia.document','wikia.window'],function(adContext,slotTweaker,log,doc,win){'use strict';var logGroup='ext.wikia.adEngine.template.floorAdhesion',slotName='INVISIBLE_HIGH_IMPACT_2';function show(){var skin=adContext.getContext().targeting.skin,wrapper=doc.getElementById('InvisibleHighImpactWrapper');wrapper.querySelector('.close').addEventListener('click',function(event){event.preventDefault();wrapper.classList.add('hidden');});if(skin==='oasis'){win.WikiaBar.hideContainer();}wrapper.
classList.add('floor-adhesion');wrapper.classList.remove('hidden');slotTweaker.adjustIframeByContentSize(slotName);log('Show floor adhesion','info',logGroup);}return{show:show};});;define('ext.wikia.adEngine.template.interstitial',['ext.wikia.adEngine.slotTweaker','wikia.document','wikia.log'],function(slotTweaker,doc,log){'use strict';var logGroup='ext.wikia.adEngine.template.interstitial',slotName='INVISIBLE_HIGH_IMPACT_2';function show(){var wrapper=doc.getElementById('InvisibleHighImpactWrapper');wrapper.querySelector('.close').addEventListener('click',function(event){event.preventDefault();wrapper.classList.add('hidden');doc.documentElement.classList.remove('stop-scrolling');log('Hide interstitial','info',logGroup);});wrapper.classList.add('interstitial');wrapper.classList.remove('hidden');doc.documentElement.classList.add('stop-scrolling');slotTweaker.adjustIframeByContentSize(slotName);log('Show interstitial','info',logGroup);}return{show:show};});;define(
'ext.wikia.adEngine.template.modal',['ext.wikia.adEngine.slot.adSlot','ext.wikia.adEngine.provider.gpt.adDetect','ext.wikia.adEngine.template.modalHandlerFactory','wikia.document','wikia.log','wikia.iframeWriter','wikia.throttle','wikia.window'],function(adSlot,adDetect,modalHandlerFactory,doc,log,iframeWriter,throttle,win){'use strict';var logGroup='ext.wikia.adEngine.template.modal';function show(params){log(['show',params],'debug',logGroup);var adContainer=doc.createElement('DIV'),adIframe=iframeWriter.getIframe({code:params.code,height:params.height,width:params.width,classes:'wikia-ad-iframe'}),async=params.canHop&&params.slotName,gptEventMock={size:{width:params.width,height:params.height}},modalHandler=modalHandlerFactory.create(),lightboxParams,slot;if(modalHandler===null){return;}function scaleAd(){var availableWidth=Math.max(win.innerWidth*lightboxParams.availableWidthRatio,lightboxParams.minWidth),availableHeight=Math.max(win.innerHeight*lightboxParams.availableHeightRatio-
lightboxParams.heightSubtract,lightboxParams.minHeight),ratioWidth=availableWidth/params.width,ratioHeight=availableHeight/params.height,ratio=Math.min(ratioWidth,ratioHeight,lightboxParams.maximumRatio);adIframe.style.transform='scale('+ratio+')';adIframe.style.msTransform='scale('+ratio+')';adIframe.style.WebkitTransform='scale('+ratio+')';adIframe.style.transformOrigin='top left';adIframe.style.msTransformOrigin='top left';adIframe.style.WebkitTransformOrigin='top left';adContainer.style.width=Math.floor(params.width*ratio)+'px';adContainer.style.height=Math.floor(params.height*ratio)+'px';}function scaleAdIfNeeded(){if(params.scalable){scaleAd();win.addEventListener('resize',throttle(function(){scaleAd();}));}}lightboxParams=modalHandler.getExpansionModel();adIframe.style.maxWidth='none';adContainer.appendChild(adIframe);if(async){slot=adSlot.create(params.slotName,null,{success:function(){log(['ad detect',params.slotName,'success'],'info',logGroup);win.postMessage(
'{"AdEngine":{"slot_'+params.slotName+'":true,"status":"success"}}','*');modalHandler.show();},hop:function(){log(['ad detect',params.slotName,'hop'],'info',logGroup);win.postMessage('{"AdEngine":{"slot_'+params.slotName+'":true,"status":"hop"}}','*');}});adIframe.addEventListener('load',function(){adDetect.onAdLoad(slot,gptEventMock,adIframe);});}scaleAdIfNeeded();if(!params.hasOwnProperty('closeDelay')){params.closeDelay=0;}modalHandler.create(adContainer,!async,params.closeDelay);}return{show:show};});;define('ext.wikia.adEngine.template.modalHandlerFactory',['ext.wikia.adEngine.adContext','wikia.log',require.optional('ext.wikia.adEngine.template.modalMercuryHandler'),require.optional('ext.wikia.adEngine.template.modalOasisHandler')],function(adContext,log,MercuryHandler,OasisHandler){'use strict';var logGroup='ext.wikia.adEngine.template.modalHandlerFactory';function create(){var skin=adContext.getContext().targeting.skin;log(['create',skin],'debug',logGroup);switch(skin){case
'mercury':log('Created handler for mercury skin','debug',logGroup);return new MercuryHandler();case'oasis':log('Created handler for oasis skin','debug',logGroup);return new OasisHandler();default:log('Unsupported skin','debug',logGroup);return null;}}return{create:create};});;define('ext.wikia.adEngine.template.modalOasisHandler',['jquery',require.optional('wikia.ui.factory')],function($,uiFactory){'use strict';var oasisHandler=function(){this.modalId='ext-wikia-adEngine-template-modal';};oasisHandler.prototype.create=function(adContainer,modalVisible,closeButtonDelay){var modalConfig={vars:{id:this.modalId,size:'medium',content:'',title:'Advertisement',closeText:'Close',buttons:[]}};uiFactory.init('modal').then((function(uiModal){uiModal.createComponent(modalConfig,(function(modal){closeButtonDelay=parseInt(closeButtonDelay,10)||0;var hideCloseButton=closeButtonDelay>0,$header,$counter,counter;this.modal=modal;modal.$content.append(adContainer);modal.$element.width('auto');function
timer(){closeButtonDelay=closeButtonDelay-1;if(closeButtonDelay<0){clearInterval(counter);$counter.hide();modal.$close.show();return;}$counter.text(closeButtonDelay);}if(hideCloseButton){$header=modal.$close.parent();$counter=$(document.createElement('div'));modal.$close.hide();$counter.addClass('close-counter');$counter.text(closeButtonDelay);$header.prepend($counter);counter=setInterval(timer,1000);}if(modalVisible){this.show();}}).bind(this));}).bind(this));};oasisHandler.prototype.show=function(){if(this.modal){this.modal.show();}};oasisHandler.prototype.getExpansionModel=function(){return{availableHeightRatio:0.8,availableWidthRatio:0.9,heightSubtract:90,minWidth:200,minHeight:150,maximumRatio:2};};return oasisHandler;});;define('ext.wikia.adEngine.template.ooyala',['ext.wikia.adEngine.video.vastUrlBuilder','wikia.log','wikia.videoBootstrap'],function(vastUrlBuilder,log,VideoBootstrap){'use strict';var libraryUrl=
'https://player.ooyala.com/v3/52bc289bedc847e3aa8eb2b347644f68?platform=html5-priority',logGroup='ext.wikia.adEngine.template.ooyala';function show(params){var aspectRatio=params.width/params.height,playerId='ooyala_'+Math.floor((1+Math.random())*0x10000),vastTargeting={passback:'ooyala',pos:params.slotName,src:params.src},vb;vb=new VideoBootstrap(params.container,{html:'<div id="'+playerId+'" style="width: 100%; height: 100%;"></div>',width:params.width,height:params.height,jsParams:{playerId:playerId,videoId:params.videoId,autoPlay:params.autoPlay||!0,tagUrl:params.vastUrl||vastUrlBuilder.build(aspectRatio,vastTargeting),jsFile:[libraryUrl,'extensions/wikia/VideoHandlers/js/handlers/lib/OoyalaAgeGate.js'],onCreate:params.onReady},init:'wikia.videohandler.ooyala',scripts:['extensions/wikia/VideoHandlers/js/handlers/Ooyala.js']});log(['show',vb,params],'debug',logGroup);}return{show:show};});;define('ext.wikia.adEngine.template.playwire',['ext.wikia.adEngine.video.player.playwire',
'wikia.log'],function(player,log){'use strict';var logGroup='ext.wikia.adEngine.template.playwire';function show(params){params.configUrl=params.configUrl||player.getConfigUrl(params.publisherId,params.videoId);if(params.container){player.inject(params);log(['show',params.configUrl],'info',logGroup);}}return{show:show};});;define('ext.wikia.adEngine.template.porvata',['ext.wikia.adEngine.domElementTweaker','ext.wikia.adEngine.slot.service.slotRegistry','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.video.player.porvata','ext.wikia.adEngine.video.player.uiTemplate','ext.wikia.adEngine.video.player.ui.videoInterface','ext.wikia.adEngine.video.videoFrequencyMonitor','ext.wikia.adEngine.video.videoSettings','wikia.browserDetect','wikia.document','wikia.log','wikia.window',require.optional('ext.wikia.adEngine.mobile.mercuryListener'),require.optional('ext.wikia.adEngine.wrappers.prebid')],function(DOMElementTweaker,slotRegistry,slotTweaker,porvata,uiTemplate,videoInterface,
videoFrequencyMonitor,videoSettings,browserDetect,doc,log,win,mercuryListener,prebid){'use strict';var fallbackBidders=['appnexusAst','rubicon'],logGroup='ext.wikia.adEngine.template.porvata',videoAspectRatio=640/360;function callHop(params,shouldSetStatus){if(shouldSetStatus){slotRegistry.get(params.slotName).hop({adType:params.adType,source:'porvata'});}}function callSuccess(params,shouldSetStatus){if(shouldSetStatus){slotRegistry.get(params.slotName).success({adType:params.adType,source:'porvata'});}}function getVideoContainer(slotName){var container=doc.createElement('div'),displayWrapper=doc.createElement('div'),providerContainer=doc.querySelector('#'+slotName+' > .provider-container');container.classList.add('video-overlay');displayWrapper.classList.add('video-display-wrapper');container.appendChild(displayWrapper);providerContainer.appendChild(container);return displayWrapper;}function isVpaid(contentType){return contentType==='application/javascript';}function
dispatchEventWhenInViewport(video,eventName){if(video.wasInViewport){video.ima.dispatchEvent(eventName);}else{video.addEventListener('wikiaFirstTimeInViewport',function(){video.ima.dispatchEvent(eventName);});}}function enabledFallbackBidHandling(video,videoSettings,params){var hasDirectAd=!0,fallbackAdRequested=!1;video.addEventListener('wikiaAdsManagerLoaded',function(){if(hasDirectAd){dispatchEventWhenInViewport(video,'wikiaInViewportWithDirect');callSuccess(params,params.setSlotStatusBasedOnVAST);}});video.addEventListener('wikiaEmptyAd',function(){var fallbackBid,offerEvent='wikiaInViewportWithoutOffer';if(fallbackAdRequested){return;}hasDirectAd=!1;fallbackBid=prebid.getWinningVideoBidBySlotName(params.slotName,fallbackBidders);if(fallbackBid){fallbackAdRequested=!0;params.bid=fallbackBid;offerEvent='wikiaInViewportWithFallbackBid';videoSettings.setMoatTracking(false);video.reload({height:params.height,width:params.width,vastResponse:fallbackBid.vastContent,vastUrl:
fallbackBid.vastUrl});if(typeof params.fallbackBidBlockOutOfViewportPausing!=='undefined'){params.blockOutOfViewportPausing=params.fallbackBidBlockOutOfViewportPausing;}if(typeof params.fallbackBidEnableInContentFloating!=='undefined'){params.enableInContentFloating=params.fallbackBidEnableInContentFloating;}if(typeof params.fallbackBidEnableLeaderboardFloating!=='undefined'){params.enableLeaderboardFloating=params.fallbackBidEnableLeaderboardFloating;}callSuccess(params,params.setSlotStatusBasedOnVAST);}else{callHop(params,params.setSlotStatusBasedOnVAST);}dispatchEventWhenInViewport(video,offerEvent);});}function onReady(video,params){var slot=doc.getElementById(params.slotName),slotWidth;slot.classList.add('porvata-outstream');video.addEventListener('loaded',function(){video.container.classList.remove('hidden');});if(params.isDynamic){win.addEventListener('resize',function(){if(!(video.isFloating&&video.isFloating())){slotWidth=slot.clientWidth;video.resize(slotWidth,slotWidth/
videoAspectRatio);}});}}function isVideoAutoplaySupported(){return!browserDetect.isAndroid()||(browserDetect.getBrowser().indexOf('Chrome')!==-1&&browserDetect.getBrowserVersion()>=54);}function show(params){var imaVpaidModeInsecure=2,settings;log(['show',params],log.levels.debug,logGroup);if(prebid&&params.hbAdId){params.bid=prebid.getBidByAdId(params.hbAdId);params.vastResponse=params.bid.vastContent||null;params.vastUrl=params.bid.vastUrl;}if(!isVideoAutoplaySupported()){log(['hop',params.adProduct,params.slotName,params],log.levels.info,logGroup);callHop(params,true);return;}callSuccess(params,!params.setSlotStatusBasedOnVAST);if(params.vpaidMode===imaVpaidModeInsecure){params.originalContainer=params.container;params.container=getVideoContainer(params.slotName);}if(params.isDynamic){slotTweaker.collapse(params.slotName,true);slotTweaker.makeResponsive(params.slotName,videoAspectRatio);}settings=videoSettings.create(params);porvata.inject(settings).then(function(video){var
imaVpaidMode=win.google.ima.ImaSdkSettings.VpaidMode,templateName=params.isDynamic?'outstreamIncontent':'outstreamLeaderboard',videoPlayer;if(params.vpaidMode===imaVpaidMode.INSECURE){videoPlayer=params.container.querySelector('.video-player');video.addEventListener('loaded',function(){var ad=video.ima.getAdsManager().getCurrentAd();if(ad&&isVpaid(ad.getContentType()||'')){params.container.classList.add('vpaid-enabled');DOMElementTweaker.show(videoPlayer);}});video.addEventListener('allAdsCompleted',function(){DOMElementTweaker.hide(params.container);});}onReady(video,params);if(prebid&&params.useBidAsFallback){enabledFallbackBidHandling(video,settings,params);}video.addEventListener('start',function(){videoFrequencyMonitor.registerLaunchedVideo();});if(mercuryListener){mercuryListener.onPageChange(function(){video.destroy();});}videoInterface.setup(video,uiTemplate[templateName],{container:params.container,isDynamic:params.isDynamic,slotName:params.slotName});return video;});}return{
show:show};});;define('ext.wikia.adEngine.template.roadblock',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.provider.gpt.helper','ext.wikia.adEngine.slot.service.slotRegistry','wikia.document','wikia.log',require.optional('ext.wikia.adEngine.template.skin')],function(adContext,uapContext,btfBlocker,gptHelper,slotRegistry,doc,log,skinTemplate){'use strict';var context=adContext.getContext(),logGroup='ext.wikia.adEngine.template.roadblock',medrecSlotElement=doc.getElementById('TOP_RIGHT_BOXAD'),uapType='ruap';function handleMedrec(medrecSlotElement){var medrecSlot=slotRegistry.get(medrecSlotElement.id);btfBlocker.unblock(medrecSlot.name);log(['handleMedrec','unblocking slot',medrecSlot.name],log.levels.info,logGroup);if(!context.opts.disableSra){medrecSlotElement.style.opacity='0';gptHelper.refreshSlot(medrecSlot.name);medrecSlot.pre('renderEnded',function(){medrecSlotElement.style.opacity='';});log([
'handleMedrec','refreshing slot',medrecSlot],log.levels.info,logGroup);}}function show(params){var isSkinAvailable=params.skin&&params.skin.skinImage;uapContext.setUapId(params.uap);uapContext.setType(uapType);if(medrecSlotElement){handleMedrec(medrecSlotElement);}if(skinTemplate&&isSkinAvailable){log(['show','loading skin',params.skin],log.levels.info,logGroup);skinTemplate.show(params.skin);}log(['show',params.uap],log.levels.info,logGroup);}return{show:show};});;define('ext.wikia.adEngine.template.skin',['ext.wikia.adEngine.adContext','wikia.document','wikia.window','wikia.log'],function(adContext,doc,win,log){'use strict';var logGroup='ext.wikia.adengine.template.skin';function show(params){win.wgAfterContentAndJS.push(function(){log(params,'debug',logGroup);params=params||{};var adSkin=doc.getElementById('ad-skin'),adSkinStyle=adSkin.style,wikiaSkin=doc.getElementById('WikiaPageBackground'),wikiaSkinStyle=wikiaSkin&&wikiaSkin.style,i,len,pixelElement,pixelUrl;if(win.
wgOasisResponsive||win.wgOasisBreakpoints){require(['wikia.backgroundchanger'],function(backgroundchanger){if(!params.middleColor){params.middleColor=params.backgroundColor;}var bcParams={skinImage:params.skinImage,skinImageWidth:1700,skinImageHeight:800,backgroundTiled:!1,backgroundFixed:!0,backgroundDynamic:!0};if(params.backgroundColor){bcParams.backgroundColor='#'+params.backgroundColor;}if(params.middleColor){bcParams.backgroundMiddleColor='#'+params.middleColor;}if(params.ten64){bcParams.ten64=!0;}backgroundchanger.load(bcParams);});}else{adSkinStyle.background='url("'+params.skinImage+'") no-repeat top center #'+params.backgroundColor;}doc.body.classList.add('background-ad');adSkinStyle.position='fixed';adSkinStyle.height='100%';adSkinStyle.width='100%';adSkinStyle.left=0;adSkinStyle.top=0;adSkinStyle.zIndex=1;adSkinStyle.cursor='pointer';if(wikiaSkinStyle){wikiaSkinStyle.opacity=1;}adSkin.onclick=function(){log('Click on skin','user',logGroup);win.open(params.destUrl);
};win.wgAdSkinPresent=!0;log('Skin set',5,logGroup);if(params.pixels){for(i=0,len=params.pixels.length;i<len;i+=1){pixelUrl=params.pixels[i];if(pixelUrl){log('Adding tracking pixel '+pixelUrl,'debug',logGroup);pixelElement=doc.createElement('img');pixelElement.src=pixelUrl;pixelElement.width=1;pixelElement.height=1;adSkin.appendChild(pixelElement);}}}log('Pixels added','debug',logGroup);});}return{show:show};});;define('ext.wikia.adEngine.tracking.adInfoListener',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.lookup.services','ext.wikia.adEngine.tracking.adInfoTracker','ext.wikia.adEngine.video.vastParser','wikia.log','wikia.querystring','wikia.window'],function(adContext,lookupServices,tracker,vastParser,log,Querystring,win){'use strict';var logGroup='ext.wikia.adEngine.tracking.adInfoListener',enabledSlots={TOP_LEADERBOARD:!0,TOP_RIGHT_BOXAD:!0,INCONTENT_BOXAD_1:!0,INCONTENT_PLAYER:!0,BOTTOM_LEADERBOARD:!0,MOBILE_TOP_LEADERBOARD:!0,MOBILE_BOTTOM_LEADERBOARD:!0,
MOBILE_IN_CONTENT:!0,MOBILE_PREFOOTER:!0};function isEnabled(){return adContext.getContext().opts.enableAdInfoLog;}function getBidderWon(slotParams,realSlotPrices){var slotPricesKeys=Object.keys(realSlotPrices).filter(function(key){return parseFloat(realSlotPrices[key])>0;}),highestPrice=Math.max.apply(null,slotPricesKeys.map(function(key){return parseFloat(realSlotPrices[key]);})),highestPriceBidders=[];slotPricesKeys.forEach(function(key){if(parseFloat(realSlotPrices[key])===highestPrice){highestPriceBidders.push(key);}});if(slotParams.hb_bidder&&highestPriceBidders.indexOf(slotParams.hb_bidder)>=0){return slotParams.hb_bidder;}return'';}function trackSlot(slot,status,adInfo){var slotFirstChildData=slot.container.firstChild.dataset,pageParams=JSON.parse(slotFirstChildData.gptPageParams||'{}'),slotParams=JSON.parse(slotFirstChildData.gptSlotParams||'{}'),slotPricesIgnoringTimeout=lookupServices.getCurrentSlotPrices(slot.name),realSlotPrices=lookupServices.getDfpSlotPrices(slot.
name),slotSize=JSON.parse(slotFirstChildData.gptCreativeSize||'[]'),bidderWon=getBidderWon(slotParams,realSlotPrices);adInfo=adInfo||{};tracker.track(slot.name,pageParams,slotParams,{adProduct:adInfo.adProduct,creativeId:slotFirstChildData.gptCreativeId,creativeSize:slotFirstChildData.gptCreativeSize,lineItemId:slotFirstChildData.gptLineItemId,slotSize:slotSize,status:status},{bidderWon:bidderWon,realSlotPrices:realSlotPrices,slotPricesIgnoringTimeout:slotPricesIgnoringTimeout});}function trackVideo(adInfo){var vastInfo=vastParser.parse(adInfo.vastUrl),slotPrices={};if(vastInfo.amznbid){slotPrices.a9=vastInfo.amznbid;}tracker.track(vastInfo.pos,vastInfo,vastInfo,{adProduct:vastInfo.position,creativeId:adInfo.creativeId,creativeSize:vastInfo.size,lineItemId:adInfo.lineItemId,status:adInfo.status},{realSlotPrices:slotPrices});}function shouldHandleSlot(slot){var dataGptDiv=slot.container&&slot.container.firstChild;return(enabledSlots[slot.name]&&dataGptDiv&&dataGptDiv.dataset.
gptPageParams);}function run(){if(isEnabled()){log('run',log.levels.debug,logGroup);win.addEventListener('adengine.slot.status',function(event){var adInfo=event.detail.adInfo||{},adType=adInfo&&adInfo.adType,slot=event.detail.slot,status=adType==='blocked'?'blocked':event.detail.status;if(shouldHandleSlot(slot)){log(['adengine.slot.status',event],log.levels.debug,logGroup);trackSlot(slot,status,adInfo);}});win.addEventListener('adengine.video.status',function(event){var adInfo=event.detail||{};if(adInfo.vastUrl){log(['adengine.video.status',event],log.levels.debug,logGroup);trackVideo(adInfo);}});}}return{run:run};});;define('ext.wikia.adEngine.tracking.adInfoTracker',['ext.wikia.adEngine.adTracker','ext.wikia.adEngine.slot.service.slotRegistry','ext.wikia.adEngine.tracking.pageLayout','wikia.browserDetect','wikia.log','wikia.window',require.optional('ext.wikia.adEngine.ml.rabbit')],function(adTracker,slotRegistry,pageLayout,browserDetect,log,win,rabbit){'use strict';var logGroup=
'ext.wikia.adEngine.tracking.adInfoTracker';function prepareData(slotName,pageParams,slotParams,creative,bidders){var data;function transformBidderPrice(bidderName){if(bidders.realSlotPrices&&bidders.realSlotPrices[bidderName]){return bidders.realSlotPrices[bidderName];}if(bidders.slotPricesIgnoringTimeout&&bidders.slotPricesIgnoringTimeout[bidderName]){return bidders.slotPricesIgnoringTimeout[bidderName]+'not_used';}return'';}pageParams=pageParams||{};slotParams=slotParams||{};creative=creative||{};bidders=bidders||{};data={'pv':pageParams.pv||'','pv_unique_id':win.pvUID,'browser':[browserDetect.getOS(),browserDetect.getBrowser()].join(' '),'country':pageParams.geo||'','time_bucket':(new Date()).getHours(),'slot_size':creative.slotSize&&creative.slotSize.length?creative.slotSize.join('x'):'','kv_s0':pageParams.s0||'','kv_s1':pageParams.s1||'','kv_s2':pageParams.s2||'','kv_s0v':pageParams.s0v||'','kv_pos':slotParams.pos||'','kv_rv':slotParams.rv||'','kv_wsi':slotParams.wsi||'',
'kv_lang':pageParams.lang||'','kv_skin':pageParams.skin||'','kv_esrb':pageParams.esrb||'','kv_ref':pageParams.ref||'','kv_top':pageParams.top||'','kv_ah':win.document.body.scrollHeight||'','kv_abi':slotParams.abi||'','bidder_won':bidders.bidderWon||'','bidder_won_price':bidders.bidderWon?bidders.realSlotPrices[bidders.bidderWon]:'','bidder_1':transformBidderPrice('indexExchange'),'bidder_2':transformBidderPrice('appnexus'),'bidder_4':transformBidderPrice('rubicon'),'bidder_6':transformBidderPrice('aol'),'bidder_7':transformBidderPrice('audienceNetwork'),'bidder_9':transformBidderPrice('openx'),'bidder_10':transformBidderPrice('appnexusAst'),'bidder_11':transformBidderPrice('rubicon_display'),'bidder_12':transformBidderPrice('a9'),'bidder_13':transformBidderPrice('onemobile'),'bidder_14':transformBidderPrice('pubmatic'),'product_chosen':creative.adProduct||'unknown','product_lineitem_id':creative.lineItemId||'','creative_id':creative.creativeId||'','creative_size':(creative.creativeSize
||'').replace('[','').replace(']','').replace(',','x'),'viewport_height':win.innerHeight||0,'ad_status':creative.status||'unknown','scroll_y':slotRegistry.getScrollY(slotName)||0,'rabbit':(rabbit&&rabbit.getSerializedResults())||'','page_width':win.document.body.scrollWidth||'','page_layout':pageLayout.getSerializedData(slotName)||''};log(['prepareData',slotName,data],log.levels.debug,logGroup);return data;}function track(slotName,pageParams,slotParams,adInfo,bidders){var data=prepareData(slotName,pageParams,slotParams,adInfo,bidders);adTracker.trackDW(data,'adengadinfo');log(['logSlotInfo',data],log.levels.debug,logGroup);}return{track:track};});;define('ext.wikia.adEngine.tracking.pageLayout',['wikia.document','wikia.domCalculator'],function(doc,domCalculator){'use strict';var topPositionSelectors={'INCONTENT_PLAYER':'#INCONTENT_WRAPPER','MOBILE_IN_CONTENT':'.mobile-in-content'};function getTopPosition(selector){var element=doc.querySelector(selector);if(element){return domCalculator
.getTopOffset(element);}}function getSerializedData(slotName){var data=[];if(topPositionSelectors[slotName]){data.push('pos_top='+getTopPosition(topPositionSelectors[slotName]));}return data.join(';');}return{getSerializedData:getSerializedData};});;define('ext.wikia.adEngine.tracking.viewabilityTracker',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','wikia.log','wikia.window'],function(adContext,adTracker,log,win){'use strict';var context=adContext.getContext(),logGroup='ext.wikia.adEngine.tracking.viewabilityTracker';function track(slot){if(!context.opts.kikimoraViewabilityTracking){log('Viewability tracking disabled',log.levels.info,logGroup);return;}var data,slotFirstChildData=slot.container.firstChild.dataset,slotParams=JSON.parse(slotFirstChildData.gptSlotParams);data={'pv_unique_id':win.pvUID,'wsi':slotParams.wsi||'','line_item_id':slotFirstChildData.gptLineItemId||'','creative_id':slotFirstChildData.gptCreativeId||'','rv':slotParams.rv||1};log(['Slot viewable',
slot.name,data],log.levels.info,logGroup);adTracker.trackDW(data,'adengviewability');}return{track:track};});;define('ext.wikia.adEngine.utils.adLogicZoneParams',['ext.wikia.adEngine.adContext','wikia.log','wikia.location'],function(adContext,log,loc){'use strict';var calculated=!1,context={},hostname=loc.hostname,logGroup='ext.wikia.adEngine.utils.adLogicZoneParams',maxNumberOfCategories=3,site,zone1,zone2;function updateContext(){context=adContext.getContext();calculated=!1;}function getDomain(){var lhost,pieces,sld='',np;lhost=hostname.toLowerCase();pieces=lhost.split('.');np=pieces.length;if(pieces[np-2]==='co'){sld=pieces[np-3]+'.'+pieces[np-2]+'.'+pieces[np-1];}else{sld=pieces[np-2]+'.'+pieces[np-1];}return sld.replace(/\./g,'');}function getHostnamePrefix(){var lhost=hostname.toLowerCase(),match=/(^|\.)(showcase|externaltest|preview|verify|stable|sandbox-[^\.]+)\./.exec(lhost);if(match&&match.length>2){return match[2];}var pieces=lhost.split('.');if(pieces.length){return pieces
[0];}}function getVerticalName(targeting){if(getHostnamePrefix()==='showcase'||context.opts.showcase===true){return'showcase';}return targeting.mappedVerticalName;}function getRawDbName(){return'_'+(context.targeting.wikiDbName||'wikia').replace('/[^0-9A-Z_a-z]/','_');}function getAdLayout(params){var layout=params.pageType||'article';if(layout==='article'&&context.targeting.hasFeaturedVideo){layout='fv-'+layout;}return layout;}function calculateParams(){log('calculateParams','info',logGroup);var mappedVertical=getVerticalName(context.targeting);if(context.targeting.pageIsHub){site='hub';zone1='_'+mappedVertical+'_hub';zone2='hub';}else{site=mappedVertical;zone1=getRawDbName();zone2=getAdLayout(context.targeting);}calculated=!0;log(['calculateParams',site,zone1,zone2],'info',logGroup);}function getSite(){if(!calculated){calculateParams();}return site;}function getName(){if(!calculated){calculateParams();}return zone1;}function getPageType(){if(!calculated){calculateParams();}return zone2
;}function getVertical(){return context.targeting.wikiVertical;}function getPageCategories(){var categories=context.targeting.pageCategories,outCategories;if(categories instanceof Array&&categories.length>0){outCategories=categories.slice(0,maxNumberOfCategories);return outCategories.join('|').toLowerCase().replace(/ /g,'_').split('|');}}function getLanguage(){return context.targeting.wikiLanguage||'unknown';}function getWikiCategories(){return context.targeting.newWikiCategories;}updateContext();adContext.addCallback(updateContext);return{getDomain:getDomain,getHostnamePrefix:getHostnamePrefix,getSite:getSite,getName:getName,getPageType:getPageType,getVertical:getVertical,getPageCategories:getPageCategories,getWikiCategories:getWikiCategories,getLanguage:getLanguage,getRawDbName:getRawDbName};});;define('ext.wikia.adEngine.utils.eventDispatcher',['wikia.document','wikia.log','wikia.window'],function(doc,log,win){'use strict';var logGroup='ext.wikia.adEngine.utils.eventDispatcher';
function dispatchEvent(name,data){var event=doc.createEvent('CustomEvent');event.initCustomEvent(name,true,true,data||{});win.dispatchEvent(event);log(['dispatchEvent',name,data],'info',logGroup);}return{dispatch:dispatchEvent};});;define('ext.wikia.adEngine.utils.hooks',[],function(){'use strict';return function(objectInstance,methodNames){var hooks={};function addHookListeners(){if(typeof objectInstance.pre==='function'||typeof objectInstance.post==='function'){return;}objectInstance.pre=function(methodName,callback){if(!hooks[methodName]){throw new Error('Method '+methodName+' is not registered.');}if(typeof callback==='function'){hooks[methodName].pre.push(callback);}};objectInstance.post=function(methodName,callback){if(!hooks[methodName]){throw new Error('Method '+methodName+' is not registered.');}if(typeof callback==='function'){hooks[methodName].post.push(callback);}};}function callAllCallbacks(callbacks,args){callbacks.forEach(function(callback){callback.apply(objectInstance,
args);});}methodNames.forEach(function(methodName){var copy=objectInstance[methodName];if(typeof copy!=='function'){throw new Error('Method '+methodName+' does not exist.');}hooks[methodName]={pre:[],post:[]};objectInstance[methodName]=function(){callAllCallbacks(hooks[methodName].pre,arguments);copy.apply(objectInstance,arguments);callAllCallbacks(hooks[methodName].post,arguments);};});addHookListeners();};});;define('ext.wikia.adEngine.utils.math',[],function(){'use strict';function getBucket(number,bucketSize){return parseInt(number/bucketSize,10)*bucketSize;}function leftPad(number,offset){var label=number+'';while(label.length<offset){label='0'+label;}return label;}return{getBucket:getBucket,leftPad:leftPad};});;define('ext.wikia.adEngine.video.player.ooyala.ooyalaTracker',['ext.wikia.adEngine.video.player.playerTracker','wikia.window'],function(playerTracker,win){'use strict';var playerName='ooyala',trackingEventsMap={adsClickthroughOpened:'clicked',ADS_ERROR:'error',ADS_PLAYED:
'completed',WILL_PLAY_ADS:'loaded',PLAYER_CREATED:'ready',WILL_PAUSE_ADS:'paused',WILL_RESUME_ADS:'resumed',WILL_PLAY_SINGLE_AD:'started',WILL_PLAY_FROM_BEGINNING:'content_started',PLAYED:'content_completed'};function track(params,eventName){playerTracker.track(params,playerName,eventName);}function register(player,params){if(!win.OO||!player||!playerTracker.isEnabled()){return;}Object.keys(trackingEventsMap).forEach(function(playerEvent){player.mb.subscribe(win.OO.EVENTS[playerEvent]||playerEvent,'ooyala-kikimora-tracking',function(){track(params,trackingEventsMap[playerEvent]);});});}return{register:register,track:track};});;define('ext.wikia.adEngine.video.player.playwire',['ext.wikia.adEngine.video.player.playwire.playwirePlayerFactory','ext.wikia.adEngine.video.player.playwire.playwireTracker','ext.wikia.adEngine.video.vastUrlBuilder','wikia.document','wikia.log'],function(playerFactory,tracker,vastUrlBuilder,doc,log){'use strict';var logGroup=
'ext.wikia.adEngine.video.player.playwire',playerUrl='//cdn.playwire.com/bolt/js/zeus/embed.js';function getConfigUrl(publisherId,videoId){return'//config.playwire.com/'+publisherId+'/videos/v2/'+videoId+'/zeus.json';}function inject(params){var configUrl=params.configUrl,container=params.container,height=params.height,playerId='playwire_'+Math.floor((1+Math.random())*0x10000),script=doc.createElement('script'),vastUrlBuilderOptions={useMegaAdUnitBuilder:params.useMegaAdUnitBuilder},vastUrl=params.vastUrl,vastTargeting=params.vastTargeting||{passback:'playwire',pos:params.slotName,src:params.src},width=params.width,win=container.ownerDocument.defaultView||container.ownerDocument.parentWindow;tracker.track(params,'init');return new Promise(function(resolve){configUrl=configUrl||getConfigUrl(params.publisherId,params.videoId);vastUrl=vastUrl||vastUrlBuilder.build(width/height,vastTargeting,vastUrlBuilderOptions);win[playerId+'_ready']=function(){var video=playerFactory.create(win.Bolt,
playerId,params);tracker.register(video,params);video.addEventListener('boltContentStarted',function(){video.api.dispatchEvent(video.id,'wikiaAdStarted');});video.addEventListener('boltContentComplete',function(){video.api.dispatchEvent(video.id,'wikiaAdCompleted');});resolve(video);if(params.onReady){params.onReady(win.Bolt,playerId,video);}};script.setAttribute('data-id',playerId);script.setAttribute('data-config',configUrl);script.setAttribute('data-onready',playerId+'_ready');script.setAttribute('data-ad-tag',vastUrl);if(params.volume!==undefined){script.setAttribute('data-volume',params.volume);}script.setAttribute('type','text/javascript');script.src=playerUrl;container.appendChild(script);log(['inject',configUrl],log.levels.debug,logGroup);});}return{getConfigUrl:getConfigUrl,inject:inject};});;define('ext.wikia.adEngine.video.player.playwire.playwirePlayerFactory',[],function(){'use strict';function create(api,playerId,params){return{api:api,id:playerId,container:params.
container,addEventListener:function(eventName,callback){this.api.on(this.id,eventName,callback);},play:function(width,height){this.api.dispatchEvent(this.id,'wikiaAdPlayTriggered');this.resize(width,height);this.api.playMedia(this.id);this.api.dispatchEvent(this.id,'wikiaAdStarted');},stop:function(){this.api.dispatchEvent(this.id,'wikiaAdStop');this.api.stopMedia(this.id);this.api.dispatchEvent(this.id,'wikiaAdCompleted');},resize:function(width,height){this.api.resizeVideo(this.id,width+'px',height+'px');}};}return{create:create};});;define('ext.wikia.adEngine.video.player.playwire.playwireTracker',['ext.wikia.adEngine.video.player.playerTracker'],function(playerTracker){'use strict';var playerName='playwire',trackingEventsMap={'boltAdRequestStart':'loaded','boltAdStarted':'started','boltFirstQuartile':'first_quartile','boltMidPoint':'midpoint','boltThirdQuartile':'third_quartile','boltAdComplete':'completed','boltAdClicked':'clicked','boltAdError':'error','boltContentStarted':
'content_started','boltContentComplete':'content_completed','boltContentError':'content_error','wikiaAdPlayTriggered':'play_triggered','wikiaAdStop':'closed'};function track(params,eventName,errorCode){playerTracker.track(params,playerName,eventName,errorCode);}function register(player,params){if(!playerTracker.isEnabled()){return;}playerTracker.track(params,playerName,'ready');Object.keys(trackingEventsMap).forEach(function(playerEvent){player.api.addEventListener(player.id,playerEvent,function(){playerTracker.track(params,playerName,trackingEventsMap[playerEvent]);});});}return{register:register,track:track};});;define('ext.wikia.adEngine.video.player.porvata.floater',['ext.wikia.adEngine.video.player.porvata.floaterConfiguration','ext.wikia.adEngine.video.player.porvata.floatingContextFactory','wikia.document','wikia.throttle','wikia.window'],function(floaterConfiguration,floatingContextFactory,doc,throttle,win){'use strict';var activeFloatingCssClass='floating',
withArticleVideoCssClass='with-article-video',wikiFloatingVideoSelector='.video-container',floatingContextCache={};function updateDimensions(element,width,height){if(element){element.style.width=width+'px';element.style.height=height+'px';}}function createCloseButton(){var a=doc.createElement('a'),img=doc.createElement('img');a.classList.add('floating-close-button');img.src='/extensions/wikia/AdEngine/js/video/player/ui/images/close.svg';a.appendChild(img);return a;}function resizeVideoAndShowCloseButton(floatingContext,width,height){var elements=floatingContext.elements,listeners=floatingContext.listeners;if(!listeners.start){listeners.start=function(){if(floatingContext.isFloating()){elements.video.resize(width,height);}};elements.video.addEventListener('start',listeners.start);}elements.video.resize(width,height);}function deleteCloseButton(floatingContext){var elements=floatingContext.elements;if(elements.closeButton){elements.ad.removeChild(elements.closeButton);}}function
endFloating(floatingContext){var video=floatingContext.elements.video,listeners=floatingContext.listeners;win.removeEventListener('scroll',listeners.scroll);if(listeners.start){video.removeEventListener('start',listeners.start);}if(listeners.adResumed){video.removeEventListener('resume',listeners.adResumed);}if(listeners.adCompleted){video.removeEventListener('wikiaAdCompleted',listeners.adCompleted);}floatingContext.stop();}function createOnCloseListener(floatingContext){return function(){disableFloating(floatingContext);if(floatingContext.pauseOnClose){floatingContext.stop();}else{endFloating(floatingContext);}};}function enableFloating(floatingContext){var elements=floatingContext.elements,width=0,height=0;floatingContext.beforeFloat();elements.adContainer.classList.add(activeFloatingCssClass);width=floatingContext.getWidth();height=floatingContext.getHeight();updateDimensions(elements.imageContainer,width,height);resizeVideoAndShowCloseButton(floatingContext,width,height);
floatingContext.float();}function disableFloating(floatingContext){var elements=floatingContext.elements,preferred=floatingContext.preferred;elements.adContainer.classList.remove(activeFloatingCssClass);updateDimensions(elements.imageContainer,preferred.width,preferred.height);elements.video.resize(preferred.width,preferred.height);floatingContext.pause();if(elements.video.isCompleted()){deleteCloseButton(floatingContext);endFloating(floatingContext);}}function isArticleVideoFloating(){var element=doc.querySelector(wikiFloatingVideoSelector);return element&&'fixed'===win.getComputedStyle(element).position;}function showAboveArticleVideo(floatingContext){floatingContext.elements.adContainer.classList.toggle(withArticleVideoCssClass,isArticleVideoFloating());}function createOnScrollListener(floatingContext){return function(){if(!floatingContext.doNotFloat){if(floatingContext.isOutsideOfViewport()){showAboveArticleVideo(floatingContext);if(floatingContext.isStill()){enableFloating(
floatingContext);}}else if(floatingContext.isFloating()){disableFloating(floatingContext);}}};}function enableFloatingOn(video,params,eventHandlers){var floatingContext=floatingContextFactory.create(video,params,eventHandlers),elements=floatingContext.elements,listeners=floatingContext.listeners;if(!elements.closeButton){elements.closeButton=createCloseButton();listeners.close=createOnCloseListener(floatingContext);elements.closeButton.addEventListener('click',listeners.close);elements.ad.insertBefore(elements.closeButton,elements.ad.firstChild);}listeners.scroll=throttle(createOnScrollListener(floatingContext),100);win.addEventListener('scroll',listeners.scroll);listeners.adCompleted=function(){disableFloating(floatingContext);elements.video.removeEventListener('wikiaAdCompleted',listeners.adCompleted);win.removeEventListener('scroll',listeners.scroll);};elements.video.addEventListener('wikiaAdCompleted',listeners.adCompleted);if(floatingContext.pauseOnClose){listeners.adResumed=
function(){if(floatingContext.isStopped()){floatingContext.pause();}};elements.video.addEventListener('resume',listeners.adResumed);}return floatingContext;}function makeFloat(video,params,eventHandlers){var floatingContext=enableFloatingOn(video,params,eventHandlers);floatingContext.invokeLater(function(floatingContext){showAboveArticleVideo(floatingContext);enableFloating(floatingContext);});floatingContextCache[params.slotName]=floatingContext;return floatingContext;}function canFloat(params){return floaterConfiguration.canFloat(params);}function isFloating(slotName){return floatingContextCache[slotName]&&floatingContextCache[slotName].elements.adContainer.classList.contains(activeFloatingCssClass);}return{canFloat:canFloat,makeFloat:makeFloat,isFloating:isFloating};});;define('ext.wikia.adEngine.video.player.porvata.floaterConfiguration',[],function(){'use strict';var slotsConfiguration={'INCONTENT_PLAYER':{enableKeyword:'enableInContentFloating',container:'WikiaArticle',configure:
function(floatingContext){var elements=floatingContext.elements;elements.viewport=elements.ad.parentElement;floatingContext.forceDoNotFloat();},floatLater:function(callback){var floatingContext=this,video=this.elements.video;video.addEventListener('wikiaSlotExpanded',function(){floatingContext.preferred.width=video.container.scrollWidth;floatingContext.preferred.height=video.container.scrollHeight;floatingContext.floatAgain();floatingContext.fireEvent('start');if(floatingContext.isOutsideOfViewport()){callback(floatingContext);}});},onAttach:function(floatingContext){var elements=floatingContext.elements;elements.ad.style.maxHeight=elements.ad.scrollHeight+'px';elements.viewport.style.removeProperty('height');elements.providerContainer.style.removeProperty('height');},onBeforeDetach:function(floatingContext){var viewport=floatingContext.elements.viewport;viewport.style.height=(viewport.offsetHeight-14)+'px';},onDetach:function(floatingContext){floatingContext.elements.providerContainer
.style.height=floatingContext.getHeight()+'px';}}};function configure(floatingContext,params){var configuration=selectConfigurationUsing(params);configuration.configure(floatingContext);floatingContext.preferred={};floatingContext.preferred.width=params.width;floatingContext.preferred.height=params.height;floatingContext.eventHandlers.onAttach=configuration.onAttach;floatingContext.eventHandlers.onBeforeDetach=configuration.onBeforeDetach;floatingContext.eventHandlers.onDetach=configuration.onDetach;floatingContext.floatLater=configuration.floatLater;}function selectConfigurationUsing(params){return slotsConfiguration[params.slotName];}function canFloat(params){var configuration=selectConfigurationUsing(params);return Boolean(configuration&&params[configuration.enableKeyword]);}return{canFloat:canFloat,configure:configure,selectConfigurationUsing:selectConfigurationUsing};});;define('ext.wikia.adEngine.video.player.porvata.floatingContextFactory',[
'ext.wikia.adEngine.video.player.porvata.floaterConfiguration','wikia.document','wikia.window'],function(floaterConfiguration,doc,win){'use strict';var events={attach:'attach',beforeDetach:'beforeDetach',detach:'detach',end:'end',start:'start'},floatingThreshold=55,state={deactivated:'deactivated',floating:'floating',never:'never',paused:'paused',stopped:'stopped'};function create(video,params,eventHandlers){var configuration=floaterConfiguration.selectConfigurationUsing(params),adContainer=doc.getElementById(configuration.container),ad=adContainer.querySelector('.wikia-ad'),container=params.originalContainer||params.container,elements={adContainer:adContainer,ad:ad,originalContainer:params.originalContainer,iframe:container.ownerDocument.defaultView.frameElement,imageContainer:container.parentElement.querySelector('#image'),providerContainer:ad.querySelector('.provider-container'),video:video},floatingContext={beforeFloat:function(){this.fireEvent(events.beforeDetach);},doNotFloat:
!1,elements:elements,eventHandlers:eventHandlers,fireEvent:function(eventName){var eventHandler='on'+eventName.charAt(0).toUpperCase()+eventName.slice(1);if(this.eventHandlers[eventHandler]){this.eventHandlers[eventHandler](this);}},float:function(){this.state=state.floating;this.fireEvent(events.detach);},floatAgain:function(){this.doNotFloat=!1;},forceDoNotFloat:function(){this.doNotFloat=!0;},getHeight:function(){return this.getWidth()/this.elements.video.computeVastMediaAspectRatio();},getWidth:function(){return elements.ad.offsetWidth;},isActive:function(){return this.state!==state.stopped;},invokeLater:function(callback){this.floatLater(callback);},isFloating:function(){return this.state===state.floating;},isOutsideOfViewport:function(){var rect=this.elements.viewport.getBoundingClientRect();return rect.top>(win.innerHeight||doc.documentElement.clientHeight)||rect.bottom<floatingThreshold;},isStill:function(){return this.state===state.never||this.state===state.paused;},
isStopped:function(){return this.state===state.stopped;},listeners:{},pause:function(){this.state=state.paused;this.fireEvent(events.attach);},pauseOnClose:params.hasUiControls,state:state.never,stop:function(){this.state=state.stopped;this.fireEvent(events.end);}};floaterConfiguration.configure(floatingContext,params);return floatingContext;}return{create:create};});;define('ext.wikia.adEngine.video.player.porvata.googleIma',['ext.wikia.adEngine.utils.scriptLoader','ext.wikia.adEngine.video.player.porvata.googleImaPlayerFactory','ext.wikia.aRecoveryEngine.sourcePoint.recovery','wikia.log','wikia.window'],function(scriptLoader,imaPlayerFactory,adBlockRecovery,log,win){'use strict';var imaLibraryUrl='//imasdk.googleapis.com/js/sdkloader/ima3.js',logGroup='ext.wikia.adEngine.video.player.porvata.googleIma';function load(){if(win.google&&win.google.ima){return new Promise(function(resolve){log('Google IMA library already loaded',log.levels.info,logGroup);resolve();});}return scriptLoader.
loadScript(adBlockRecovery.getSafeUri(imaLibraryUrl));}function getPlayer(videoSettings){var params=videoSettings.getParams(),adDisplayContainer=new win.google.ima.AdDisplayContainer(params.container),adsLoader,iframe=params.container.querySelector('div > iframe');if(win.performance&&win.performance.navigation.type===win.performance.navigation.TYPE_BACK_FORWARD){iframe.contentWindow.location.href=iframe.src;}adsLoader=new win.google.ima.AdsLoader(adDisplayContainer);adsLoader.getSettings().setVpaidMode(videoSettings.getVpaidMode());return imaPlayerFactory.create(adDisplayContainer,adsLoader,videoSettings);}return{load:load,getPlayer:getPlayer};});;define('ext.wikia.adEngine.video.player.porvata.googleImaPlayerFactory',['ext.wikia.adEngine.video.player.porvata.googleImaSetup','ext.wikia.adEngine.video.player.porvata.moatVideoTracker','ext.wikia.adEngine.video.vastDebugger','wikia.document','wikia.log','wikia.window'],function(imaSetup,moatVideoTracker,vastDebugger,doc,log,win){
'use strict';var logGroup='ext.wikia.adEngine.video.player.porvata.googleImaPlayerFactory';function getVideoElement(){var videoElement=doc.createElement('video');videoElement.setAttribute('preload','none');return videoElement;}function create(adDisplayContainer,adsLoader,videoSettings){var adRequest,params=videoSettings.getParams(),isAdsManagerLoaded=!1,status='',videoElement=getVideoElement(),adsManager,mobileVideoAd=params.container.querySelector('video'),eventListeners={};function setVastAttributes(status){var currentAd=adsManager&&adsManager.getCurrentAd&&adsManager.getCurrentAd(),playerElement=params.container.querySelector('.video-player');vastDebugger.setVastAttributes(playerElement,adRequest.adTagUrl,status,currentAd);}function adsManagerLoadedCallback(adsManagerLoadedEvent){adsManager=adsManagerLoadedEvent.getAdsManager(videoElement,imaSetup.getRenderingSettings(params));isAdsManagerLoaded=!0;if(videoSettings.isMoatTrackingEnabled()){moatVideoTracker.init(adsManager,
params.container,win.google.ima.ViewMode.NORMAL,params.src,params.adProduct+'/'+params.slotName);}dispatchEvent('wikiaAdsManagerLoaded');log('AdsManager loaded',log.levels.debug,logGroup);adsManager.addEventListener(win.google.ima.AdEvent.Type.LOADED,function(){setVastAttributes('success');});adsManager.addEventListener(win.google.ima.AdErrorEvent.Type.AD_ERROR,function(){setVastAttributes('error');});}function addEventListener(eventName,callback){log(['addEventListener to AdManager',eventName],log.levels.debug,logGroup);if(eventName.indexOf('wikia')!==-1){eventListeners[eventName]=eventListeners[eventName]||[];eventListeners[eventName].push(callback);return;}if(isAdsManagerLoaded){adsManager.addEventListener(eventName,callback);}else{adsLoader.addEventListener(win.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(){adsManager.addEventListener(eventName,callback);});}}function removeEventListener(eventName,callback){log(['removeEventListener to AdManager',eventName],log
.levels.debug,logGroup);if(eventListeners[eventName]){var listenerId=eventListeners[eventName].indexOf(callback);if(listenerId!==-1){eventListeners[eventName].splice(listenerId,1);}return;}if(isAdsManagerLoaded){adsManager.removeEventListener(eventName,callback);}else{adsLoader.addEventListener(win.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(){adsManager.removeEventListener(eventName,callback);});}}function setAutoPlay(value){if(mobileVideoAd){mobileVideoAd.muted=value;mobileVideoAd.autoplay=value;}}function playVideo(width,height){function callback(){var roundedWidth=Math.round(width),roundedHeight=Math.round(height);log(['Video play: prepare player UI',roundedWidth,roundedHeight],log.levels.debug,logGroup);dispatchEvent('wikiaAdPlayTriggered');adDisplayContainer.initialize();adsManager.init(roundedWidth,roundedHeight,win.google.ima.ViewMode.NORMAL);adsManager.start();adsLoader.removeEventListener(win.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,
callback);log('Video play: started',log.levels.debug,logGroup);}if(isAdsManagerLoaded){callback();}else{setAutoPlay(true);adsLoader.addEventListener(win.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,callback,false);log(['Video play: waiting for full load of adsManager'],log.levels.debug,logGroup);}}function reload(reloadParams){if(adsManager){adsManager.destroy();}adsLoader.contentComplete();adRequest=imaSetup.createRequest(reloadParams||params);adsLoader.requestAds(adRequest);log('IMA player reloaded',log.levels.debug,logGroup);}function resize(width,height){var roundedWidth=Math.round(width),roundedHeight=Math.round(height);if(adsManager){adsManager.resize(roundedWidth,roundedHeight,win.google.ima.ViewMode.NORMAL);log(['IMA player resized',roundedWidth,roundedHeight],log.levels.debug,logGroup);}}function dispatchEvent(eventName){if(eventListeners[eventName]&&eventListeners[eventName].length>0){eventListeners[eventName].forEach(function(callback){callback({});});}}function
setStatus(newStatus){return function(){status=newStatus;};}function getStatus(){return status;}function getAdsManager(){return adsManager;}if(mobileVideoAd){params.container.classList.add('mobile-porvata');}adsLoader.addEventListener(win.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,adsManagerLoadedCallback,false);adsLoader.addEventListener(win.google.ima.AdErrorEvent.Type.AD_ERROR,function(event){var emptyVastErrorCode=win.google.ima.AdError.ErrorCode.VAST_EMPTY_RESPONSE;if(typeof event.getError==='function'&&event.getError().getErrorCode()===emptyVastErrorCode){dispatchEvent('wikiaEmptyAd');}setVastAttributes('error');});adRequest=imaSetup.createRequest(params);adsLoader.requestAds(adRequest);if(videoSettings.isAutoPlay()){setAutoPlay(true);}addEventListener(win.google.ima.AdEvent.Type.RESUMED,setStatus('playing'));addEventListener(win.google.ima.AdEvent.Type.STARTED,setStatus('playing'));addEventListener(win.google.ima.AdEvent.Type.PAUSED,setStatus('paused'));
addEventListener(win.google.ima.AdEvent.Type.COMPLETE,setStatus('completed'));return{addEventListener:addEventListener,dispatchEvent:dispatchEvent,getAdsManager:getAdsManager,getStatus:getStatus,playVideo:playVideo,reload:reload,removeEventListener:removeEventListener,resize:resize,setAutoPlay:setAutoPlay};}return{create:create};});;define('ext.wikia.adEngine.video.player.porvata.googleImaSetup',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.slot.service.megaAdUnitBuilder','ext.wikia.adEngine.video.vastUrlBuilder','ext.wikia.aRecoveryEngine.sourcePoint.recovery','wikia.browserDetect','wikia.log','wikia.window'],function(adContext,megaAdUnitBuilder,vastUrlBuilder,adBlockRecovery,browserDetect,log,win){'use strict';var logGroup='ext.wikia.adEngine.video.player.porvata.googleImaSetup';function megaIsEnabled(params){return params.useMegaAdUnitBuilder!==!1&&(params.useMegaAdUnitBuilder||adContext.get('opts.megaAdUnitBuilderEnabled'));}function getPosBasedOnProduct(params){if(params.
adProduct==='abcd'){return params.adProduct.toUpperCase();}if(params.adProduct==='vuap'){return'UAP_'+params.type.toUpperCase();}return params.vastTargeting.pos;}function buildVastUrl(params){var vastUrlBuilderOptions={},vastUrl;if(megaIsEnabled(params)){vastUrlBuilderOptions.adUnit=megaAdUnitBuilder.build(getPosBasedOnProduct(params),params.vastTargeting.src);}vastUrl=params.vastUrl||vastUrlBuilder.build(params.width/params.height,params.vastTargeting,vastUrlBuilderOptions);log(['build vast url',vastUrl,params],log.levels.debug,logGroup);return adBlockRecovery.getSafeUri(vastUrl);}function getOverriddenVast(){if(win.location.href.indexOf('porvata_override_vast=1')!==-1){return win.localStorage.getItem('porvata_vast');}}function createRequest(params){var adsRequest=new win.google.ima.AdsRequest(),overriddenVast=getOverriddenVast();if(params.vastResponse||overriddenVast){adsRequest.adsResponse=overriddenVast||params.vastResponse;}adsRequest.adTagUrl=buildVastUrl(params);adsRequest.
linearAdSlotWidth=params.width;adsRequest.linearAdSlotHeight=params.height;adsRequest.nonLinearAdSlotWidth=params.width;adsRequest.nonLinearAdSlotHeight=params.height;log(['ads request created',adsRequest],log.levels.debug,logGroup);return adsRequest;}function getRenderingSettings(params){var adsRenderingSettings=new win.google.ima.AdsRenderingSettings(),maximumRecommendedBitrate=68000;params=params||{};if(!browserDetect.isMobile()){adsRenderingSettings.bitrate=maximumRecommendedBitrate;}adsRenderingSettings.loadVideoTimeout=params.loadVideoTimeout||15000;adsRenderingSettings.enablePreloading=!0;adsRenderingSettings.uiElements=[];log(['ads rendering settings created',adsRenderingSettings],log.levels.debug,logGroup);return adsRenderingSettings;}return{createRequest:createRequest,getRenderingSettings:getRenderingSettings};});;define('ext.wikia.adEngine.video.player.porvata.moatVideoTracker',['wikia.log','wikia.window'],function(log,win){'use strict';var logGroup=
'ext.wikia.adEngine.video.player.porvata.moatVideoTracker',partnerCode='wikiaimajsint377461931603';function init(adsManager,container,viewMode,src,pos){var ids={partnerCode:partnerCode,viewMode:viewMode,slicer1:src,slicer2:pos};try{win.initMoatTracking(adsManager,ids,container,src,pos);log(['MOAT video tracking initialized with params',adsManager,ids,container,src,pos],log.levels.debug,logGroup);}catch(error){log(['MOAT video tracking initalization error',error],log.levels.debug,logGroup);}}return{init:init};});;function initMoatTracking(a,f,c){if(!1===f.hasOwnProperty("partnerCode"))return!1;var g=document.createElement("script");c=c||a&&("undefined"!==typeof a.O?a.O.parentNode:document.body)||document.body;listeners=[];moatapi={adsManager:a,ids:f,imaSDK:!0,events:[]};eventMapping={complete:"AdVideoComplete",firstquartile:"AdVideoFirstQuartile",impression:"AdImpression",loaded:"AdLoaded",midpoint:"AdVideoMidpoint",pause:"AdPaused",skip:"AdSkipped",start:"AdVideoStart",thirdquartile:
"AdVideoThirdQuartile",volumeChange:"AdVolumeChange"};if(google&&google.ima&&a){var d="_moatApi"+Math.floor(1E8*Math.random()),h;for(h in google.ima.AdEvent.Type){var l=function(b){if(moatapi.sendEvent){for(b=listeners.length-1;0<=b;b--)a.removeEventListener(listeners[b].type,listeners[b].func);moatapi.sendEvent(moatapi.events)}else moatapi.events.push({type:eventMapping[b.type]||b.type,adVolume:a.getVolume()})};a.addEventListener(google.ima.AdEvent.Type[h],l);listeners.push({type:google.ima.AdEvent.Type[h],func:l})}}var d="undefined"!==typeof d?d:"",e,k;try{e=c.ownerDocument,k=e.defaultView||e.parentWindow}catch(m){e=document,k=window}k[d]=moatapi;g.type="text/javascript";c&&c.appendChild(g);g.src="https://z.moatads.com/"+f.partnerCode+"/moatvideo.js#"+d};;define('ext.wikia.adEngine.video.player.porvata',['ext.wikia.adEngine.video.player.porvata.googleIma','ext.wikia.adEngine.video.player.porvata.porvataPlayerFactory','ext.wikia.adEngine.video.player.porvata.porvataTracker',
'wikia.document','wikia.log','wikia.viewportObserver',require.optional('ext.wikia.adEngine.video.player.porvata.floater')],function(googleIma,porvataPlayerFactory,tracker,doc,log,viewportObserver,floater){'use strict';var logGroup='ext.wikia.adEngine.video.player.porvata';function inject(videoSettings){var params=videoSettings.getParams(),isFirstPlay=!0,autoPlayed=!1,autoPaused=!1,viewportListener=null;function isFloatingEnabled(params){return params.floatingContext&&params.floatingContext.isActive();}function tryEnablingFloating(video,inViewportCallback){if(floater&&floater.canFloat(params)){params.floatingContext=floater.makeFloat(video,params,{onStart:function(){inViewportCallback(true);},onEnd:function(){inViewportCallback(false);}});}}function muteFirstPlay(video){video.addEventListener('loaded',function(){if(isFirstPlay){video.mute();}});}log(['injecting porvata player',params],log.levels.debug,logGroup);tracker.track(params,'init');params.vastTargeting=params.
vastTargeting||{src:params.src,pos:params.slotName,passback:'porvata'};return googleIma.load().then(function(){log('google ima loaded',log.levels.debug,logGroup);return googleIma.getPlayer(videoSettings);}).then(function(ima){log(['ima player set up',ima],log.levels.debug,logGroup);return porvataPlayerFactory.create(videoSettings,ima);}).then(function(video){var viewportHook=params.container;video.wasInViewport=!1;log(['porvata video player created',video],log.levels.debug,logGroup);tracker.register(video,params);if(params.viewportHookSelector){viewportHook=doc.querySelector(params.viewportHookSelector)||viewportHook;}function shouldResume(isVisible){return isVisible&&autoPaused&&!isFloatingEnabled(params);}function shouldPause(isVisible){return!params.blockOutOfViewportPausing&&!isVisible&&video.isPlaying()&&!isFloatingEnabled(params);}function inViewportCallback(isVisible){video.wasInViewport=!0;if(isVisible&&!autoPlayed&&videoSettings.isAutoPlay()){video.ima.dispatchEvent(
'wikiaFirstTimeInViewport');video.play();autoPlayed=!0;}else if(shouldResume(isVisible)){video.resume();}else if(shouldPause(isVisible)){video.pause();autoPaused=!0;}}video.addEventListener('adCanPlay',function(){video.ima.dispatchEvent('wikiaAdStarted');});video.addEventListener('allAdsCompleted',function(){isFirstPlay=!1;video.ima.setAutoPlay(false);video.ima.dispatchEvent('wikiaAdCompleted');if(viewportListener){viewportObserver.removeListener(viewportListener);viewportListener=null;}});video.addEventListener('start',function(){video.ima.dispatchEvent('wikiaAdPlay');if(!viewportListener){viewportListener=viewportObserver.addListener(viewportHook,inViewportCallback);}});video.addEventListener('loaded',function(){tryEnablingFloating(video,inViewportCallback);});video.addEventListener('resume',function(){video.ima.dispatchEvent('wikiaAdPlay');autoPaused=!1;});video.addEventListener('pause',function(){video.ima.dispatchEvent('wikiaAdPause');});video.addOnDestroyCallback(
function(){if(viewportListener){viewportObserver.removeListener(viewportListener);viewportListener=null;}});if(videoSettings.isAutoPlay()){muteFirstPlay(video);}video.addEventListener('wikiaAdsManagerLoaded',function(){viewportListener=viewportObserver.addListener(viewportHook,inViewportCallback);});video.addEventListener('wikiaEmptyAd',function(){viewportListener=viewportObserver.addListener(viewportHook,inViewportCallback);});return video;});}return{inject:inject};});;define('ext.wikia.adEngine.video.player.porvata.porvataPlayerFactory',['ext.wikia.adEngine.domElementTweaker','wikia.log'],function(DOMElementTweaker,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.porvata.porvataPlayerFactory',autoPlayClassName='autoplay',defaultAspectRatio=320/240,videoPlayerClassName='video-player';function prepareVideoAdContainer(videoAdContainer,videoSettings){DOMElementTweaker.hide(videoAdContainer);videoAdContainer.classList.add(videoPlayerClassName);if(videoSettings.isAutoPlay())
{videoAdContainer.classList.add(autoPlayClassName);}return videoAdContainer;}function create(videoSettings,ima){var params=videoSettings.getParams(),width=params.width,height=params.height,mobileVideoAd=params.container.querySelector('video'),videoAdContainer=params.container.querySelector('div'),destroyCallbacks=[];log(['create porvata player'],log.levels.debug,logGroup);return{container:prepareVideoAdContainer(videoAdContainer,videoSettings),ima:ima,addEventListener:function(eventName,callback){ima.addEventListener(eventName,callback);},computeVastMediaAspectRatio:function(){var adsManager=ima.getAdsManager(),aspectRatio=width/height,currentAd,vastHeight=0,vastWidth=0;if(adsManager){currentAd=adsManager.getCurrentAd();vastHeight=currentAd.getVastMediaHeight();vastWidth=currentAd.getVastMediaWidth();aspectRatio=(vastWidth&&vastHeight)?vastWidth/vastHeight:defaultAspectRatio;}return aspectRatio;},getRemainingTime:function(){return ima.getAdsManager().getRemainingTime();},getVolume:
function(){return ima.getAdsManager().getVolume();},isFloating:function(){return Boolean(params.floatingContext&&params.floatingContext.isFloating());},isMuted:function(){return ima.getAdsManager().getVolume()===0;},isMobilePlayerMuted:function(){var mobileVideoAd=this.container.querySelector('video');return mobileVideoAd&&mobileVideoAd.autoplay&&mobileVideoAd.muted;},isPaused:function(){return ima.getStatus()==='paused';},isPlaying:function(){return ima.getStatus()==='playing';},isCompleted:function(){return ima.getStatus()==='completed';},pause:function(){ima.getAdsManager().pause();},play:function(newWidth,newHeight){if(newWidth!==undefined&&newHeight!==undefined){width=newWidth;height=newHeight;}if(!width||!height){width=params.container.offsetWidth;height=params.container.offsetHeight;}ima.playVideo(width,height);},reload:function(reloadParams){ima.reload(reloadParams);},removeEventListener:function(eventName,callback){ima.removeEventListener(eventName,callback);},resize:function(
newWidth,newHeight){width=newWidth;height=newHeight;ima.resize(width,height);},resume:function(){ima.getAdsManager().resume();},mute:function(){return this.setVolume(0);},unmute:function(){return this.setVolume(0.75);},volumeToggle:function(){if(this.isMuted()){this.unmute();}else{this.mute();}},setVolume:function(volume){this.updateVideoDOMElement(volume);ima.getAdsManager().setVolume(volume);ima.dispatchEvent('wikiaVolumeChange');},stop:function(){ima.dispatchEvent('wikiaAdStop');ima.getAdsManager().stop();},updateVideoDOMElement:function(volume){if(mobileVideoAd){mobileVideoAd.muted=volume===0;}},addOnDestroyCallback:function(callback){destroyCallbacks.push(callback);},destroy:function(){var callback=destroyCallbacks.pop();while(callback){callback(this);callback=destroyCallbacks.pop();}}};}return{create:create};});;define('ext.wikia.adEngine.video.player.porvata.porvataTracker',['ext.wikia.adEngine.video.player.playerTracker','ext.wikia.adEngine.video.player.porvata.vastLogger'],
function(playerTracker,logger){'use strict';var playerName='porvata',trackingEventsMap={'adCanPlay':'ad_can_play','complete':'completed','click':'clicked','firstquartile':'first_quartile','impression':'impression','loaded':'loaded','midpoint':'midpoint','pause':'paused','resume':'resumed','start':'started','thirdquartile':'third_quartile','viewable_impression':'viewable_impression','adError':'error','wikiaAdPlayTriggered':'play_triggered','wikiaAdStop':'closed','wikiaInViewportWithDirect':'in_viewport_with_direct','wikiaInViewportWithFallbackBid':'in_viewport_with_fallback_bid','wikiaInViewportWithoutOffer':'in_viewport_without_offer'};function getContentType(player){var ad;if(player){ad=player.ima.getAdsManager()&&player.ima.getAdsManager().getCurrentAd();if(ad){return ad.getContentType();}}}function track(params,eventName,errorCode,player){var contentType=getContentType(player),data=playerTracker.track(params,playerName,eventName,errorCode,contentType);if(data&&params.adProduct===
'rubicon'){logger.logVast(player,params,data);}}function register(player,params){if(!playerTracker.isEnabled()){return;}track(params,'ready');Object.keys(trackingEventsMap).forEach(function(playerEvent){player.addEventListener(playerEvent,function(event){var errorCode=event.getError&&event.getError().getErrorCode();track(params,trackingEventsMap[playerEvent],errorCode,player);});});}return{register:register,track:track};});;define('ext.wikia.adEngine.video.player.porvata.vastLogger',['wikia.instantGlobals','wikia.log','wikia.window'],function(instantGlobals,log,win){'use strict';var config=instantGlobals.wgPorvataVastLoggerConfig||[],trackEndpoint='/wikia.php?controller=AdEngine2Api&method=postPorvataInfo',logGroup='ext.wikia.adEngine.video.player.porvata.vastLogger';function createConfigKey(advertiserId,eventName){return[advertiserId,eventName].join('_');}function prepareData(data,playerParams){return['advertiser_id='+playerParams.bid.rubiconAdvertiserId||'','event_name='+data[
'event_name']||'','ad_error_code='+data['ad_error_code']||'','position='+data['position']||'','browser='+data['browser']||'','vast_url='+encodeURIComponent(playerParams.vastUrl||'')];}function addCurrentAdDetails(player,postData){var ad=player&&player.ima.getAdsManager()&&player.ima.getAdsManager().getCurrentAd();if(ad){postData.push('ad_system='+ad.getAdSystem()||'');postData.push('advertiser='+ad.getAdvertiserName()||'');postData.push('content_type='+ad.getContentType()||'');postData.push('media_url='+encodeURIComponent(ad.getMediaUrl())||'');}}function sendRequest(data){var request=new win.XMLHttpRequest();request.open('POST',trackEndpoint,true);request.setRequestHeader('Content-type','application/x-www-form-urlencoded');request.send(data);}function logVast(player,params,data){if(!params.bid){return;}var configKey=createConfigKey(params.bid.rubiconAdvertiserId,data['event_name']),postData;if(config.indexOf(configKey)===-1){return;}postData=prepareData(data,params);
addCurrentAdDetails(player,postData);log(['Track',postData],log.levels.debug,logGroup);sendRequest(postData.join('&'));}return{logVast:logVast};});;define('ext.wikia.adEngine.ml.fmr.fmrInputParser',['ext.wikia.adEngine.adLogicPageParams','wikia.log'],function(pageParams,log){'use strict';var articleHeightMean=12169.6328125,logGroup='ext.wikia.adEngine.ml.fmr.fmrInputParser';function getData(){var data,params=pageParams.getPageLevelParams();data=[parseInt(params.ah||0,10)/articleHeightMean,params.s2==='article'?1:0,params.s2==='extra'?1:0,params.s2==='file'?1:0,params.s2==='forum'?1:0,params.s2==='fv-article'?1:0,params.s2==='home'?1:0,params.s2==='search'?1:0,params.s2==='special'?1:0,params.s0v==='books'?1:0,params.s0v==='comics'?1:0,params.s0v==='games'?1:0,params.s0v==='lifestyle'?1:0,params.s0v==='movies'?1:0,params.s0v==='music'?1:0,params.s0v==='other'?1:0,params.s0v==='tv'?1:0,params.skin==='mercury'?1:0,params.skin==='oasis'?1:0,params.esrb==='e10'?1:0,params.esrb==='ec'?1:0,
params.esrb==='everyone'?1:0,params.esrb==='mature'?1:0,params.esrb==='rp'?1:0,params.esrb==='teen'?1:0,params.esrb==='tenn'?1:0,params.ref==='direct'?1:0,params.ref==='external'?1:0,params.ref==='external_search'?1:0,params.ref==='wiki'?1:0,params.ref==='wiki_search'?1:0,params.ref==='wikia'?1:0,params.ref==='wikia_search'?1:0,params.top==='1k'?1:0];log(['FMR data',data],log.levels.debug,logGroup);return data;}return{getData:getData};});;define('ext.wikia.adEngine.ml.fmr.fmrLogisticRegression',['ext.wikia.adEngine.ml.fmr.fmrInputParser','ext.wikia.adEngine.ml.modelFactory','ext.wikia.adEngine.ml.model.linear'],function(inputParser,modelFactory,linearModel){'use strict';var coefficients=[-0.304360167,-3.03645625,2.43407028,1.37748331,8.18936945,-6.80640838,3.07912864,4.22575335,3.05398039,1.56544758,1.35266676,1.46443631,1.63976417,1.72897041,1.56771498,1.64995283,1.54796903,27.2848195,-14.7678968,1.99373638,2.18399385,2.04954933,2.02234034,1.66476354,2.03765807,0.564880392,2.46780663,
2.07613289,1.79205965,2.05993374,1.99533944,1.71450779,0.411141975,0.0230943713],intercept=12.51692079;return modelFactory.create({inputParser:inputParser,model:linearModel.create(coefficients,intercept),name:'fmrlr',wgCountriesVariable:'wgAdDriverFMRLogisticRegressionRabbitCountries'});});;define('ext.wikia.adEngine.ml.fmr.fmrPassiveAggressiveClassifier',['ext.wikia.adEngine.ml.fmr.fmrInputParser','ext.wikia.adEngine.ml.modelFactory','ext.wikia.adEngine.ml.model.linear'],function(inputParser,modelFactory,linearModel){'use strict';var coefficients=[-0.82278099,-8.79683582,7.60984978,1.45988694,8.92733562,-12.05770462,5.62087356,9.07374935,3.01971169,0.12593883,4.46370629,1.33673095,2.01391295,4.59430009,0.81224786,2.17649926,-0.66646972,26.31888106,-11.46201455,2.07762358,2.60118493,2.51322211,0.65912343,2.379149,0.60862587,4.01793758,1.26946244,3.84173804,1.20193068,2.36249361,1.84468104,2.31894266,2.01761805,0.11216369],intercept=14.85686651;return modelFactory.create({inputParser:
inputParser,model:linearModel.create(coefficients,intercept),name:'fmrpac',wgCountriesVariable:'wgAdDriverFMRPassiveAggressiveClassifierRabbitCountries'});});;define('ext.wikia.adEngine.ml.modelFactory',['wikia.geo','wikia.instantGlobals'],function(geo,instantGlobals){'use strict';var requiredData=['inputParser','model','name','wgCountriesVariable'];function create(modelData){requiredData.forEach(function(key){if(!modelData[key]){throw new Error('Missing '+key+' in model definition.');}});return{getResult:function(){return this.getName()+'_'+this.predict();},getName:function(){return modelData.name;},isEnabled:function(){return geo.isProperGeo(instantGlobals[modelData.wgCountriesVariable]);},predict:function(){var data=modelData.inputParser.getData();return modelData.model.predict(data);}};}return{create:create};});;define('ext.wikia.adEngine.ml.model.linear',['wikia.log'],function(log){'use strict';var logGroup='ext.wikia.adEngine.ml.model.linear';function create(coefficients,
intercept){function predict(x){var i,result=0;if(x.length!==coefficients.length){log('Incorrect vectors',log.levels.debug,logGroup);return-1;}for(i=0;i<coefficients.length;i+=1){result+=x[i]*coefficients[i];}result+=intercept;return result>0?1:0;}return{predict:predict};}return{create:create};});;define('ext.wikia.adEngine.ml.rabbit',[require.optional('ext.wikia.adEngine.ml.fmr.fmrLogisticRegression'),require.optional('ext.wikia.adEngine.ml.fmr.fmrPassiveAggressiveClassifier')],function(fmrLr,fmrPac){'use strict';var models=[fmrLr,fmrPac];function getSerializedResults(){var results=[];models.forEach(function(model){if(model&&model.isEnabled()){results.push(model.getResult());}});return results.join(';');}return{getSerializedResults:getSerializedResults};});;define('ext.wikia.adEngine.video.player.ui.closeButton',['wikia.document','wikia.log'],function(doc,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.closeButton';function add(video){var closeButton=doc.
createElement('div');closeButton.classList.add('close-ad');closeButton.addEventListener('click',function(event){video.stop();event.preventDefault();log(['stop',log.levels.debug,logGroup]);});video.container.appendChild(closeButton);}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.dynamicReveal',['ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.video.player.porvata.floater','wikia.document'],function(slotTweaker,floater,doc){'use strict';var videoAspectRatio=640/360;function add(video,params){var slot,slotExpanded=!1,slotWidth;if(params.isDynamic){slot=doc.getElementById(params.slotName);video.addEventListener('loaded',function(){if(!slotExpanded){slotTweaker.expand(params.slotName);slotExpanded=!0;setTimeout(function(){video.ima.dispatchEvent('wikiaSlotExpanded');},0);}slotWidth=slot.scrollWidth;if(!floater.isFloating(params.slotName)){video.resize(slotWidth,slotWidth/videoAspectRatio);}});video.addEventListener('allAdsCompleted',function(){slotTweaker.collapse(
params.slotName);video.ima.dispatchEvent('wikiaSlotCollapsed');});}}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.mouseEvents',['wikia.window'],function(win){'use strict';function muteVideo(video){setTimeout(function(){video.setVolume(0);});}function add(video,params){var isTouchDevice='ontouchstart'in win||'onmsgesturechange'in win,onMouseEnter=function(){video.setVolume(1);},onMouseLeave=function(){video.setVolume(0);};video.addEventListener('loaded',function(){muteVideo(video);});video.addEventListener('start',function(){muteVideo(video);});if(!isTouchDevice){video.addEventListener('loaded',function(){params.container.addEventListener('mouseenter',onMouseEnter);params.container.addEventListener('mouseleave',onMouseLeave);video.addEventListener('wikiaVolumeChangeClicked',function(){params.container.removeEventListener('mouseenter',onMouseEnter);params.container.removeEventListener('mouseleave',onMouseLeave);});});}}return{add:add};});;define(
'ext.wikia.adEngine.video.player.ui.pauseOverlay',['wikia.document','wikia.log'],function(doc,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.pauseOverlay';function add(video){var overlay=doc.createElement('div');overlay.classList.add('pause-overlay');overlay.addEventListener('click',function(){if(video.isPaused()){video.resume();log(['resume',log.levels.debug,logGroup]);}else{video.pause();log(['pause',log.levels.debug,logGroup]);}});video.container.appendChild(overlay);}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.progressBar',['ext.wikia.adEngine.domElementTweaker','wikia.document','wikia.log'],function(DOMElementTweaker,doc,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.progressBar';function add(video,params){var progressBar=doc.createElement('div'),currentTime=doc.createElement('div');progressBar.classList.add('progress-bar');currentTime.classList.add('current-time');progressBar.currentTime=currentTime;progressBar.
appendChild(currentTime);progressBar.pause=function(){var currentStatus=(currentTime.offsetWidth/progressBar.offsetWidth*100)+'%';currentTime.style.width=currentStatus;log(['pause',currentStatus],log.levels.debug,logGroup);};progressBar.reset=function(){currentTime.style.transitionDuration='';currentTime.style.width='0';log(['update, reset'],log.levels.debug,logGroup);};progressBar.start=function(){var remainingTime=video.getRemainingTime();if(remainingTime){currentTime.style.transitionDuration=remainingTime+'s';DOMElementTweaker.forceRepaint(currentTime);currentTime.style.width='100%';}else{currentTime.style.width='0';}log(['update, remaining time:',remainingTime],log.levels.debug,logGroup);};video.addEventListener('wikiaAdPlay',progressBar.start);video.addEventListener('wikiaAdCompleted',progressBar.reset);video.addEventListener('wikiaAdPause',progressBar.pause);if(params.controlBar){params.controlBar.insertBefore(progressBar,params.controlBar.firstChild);}else{video.container.
appendChild(progressBar);}}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.replayOverlay',['wikia.document','wikia.log'],function(doc,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.replayOverlay',replayOverlayClass='replay-overlay';function add(video,params){var overlay=doc.createElement('div'),overlayPercentWidth=0;if(video.container.classList.contains('video-player-right')){overlay.style.right=0;}overlay.classList.add(replayOverlayClass);overlay.addEventListener('click',function(){video.play();log(['replay',log.levels.debug,logGroup]);overlay.style.width='';});if(!params.autoPlay){overlayPercentWidth=computeOverlayWidth(params,overlayPercentWidth);showOverlay(overlay,overlayPercentWidth);}video.addEventListener('wikiaAdCompleted',function(){overlayPercentWidth=computeOverlayWidth(params,overlayPercentWidth);showOverlay(overlay,overlayPercentWidth);});video.container.parentElement.insertBefore(overlay,video.container);}function computeOverlayWidth(
params,overlayPercentWidth){var width=overlayPercentWidth;if(!width){width=getOverlayWidth(params);}return width;}function showOverlay(overlay,overlayPercentWidth){overlay.style.width=overlayPercentWidth;}function getOverlayWidth(params){var adWidth=params.container.offsetWidth,videoWidth=params.hideWhenPlaying.offsetWidth;return 100*videoWidth/adWidth+'%';}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.toggleAnimation',['ext.wikia.adEngine.domElementTweaker'],function(DOMElementTweaker){'use strict';var animationDuration=400;function getAdHeight(params){return params.container.clientWidth/params.aspectRatio;}function getVideoHeight(params){return params.container.clientWidth/params.videoAspectRatio;}function updateHeight(element,value){value=value?value+'px':'';element.style.height=value;}function toggle(elementToShow,elementToHide){DOMElementTweaker.hide(elementToHide);DOMElementTweaker.show(elementToShow);}function clearHeight(element){setTimeout(function(){element.
style.height='';},animationDuration);}function hideVideo(video,params){updateHeight(params.container,getVideoHeight(params));updateHeight(params.container,getAdHeight(params));setTimeout(function(){toggle(params.image,video.container);},animationDuration);clearHeight(params.container);}function showVideo(video,params){updateHeight(params.container,getAdHeight(params));updateHeight(params.container,getVideoHeight(params));toggle(video.container,params.image);clearHeight(params.container);}function add(video,params){video.addEventListener('wikiaAdStarted',function(){showVideo(video,params);});video.addEventListener('wikiaAdCompleted',function(){hideVideo(video,params);});}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.toggleVideo',['ext.wikia.adEngine.domElementTweaker'],function(DOMElementTweaker){'use strict';function toggle(elementToShow,elementToHide){DOMElementTweaker.hide(elementToHide);DOMElementTweaker.show(elementToShow);}function hideVideo(video,params){toggle(
params.hideWhenPlaying||params.image,video.container);}function showVideo(video,params){toggle(video.container,params.hideWhenPlaying||params.image);}function add(video,params){video.addEventListener('wikiaAdStarted',function(){showVideo(video,params);});video.addEventListener('wikiaAdCompleted',function(){hideVideo(video,params);});}return{add:add};});;define('ext.wikia.adEngine.video.player.ui.videoInterface',['wikia.log'],function(log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.videoInterface';function setup(video,uiElements,params){uiElements.forEach(function(element){var module='ext.wikia.adEngine.video.player.ui.'+element;require([module],function(uiElement){uiElement.add(video,params);log(['setup',element,video],'debug',logGroup);});});}return{setup:setup};});;define('ext.wikia.adEngine.video.player.ui.volumeControl',['wikia.document','wikia.log'],function(doc,log){'use strict';var logGroup='ext.wikia.adEngine.video.player.ui.volumeControl';function
createVolumeControl(){var volume=doc.createElement('div'),speaker=doc.createElement('a');speaker.className='speaker';speaker.appendChild(doc.createElement('span'));volume.className='ima-mute-div volume-control hidden';volume.appendChild(speaker);volume.speaker=speaker;log('volume control is added',log.levels.info,logGroup);volume.mute=function(){volume.speaker.classList.add('mute');log('mute',log.levels.info,logGroup);};volume.unmute=function(){volume.speaker.classList.remove('mute');log('unmute',log.levels.info,logGroup);};return volume;}function updateCurrentState(video,volumeControl){if(video.isMuted()||video.isMobilePlayerMuted()){volumeControl.mute();}else{volumeControl.unmute();}}function add(video){var volumeControl=createVolumeControl();video.addEventListener('wikiaVolumeChange',function(){updateCurrentState(video,volumeControl);});video.addEventListener('wikiaAdPlay',function(){updateCurrentState(video,volumeControl);volumeControl.classList.remove('hidden');});volumeControl.
addEventListener('click',function(e){video.ima.dispatchEvent('wikiaVolumeChangeClicked');video.volumeToggle();e.preventDefault();});video.container.appendChild(volumeControl);}return{add:add};});;define('ext.wikia.adEngine.video.player.uiTemplate',['wikia.log'],function(log){'use strict';var autoPlayLayout=['progressBar','pauseOverlay','volumeControl','toggleAnimation'],defaultLayout=['progressBar','pauseOverlay','volumeControl','closeButton','toggleAnimation'],splitLayout=['progressBar','pauseOverlay','volumeControl','toggleVideo','replayOverlay'],clickToPlaySplitLayout=['progressBar','pauseOverlay','volumeControl','toggleVideo','replayOverlay','closeButton'],outstreamIncontent=['dynamicReveal','mouseEvents','progressBar','volumeControl'],outstreamLeaderboard=['mouseEvents','progressBar','volumeControl'],logGroup='ext.wikia.adEngine.video.player.uiTemplate';function selectTemplate(videoSettings){var template=defaultLayout;if(!videoSettings.isAutoPlay()&&videoSettings.isSplitLayout()){
template=clickToPlaySplitLayout;}else if(videoSettings.isSplitLayout()){template=splitLayout;}else if(videoSettings.isAutoPlay()){template=autoPlayLayout;}log(['VUAP UI elements',template],log.levels.debug,logGroup);return template;}return{autoPlayLayout:autoPlayLayout,defaultLayout:defaultLayout,splitLayout:splitLayout,outstreamIncontent:outstreamIncontent,outstreamLeaderboard:outstreamLeaderboard,selectTemplate:selectTemplate};});;define('ext.wikia.adEngine.video.uapVideo',['ext.wikia.adEngine.context.uapContext','ext.wikia.adEngine.slot.adSlot','ext.wikia.adEngine.video.player.porvata','ext.wikia.adEngine.video.player.playwire','ext.wikia.adEngine.video.player.ui.videoInterface','ext.wikia.adEngine.video.player.uiTemplate','ext.wikia.adEngine.video.videoSettings','wikia.document','wikia.log','wikia.throttle','wikia.window',require.optional('ext.wikia.adEngine.mobile.mercuryListener')],function(uapContext,adSlot,porvata,playwire,videoInterface,UITemplate,VideoSettings,doc,log,
throttle,win,mercuryListener){'use strict';var logGroup='ext.wikia.adEngine.video.uapVideo',positionVideoPlayerClassName='video-player-',uapTypesToMegaMap={'abcd':!0};function getVideoSize(slot,params,videoSettings){var width=slot.clientWidth;if(videoSettings.isSplitLayout()&&params.videoPlaceholderElement){width=params.videoPlaceholderElement.offsetWidth;}return{width:width,height:width/params.videoAspectRatio};}function shouldUseMegaAdUnitBuilder(type){return uapTypesToMegaMap[type];}function loadPorvata(params,slotContainer,providerContainer,videoSettings){params.container=slotContainer;log(['VUAP loadPorvata',params],log.levels.debug,logGroup);return porvata.inject(videoSettings).then(function(video){video.container.style.position='relative';if(mercuryListener){mercuryListener.onPageChange(function(){video.destroy();});}return video;}).then(function(video){var splitLayoutVideoPosition=params.splitLayoutVideoPosition,template=UITemplate.selectTemplate(videoSettings);videoInterface
.setup(video,template,{aspectRatio:params.aspectRatio,autoPlay:videoSettings.isAutoPlay(),container:slotContainer,hideWhenPlaying:params.videoPlaceholderElement||params.image,image:providerContainer,videoAspectRatio:params.videoAspectRatio});if(splitLayoutVideoPosition){video.container.style.position='absolute';video.container.classList.add(positionVideoPlayerClassName+splitLayoutVideoPosition);}video.addEventListener('wikiaAdCompleted',function(){video.reload();});return video;});}function loadPlaywire(params,adSlot,providerContainer,videoSettings){var container=doc.createElement('div');container.classList.add('video-player','hidden');adSlot.appendChild(container);params.container=container;log(['VUAP loadPlaywire',params],log.levels.debug,logGroup);return playwire.inject(params).then(function(video){videoInterface.setup(video,['closeButton','toggleAnimation'],{image:providerContainer,container:adSlot,aspectRatio:params.aspectRatio,videoAspectRatio:params.videoAspectRatio});video.
addEventListener('wikiaAdStarted',function(){var size=getVideoSize(adSlot,params,videoSettings);video.resize(size.width,size.height);});if(params.autoPlay){var size=getVideoSize(adSlot,params,videoSettings);video.play(size.width,size.height);}return video;});}function loadVideoAd(videoSettings){var params=videoSettings.getParams(),loadedPlayer,providerContainer=adSlot.getProviderContainer(params.slotName),uapType=uapContext.getType(),videoContainer=providerContainer.parentNode,size;log(['loadVideoAd params',params],log.levels.debug,logGroup);size=getVideoSize(videoContainer,params,videoSettings);params.width=size.width;params.height=size.height;params.useMegaAdUnitBuilder=shouldUseMegaAdUnitBuilder(uapType);params.vastTargeting={src:params.src,pos:params.slotName,passback:uapType,uap:uapContext.getUapId()};log(['loadVideoAd upadated params',params],log.levels.debug,logGroup);if(params.player==='playwire'){loadedPlayer=loadPlaywire(params,videoContainer,providerContainer,videoSettings);
}else{loadedPlayer=loadPorvata(params,videoContainer,providerContainer,videoSettings);}return loadedPlayer.then(function(video){function playVideo(){var videoSize=getVideoSize(videoContainer,params,videoSettings);video.play(videoSize.width,videoSize.height);}function resizeVideo(){var videoSize=getVideoSize(videoContainer,params,videoSettings);video.resize(videoSize.width,videoSize.height);}if(params.videoTriggerElement){params.videoTriggerElement.addEventListener('click',playVideo);}else if(params.videoTriggers){params.videoTriggers.forEach(function(trigger){trigger.addEventListener('click',playVideo);});}win.addEventListener('resize',throttle(resizeVideo));video.addEventListener('play',resizeVideo);return video;});}function isEnabled(params){return!!params.videoAspectRatio&&(params.videoTriggerElement||params.videoTriggers);}return{isEnabled:isEnabled,loadVideoAd:loadVideoAd};});;define('ext.wikia.adEngine.video.videoSettings',['ext.wikia.adEngine.adContext',
'ext.wikia.adEngine.slot.resolvedState','ext.wikia.adEngine.utils.sampler','wikia.instantGlobals','wikia.window'],function(adContext,resolvedState,sampler,instantGlobals,win){'use strict';function create(params){var state={autoPlay:!1,moatTracking:!1,resolvedState:!1,splitLayout:!1,withUiControls:!1};function calculateAutoPlayFlag(params){var defaultStateAutoPlay=params.autoPlay&&!state.resolvedState,resolvedStateAutoPlay=params.resolvedStateAutoPlay&&state.resolvedState;return Boolean(defaultStateAutoPlay||resolvedStateAutoPlay);}function calculateMoatTrackingFlag(params){var sampling=instantGlobals.wgAdDriverPorvataMoatTrackingSampling||0;if(typeof params.moatTracking==='boolean'){return params.moatTracking;}if(!adContext.get('opts.porvataMoatTrackingEnabled')){return false;}if(sampling===100){return true;}if(sampling>0){return sampler.sample('moat_video_tracking',sampling,100);}return false;}function init(){state.resolvedState=resolvedState.isResolvedState();state.
autoPlay=calculateAutoPlayFlag(params);state.splitLayout=Boolean(params.splitLayoutVideoPosition);state.moatTracking=calculateMoatTrackingFlag(params);state.withUiControls=Boolean(params.hasUiControls);}init();return{getParams:function(){return params;},getVpaidMode:function(){return params.vpaidMode!==undefined?params.vpaidMode:win.google.ima.ImaSdkSettings.VpaidMode.ENABLED;},hasUiControls:function(){return state.withUiControls;},isAutoPlay:function(){return state.autoPlay;},isResolvedState:function(){return state.resolvedState;},isSplitLayout:function(){return state.splitLayout;},isMoatTrackingEnabled:function(){return state.moatTracking;},setMoatTracking:function(status){state.moatTracking=status;}};}return{create:create};});;define('ext.wikia.aRecoveryEngine.adBlockDetection',['ext.wikia.adEngine.adContext','wikia.document','wikia.instantGlobals','wikia.lazyqueue','wikia.log',require.optional('ext.wikia.aRecoveryEngine.pageFair.recovery')],function(adContext,doc,instantGlobals,
lazyQueue,log,pageFair){'use strict';var cb=function(callback){callback();},logGroup='ext.wikia.aRecoveryEngine.adBlockDetection',onBlockingEventsQueue=lazyQueue.makeQueue([],cb),onNotBlockingEventsQueue=lazyQueue.makeQueue([],cb);function initEventQueues(){doc.addEventListener('sp.not_blocking',onNotBlockingEventsQueue.start);doc.addEventListener('sp.blocking',onBlockingEventsQueue.start);}function addOnBlockingCallback(callback){onBlockingEventsQueue.push(callback);}function addOnNotBlockingCallback(callback){onNotBlockingEventsQueue.push(callback);}function isBlocking(){return isEnabled()&&pageFair&&pageFair.isBlocking();}function isEnabled(){var context=adContext.getContext();log(['isEnabled',context.opts.pageFairRecovery],log.levels.debug,logGroup);return context.opts.pageFairRecovery;}return{addOnBlockingCallback:addOnBlockingCallback,addOnNotBlockingCallback:addOnNotBlockingCallback,initEventQueues:initEventQueues,isBlocking:isBlocking,isEnabled:isEnabled};});;define(
'ext.wikia.aRecoveryEngine.adBlockRecovery',['ext.wikia.adEngine.adContext','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.document','wikia.instantGlobals','wikia.log','wikia.window'],function(adContext,adBlockDetection,doc,instantGlobals,log,win){'use strict';var customLogEndpoint='/wikia.php?controller=ARecoveryEngineApi&method=getLogInfo&kind=',logGroup='ext.wikia.aRecoveryEngine.adBlockRecovery';function getName(){return'adBlockRecovery';}function addResponseListener(callback){adBlockDetection.addOnBlockingCallback(callback);adBlockDetection.addOnNotBlockingCallback(callback);}function isEnabled(){var context=adContext.getContext(),enabled=context.opts.sourcePointRecovery||context.opts.pageFairRecovery||context.opts.instartLogicRecovery;log(['isEnabled',enabled],log.levels.debug,logGroup);return enabled;}function track(type){if(win._sp_&&!win._sp_.trackingSent){if(Wikia&&Wikia.Tracker){Wikia.Tracker.track({eventName:'ads.recovery',category:'ads-recovery-blocked',action:Wikia.
Tracker.ACTIONS.IMPRESSION,label:type,trackingMethod:'analytics'});}if(instantGlobals.wgARecoveryEngineCustomLog){sendCustomLog(type);}win._sp_.trackingSent=!0;}}function sendCustomLog(type){var xmlHttp=new XMLHttpRequest();try{xmlHttp.open('GET',customLogEndpoint+type,true);xmlHttp.send();}catch(e){log(['track',e],log.levels.error,logGroup);}}function verifyContent(){var wikiaArticle=doc.getElementById('WikiaArticle'),display=wikiaArticle.currentStyle?wikiaArticle.currentStyle.display:getComputedStyle(wikiaArticle,null).display;if(display==='none'){track('css-display-none');}}return{addResponseListener:addResponseListener,isEnabled:isEnabled,getName:getName,track:track,verifyContent:verifyContent,wasCalled:isEnabled};});;define('ext.wikia.aRecoveryEngine.instartLogic.recovery',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,win){'use strict';var logGroup='ext.wikia.aRecoveryEngine.instartLogic.recovery',context=adContext.getContext();function
isEnabled(){var enabled=!!context.opts.instartLogicRecovery;log(['isEnabled',enabled,log.levels.debug,logGroup]);return enabled;}function isBlocking(){var isBlocking=!!(win.I11C&&win.I11C.Morph);log(['isBlocking',isBlocking],log.levels.debug,logGroup);return isEnabled()&&isBlocking;}return{isBlocking:isBlocking,isEnabled:isEnabled,isSlotRecoverable:isEnabled};});;define('ext.wikia.aRecoveryEngine.sourcePoint.recovery',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,win){'use strict';var logGroup='ext.wikia.aRecoveryEngine.sourcePoint.recovery',context=adContext.getContext(),recoverableSlots=['TOP_LEADERBOARD','TOP_RIGHT_BOXAD','INCONTENT_BOXAD_1','BOTTOM_LEADERBOARD','GPT_FLUSH'];function isEnabled(){var enabled=!!context.opts.sourcePointRecovery&&!context.opts.pageFairRecovery;log(['isEnabled',enabled],log.levels.debug,logGroup);return enabled;}function isBlocking(){var isBlocking=!!(win.ads&&win.ads.runtime.sp&&win.ads.runtime.sp.blocking);log([
'isBlocking',isBlocking],log.levels.debug,logGroup);return isBlocking;}function isSlotRecoverable(slotName){var result=isEnabled()&&recoverableSlots.indexOf(slotName)!==-1;log(['isSlotRecoverable',result],log.levels.info,logGroup);return result;}function getSafeUri(url){if(isBlocking()){url=win._sp_.getSafeUri(url);}return url;}return{getSafeUri:getSafeUri,isBlocking:isBlocking,isSlotRecoverable:isSlotRecoverable,isEnabled:isEnabled};});;define('ext.wikia.aRecoveryEngine.sourcePoint.slotFinder',['ext.wikia.adEngine.slot.adUnitBuilder','wikia.document','wikia.window'],function(adUnitBuilder,doc,win){'use strict';function getRecoveredSlot(slotName){var recoveredId=win._sp_.getElementId(getAdUnit(slotName));if(!recoveredId){return null;}return doc.getElementById(recoveredId);}function getAdUnit(slotName){return'wikia_gpt'+adUnitBuilder.build(slotName,'gpt');}return{getRecoveredSlot:getRecoveredSlot};});;define('ext.wikia.aRecoveryEngine.tweaker',['ext.wikia.adEngine.domElementTweaker',
'ext.wikia.adEngine.slotTweaker','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.browserDetect','wikia.document','wikia.log'],function(DOMElementTweaker,slotTweaker,adBlockDetection,browser,doc,log){'use strict';var logGroup='ext.wikia.aRecoveryEngine.tweaker';function isNotSupportedBrowser(){return browser.isIE()||browser.isEdge();}function mirrorDOMStructure(parentNode){var div=doc.createElement('div'),originalIframe=doc.createElement('iframe');div.appendChild(originalIframe);parentNode.appendChild(div);originalIframe.style.display='none';div.style.display='none';return originalIframe;}function tweakSlot(slotName,iframe){var adContainer=iframe.parentNode.parentNode.parentNode.parentNode,originalIframe=mirrorDOMStructure(doc.querySelector('#'+slotName+' > div > div'));if(isNotSupportedBrowser()){DOMElementTweaker.hide(adContainer,true);log(['tweakSlot','not supported browser'],'info',logGroup);return;}slotTweaker.tweakRecoveredSlot(originalIframe,iframe);log(['tweakSlot',slotName]
,'info',logGroup);}function isTweakable(){return adBlockDetection.isBlocking();}return{isTweakable:isTweakable,tweakSlot:tweakSlot};});;define('ext.wikia.aRecoveryEngine.pageFair.recovery',['ext.wikia.adEngine.adContext','wikia.log','wikia.window'],function(adContext,log,win){'use strict';var logGroup='ext.wikia.aRecoveryEngine.pageFair.recovery',context=adContext.getContext(),recoverableSlots=['TOP_LEADERBOARD','TOP_RIGHT_BOXAD','BOTTOM_LEADERBOARD'];function isEnabled(){var enabled=!!context.opts.pageFairRecovery;log(['isEnabled',enabled,log.levels.debug,logGroup]);return enabled;}function isSlotRecoverable(slotName){var result=isEnabled()&&recoverableSlots.indexOf(slotName)!==-1;log(['isSlotRecoverable',result],log.levels.info,logGroup);return result;}function isBlocking(){var isBlocking=!!(win.ads&&win.ads.runtime.pf&&win.ads.runtime.pf.recovering);log(['isBlocking',isBlocking],log.levels.debug,logGroup);return isBlocking;}function addMarker(slotElement){slotElement.setAttribute(
'adonis-marker','');}return{isBlocking:isBlocking,isEnabled:isEnabled,isSlotRecoverable:isSlotRecoverable,addMarker:addMarker};});;define('wikia.domCalculator',['wikia.document','wikia.window'],function(doc,win){'use strict';function getTopOffset(element){var topPos=0,elementWindow=element.ownerDocument.defaultView;do{topPos+=element.offsetTop;element=element.offsetParent;}while(element!==null);if(elementWindow&&elementWindow.frameElement){topPos+=getTopOffset(elementWindow.frameElement);}return topPos;}function isInViewport(element){var globalNavHeight=55,elementHeight=element.offsetHeight,topElement=getTopOffset(element),bottomElement=topElement+elementHeight,scrollPosition=win.scrollY,topViewport=scrollPosition+globalNavHeight,bottomViewport=scrollPosition+Math.max(doc.documentElement.clientHeight,win.innerHeight||0);return topElement>=(topViewport-elementHeight/2)&&bottomElement<=(bottomViewport+elementHeight/2);}return{getTopOffset:getTopOffset,isInViewport:isInViewport};});;
window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);define('wikia.krux',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','wikia.document','wikia.tracker','wikia.window'],function(adContext,adTracker,doc,wikiaTracker,win){'use strict';var maxNumberOfKruxSegments=50,kruxScriptId='krux-control-tag',kruxLoaded=!1,segmentsCountTracked=!1;function exportPageParams(adLogicPageParams){var params,value;if(Object.keys){params=adLogicPageParams.getPageLevelParams();Object.keys(params).forEach(function(key){value=params[key];if(value){win['kruxDartParam_'+key]=value.toString();}});}}function addConfigScript(confid){var k,s;k=document.createElement('script');k.type='text/javascript';k.id=kruxScriptId;k.async=!0;k.src=(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag?confid='+confid;s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);}function load(confid){require(['ext.wikia.adEngine.adContext',
'ext.wikia.adEngine.adLogicPageParams'],function(adContext,adLogicPageParams){var script;if(adContext.getContext().targeting.enableKruxTargeting){exportPageParams(adLogicPageParams);script=doc.getElementById(kruxScriptId);if(script){script.parentNode.removeChild(script);}addConfigScript(confid);kruxLoaded=!0;adTracker.track('krux/load');wikiaTracker.track({category:'ads-trackers',action:'krux',label:'load',value:0,trackingMethod:'analytics'});}});}function getParams(n){var k='kx'+n;if(win.localStorage){return win.localStorage[k]||'';}else{return'';}}function trackNumberOfSegments(numberOfSegments){if(segmentsCountTracked){return;}var label=numberOfSegments+'';while(label.length<4){label='0'+label;}adTracker.track('krux/segments_count',{},numberOfSegments,label);segmentsCountTracked=!0;}function getSegments(){var segments=getParams('segs'),segsArray;if(segments===''){trackNumberOfSegments(0);return[];}segsArray=segments.split(',');trackNumberOfSegments(segsArray.length);return segsArray
.slice(0,maxNumberOfKruxSegments);}function getUser(){return getParams('user');}function sendEvent(eventId,data){if(!kruxLoaded){return false;}Krux('admEvent',eventId,data||{});return true;}adContext.addCallback(function(){segmentsCountTracked=!1;});return{load:load,getSegments:getSegments,getUser:getUser,sendEvent:sendEvent};});;define('wikia.throttle',function(){'use strict';function throttle(fn,threshold,scope){threshold=threshold||250;var last,deferTimer;return function(){var context=scope||this,now=+(new Date()),args=arguments;if(last&&now<last+threshold){clearTimeout(deferTimer);deferTimer=setTimeout(function(){last=now;fn.apply(context,args);},threshold);}else{last=now;fn.apply(context,args);}};}return throttle;});;define('wikia.viewportObserver',['wikia.domCalculator','wikia.throttle','wikia.window'],function(domCalculator,throttle,win){'use strict';function updateInViewport(listener){var newInViewport=domCalculator.isInViewport(listener.element);if(newInViewport!==listener.
inViewport){listener.callback(newInViewport);listener.inViewport=newInViewport;}}function addListener(element,callback,throttleThreshold){var listener={element:element,callback:callback,inViewport:!1},updateCallback=throttle(function(){updateInViewport(listener);},throttleThreshold);win.addEventListener('scroll',updateCallback);updateCallback();return updateCallback;}function removeListener(listener){win.removeEventListener('scroll',listener);}return{addListener:addListener,removeListener:removeListener};});;require(['wikia.window','wikia.tracker'],function(window,tracker){'use strict';var wikia=window.Wikia=window.Wikia||{};wikia.fliteOoyalaTracker=function(id){tracker.track({action:'content-begin',category:'video-player-stats',label:'ooyala',trackingMethod:'internal',title:id||'',clickSource:'ad'});};});;define('ext.wikia.adEngine.dartVideoHelper',['wikia.log','wikia.location','ext.wikia.adEngine.adLogicPageParams'],function(log,location,adLogicPageParams){'use strict';var logGroup
='adengine.dartVideoHelper',pageParams=adLogicPageParams.getPageLevelParams();pageParams.src='ooyala';function getCustParams(){var key,vals,params=[],urlValues,valIndex;for(key in pageParams){if(pageParams.hasOwnProperty(key)&&key!==''){vals=pageParams[key];if(vals&&vals.length){if(!(vals instanceof Array)){vals=[vals];}urlValues=[];for(valIndex=0;valIndex<vals.length;valIndex+=1){urlValues.push(vals[valIndex].toString());}params.push(key+'='+urlValues.join(','));}}}return params.join('&');}function getUrl(extraParams){log('getUrl',5,logGroup);var ord=Math.round(Math.random()*23945290875),out=['http://pubads.g.doubleclick.net/gampad/ads?ciu_szs','&iu=/5441/wka.ooyalavideo/_page_targeting','&cust_params='+encodeURIComponent(getCustParams()),'&sz=320x240','&impl=s','&output=xml_vast2','&gdfp_req=1','&env=vp','&ad_rule=0','&unviewed_position_start=1','&url='+encodeURIComponent(location.href),'&description_url='+encodeURIComponent(location.href),'&correlator='+ord],url;extraParams=
extraParams||[];extraParams.forEach(function(param){out.push('&'+param);});url=out.join('');log(url,5,logGroup);return url;}return{getUrl:getUrl};});;define('ext.wikia.adEngine.utils.scriptLoader',['ext.wikia.adEngine.adContext','ext.wikia.adEngine.adTracker','wikia.document',],function(adContext,adTracker,doc){'use strict';function createScript(src,type,isAsync,node){var script=doc.createElement('script');node=node||doc.body.lastChild;script.async=isAsync||!0;script.type=type||'text/javascript';script.src=src;node.parentNode.insertBefore(script,node);return script;}function loadAsync(src,node,type){return loadScript(src,type,true,node);}function loadScript(src,type,isAsync,node){return new Promise(function(resolve,reject){var script=createScript(src,type,isAsync,node);script.onload=resolve;script.onerror=reject;});}return{loadAsync:loadAsync,loadScript:loadScript};});;define('ext.wikia.adEngine.provider.evolve2',['ext.wikia.adEngine.adContext',
'ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.provider.gpt.helper','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.utils.adLogicZoneParams','ext.wikia.adEngine.utils.eventDispatcher','wikia.log'],function(adContext,btfBlocker,gptHelper,slotTweaker,zoneParams,eventDispatcher,log){'use strict';var logGroup='ext.wikia.adEngine.provider.evolve2',atfSlots=['INVISIBLE_SKIN','TOP_LEADERBOARD','TOP_RIGHT_BOXAD','EVOLVE_FLUSH'],posTargetingValue,site='wikia_intl',slotMap={EVOLVE_FLUSH:{flushOnly:!0},INVISIBLE_SKIN:{size:'1000x1000,1x1',wloc:'top'},TOP_LEADERBOARD:{size:'728x90,970x250,970x300,970x90',wloc:'top'},TOP_RIGHT_BOXAD:{size:'300x250,300x600',wloc:'top'},MOBILE_TOP_LEADERBOARD:{size:'320x50,320x100',wsrc:'mobile_evolve'},MOBILE_IN_CONTENT:{size:'300x250',wsrc:'mobile_evolve'},MOBILE_PREFOOTER:{size:'300x250',wsrc:'mobile_evolve'}};function resetPosTargeting(){posTargetingValue={'728x90,970x250,970x300,970x90':'a','300x250,300x600':'a','1000x1000,1x1':'a','160x600'
:'b','320x50,320x100':'a','300x250':'a'};}function getSection(){var vertical=zoneParams.getVertical(),mappedVertical=zoneParams.getSite();switch(vertical){case'movies':case'tv':return vertical;}switch(mappedVertical){case'gaming':return'gaming';case'ent':return'entertainment';}return'ros';}function nextChar(char){return String.fromCharCode(char.charCodeAt(0)+1);}function setTargeting(slot){var position=posTargetingValue[slot.size];slot.pos=position;if(!slot.wsrc){slot.wsrc='evolve';}posTargetingValue[slot.size]=nextChar(position);}function canHandleSlot(slotName){log(['canHandleSlot',slotName],'debug',logGroup);var ret=!!slotMap[slotName];log(['canHandleSlot',slotName,ret],'debug',logGroup);return ret;}function fillInSlot(slot){log(['fillInSlot',slot.name],'debug',logGroup);var section=getSection(),slotCopy=JSON.parse(JSON.stringify(slotMap[slot.name]));if(!slotCopy.flushOnly){slotCopy.wpos=slot.name;setTargeting(slotCopy);}slot.pre('success',function(){slotTweaker.removeDefaultHeight(
slot.name);slotTweaker.removeTopButtonIfNeeded(slot.name);slotTweaker.adjustLeaderboardSize(slot.name);});gptHelper.pushAd(slot,'/4403/ev/'+site+'/'+section+'/'+slot.name,slotCopy,{forcedAdType:'evolve2',sraEnabled:!0});log(['fillInSlot',slot.name,'done'],'debug',logGroup);}function decorateFillInSlot(){if(adContext.getContext().targeting.skin==='oasis'){return btfBlocker.decorate(fillInSlot,{atfSlots:atfSlots});}return fillInSlot;}resetPosTargeting();adContext.addCallback(function(){resetPosTargeting();});return{name:'Evolve2',canHandleSlot:canHandleSlot,fillInSlot:decorateFillInSlot()};});;require(['ad-engine.bridge','ext.wikia.adEngine.adContext','ext.wikia.adEngine.adEngineRunner','ext.wikia.adEngine.adLogicPageParams','ext.wikia.adEngine.slot.service.stateMonitor','ext.wikia.adEngine.config.desktop','ext.wikia.adEngine.customAdsLoader','ext.wikia.adEngine.dartHelper','ext.wikia.adEngine.messageListener','ext.wikia.adEngine.pageFairDetection',
'ext.wikia.adEngine.provider.btfBlocker','ext.wikia.adEngine.slot.service.actionHandler','ext.wikia.adEngine.slot.service.slotRegistry','ext.wikia.adEngine.slotTracker','ext.wikia.adEngine.slotTweaker','ext.wikia.adEngine.sourcePointDetection','ext.wikia.adEngine.tracking.adInfoListener','ext.wikia.aRecoveryEngine.adBlockDetection','wikia.window'],function(adEngineBridge,adContext,adEngineRunner,pageLevelParams,slotStateMonitor,adConfigDesktop,customAdsLoader,dartHelper,messageListener,pageFairDetection,btfBlocker,actionHandler,slotRegistry,slotTracker,slotTweaker,sourcePointDetection,adInfoListener,adBlockDetection,win){'use strict';var context=adContext.getContext();win.AdEngine_getTrackerStats=slotTracker.getStats;messageListener.init();win.wikiaDartHelper=dartHelper;win.adSlotTweaker=slotTweaker;if(adContext.get('opts.isAdProductsBridgeEnabled')){adEngineBridge.init(slotRegistry,null,pageLevelParams.getPageLevelParams(),adContext,btfBlocker,'oasis');win.loadCustomAd=adEngineBridge.
loadCustomAd(customAdsLoader.loadCustomAd);}else{win.loadCustomAd=customAdsLoader.loadCustomAd;}win.wgAfterContentAndJS.push(function(){adInfoListener.run();slotStateMonitor.run();win.adslots2=win.adslots2||[];adEngineRunner.run(adConfigDesktop,win.adslots2,'queue.desktop',!!context.opts.delayEngine);actionHandler.registerMessageListener();sourcePointDetection.initDetection();if(context.opts.pageFairDetection){pageFairDetection.initDetection(context);}adBlockDetection.initEventQueues();});});require(['ext.wikia.adEngine.adContext','ext.wikia.adEngine.context.slotsContext','ext.wikia.adEngine.slot.bottomLeaderboard','ext.wikia.adEngine.slot.highImpact','ext.wikia.adEngine.slot.inContent','wikia.document','wikia.window'],function(adContext,slotsContext,bottomLeaderboard,highImpact,inContent,doc,win){'use strict';function initDesktopSlots(){highImpact.init();inContent.init('INCONTENT_PLAYER');bottomLeaderboard.init();}if(doc.readyState==='complete'){initDesktopSlots();}else{win.
addEventListener('load',initDesktopSlots);}});require(['wikia.querystring','wikia.document'],function(qs,doc){'use strict';if(qs().getVal('fps')){var s=doc.createElement('script');s.src='https://raw.githubusercontent.com/Wikia/fps-meter/master/fps-meter.js';doc.body.appendChild(s);}});;define("ad-engine.bridge",[],function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=24)}([function(e,t,n){"use strict";function i(e,t,n){s[e]&&s[e].forEach(function(e){e(t,n)})}function o(e,t,n){var o="";t.forEach(function(t){o+=(""===o?"":".")+t,i(o,e,n)})}function a(e,t){for(var n=e.
split("."),i=n.length,a=r,s=null,l=0;l<i;l+=1)s=n[l],l<i-1&&(a[s]=a[s]||{},a=a[s]);return void 0!==t&&(a[s]=t,o(e,n,t)),a[s]}Object.defineProperty(t,"__esModule",{value:!0});var r={adUnitId:"",events:{},options:{customAdLoader:{globalMethodName:"loadCustomAd"},video:{moatTracking:{enabled:!0,partnerCode:"wikiaimajsint377461931603",sampling:1}}},slots:{},src:"gpt",state:{adStack:[],isMobile:!1},targeting:{},vast:{size:[640,480],adUnitId:""}},s={};t.__useDefault=!0;t.default={extend:function(e){Object.assign(r,e)},set:function(e,t){a(e,t)},get:function(e){return a(e)},onChange:function(e,t){s[e]=s[e]||[],s[e].push(t)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29),a=i(o),r=n(6),s=i(r),l=n(2),u="slot-tweaker";t.default={forceRepaint:function(e){return e.offsetWidth},getContainer:function(e){var t=document.getElementById(e.getId());return t||(0,l.logger)(u,"cannot find container",e.getId()),t},
hide:function(e){var t=this.getContainer(e);t&&((0,l.logger)(u,"hide",e.getId()),t.classList.add("hide"))},show:function(e){var t=this.getContainer(e);t&&((0,l.logger)(u,"show",e.getId()),t.classList.remove("hide"))},collapse:function(e){var t=this.getContainer(e);t.style.maxHeight=t.scrollHeight+"px",this.forceRepaint(t),t.classList.add("slot-animation"),t.style.maxHeight="0"},expand:function(e){var t=this.getContainer(e);t.style.maxHeight=t.offsetHeight+"px",t.classList.remove("hide"),t.classList.add("slot-animation"),t.style.maxHeight=t.scrollHeight+"px"},makeResponsive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getContainer(e).classList.add("slot-responsive"),this.onReady(e).then(function(n){var i=n.parentElement;if(!t){var o=n.contentWindow.document.body.scrollHeight,a=n.contentWindow.document.body.scrollWidth;t=a/o}return(0,l.logger)(u,"make responsive",e.getId()),i.style.paddingBottom=100/t+"%",n})},onReady:function(e){var t=this.
getContainer(e),n=t.querySelector('div[id*="_container_"] iframe');return new Promise(function(e,t){n||t("Cannot find iframe element"),"complete"===n.contentWindow.document.readyState?e(n):n.addEventListener("load",function(){return e(n)})})},registerMessageListener:function(){var e=this;a.default.register({keys:["action","slotName"],infinite:!0},function(t){if(!t.slotName)return void(0,l.logger)(u,"Missing slot name");var n=s.default.getBySlotName(t.slotName);switch(t.action){case"expand":e.expand(n);break;case"collapse":e.collapse(n);break;case"hide":e.hide(n);break;case"show":e.show(n);break;case"make-responsive":e.makeResponsive(n,t.aspectRatio);break;default:(0,l.logger)(u,"Unknown action",t.action)}})},setDataParam:function(e,t,n){this.getContainer(e).dataset[t]="string"==typeof n?n:JSON.stringify(n)}}},function(e,t,n){"use strict";function i(e){if(""!==r&&("1"===r||-1!==s.indexOf(e))){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];window.console.
info(e,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logger=i;var o=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(o),r=a.default.get("adengine_debug")||"",s=r.split(",");""!==r&&window.console.info("AdEngine debug mode - groups:","1"===r?"all":s)},function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(a.default[e]){var n=r.parseFromString(a.default[e],"image/svg+xml").documentElement;return t.forEach(function(e){return n.classList.add(e)}),n}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.icons=void 0,t.createIcon=i;var o=n(51),a=function(e){return e&&e.__esModule?e:{default:e}}(o),r=new window.DOMParser;t.icons=Object.keys(a.default).reduce(function(e,t){return e[t]=t,e},{})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],i=!0,o=!1,
a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e)}return a(e,null,[{key:"getValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||window.location.search.substr(1),n={},i=t.split("&");return""===i?null:(i.forEach(function(e){var t=e.split("="),i=o(t,2),a=i[0],r=i[1];r&&(n[a]=decodeURIComponent(r.replace(/\+/g," ")))}),n)}},{key:"get",value:function(t){
return e.getValues()[t]}}]),e}();t.__useDefault=!0;t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return(16777216*(1+Math.random())).toString(16).substring(1)}function a(e,t){e.push({id:t.id})}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(12),l={},u=function(){function e(){i(this,e)}return r(e,null,[{key:"init",value:function(){document.addEventListener("scroll",function(e){return window.requestAnimationFrame(function(){Object.keys(l).forEach(function(t){"function"==typeof l[t]&&l[t](e,t)})})})}},{key:"addSlot",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=document.getElementById(n);o&&e.
addCallback(function(n,r){var l=window.scrollY||window.pageYOffset||document.documentElement.scrollTop,u=(0,s.getTopOffset)(o);l+Math.max(document.documentElement.clientHeight,window.innerHeight||0)>u-i&&(e.removeCallback(r),a(t,o))})}},{key:"addCallback",value:function(e){var t=o();return l[t]=e,t}},{key:"removeCallback",value:function(e){delete l[e]}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=u.getBySlotName(e);l[e]=t,n&&(t?n.enable():n.disable())}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r={},s={},l={},u=function(){function e(){i(this,e)}return a(e,null,[{key:"add",value:function(e){var t=e.getSlotName();s[e.
getId()]=e,r[t]=e.getId(),!1===l[t]&&e.disable(),!0===l[t]&&e.enable()}},{key:"get",value:function(e){return s[e]}},{key:"getBySlotName",value:function(e){var t=r[e];return this.get(t)}},{key:"forEach",value:function(e){Object.keys(s).forEach(function(t){e(s[t])})}},{key:"enable",value:function(e){o(e,!0)}},{key:"disable",value:function(e){o(e,!1)}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var i=n.isSplitLayout()?t.videoPlaceholderElement.offsetWidth:e.clientWidth;return{width:i,height:i/t.videoAspectRatio}}function a(e){if(e.splitLayoutVideoPosition){e.container.querySelector(".video-player").classList.add("video-player-"+e.splitLayoutVideoPosition)}}function r(e,t,n){var i=e.getParams(),o=m.selectTemplate(e);return i.autoPlay=e.isAutoPlay(),e.updateParams(i),p.default.inject(i).then(function(r){return r.container.style.position="relative",m.setup(r,o,{autoPlay:e.isAutoPlay(),image:n,container:t,thumbnail:i.
thumbnail,clickThroughURL:i.clickThroughURL,aspectRatio:i.aspectRatio,videoAspectRatio:i.videoAspectRatio,hideWhenPlaying:i.videoPlaceholderElement||i.image,splitLayoutVideoPosition:i.splitLayoutVideoPosition}),r.addEventListener("wikiaAdCompleted",function(){r.reload()}),a(i),r})}function s(e){function t(t){return function(){var i=o(a,n,e);t.resize(i.width,i.height)}}var n=e.getParams(),i=S.default.getBySlotName(n.slotName),a=document.getElementById(i.getId()),s=a.querySelector("div:last-of-type"),l=o(a,n,e);return n.vastTargeting={passback:c()},n.width=l.width,n.height=l.height,n.container=a,e.updateParams(n),r(e,a,s).then(function(e){return window.addEventListener("resize",(0,f.throttle)(t(e),250)),n.videoTriggerElement?n.videoTriggerElement.addEventListener("click",function(){return e.play()}):n.videoTriggers&&n.videoTriggers.forEach(function(t){t.addEventListener("click",function(){return e.play()})}),e})}function l(){return P}function u(e){P=e}function c(){return M}function d(e){
M=e}Object.defineProperty(t,"__esModule",{value:!0});var f=n(32),T=n(0),h=i(T),b=n(33),p=i(b),v=n(6),S=i(v),g=n(47),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(g),P="none",M="uap";t.default={init:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n="uap";this.isVideoEnabled(e)&&(n="vuap"),e.adProduct=e.adProduct||n,u(e.uap),d(e.adProduct),Object.keys(h.default.get("slots")).forEach(function(e){h.default.set("slots."+e+".targeting.uap",l())}),"abcd"!==c()&&t.forEach(function(e){S.default.enable(e)})},getType:c,getUapId:l,isVideoEnabled:function(e){var t=Array.isArray(e.videoTriggers)&&e.videoTriggers.length>0;return!!e.videoAspectRatio&&(e.videoPlaceholderElement||t)},loadVideoAd:s,setType:d,setUapId:u}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,
"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),r=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l={},u=function(){function e(){i(this,e)}return o(e,null,[{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("function"!=typeof e.getName)throw new Error("Template does not implement getName method.");var n=e.getName(),i={};"function"==typeof e.getDefaultConfig&&(i=e.getDefaultConfig()),t&&(i=Object.assign(i,t)),s.default.set("templates."+n,i),l[n]=e}},{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((0,a.logger)("template-service","Load template",e,t,n),!l[e])throw new Error("Template "+e+
" does not exist.");return new l[e](t).init(n)}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.props=t}return o(e,[{key:"classNames",get:function(){return this.props.classNames||[]}}]),o(e,[{key:"render",value:function(){return document.createDocumentFragment()}}]),e}();t.default=a},function(e,t,n){"use strict";function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function a(e){return"number"==typeof e}function r(e){
return"object"===(void 0===e?"undefined":l(e))&&null!==e}function s(e){return void 0===e}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,a,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(
this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(r(n))for(a=Array.prototype.slice.call(arguments,1),u=n.slice(),i=u.length,l=0;l<i;l++)u[l].apply(this,a);return!0},i.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.
prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,a,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,i=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(s=a;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this
._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){if(null===u){var e=window.navigator.userAgent;u=new s.default(e)}return u}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=
!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(26),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=null,u=null,c=null,d=function(){function e(){i(this,e)}return a(e,null,[{key:"isSmartphone",value:function(){return o().mobile()}},{key:"isTablet",value:function(){return o().tablet()}},{key:"isDesktop",value:function(){return!e.isSmartphone()&&!e.isTablet()}},{key:"getDeviceType",value:function(){return e.isTablet()?"tablet":e.isSmartphone()?"smartphone":"desktop"}},{key:"getOperatingSystem",value:function(){if(null!==c)return c;var e=window.navigator.userAgent;return c="unknown",-1!==e.indexOf("Win")&&(c="Windows"),-1!==e.indexOf("Mac")&&(c="OSX"),-1!==e.indexOf("Linux")&&(c="Linux"),-1!==e.indexOf("Android")&&(c="Android"),-1!==e.indexOf("like Mac")&&(c="iOS"),c}},{key:"getBrowser",value:function(){if(null!==l)return l;var e=window.navigator.appName,t=window.navigator.appVersion,n=window.navigator.userAgent,i=void 0,
o=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(o[1])?(i=/\brv[ :]+(\d+)/g.exec(n)||[],l="IE "+(i[1]||"")):"Chrome"===o[1]&&null!==(i=n.match(/\b(OPR|Edge)\/(\d+)/))?l=i.slice(1).join(" ").replace("OPR","Opera"):(o=o[2]?[o[1],o[2]]:[e,t,"-?"],i=n.match(/version\/(\d+)/i),null!==i&&o.splice(1,1,i[1]),l=o.join(" "))}}]),e}();t.default=d},function(e,t,n){"use strict";function i(e){var t=e.ownerDocument.defaultView,n=e,o=!1,a=0;e.classList.contains("hide")&&(o=!0,e.classList.remove("hide"));do{a+=n.offsetTop,n=n.offsetParent}while(null!==n);return o&&e.classList.add("hide"),t&&t.frameElement&&(a+=i(t.frameElement)),a}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=["fixed","sticky"],a=window.getComputedStyle(e).position;if(o.includes(a))return!0;var r=e.offsetHeight,s=i(e),l=s+r,u=window.scrollY,c=Math.max(document.documentElement.clientHeight,window
.innerHeight||0),d=t+u,f=n+u+c;return s>=d-r/2&&l<=f+r/2}Object.defineProperty(t,"__esModule",{value:!0}),t.getTopOffset=i,t.isInViewport=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SLOT_VIEWED_EVENT=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i
&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(10),u=n(0),c=i(u),d=n(1),f=i(d),T=n(14),h=i(T),b=n(8),p=i(b),v=t.SLOT_VIEWED_EVENT="slotViewed",S=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),i=e.id.split("-");if(i.length<3)throw new Error("Invalid GPT id passed to parseId ("+e.id+").");return n.id=e.id,n.location=i[1],n.screenSize=i[3]?i[3]:"both",n.type=i[2],n.config=c.default.get("slots."+n.location+"-"+n.type)||{},n.enabled=!n.config.disabled,n.viewed=!1,n.config.targeting=n.config.targeting||{},n.config.targeting.src=n.config.targeting.src||c.default.get("src"),n.config.targeting.pos=n.config.targeting.pos||n.getSlotName(),n.once(v,function(){n.viewed=!0}),n}return r(t,e),s(t,[{key:"getId",value:function(){return this.id}},{key:"getAdUnit",value:function(){return this.adUnit||(this.adUnit=h.default.build(this.config.adUnit||c.default.get("adUnitId"),{
slotConfig:this.config})),this.adUnit}},{key:"getVideoAdUnit",value:function(){return this.videoAdUnit||(this.videoAdUnit=h.default.build(this.config.videoAdUnit||c.default.get("vast.adUnitId"),{slotConfig:this.config})),this.videoAdUnit}},{key:"getElement",value:function(){return document.getElementById(this.id)}},{key:"getSlotName",value:function(){return this.config.slotName}},{key:"getSizes",value:function(){return this.config.sizes}},{key:"getTargeting",value:function(){return this.config.targeting}},{key:"getDefaultSizes",value:function(){return this.config.defaultSizes}},{key:"shouldLoad",value:function(){var e=c.default.get("state.isMobile"),t="both"===this.screenSize,n=!e&&"desktop"===this.screenSize,i=e&&"mobile"===this.screenSize;return t||n||i}},{key:"isAboveTheFold",value:function(){return!!this.config.aboveTheFold}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isViewed",value:function(){return this.viewed}},{key:"enable",value:function(){this.enabled=!0}}
,{key:"disable",value:function(){this.enabled=!1}},{key:"success",value:function(){f.default.show(this),f.default.setDataParam(this,"slotResult","success"),this.config.defaultTemplate&&p.default.init(this.config.defaultTemplate,this)}},{key:"collapse",value:function(){f.default.hide(this),f.default.setDataParam(this,"slotResult","collapse")}}]),t}(l.EventEmitter);t.default=S},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(0),r=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(){function e(){i(this,e)}return o(e,null,[{key:"build",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?
arguments[1]:{},n=e.match(/{(.+?)}/g);return n&&n.forEach(function(n){var i=n.replace("{","").replace("}",""),o=r.default.get(i),a=i.split("."),s=void 0,l=void 0,u=t[a[0]];if(u)for(s=1;s<a.length;s+=1){if(l=a[s],!u[l]){u=null;break}u=u[l]}(u||o)&&(e=e.replace(n,u||o))}),e}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=o(s),u=n(16),c=o(u),d=n(7),f=o(d),T=n(18),h=o(T),b=n(20),p=i(b),v=n(22)
,S=i(v),g=function(){function e(t){a(this,e),this.adSlot=t,this.config=l.default.get("templates.bfaa"),this.container=document.getElementById(this.adSlot.getId()),this.videoSettings=null,this.theme=null}return r(e,null,[{key:"getName",value:function(){return"bfaa"}},{key:"getDefaultConfig",value:function(){function e(e){e.getElement().classList.add("sticky-bfaa")}function t(e){e.getElement().classList.remove("sticky-bfaa")}return{desktopNavbarWrapperSelector:".wds-global-navigation-wrapper",handleNavbar:!1,mobileNavbarWrapperSelector:".global-navigation-mobile-wrapper",slotSibling:".topic-header",slotsToEnable:["BOTTOM_LEADERBOARD","INCONTENT_BOXAD"],stickyAnimationDuration:500,onInit:function(){},onStickBfaaCallback:e,onUnstickBfaaCallback:t}}}]),r(e,[{key:"init",value:function(e){var t=this;if(this.params=e,this.container){var n="hivi"===this.params.theme?S:p;f.default.init(this.params,this.config.slotsToEnable),this.videoSettings=new h.default(this.params),this.container.style.
backgroundColor=this.getBackgroundColor(),this.container.classList.add("bfaa-template"),this.theme=new n.BfaaTheme(this.adSlot,this.params),n.adIsReady({adSlot:this.adSlot,videoSettings:this.videoSettings,params:this.params}).then(function(e){return t.onAdReady(e)}),this.config.onInit(this.adSlot,this.params,this.config)}}},{key:"setupNavbar",value:function(){var e=document.querySelector(this.config.desktopNavbarWrapperSelector),t=document.querySelector(this.config.mobileNavbarWrapperSelector),n=this.container.parentNode,i=document.querySelector(this.config.slotSibling)||this.container.nextElementSibling;t&&n.insertBefore(t,i),e&&n.insertBefore(e,i)}},{key:"getBackgroundColor",value:function(){var e="#"+this.params.backgroundColor.replace("#","");return this.params.backgroundColor?e:"#000"}},{key:"onAdReady",value:function(e){var t=this;document.body.style.paddingTop=e.parentElement.style.paddingBottom,document.body.classList.add("has-bfaa"),this.config.handleNavbar&&this.setupNavbar()
,f.default.isVideoEnabled(this.params)&&(0,c.default)(f.default.loadVideoAd,this.videoSettings).then(function(e){return t.theme.onVideoReady(e),e}),this.theme.onAdReady(e)}}]),e}();t.default=g},function(e,t,n){"use strict";function i(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("function"!=typeof e)throw new Error("Expected a function.");return new Promise(function(t){setTimeout(function(){return t(e.apply(void 0,n))},0)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";function i(e,t){e.style.height=e.offsetHeight+"px",e.style.height=e.offsetWidth/t+"px",setTimeout(function(){e.style.height=""},l)}function o(e,t){t.classList.add("hide"),e.classList.remove("hide")}function a(e,t){i(t.container,t.aspectRatio),setTimeout(function(){o(t.image,e.container),t.container.classList.remove(u)},l)}function r(e,t){t.container.classList.add(u),i(t.container,t.videoAspectRatio),o(e.container,t.image)}function s(e,t,n)
{e.addEventListener("wikiaAdStarted",function(){r(e,n)}),e.addEventListener("wikiaAdCompleted",function(){a(e,n)})}Object.defineProperty(t,"__esModule",{value:!0});var l=400,u="on-animation";t.default={add:s,duration:l}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(19),r=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(){function e(t){i(this,e),this.params=t,Object.defineProperty(this,"resolvedState",{value:r.default.isResolvedState(this.params),writable:!1}),Object.defineProperty(this,"autoPlay",{value:this.detectAutoPlay(),writable:!1}),Object.defineProperty(this,"splitLayout",{value:Boolean(t.
splitLayoutVideoPosition),writable:!1})}return o(e,[{key:"detectAutoPlay",value:function(){var e=this.params.autoPlay&&!this.resolvedState,t=this.params.resolvedStateAutoPlay&&this.resolvedState;return Boolean(e||t)}},{key:"getParams",value:function(){return Object.assign({},this.params)}},{key:"updateParams",value:function(e){Object.assign(this.params,e)}},{key:"isAutoPlay",value:function(){return this.autoPlay}},{key:"isResolvedState",value:function(){return this.resolvedState}},{key:"isSplitLayout",value:function(){return this.splitLayout}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){return Array.isArray(e)?e:Array.from(e)}function r(){return b.default.get("resolved_state",null)}function s(){return[!0,"true","1"].indexOf(r())>-1}function l(){return[!1,"blocked","false","0"].indexOf(r())>-1}
function u(e,t){var n=t.image1,i=t.image2,o=[],a="defaultStateSrc";return e===m&&(t.aspectRatio=t.resolvedStateAspectRatio,a="resolvedStateSrc"),o.push(Promise.resolve(t)),n.element.src=n[a],o.push(Promise.race([(0,p.once)(n.element,"load"),(0,p.once)(n.element,"error")])),i&&i[a]&&(i.element.src=i[a],o.push(Promise.race([(0,p.once)(i.element,"load"),(0,p.once)(i.element,"error")]))),Promise.all(o)}function c(e){return u(g,e)}function d(e){return u(m,e)}function f(e){return!(!e.image1||!e.image1.resolvedStateSrc)}function T(e){var t=!1;if(f(e)){var n=!l(),i=!0;n&&(i=S.default.wasDefaultStateSeen()||s()),t=n&&i}return t}Object.defineProperty(t,"__esModule",{value:!0});var h=n(4),b=i(h),p=n(63),v=n(64),S=i(v),g="default",m="resolved";t.default={setImage:function(e){var t=e.getParams();return f(t)?e.isResolvedState()?d(t).then(function(t){var n=a(t),i=n[0],r=n.slice(1);return e.updateParams(i),[i].concat(o(r))}):(S.default.updateInformationAboutSeenDefaultStateAd(),c(t)):Promise.resolve()
},isResolvedState:T}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(66);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=n(67);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.BigFancyAdTheme=function(){function e(t,n){i(this,e),this.adSlot=t,this.container=this.adSlot.getElement(),this.params=n}return o(e,[{key:"onAdReady",value:function(){}},
{key:"onVideoReady",value:function(){}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(68);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=n(73);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function
(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(16),l=o(s),u=n(7),c=o(u),d=n(18),f=o(d),T=n(20),h=i(T),b=n(22),p=i(b),v=function(){function e(t){a(this,e),this.adSlot=t,this.container=document.getElementById(this.adSlot.getId()),this.theme=null,this.videoSettings=null}return r(e,null,[{key:"getName",value:function(){return"bfab"}}]),r(e,[{key:"init",value:function(e){var t=this;if(this.params=e,this.container){var n="hivi"===this.params.theme?p:h;this.container.classList.add("bfab-template"),this.videoSettings=new f.default(e),this.theme=new n.BfabTheme(this.adSlot,this.params),n.adIsReady({adSlot:this.adSlot,videoSettings:this.videoSettings,params:this.params}).then(function(e){return t.onAdReady(e)})}}},{key:"onAdReady",value:function(e){var t=this;c.default.isVideoEnabled(this.params)&&(0,l.default)(c.default.loadVideoAd,this.videoSettings).then(function(e){return t.theme.onVideoReady(e),e}),this.theme.onAdReady(e)}}]),e}();t.default=v},function(e,t,n){e.exports=n(25)},
function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,i,o,r){E.default.init(i,t),v.default.init(),b.default.extend({slots:V.default[r]}),a(e,o),c(i,n,r)}function a(e,t){P.default.getBySlotName=function(t){var n=e.get(t);if(t&&n)return r(n)},P.default.legacyEnabled=P.default.enable,P.default.enable=function(e){t.unblock(e)}}function r(e){var t=b.default.get("slots."+e.name)||{targeting:{}};return e=Object.assign(new d.EventEmitter,e,{config:t,default:{getSlotName:function(){return e.name}},getElement:function(){return e.container.parentElement},getId:function(){return e.name},getSlotName:function(){return e.name},getTargeting:function(){return t.targeting},getVideoAdUnit:function(){return s(e.name)}}),e.pre("viewed",function(){g.default.onImpressionViewable(e)}),e}function s(e){return A.default.build(b.default.get("vast.adUnitId"),Object.assign({},b.default.get("targeting"),b.default.get("slots."+e)))}function l(e){return function(t){if(u().
includes(t.type)){var n=P.default.getBySlotName(t.slotName);n.container.parentNode.classList.add("gpt-ad"),b.default.set("slots."+t.slotName+".targeting.src",t.src),w.default.init(t.type,n,t)}else e(t)}}function u(){return R.map(function(e){return e.getName()})}function c(e,t,n){b.default.set("custom.device",T.default.getDeviceType()),b.default.set("targeting.skin",n),b.default.set("options.video.moatTracking.enabled",e.get("opts.porvataMoatTrackingEnabled")),b.default.set("options.video.moatTracking.sampling",e.get("opts.porvataMoatTrackingSampling")),Object.keys(t).forEach(function(e){return b.default.set("targeting."+e,t[e])})}Object.defineProperty(t,"__esModule",{value:!0}),t.UniversalAdPackage=t.Context=t.loadCustomAd=t.init=void 0;var d=n(10),f=n(11),T=i(f),h=n(0),b=i(h),p=n(5),v=i(p),S=n(28),g=i(S),m=n(6),P=i(m),M=n(14),A=i(M),y=n(31),E=i(y),G=n(8),w=i(G),C=n(15),B=i(C),O=n(23),L=i(O),H=n(7),I=i(H),_=n(77),k=i(_),D=n(78),V=i(D);b.default.extend(k.default);var R=[B.default,L.
default];t.init=o,t.loadCustomAd=l,t.Context=b.default,t.UniversalAdPackage=I.default},function(e,t,n){"use strict";!function(e,t){e(function(){function e(e,t){return null!=e&&null!=t&&e.toLowerCase()===t.toLowerCase()}function t(e,t){var n,i,o=e.length;if(!o||!t)return!1;for(n=t.toLowerCase(),i=0;i<o;++i)if(n===e[i].toLowerCase())return!0;return!1}function n(e){for(var t in e)s.call(e,t)&&(e[t]=new RegExp(e[t],"i"))}function i(e){return(e||"").substr(0,500)}function o(e,t){this.ua=i(e),this._cache={},this.maxPhoneWidth=t||600}var a={};a.mobileDetectRules={phones:{iPhone:"\\biPhone\\b|\\biPod\\b",BlackBerry:"BlackBerry|\\bBB10\\b|rim[0-9]+",HTC:"HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m|Android [0-9.]+; Pixel",Nexus:
"Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 6",Dell:"Dell[;]? (Streak|Aero|Venue|Venue Pro|Flash|Smoke|Mini 3iX)|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",Motorola:"Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b",Samsung:
"\\bSamsung\\b|SM-G950F|SM-G955F|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F|SM-G920F|SM-G920V|SM-G930F|SM-N910C|SM-A310F|GT-I9190"
,LG:"\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323)",Sony:"SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533",Asus:"Asus.*Galaxy|PadFone.*Mobile",NokiaLumia:"Lumia [0-9]{3,4}",Micromax:"Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",Palm:"PalmSource|Palm",Vertu:"Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",Pantech:
"PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",Fly:"IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",Wiko:"KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",iMobile:"i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",SimValley:"\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",Wolfgang:
"AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",Alcatel:"Alcatel",Nintendo:"Nintendo 3DS",Amoi:"Amoi",INQ:"INQ",GenericPhone:"Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser"},tablets:{iPad:"iPad|iPad.*Mobile",NexusTablet:"Android.*Nexus[\\s]+(7|9|10)",SamsungTablet:
"SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-T116BU|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|SM-T719|SM-T813|SM-T819|SM-T580|SM-T355Y?|SM-T280|SM-T817A|SM-T820|SM-W700|SM-P580|SM-T587|SM-P350|SM-P555M|SM-P355M|SM-T113NU|SM-T815Y"
,Kindle:"Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI|KFFOWI|KFGIWI|KFMEWI)\\b|Android.*Silk/[0-9.]+ like Chrome/[0-9.]+ (?!Mobile)",SurfaceTablet:"Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",HPTablet:"HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",AsusTablet:"^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z|\\bP027\\b",BlackBerryTablet:"PlayBook|RIM Tablet",HTCtablet:"HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",MotorolaTablet:
"xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",NookTablet:"Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",AcerTablet:"Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|\\bA3-A20\\b|\\bA3-A30",ToshibaTablet:"Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",LGTablet:"\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",FujitsuTablet:"Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",PrestigioTablet:
"PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",LenovoTablet:"Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-850M|YT3-X90L|YT3-X90F|YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)",DellTablet:"Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",YarvikTablet:
"Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",MedionTablet:"Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",ArnovaTablet:"97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",IntensoTablet:"INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",IRUTablet:"M702pro",MegafonTablet:"MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",EbodaTablet:"E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",AllViewTablet:"Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",ArchosTablet
:"\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|c|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",AinolTablet:"NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",NokiaLumiaTablet:"Lumia 2520",SonyTablet:"Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP612|SOT31",PhilipsTablet:"\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",CubeTablet:"Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",CobyTablet:"MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",MIDTablet:
"M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10",MSITablet:"MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",SMiTTablet:"Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",RockChipTablet:"Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",FlyTablet:"IQ310|Fly Vision",bqTablet:"Android.*(bq)?.*(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris ([E|M]10|M8))|Maxwell.*Lite|Maxwell.*Plus",HuaweiTablet:"MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim",NecTablet:"\\bN-06D|\\bN-08D",PantechTablet:"Pantech.*P4100",BronchoTablet:
"Broncho.*(N701|N708|N802|a710)",VersusTablet:"TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",ZyncTablet:"z1000|Z99 2G|z99|z930|z999|z990|z909|Z919|z900",PositivoTablet:"TB07STA|TB10STA|TB07FTA|TB10FTA",NabiTablet:"Android.*\\bNabi",KoboTablet:"Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",DanewTablet:"DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",TexetTablet:
"NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",PlaystationTablet:"Playstation.*(Portable|Vita)",TrekstorTablet:"ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",PyleAudioTablet:"\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",AdvanTablet:
"Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",DanyTechTablet:"Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",GalapadTablet:"Android.*\\bG1\\b",MicromaxTablet:"Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",KarbonnTablet:"Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",AllFineTablet:"Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",PROSCANTablet:"\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",YONESTablet:
"BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",ChangJiaTablet:"TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",GUTablet:"TX-A1301|TX-M9002|Q702|kf026",PointOfViewTablet:"TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",OvermaxTablet:"OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)|Qualcore 1027",
HCLTablet:"HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",DPSTablet:"DPS Dream 9|DPS Dual 7",VistureTablet:"V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",CrestaTablet:"CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",MediatekTablet:"\\bMT8125|MT8389|MT8135|MT8377\\b",ConcordeTablet:"Concorde([ ]+)?Tab|ConCorde ReadMan",GoCleverTablet:"GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",ModecomTablet:
"FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",VoninoTablet:"\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",ECSTablet:"V07OT2|TM105A|S10OT1|TR10CS1",StorexTablet:"eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",VodafoneTablet:"SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497",EssentielBTablet:"Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",RossMoorTablet:"RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",iMobileTablet:"i-mobile i-note",TolinoTablet:"tolino tab [0-9.]+|tolino shine",AudioSonicTablet:
"\\bC-22Q|T7-QC|T-17B|T-17P\\b",AMPETablet:"Android.* A78 ",SkkTablet:"Android.* (SKYPAD|PHOENIX|CYCLOPS)",TecnoTablet:"TECNO P9",JXDTablet:"Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",iJoyTablet:"Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",FX2Tablet:"FX2 PAD7|FX2 PAD10",XoroTablet:
"KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",ViewsonicTablet:"ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",OdysTablet:"LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",CaptivaTablet:"CAPTIVA PAD",IconbitTablet:"NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",TeclastTablet:
"T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",OndaTablet:
"\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+",JaytechTablet:"TPC-PA762",BlaupunktTablet:"Endeavour 800NG|Endeavour 1010",DigmaTablet:"\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",EvolioTablet:"ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",LavaTablet:"QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",AocTablet:"MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712",MpmanTablet:
"MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|\\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010",CelkonTablet:"CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",WolderTablet:"miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",MiTablet:"\\bMI PAD\\b|\\bHM NOTE 1W\\b",NibiruTablet:"Nibiru M1|Nibiru Jupiter One",NexoTablet:"NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",LeaderTablet:
"TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",UbislateTablet:"UbiSlate[\\s]?7C",PocketBookTablet:"Pocketbook",KocasoTablet:"\\b(TB-1207)\\b",HisenseTablet:"\\b(F5281|E2371)\\b",Hudl:"Hudl HT7S3|Hudl 2",TelstraTablet:"T-Hub2",GenericTablet:"Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b|\\bQTAQZ3\\b"},oss:{AndroidOS:"Android",BlackBerryOS:"blackberry|\\bBB10\\b|rim tablet os",PalmOS:"PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",SymbianOS:"Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",WindowsMobileOS:"Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Window Mobile|Windows Phone [0-9.]+|WCE;",WindowsPhoneOS:
"Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",iOS:"\\biPhone.*Mobile|\\biPod|\\biPad",MeeGoOS:"MeeGo",MaemoOS:"Maemo",JavaOS:"J2ME/|\\bMIDP\\b|\\bCLDC\\b",webOS:"webOS|hpwOS",badaOS:"\\bBada\\b",BREWOS:"BREW"},uas:{Chrome:"\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",Dolfin:"\\bDolfin\\b",Opera:"Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+|Coast/[0-9.]+",Skyfire:"Skyfire",Edge:"Mobile Safari/[.0-9]* Edge",IE:"IEMobile|MSIEMobile",Firefox:"fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile|FxiOS",Bolt:"bolt",TeaShark:"teashark",Blazer:"Blazer",Safari:"Version.*Mobile.*Safari|Safari.*Mobile|MobileSafari",UCBrowser:"UC.*Browser|UCWEB",baiduboxapp:"baiduboxapp",baidubrowser:"baidubrowser",DiigoBrowser:"DiigoBrowser",Puffin:"Puffin",Mercury:"\\bMercury\\b",ObigoBrowser:"Obigo",NetFront:"NF-Browser",GenericBrowser:
"NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger",PaleMoon:"Android.*PaleMoon|Mobile.*PaleMoon"},props:{Mobile:"Mobile/[VER]",Build:"Build/[VER]",Version:"Version/[VER]",VendorID:"VendorID/[VER]",iPad:"iPad.*CPU[a-z ]+[VER]",iPhone:"iPhone.*CPU[a-z ]+[VER]",iPod:"iPod.*CPU[a-z ]+[VER]",Kindle:"Kindle/[VER]",Chrome:["Chrome/[VER]","CriOS/[VER]","CrMo/[VER]"],Coast:["Coast/[VER]"],Dolfin:"Dolfin/[VER]",Firefox:["Firefox/[VER]","FxiOS/[VER]"],Fennec:"Fennec/[VER]",Edge:"Edge/[VER]",IE:["IEMobile/[VER];","IEMobile [VER]","MSIE [VER];","Trident/[0-9.]+;.*rv:[VER]"],NetFront:"NetFront/[VER]",NokiaBrowser:"NokiaBrowser/[VER]",Opera:[" OPR/[VER]","Opera Mini/[VER]","Version/[VER]"],"Opera Mini":"Opera Mini/[VER]","Opera Mobi":"Version/[VER]","UC Browser":"UC Browser[VER]",MQQBrowser:"MQQBrowser/[VER]",MicroMessenger:"MicroMessenger/[VER]",baiduboxapp:"baiduboxapp/[VER]",baidubrowser:"baidubrowser/[VER]",
SamsungBrowser:"SamsungBrowser/[VER]",Iron:"Iron/[VER]",Safari:["Version/[VER]","Safari/[VER]"],Skyfire:"Skyfire/[VER]",Tizen:"Tizen/[VER]",Webkit:"webkit[ /][VER]",PaleMoon:"PaleMoon/[VER]",Gecko:"Gecko/[VER]",Trident:"Trident/[VER]",Presto:"Presto/[VER]",Goanna:"Goanna/[VER]",iOS:" \\bi?OS\\b [VER][ ;]{1}",Android:"Android [VER]",BlackBerry:["BlackBerry[\\w]+/[VER]","BlackBerry.*Version/[VER]","Version/[VER]"],BREW:"BREW [VER]",Java:"Java/[VER]","Windows Phone OS":["Windows Phone OS [VER]","Windows Phone [VER]"],"Windows Phone":"Windows Phone [VER]","Windows CE":"Windows CE/[VER]","Windows NT":"Windows NT [VER]",Symbian:["SymbianOS/[VER]","Symbian/[VER]"],webOS:["webOS/[VER]","hpwOS/[VER];"]},utils:{Bot:"Googlebot|facebookexternalhit|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|YandexMobileBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom",MobileBot:
"Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",DesktopMode:"WPDesktop",TV:"SonyDTV|HbbTV",WebKit:"(webkit)[ /]([\\w.]+)",Console:"\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|PLAYSTATION|Xbox)\\b",Watch:"SM-V700"}},a.detectMobileBrowsers={fullPattern:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,shortPattern:
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i
,tabletPattern:/android|ipad|playbook|silk/i};var r,s=Object.prototype.hasOwnProperty;return a.FALLBACK_PHONE="UnknownPhone",a.FALLBACK_TABLET="UnknownTablet",a.FALLBACK_MOBILE="UnknownMobile",r="isArray"in Array?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},function(){var e,t,i,o,l,u,c=a.mobileDetectRules;for(e in c.props)if(s.call(c.props,e)){for(t=c.props[e],r(t)||(t=[t]),l=t.length,o=0;o<l;++o)i=t[o],u=i.indexOf("[VER]"),u>=0&&(i=i.substring(0,u)+"([\\w._\\+]+)"+i.substring(u+5)),t[o]=new RegExp(i,"i");c.props[e]=t}n(c.oss),n(c.phones),n(c.tablets),n(c.uas),n(c.utils),c.oss0={WindowsPhoneOS:c.oss.WindowsPhoneOS,WindowsMobileOS:c.oss.WindowsMobileOS}}(),a.findMatch=function(e,t){for(var n in e)if(s.call(e,n)&&e[n].test(t))return n;return null},a.findMatches=function(e,t){var n=[];for(var i in e)s.call(e,i)&&e[i].test(t)&&n.push(i);return n},a.getVersionStr=function(e,t){var n,i,o,r,l=a.mobileDetectRules.props;if(s.call(l,e))for(n=l[e],o=n.
length,i=0;i<o;++i)if(null!==(r=n[i].exec(t)))return r[1];return null},a.getVersion=function(e,t){var n=a.getVersionStr(e,t);return n?a.prepareVersionNo(n):NaN},a.prepareVersionNo=function(e){var t;return t=e.split(/[a-z._ \/\-]/i),1===t.length&&(e=t[0]),t.length>1&&(e=t[0]+".",t.shift(),e+=t.join("")),Number(e)},a.isMobileFallback=function(e){return a.detectMobileBrowsers.fullPattern.test(e)||a.detectMobileBrowsers.shortPattern.test(e.substr(0,4))},a.isTabletFallback=function(e){return a.detectMobileBrowsers.tabletPattern.test(e)},a.prepareDetectionCache=function(e,t,n){if(void 0===e.mobile){var i,r,s;if(r=a.findMatch(a.mobileDetectRules.tablets,t))return e.mobile=e.tablet=r,void(e.phone=null);if(i=a.findMatch(a.mobileDetectRules.phones,t))return e.mobile=e.phone=i,void(e.tablet=null);a.isMobileFallback(t)?(s=o.isPhoneSized(n),void 0===s?(e.mobile=a.FALLBACK_MOBILE,e.tablet=e.phone=null):s?(e.mobile=e.phone=a.FALLBACK_PHONE,e.tablet=null):(e.mobile=e.tablet=a.FALLBACK_TABLET,e.phone=
null)):a.isTabletFallback(t)?(e.mobile=e.tablet=a.FALLBACK_TABLET,e.phone=null):e.mobile=e.tablet=e.phone=null}},a.mobileGrade=function(e){var t=null!==e.mobile();return e.os("iOS")&&e.version("iPad")>=4.3||e.os("iOS")&&e.version("iPhone")>=3.1||e.os("iOS")&&e.version("iPod")>=3.1||e.version("Android")>2.1&&e.is("Webkit")||e.version("Windows Phone OS")>=7||e.is("BlackBerry")&&e.version("BlackBerry")>=6||e.match("Playbook.*Tablet")||e.version("webOS")>=1.4&&e.match("Palm|Pre|Pixi")||e.match("hp.*TouchPad")||e.is("Firefox")&&e.version("Firefox")>=12||e.is("Chrome")&&e.is("AndroidOS")&&e.version("Android")>=4||e.is("Skyfire")&&e.version("Skyfire")>=4.1&&e.is("AndroidOS")&&e.version("Android")>=2.3||e.is("Opera")&&e.version("Opera Mobi")>11&&e.is("AndroidOS")||e.is("MeeGoOS")||e.is("Tizen")||e.is("Dolfin")&&e.version("Bada")>=2||(e.is("UC Browser")||e.is("Dolfin"))&&e.version("Android")>=2.3||e.match("Kindle Fire")||e.is("Kindle")&&e.version("Kindle")>=3||e.is("AndroidOS")&&e.is(
"NookTablet")||e.version("Chrome")>=11&&!t||e.version("Safari")>=5&&!t||e.version("Firefox")>=4&&!t||e.version("MSIE")>=7&&!t||e.version("Opera")>=10&&!t?"A":e.os("iOS")&&e.version("iPad")<4.3||e.os("iOS")&&e.version("iPhone")<3.1||e.os("iOS")&&e.version("iPod")<3.1||e.is("Blackberry")&&e.version("BlackBerry")>=5&&e.version("BlackBerry")<6||e.version("Opera Mini")>=5&&e.version("Opera Mini")<=6.5&&(e.version("Android")>=2.3||e.is("iOS"))||e.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3")||e.version("Opera Mobi")>=11&&e.is("SymbianOS")?"B":(e.version("BlackBerry")<5||e.match("MSIEMobile|Windows CE.*Mobile")||e.version("Windows Mobile"),"C")},a.detectOS=function(e){return a.findMatch(a.mobileDetectRules.oss0,e)||a.findMatch(a.mobileDetectRules.oss,e)},a.getDeviceSmallerSide=function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height},o.prototype={constructor:o,mobile:function(){return a.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth)
,this._cache.mobile},phone:function(){return a.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.phone},tablet:function(){return a.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.tablet},userAgent:function(){return void 0===this._cache.userAgent&&(this._cache.userAgent=a.findMatch(a.mobileDetectRules.uas,this.ua)),this._cache.userAgent},userAgents:function(){return void 0===this._cache.userAgents&&(this._cache.userAgents=a.findMatches(a.mobileDetectRules.uas,this.ua)),this._cache.userAgents},os:function(){return void 0===this._cache.os&&(this._cache.os=a.detectOS(this.ua)),this._cache.os},version:function(e){return a.getVersion(e,this.ua)},versionStr:function(e){return a.getVersionStr(e,this.ua)},is:function(n){return t(this.userAgents(),n)||e(n,this.os())||e(n,this.phone())||e(n,this.tablet())||t(a.findMatches(a.mobileDetectRules.utils,this.ua),n)},match:function(e){return e instanceof RegExp||(e=new RegExp(e,"i")),e.test(this.ua)},
isPhoneSized:function(e){return o.isPhoneSized(e||this.maxPhoneWidth)},mobileGrade:function(){return void 0===this._cache.grade&&(this._cache.grade=a.mobileGrade(this)),this._cache.grade}},"undefined"!=typeof window&&window.screen?o.isPhoneSized=function(e){return e<0?void 0:a.getDeviceSmallerSide()<=e}:o.isPhoneSized=function(){},o._impl=a,o.version="1.4.0 2017-12-09",o})}(function(t){return void 0!==e&&e.exports?function(t){e.exports=t()}:n(27)}())},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return document.getElementById(e.getId()).querySelector('div[id*="_container_"] iframe')}function r(e,t){var n=a(t),i=!1;if(e.isEmpty)return"collapse";try{i=!!n.contentWindow.document.querySelector}catch(e){(0,l.logger)(h,"getAdType","iframe is not accessible")}return i
&&n.contentWindow.AdEngine_adType?n.contentWindow.AdEngine_adType:"success"}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(2),u=n(13),c=n(1),d=i(c),f=n(30),T=i(f),h="slot-listener",b=function(){function e(){o(this,e)}return s(e,null,[{key:"onRenderEnded",value:function(e,t){var n=r(e,t);switch((0,l.logger)(h,"onRenderEnded",t.getId(),n,e),T.default.updateOnRenderEnd(t,e),n){case"collapse":t.collapse();break;default:t.success()}}},{key:"onImpressionViewable",value:function(e){e.emit(u.SLOT_VIEWED_EVENT),d.default.setDataParam(e,"slotViewed",!0)}}]),e}();t.default=b},function(e,t,n){"use strict";function i(e){try{return!!JSON.parse(e.data).AdEngine}catch(e){return!1}}function o(e,t){var n=!0;if(e.keys){var i=JSON.parse(t.data).AdEngine;e
.keys.forEach(function(e){n=n&&i[e]})}return n}function a(e){var t=0,n=void 0;if(i(e))for((0,r.logger)(l,"Message received",e),t=0;t<s.length;t+=1)if(n=s[t],o(n.match,e))return(0,r.logger)(l,"Matching message",e,n),n.fn(JSON.parse(e.data).AdEngine),void(n.match.infinite||s.splice(t,1))}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),s=[],l="message-bus";t.default={init:function(){(0,r.logger)(l,"Register message listener"),window.addEventListener("message",a)},register:function(e,t){s.push({match:e,fn:t})}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=i(o),r=n(0),s=i(r);t.default={getSlotSizes:function(e){var t={};return e.getSizes().forEach(function(e){t[e.viewportSize[0]+"x"+e.viewportSize[1]]=e.sizes}),JSON.stringify(t)},updateOnCreate:function(e,t){a.default.setDataParam(e,"gptPageParams",s.default.get("targeting")),a.default.setDataParam(e,"gptSlotParams",t),a.default.
setDataParam(e,"sizes",this.getSlotSizes(e))},updateOnRenderEnd:function(e,t){a.default.setDataParam(e,"gptLineItemId",t.lineItemId),a.default.setDataParam(e,"gptCreativeId",t.creativeId),a.default.setDataParam(e,"gptCreativeSize",t.size)}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(15),s=i(r),l=n(23),u=i(l),c=n(1),d=(i(c),n(8)),f=i(d),T=n(74),h=n(75),b=function(){function e(){o(this,e)}return a(e,null,[{key:"init",value:function(e,t){var n="oasis"!==e.get("targeting.skin"),i=n?T.getConfig:h.getConfig;f.default.register(s.default,i(t)),f.default.register(u.
default)}}]),e}();t.default=b},function(e,t,n){"use strict";function i(e,t){var n=void 0,i=0,o=void 0,a=void 0;return function(){for(var r=arguments.length,s=Array(r),l=0;l<r;l++)s[l]=arguments[l];var u=Date.now(),c=t-(u-i);return n=this,a&&(clearTimeout(a),a=null),c<=0||c>t?(i=u,o=e.apply(n,s),a||(n=s=null)):a=window.setTimeout(function(){o=e.apply(n,s)},t),o}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PorvataPlayer=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(34),s=i(r),l=n(43),u=i(l),c=n(45),d=i(c),f=n(46),T=i(f),h=function(e){var t
=e.container.querySelector("div");return t.classList.add("video-player"),t.classList.add("hide"),t},b=function(e){var t=(0,T.default)(e,["webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","requestFullscreen"]),n=(0,T.default)(document,["webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","exitFullscreen"]),i=((0,f.whichProperty)(document,["onwebkitfullscreenchange","onmozfullscreenchange","MSFullscreenChange","onfullscreenchange"])||"").replace(/^on/,"");return{enter:t,exit:n,addChangeListener:function(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=document).addEventListener.apply(e,[i].concat(n))},removeChangeListener:function(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=document).removeEventListener.apply(e,[i].concat(n))},isSupported:function(){return Boolean(t&&n)}}},p=t.PorvataPlayer=function(){function e(t,n){var i=this;o(this,e),this.ima=t,this.container=h(n),this.mobileVideoAd=n
.container.querySelector("video"),this.params=n;var a=b(this.container);this.fullscreen=Boolean(n.isFullscreen),this.nativeFullscreen=a,this.width=n.width,this.height=n.height,a.isSupported()&&a.addChangeListener(function(){return i.onFullscreenChange()})}return a(e,[{key:"addEventListener",value:function(e,t){this.ima.addEventListener(e,t)}},{key:"getRemainingTime",value:function(){return this.ima.getAdsManager().getRemainingTime()}},{key:"isFullscreen",value:function(){return this.fullscreen}},{key:"isMuted",value:function(){return 0===this.ima.getAdsManager().getVolume()}},{key:"isMobilePlayerMuted",value:function(){var e=this.container.querySelector("video");return e&&e.autoplay&&e.muted}},{key:"isPaused",value:function(){return"paused"===this.ima.getStatus()}},{key:"isPlaying",value:function(){return"playing"===this.ima.getStatus()}},{key:"pause",value:function(){this.ima.getAdsManager().pause()}},{key:"play",value:function(e,t){void 0!==e&&void 0!==t&&(this.width=e,this.height=t)
,this.width&&this.height||(this.width=this.params.container.offsetWidth,this.height=this.params.container.offsetHeight),this.ima.playVideo(this.width,this.height)}},{key:"reload",value:function(){this.ima.reload()}},{key:"resize",value:function(e,t){isFinite(e)&&isFinite(t)&&(this.width=e,this.height=t),this.isFullscreen()?this.ima.resize(window.innerWidth,window.innerHeight,!0):this.ima.resize(this.width,this.height,!1)}},{key:"resume",value:function(){this.ima.getAdsManager().resume()}},{key:"setVolume",value:function(e){this.updateVideoDOMElement(e),this.ima.getAdsManager().setVolume(e),this.ima.dispatchEvent("wikiaVolumeChange")}},{key:"toggleFullscreen",value:function(){var e=this.isFullscreen(),t=this.nativeFullscreen;if(t.isSupported()){(e?t.exit:t.enter)()}else this.onFullscreenChange()}},{key:"onFullscreenChange",value:function(){this.fullscreen=!this.fullscreen,this.isFullscreen()?(this.container.classList.add("video-player-fullscreen"),document.documentElement.classList.add(
"stop-scrolling")):(this.container.classList.remove("video-player-fullscreen"),document.documentElement.classList.remove("stop-scrolling")),this.resize(),this.ima.dispatchEvent("wikiaFullscreenChange")}},{key:"updateVideoDOMElement",value:function(e){this.mobileVideoAd&&(this.mobileVideoAd.muted=0===e)}},{key:"mute",value:function(){this.setVolume(0)}},{key:"unmute",value:function(){this.setVolume(.75)}},{key:"volumeToggle",value:function(){this.isMuted()?this.unmute():this.mute()}},{key:"stop",value:function(){this.ima.getAdsManager().stop(),this.ima.dispatchEvent("wikiaAdStop")}}]),e}(),v=function(){function e(){o(this,e)}return a(e,null,[{key:"addOnViewportChangeListener",value:function(e,t){return d.default.addListener(e.container,t,{offsetTop:e.viewportOffsetTop||0,offsetBottom:e.viewportOffsetBottom||0})}},{key:"inject",value:function(t){function n(e){e.addEventListener("loaded",function(){i&&e.mute()})}var i=!0,o=!1,a=!1,r=null;t.vastTargeting=t.vastTargeting||{passback:
"porvata"};var l=new u.default(t);return s.default.load().then(function(){return s.default.getPlayer(l)}).then(function(e){return new p(e,t)}).then(function(s){function l(e){e&&!a&&t.autoPlay?(s.play(),a=!0):e&&o?s.resume():!e&&s.isPlaying()&&(s.pause(),o=!0)}return s.addEventListener("adCanPlay",function(){s.ima.dispatchEvent("wikiaAdStarted")}),s.addEventListener("allAdsCompleted",function(){s.isFullscreen()&&s.toggleFullscreen(),s.ima.setAutoPlay(!1),s.ima.dispatchEvent("wikiaAdCompleted"),r&&(d.default.removeListener(r),r=null),i=!1}),s.addEventListener("start",function(){s.ima.dispatchEvent("wikiaAdPlay"),r||(r=e.addOnViewportChangeListener(t,l))}),s.addEventListener("resume",function(){s.ima.dispatchEvent("wikiaAdPlay"),o=!1}),s.addEventListener("pause",function(){s.ima.dispatchEvent("wikiaAdPause")}),t.autoPlay&&n(s),t.onReady&&t.onReady(s),s.addEventListener("wikiaAdsManagerLoaded",function(){r=e.addOnViewportChangeListener(t,l)}),s})}}]),e}();t.default=v},function(e,t,n){
"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){return window.google&&window.google.ima?new Promise(function(e){e()}):u.default.loadScript(c)}function a(e){var t=new window.google.ima.AdDisplayContainer(e.getContainer()),n=e.getContainer().querySelector("div > iframe");window.performance&&window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD&&(n.contentWindow.location.href=n.src);var i=new window.google.ima.AdsLoader(t);return s.default.create(t,i,e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),s=i(r),l=n(42),u=i(l),c="//imasdk.googleapis.com/js/sdkloader/ima3.js";t.default={load:o,getPlayer:a}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){var e=document.createElement("video");return e.setAttribute("preload","none"),e}Object.defineProperty(t,"__esModule",{value:!0});var r
=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(36),l=i(s),u=n(38),c=i(u),d=n(40),f=i(d),T=function(){function e(t,n,i){o(this,e),this.isAdsManagerLoaded=!1,this.status="",this.adDisplayContainer=t,this.adsLoader=n,this.adsManager=null,this.params=i,this.mobileVideoAd=i.container.querySelector("video"),this.eventListeners={},this.vastUrl=""}return r(e,[{key:"setVastUrl",value:function(e){this.vastUrl=e}},{key:"setAdsManager",value:function(e){this.adsManager=e,this.isAdsManagerLoaded=!0}},{key:"addEventListener",value:function(e,t){var n=this;if(-1!==e.indexOf("wikia"))return this.eventListeners[e]=this.eventListeners[e]||[],void this.eventListeners[e].push(t);this.isAdsManagerLoaded?this.adsManager.addEventListener(e,t):this.adsLoader.addEventListener("adsManagerLoaded",function(){n.
adsManager.addEventListener(e,t)})}},{key:"setVastAttributes",value:function(e){var t=this.adsManager&&this.adsManager.getCurrentAd&&this.adsManager.getCurrentAd(),n=this.params.container.querySelector(".video-player");f.default.setVastAttributes(n,this.vastUrl,e,t)}},{key:"setAutoPlay",value:function(e){this.mobileVideoAd&&(this.mobileVideoAd.autoplay=e,this.mobileVideoAd.muted=e)}},{key:"playVideo",value:function(e,t){var n=this,i=function i(){n.adDisplayContainer.initialize(),n.adsManager.init(Math.round(e),Math.round(t),window.google.ima.ViewMode.NORMAL),n.adsManager.start(),n.adsLoader.removeEventListener("adsManagerLoaded",i)};this.isAdsManagerLoaded?i():(this.setAutoPlay(!0),this.adsLoader.addEventListener("adsManagerLoaded",i,!1))}},{key:"reload",value:function(){var e=l.default.createRequest(this.params);this.adsManager.destroy(),this.adsLoader.contentComplete(),this.setVastUrl(e.adTagUrl),this.adsLoader.requestAds(e)}},{key:"resize",value:function(e,t){var n=arguments.length>
2&&void 0!==arguments[2]&&arguments[2],i=window.google.ima.ViewMode;this.adsManager&&this.adsManager.resize(Math.round(e),Math.round(t),n?i.FULLSCREEN:i.NORMAL)}},{key:"dispatchEvent",value:function(e){this.eventListeners[e]&&this.eventListeners[e].length>0&&this.eventListeners[e].forEach(function(e){e({})})}},{key:"setStatus",value:function(e){var t=this;return function(){t.status=e}}},{key:"getStatus",value:function(){return this.status}},{key:"getAdsManager",value:function(){return this.adsManager}}]),e}(),h=function(){function e(){o(this,e)}return r(e,null,[{key:"create",value:function(e,t,n){var i=l.default.createRequest(n.getParams()),o=new T(e,t,n.getParams()),r=a();return o.mobileVideoAd&&n.getContainer().classList.add("mobile-porvata"),t.addEventListener("adsManagerLoaded",function(e){var t=l.default.getRenderingSettings(n),i=e.getAdsManager(r,t);o.setAdsManager(i),n.isMoatTrackingEnabled()&&c.default.init(i,n.getContainer(),window.google.ima.ViewMode.NORMAL,n.get("src"),n.get
("adProduct")+"/"+n.get("slotName")),o.dispatchEvent("wikiaAdsManagerLoaded"),i.addEventListener("loaded",function(){return o.setVastAttributes("success")}),i.addEventListener("adError",function(){return o.setVastAttributes("error")})},!1),t.addEventListener("adError",function(){return o.setVastAttributes("error")}),o.setVastUrl(i.adTagUrl),t.requestAds(i),n.get("autoPlay")&&o.setAutoPlay(!0),o.addEventListener("resume",o.setStatus("playing")),o.addEventListener("start",o.setStatus("playing")),o.addEventListener("pause",o.setStatus("paused")),o}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){if("1"===d.default.get("porvata_override_vast")){var e=window.localStorage.getItem("porvata_vast");return(0,u.logger)(T,"Overridden VAST",e),e}return null}function a(e){var t=new window.google.ima.AdsRequest,n=o();return(e.vastResponse||n)&&(t.adsResponse=n||e.vastResponse),t.adTagUrl=e.vastUrl||(0,f.build)(e.width/e.height,e.
slotName,{targeting:e.vastTargeting}),t.linearAdSlotWidth=e.width,t.linearAdSlotHeight=e.height,t}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new window.google.ima.AdsRenderingSettings;return l.default.get("state.isMobile")||(t.bitrate=68e3),t.loadVideoTimeout=e.loadVideoTimeout||15e3,t.enablePreloading=!0,t.uiElements=[],t}Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=i(s),u=n(2),c=n(4),d=i(c),f=n(37),T="google-ima-setup";t.default={createRequest:a,getRenderingSettings:r}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},l.default.get("targeting"),e.getTargeting(),t);return encodeURIComponent(Object.keys(n).filter(function(e){return n[e]}).map(function(e){return e+"="+n[e]}).join("&"))}function a(e){return!isNaN(parseFloat(e))&&isFinite(e)}function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?
arguments[2]:{},i=["output=vast","env=vp","gdfp_req=1","impl=s","unviewed_position_start=1","sz="+(e>1||!a(e)?"640x480":"320x480"),"url="+encodeURIComponent(window.location.href),"description_url="+encodeURIComponent(window.location.href),"correlator="+T],r=c.default.getBySlotName(t);if(!r)throw Error("Slot does not exist!");return i.push("iu="+r.getVideoAdUnit()),i.push("cust_params="+o(r,n.targeting)),n.contentSourceId&&n.videoId&&(i.push("cmsid="+n.contentSourceId),i.push("vid="+n.videoId)),n.vpos&&d.indexOf(n.vpos)>-1&&i.push("vpos="+n.vpos),void 0!==n.numberOfAds&&i.push("pmad="+n.numberOfAds),f+i.join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t.build=r;var s=n(0),l=i(s),u=n(6),c=i(u),d=["preroll","midroll","postroll"],f="https://pubads.g.doubleclick.net/gampad/ads?",T=Math.round(1e10*Math.random())},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError(
"Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(2),s=n(0),l=i(s),u=n(39),c=i(u),d=function(){function e(){o(this,e)}return a(e,null,[{key:"init",value:function(e,t,n,i,o){var a={partnerCode:l.default.get("options.video.moatTracking.partnerCode"),viewMode:n,slicer1:i,slicer2:o};try{(0,c.default)(e,a,t),(0,r.logger)("moat-video-tracker","MOAT video tracking initialized")}catch(e){(0,r.logger)("moat-video-tracker","MOAT video tracking initalization error",e)}}}]),e}();t.default=d},function(e,t,n){"use strict";function i(e,t,n){if(!1===t.hasOwnProperty("partnerCode"))return!1;var i=document.createElement("script");if(n=n||e&&(void 0!==e.O?e.O.parentNode:document.body)||document.body,a=[],r={adsManager:e,
ids:t,imaSDK:!0,events:[]},o={complete:"AdVideoComplete",firstquartile:"AdVideoFirstQuartile",impression:"AdImpression",loaded:"AdLoaded",midpoint:"AdVideoMidpoint",pause:"AdPaused",skip:"AdSkipped",start:"AdVideoStart",thirdquartile:"AdVideoThirdQuartile",volumeChange:"AdVolumeChange"},google&&google.ima&&e){var s,l="_moatApi"+Math.floor(1e8*Math.random());for(s in google.ima.AdEvent.Type){var u=function(t){if(r.sendEvent){for(t=a.length-1;0<=t;t--)e.removeEventListener(a[t].type,a[t].func);r.sendEvent(r.events)}else r.events.push({type:o[t.type]||t.type,adVolume:e.getVolume()})};e.addEventListener(google.ima.AdEvent.Type[s],u),a.push({type:google.ima.AdEvent.Type[s],func:u})}}var c,d,l=void 0!==l?l:"";try{c=n.ownerDocument,d=c.defaultView||c.parentWindow}catch(e){c=document,d=window}d[l]=r,i.type="text/javascript",n&&n.appendChild(i),i.src="https://z.moatads.com/"+t.partnerCode+"/moatvideo.js#"+l}Object.defineProperty(t,"__esModule",{value:!0});var o={},a=[],r={};t.default=i},
function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){e&&n&&e.setAttribute(t,n)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(41),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=function(){function e(){i(this,e)}return a(e,null,[{key:"setVastAttributes",value:function(e,t,n,i){var a=s.default.parse(t,{imaAd:i});o(e,"data-vast-content-type",a.contentType),o(e,"data-vast-creative-id",a.creativeId),o(e,"data-vast-line-item-id",a.lineItemId),o(e,"data-vast-position",a.position),o(e,"data-vast-size",a.size),o(e,"data-vast-status",n),o(e,"data-vast-params",JSON.stringify(a.customParams))}}]),e}();t.default=l},function(e,t,n){"use strict";function
i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(4),r=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(){function e(){i(this,e)}return o(e,null,[{key:"getAdInfo",value:function(e){var t={},n=void 0,i=void 0;return e&&(t.lineItemId=e.getAdId(),t.creativeId=e.getCreativeId(),t.contentType=e.getContentType(),i=e.getWrapperAdIds(),i.length&&(t.lineItemId=i[0]),n=e.getWrapperCreativeIds(),n.length&&(t.creativeId=n[0])),t}},{key:"parse",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.getAdInfo(n.imaAd),o=r.default.getValues(t.substr(1+t.indexOf("?"))),a=r.default.getValues(o.cust_params);return{contentType:i
.contentType||n.contentType,creativeId:i.creativeId||n.creativeId,customParams:a,lineItemId:i.lineItemId||n.lineItemId,position:o.vpos,size:o.sz}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={createScript:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/javascript",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=document.createElement("script");return i=i||document.body.lastChild,o.async=n,o.type=t,o.src=e,i.parentNode.insertBefore(o,i),o},loadScript:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/javascript",n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise(function(a,r){var s=n.createScript(e,t,i,o);s.onload=a,s.onerror=r})}}},function(e,t,n){"use strict";function i(e){return e&&e.
__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){var t=l.default.get("options.video.moatTracking.sampling");return"boolean"==typeof e.moatTracking?e.moatTracking:!!l.default.get("options.video.moatTracking.enabled")&&(100===t||t>0&&c.default.sample("moat_video_tracking",t))}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=i(s),u=n(44),c=i(u),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.params=t,this.moatTracking=a(t)}return r(e,[{key:"get",value:function(e){return this.params[e]}},{key:"getContainer",value:function(){return this.get("container")}},{key:"getParams",value:function(){return this
.params}},{key:"isMoatTrackingEnabled",value:function(){return this.moatTracking}}]),e}();t.default=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return-1!==(l.default.get("ignored_samplers")||"").split(",").indexOf(e)}function a(e,t){return Math.floor(Math.random()*(t-e))+e}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(4),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(){function e(){i(this,e)}return r(e,null,[{key:"sample",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return!!o(e)||a(0,n)<t}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e){var t=(0,l.isInViewport)(e.
element);t!==e.inViewport&&(e.callback(t),e.inViewport=t)}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={element:e,callback:t,offsetTop:n.offsetTop||0,offsetBottom:n.offsetBottom||0,inViewport:!1},a=function(){i(o)};return o.id=s.default.addCallback(a),a(),o.id}function a(e){s.default.removeCallback(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=n(12);t.default={addListener:o,removeListener:a}},function(e,t,n){"use strict";function i(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;n<t.length;n+=1){var i=t[n];if("string"!=typeof i)throw new Error("property name must be a string");if(i in e)return i}return null}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=i(e,t);if(null!==n){var o=e[n];return"function"==typeof o?o.bind(e):o}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.whichProperty=i,t.default=o},
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(48);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=n(62);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.getParams(),n=_(t,e),i="default";return"hivi"===t.theme?i="hivi":e.isSplitLayout()?i="right"===t.splitLayoutVideoPosition?"split-right":"split-left":e.isAutoPlay()?i="auto-play":document.body.classList.add("ctp-vuap-loaded"),t.container.classList.add("theme-"+i),t.isDarkTheme&&t.container.classList.add("theme-dark"),t.isMobile&&t.container.classList.add("theme-mobile-layout"),(r.default.isSmartphone()||r.default.isTablet())&&t.container.classList.add("theme-mobile-device"),n[i]}Object.defineProperty(t,
"__esModule",{value:!0}),t.selectTemplate=o;var a=n(11),r=i(a),s=n(49),l=i(s),u=n(50),c=i(u),d=n(52),f=i(d),T=n(53),h=i(T),b=n(54),p=i(b),v=n(55),S=i(v),g=n(17),m=i(g),P=n(56),M=i(P),A=n(57),y=i(A),E=n(58),G=i(E),w=n(59),C=i(w),B=n(60),O=i(B),L=n(61),H=i(L),I=function(e){var t=e.theme,n=void 0===t?null:t,i="hivi"===n,o="bottom-panel";return i&&(o+=" dynamic-panel"),new H.default(o,[i?f.default:null,O.default,i?M.default:null])},_=function(e,t){return{"auto-play":[p.default,h.default,I(e),m.default],default:[p.default,h.default,I(e),l.default,m.default],"split-left":[p.default,h.default,I(e),C.default,S.default,t.isAutoPlay()?null:l.default],"split-right":[p.default,h.default,I(e),C.default,S.default,t.isAutoPlay()?null:l.default],hivi:[p.default,I(e),e.videoPlaceholderElement?C.default:m.default,y.default,G.default,c.default,e.videoPlaceholderElement?S.default:null]}}},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div");n.classList.add("close-ad"),n.
addEventListener("click",function(t){e.stop(),t.preventDefault()}),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default={add:i}},function(e,t,n){"use strict";function i(e,t,n){var i=document.createElement("div"),r=(0,o.createIcon)(o.icons.LEARN_MORE,["learn-more-icon","porvata-icon"]),s=document.createElement("div");s.innerText=a,i.appendChild(s),i.appendChild(r),i.classList.add("learn-more"),i.addEventListener("click",function(){top.open(n.clickThroughURL,"_blank")}),t.appendChild(i)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a="Learn More";t.default={add:i}},function(e,t){e.exports={CROSS:
'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.707 4.293a.999.999 0 0 0-1.414 0L12 10.586 5.707 4.293a.999.999 0 1 0-1.414 1.414L10.586 12l-6.293 6.293a.999.999 0 1 0 1.414 1.414L12 13.414l6.293 6.293a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414L13.414 12l6.293-6.293a.999.999 0 0 0 0-1.414" fill-rule="evenodd"/></svg>',LEARN_MORE:
'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill-rule="evenodd"><g transform="translate(-753.000000, -1764.000000)" fill-rule="nonzero"><g transform="translate(153.000000, 1746.000000)"><g transform="translate(5.000000, 0.000000)"><g transform="translate(459.000000, 0.000000)"><g transform="translate(136.000000, 18.000000)"><polygon points="24 0 15 0 18.4395 3.4395 9.033 12.846 11.154 14.967 20.5605 5.5605 24 9"></polygon><path d="M19.5,24 L1.5,24 C0.672,24 0,23.328 0,22.5 L0,4.5 C0,3.672 0.672,3 1.5,3 L10.5,3 L10.5,6 L3,6 L3,21 L18,21 L18,13.5 L21,13.5 L21,22.5 C21,23.328 20.328,24 19.5,24 Z"></path></g></g></g></g></g></g></svg>',PAUSE:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><rect width="7" height="22" rx="1" x="3" y="1"></rect><rect x="14" width="7" height="22" rx="1" y="1"></rect></g></svg>',PLAY:
'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.69 12.6L5.143 22.867a.722.722 0 0 1-.753.05.733.733 0 0 1-.391-.65V1.733c0-.274.15-.524.391-.65a.724.724 0 0 1 .753.05l14.545 10.266a.734.734 0 0 1 0 1.201z" fill-rule="evenodd"></path></svg>',REPLAY:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 23c6.065 0 11-4.863 11-10.84a.992.992 0 0 0-1-.985c-.553 0-1 .44-1 .986 0 4.89-4.037 8.868-9 8.868s-9-3.978-9-8.868c0-4.89 4.037-8.869 9-8.869a8.991 8.991 0 0 1 6.975 3.292l-3.794-.501a.996.996 0 0 0-1.124.845.987.987 0 0 0 .858 1.108l5.946.785a.996.996 0 0 0 1.124-.845l.797-5.86a.987.987 0 0 0-.858-1.107.994.994 0 0 0-1.124.846l-.446 3.28A10.997 10.997 0 0 0 12 1.322c-6.065 0-11 4.862-11 10.839C1 18.137 5.935 23 12 23" fill-rule="evenodd"/></svg>',FULLSCREEN_OFF:
'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 9H8V2H5v4H1v3h4.5zm13 0H16V2h3v4h4v3h-4.5zm-13 6H8v7H5v-4H1v-3h4.5zm13 0H16v7h3v-4h4v-3h-4.5z" fill-rule="evenodd"/></svg>',FULLSCREEN_ON:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.5 22H23v-7h-3v4h-4v3h5.5zM23 3.5V9h-3V5h-4V2h7v1.5zm-22 17V15h3v4h4v3H1v-1.5zM2.5 2H1v7h3V5h4V2H2.5z" fill-rule="evenodd"/></svg>',VOLUME_OFF:
'<svg viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#fff;opacity:0.4;}.cls-2{fill:#231f20;}</style></defs><title>sound_off_button</title><circle class="cls-1" cx="14.06" cy="13.96" r="13.74"/><path class="cls-2" d="M16,2.93A13.07,13.07,0,1,1,2.93,16,13.08,13.08,0,0,1,16,2.93M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Z" transform="translate(-2 -2)"/><g id="Page-1"><g id="Video-Player-Skin"><g id="Video-Copy"><g id="volume-off"><path id="Shape" class="cls-2" d="M14.25,9.17l-3.79,4.11H6.84c-.78,0-1,.46-1,.89V17.7a1,1,0,0,0,1,1h3.65l3.79,4.18a1.09,1.09,0,0,0,.53.14,1,1,0,0,0,.5-.14,1,1,0,0,0,.5-.9V10a1,1,0,0,0-.5-.9,1.06,1.06,0,0,0-1,.05Z" transform="translate(-2 -2)"/><path id="Fill-1" class="cls-2" d="M22.91,16.21l3-3a.92.92,0,1,0-1.3-1.3l-3,3-3-3a.92.92,0,1,0-1.3,1.3l3,3-3,3a.92.92,0,1,0,1.3,1.3l3-3,3,3a.92.92,0,1,0,1.3-1.3Z" transform="translate(-2 -2)"/></g></g></g></g></svg>',VOLUME_ON:
'<svg viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#fff;opacity:0.4;}.cls-2{fill:#231f20;}</style></defs><title>sound_on_button</title><circle class="cls-1" cx="13.96" cy="14.06" r="13.74"/><path class="cls-2" d="M16,2.93A13.07,13.07,0,1,1,2.93,16,13.08,13.08,0,0,1,16,2.93M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Z" transform="translate(-2 -2)"/><g id="Page-1"><g id="Video-Player-Skin"><g id="Video-Copy"><g id="volume"><path id="Shape" class="cls-2" d="M14.24,9.17l-3.79,4.11H6.82c-.78,0-1,.46-1,.89V17.7a1,1,0,0,0,1,1h3.65l3.79,4.18a1.09,1.09,0,0,0,.53.14,1,1,0,0,0,.5-.14,1,1,0,0,0,.5-.9V10a1,1,0,0,0-.5-.9,1.06,1.06,0,0,0-1,.05Z" transform="translate(-2 -2)"/><path id="Shape-2" data-name="Shape" class="cls-2" d="M19.18,19.33a4.39,4.39,0,0,0,0-6.19.71.71,0,0,0-1,1,3,3,0,0,1,0,4.19.71.71,0,0,0,1,1Z" transform="translate(-2 -2)"/><path id="Shape-3" data-name="Shape" class="cls-2" d="M23.3,16.23a6.19,6.19,0,0,0-1.81-4.39.71.71,0,1,0-1,1,4.81,4.81,0,0,1,0,6.79.71.71,0,1,0,1,1,6.19,6.19,0,0,0,1.81-4.39Z" transform="translate(-2 -2)"/></g></g></g></g></svg>'
,HIVI_VOLUME_OFF:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 8.007H1.347C.333 8.007 0 8.769 0 9.391v5.032C0 15.045.333 16 1.347 16H6l5.007 5.796c.215.132.454.205.693.205.24 0 .436-.063.65-.196.429-.265.65-.75.65-1.28V3.447c0-.53-.221-1.02-.65-1.284-.429-.265-.935-.187-1.365.078L6 8.007zM20.305 12l2.425-2.425a.922.922 0 1 0-1.306-1.305l-2.425 2.424-2.423-2.424a.923.923 0 0 0-1.306 1.305L17.695 12l-2.425 2.425a.922.922 0 1 0 1.306 1.304L19 13.306l2.425 2.423a.92.92 0 0 0 1.306 0 .922.922 0 0 0 0-1.304L20.305 12z" fill-rule="evenodd"></path></svg>',HIVI_VOLUME_ON:
'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="M6 8.007H1.347C.333 8.007 0 8.769 0 9.391v5.032C0 15.045.333 16 1.347 16H6l5.007 5.796c.215.132.454.205.693.205.24 0 .436-.063.65-.196.429-.265.65-.75.65-1.28V3.447c0-.53-.221-1.02-.65-1.284-.429-.265-.935-.187-1.365.078L6 8.007zm11.612 8.524a5.858 5.858 0 0 0 0-8.253.944.944 0 0 0-1.337 1.332 3.97 3.97 0 0 1 0 5.59.943.943 0 1 0 1.337 1.331z"></path><path d="M23.03 12.135c0-2.21-.859-4.292-2.418-5.857a.943.943 0 1 0-1.337 1.332 6.37 6.37 0 0 1 1.868 4.525 6.37 6.37 0 0 1-1.868 4.525.943.943 0 1 0 1.338 1.332 8.249 8.249 0 0 0 2.418-5.857z"></path></g></svg>'}},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div"),i=(0,o.createIcon)(o.icons.PAUSE,["play-off-icon","porvata-icon","porvata-off-icon"]),a=(0,o.createIcon)(o.icons.PLAY,["play-on-icon","porvata-icon","porvata-on-icon"]);n.appendChild(a),n.appendChild(i),n.className=
"play-pause-button porvata-switchable-icon",n.addEventListener("click",function(){e.isPaused()?e.resume():e.pause()}),e.addEventListener("pause",function(){n.classList.remove("is-on")}),e.addEventListener("resume",function(){n.classList.add("is-on")}),e.addEventListener("start",function(){n.classList.add("is-on")}),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3);t.default={add:i}},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div");n.classList.add("pause-overlay"),n.addEventListener("click",function(){e.isPaused()?e.resume():e.pause()}),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default={add:i}},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div"),i=document.createElement("div");n.classList.add("progress-bar"),i.classList.add("current-time"),n.appendChild(i),n.pause=function(){i.style.width=i.offsetWidth/n.offsetWidth*100+"%"},n.reset=function(){i.style.transitionDuration="",i
.style.width="0"},n.start=function(){var t=e.getRemainingTime();t?(i.style.transitionDuration=t+"s",a.default.forceRepaint(i),i.style.width="100%"):i.style.width="0"},e.addEventListener("wikiaAdPlay",n.start),e.addEventListener("wikiaAdCompleted",n.reset),e.addEventListener("wikiaAdPause",n.pause),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default={add:i}},function(e,t,n){"use strict";function i(e,t,n){var i=document.createElement("div");i.classList.add(l),i.addEventListener("click",function(){return e.play()}),n.autoPlay||o(i,n),e.addEventListener("wikiaAdCompleted",function(){o(i,n)}),e.params.theme&&"hivi"===e.params.theme?(r(i),t=e.params.thumbnail,t.appendChild(i)):t.parentElement.insertBefore(i,t)}function o(e,t){t.container.classList.contains("theme-hivi")||(e.style.width=e.style.width||a(t)),e.style.display="block"}function a(e){var t=e.container.offsetWidth;return 100*e.hideWhenPlaying.
offsetWidth/t+"%"}function r(e){var t=(0,s.createIcon)(s.icons.REPLAY,["replay-icon"]);e.appendChild(t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),l="replay-overlay";t.default={add:i}},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("div"),i=(0,o.createIcon)(o.icons.FULLSCREEN_OFF,["fullscreen-off-icon","porvata-icon","porvata-off-icon"]),a=(0,o.createIcon)(o.icons.FULLSCREEN_ON,["fullscreen-on-icon","porvata-icon","porvata-on-icon"]);n.appendChild(i),n.appendChild(a),n.className="toggle-fullscreen-button porvata-switchable-icon",n.addEventListener("click",function(){e.toggleFullscreen()}),e.addEventListener("wikiaFullscreenChange",function(){e.isFullscreen()?n.classList.add("is-on"):n.classList.remove("is-on")}),e.addEventListener("wikiaAdStop",function(){e.isFullscreen()&&e.toggleFullscreen()}),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3);t.default={add:i}},function(e,t,n){"use strict";function i(e,t,n){e.
addEventListener("wikiaAdStarted",function(){n.thumbnail.classList.add("hidden-state")}),e.addEventListener("wikiaAdCompleted",function(){n.thumbnail.classList.remove("hidden-state")})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={add:i}},function(e,t,n){"use strict";function i(e,t,n){var i=null,a=e.container.parentNode.classList.contains("theme-mobile-device"),r=document.createElement("div"),s=function(){i=setTimeout(function(){e.isPlaying()&&e.container.classList.remove("ui-visible")},o)};r.classList.add("toggle-ui-overlay"),a?(r.addEventListener("click",function(){e.container.classList.toggle("ui-visible"),clearTimeout(i),s()}),e.addEventListener("resume",s)):(e.container.addEventListener("mouseenter",function(){e.container.classList.add("ui-visible")}),e.container.addEventListener("mouseleave",function(){e.container.classList.remove("ui-visible")}),r.addEventListener("click",function(){top.open(n.clickThroughURL,"_blank")})),t.appendChild(r)}Object.defineProperty(t,
"__esModule",{value:!0});var o=5e3;t.default={add:i}},function(e,t,n){"use strict";function i(e,t){e.addEventListener("wikiaAdStarted",function(){t.classList.remove("hide")}),e.addEventListener("wikiaAdCompleted",function(){t.classList.add("hide")})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={add:i}},function(e,t,n){"use strict";function i(e){var t="hivi"===e.theme?"HIVI_":"",n=document.createElement("div"),i=(0,r.createIcon)(r.icons[t+"VOLUME_OFF"],["volume-off-icon","porvata-icon","porvata-off-icon"]),o=(0,r.createIcon)(r.icons[t+"VOLUME_ON"],["volume-on-icon","porvata-icon","porvata-on-icon"]);return n.className="volume-button porvata-switchable-icon hidden",n.appendChild(i),n.appendChild(o),n}function o(e,t){e.isMuted()||e.isMobilePlayerMuted()?t.classList.add("is-on"):t.classList.remove("is-on")}function a(e,t){var n=i(e.params);e.addEventListener("wikiaVolumeChange",function(){o(e,n)}),e.addEventListener("wikiaAdStarted",function(){o(e,n),n.classList.remove(
"hidden")}),n.addEventListener("click",function(t){e.volumeToggle(),t.preventDefault()}),t.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default={add:a}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t,n){i(this,e),this.uiElements=n,this.className=t,this.panelContainer=null}return o(e,[{key:"add",value:function(e,t,n){var i=this;this.panelContainer=document.createElement("div"),this.panelContainer.className=this.className,this.uiElements.forEach(function(t){t&&t.add(e,i.panelContainer,n)}),t.appendChild(this.panelContainer)}}]),e}();t.default=a},function(e,t,n){
"use strict";function i(e,t,n){t.forEach(function(t){t&&t.add(e,e.container,n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.setup=i},function(e,t,n){"use strict";function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(i,o){e&&"function"==typeof e.addEventListener||o("EventTarget does not have addEventListener method"),"boolean"==typeof n&&(n={capture:n}),e.addEventListener(t,i,Object.assign({},n,{once:!0}))})}Object.defineProperty(t,"__esModule",{value:!0}),t.once=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){return f+"_"+d.default.getUapId()}function a(){return u.default.get(o())}function r(){var e=a();return!!e&&h.getTime()!==e.lastSeenDate}function s(){u.default.set(o(),{adId:d.default.getUapId(),lastSeenDate:h.getTime()},T)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(65),u=i(l),c=n(7),d=i(c),f="adEngine_resolvedStateCounter",T=86400,h=new Date;t.default={
updateInformationAboutSeenDefaultStateAd:s,wasDefaultStateSeen:r}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),r=void 0,s=function(){function e(){i(this,e)}return o(e,null,[{key:"canUseStorage",value:function(){if(void 0===r&&(r=!1,window.localStorage))try{window.localStorage.setItem("test","1"),window.localStorage.removeItem("test"),r=!0}catch(t){try{e.createPolyfill(),r=!0}catch(e){(0,a.logger)("local-cache","Local Storage polyfill error: ",e)}}return r}},{key:"createPolyfill",value:function(){(0,a.logger)("local-cache","Local Storage polyfill being created"),Storage.prototype.data={},Storage.prototype.
setItem=function(e,t){this.data[e]=String(t)},Storage.prototype.getItem=function(e){return this.data[e]?this.data[e]:null},Storage.prototype.removeItem=function(e){delete this.data[e]},Storage.prototype.clear=function(){this.data={}}}},{key:"get",value:function(t){if(!e.canUseStorage())return!1;var n=window.localStorage.getItem(t);return!!n&&(n=JSON.parse(n),e.isExpired(n)?(e.delete(t),!1):n.data)}},{key:"set",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.canUseStorage()||!e.isStorable(n))return!1;var o={data:n},a=parseInt(i,10);isNaN(a)||(o.expires=1e3*a+Date.now());try{window.localStorage.setItem(t,JSON.stringify(o))}catch(e){return!1}return!0}},{key:"delete",value:function(t){e.canUseStorage()&&window.localStorage.removeItem(t)}},{key:"isStorable",value:function(e){return!("function"==typeof e||"number"==typeof e&&isNaN(e)||void 0===e)}},{key:"isExpired",value:function(e){return e.expires&&Date.now()>=parseInt(e.expires,10)}}]),e}();t.
default=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BfabTheme=t.BfaaTheme=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(17),l=function(e){return e&&e.__esModule?e:{default:e}}
(s),u=n(21);t.BfaaTheme=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),r(t,[{key:"onVideoReady",value:function(e){var t=this;this.params.splitLayoutVideoPosition||(e.addEventListener("wikiaAdStarted",function(){t.recalculatePaddingTop(t.params.videoAspectRatio)}),e.addEventListener("wikiaAdCompleted",function(){t.recalculatePaddingTop(t.params.aspectRatio)}))}},{key:"recalculatePaddingTop",value:function(e){var t=this;document.body.style.paddingTop=100/e+"%",this.container.style.height=this.container.offsetHeight+"px",this.container.style.height=this.container.offsetWidth/e+"px",setTimeout(function(){t.container.style.height=""},l.default.duration)}}]),t}(u.BigFancyAdTheme),t.BfabTheme=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(u.BigFancyAdTheme)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:
e}}function o(e){var t=e.adSlot,n=e.params,i=e.videoSettings;return l.default.setImage(i).then(function(){return r.default.makeResponsive(t,n.aspectRatio)})}Object.defineProperty(t,"__esModule",{value:!0}),t.adIsReady=o;var a=n(1),r=i(a),s=n(19),l=i(s)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BfabTheme=t.BfaaTheme=void 0;var s=function
(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),u=i(l),c=n(5),d=i(c),f=n(1),T=i(f),h=n(69),b=i(h),p=n(70),v=i(p),S=n(21),g=n(72),m=i(g);t.BfaaTheme=function(e){function t(e,n){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.stickyBfaa=null,i.video=null,i.config=u.default.get("templates.bfaa"),i.addAdvertisementLabel(),i.params.isSticky&&(i.stickyBfaa=new m.default(i.adSlot,i.config),i.addUnstickButton(),i.stickyBfaa.run()),i}return r(t,e),s(t,[{key:"addAdvertisementLabel",value:function(){var e=new b.default;this.container.appendChild(e.render())}},{key:"addUnstickButton",value:function(){var e=this,t=new v.default({classNames:["button-unstick"],onClick:function(){return e.stickyBfaa.revertStickiness()}});this.container.appendChild(t.render())}},{key:
"onAdReady",value:function(){var e=this;d.default.addCallback(function(){return e.updateOnScroll()}),this.updateOnScroll()}},{key:"onVideoReady",value:function(e){var t=this;this.video=e,e.addEventListener("wikiaAdStarted",function(){return t.updateOnScroll()})}},{key:"updateOnScroll",value:function(){var e=this,t=this.container,n=this.params.config,i=document.body.offsetWidth,o=!this.params.image2.element.classList.contains("hidden-state"),a=t.classList.contains("sticky-bfaa"),r=i/n.aspectRatio.default,s=i/n.aspectRatio.resolved,l=Math.max(s,r-window.scrollY),u=i/l,c=n.aspectRatio.default-n.aspectRatio.resolved,d=n.aspectRatio.default-u,f=1-(c-d)/c,h=n.state.height.default-n.state.height.resolved,b=(n.state.height.default-h*f)/100;Object.keys(n.state).forEach(function(t){n.state[t]&&e.handleProperty(n,f,t)}),this.video&&!this.video.isFullscreen()&&(this.video.container.style.width=this.params.videoAspectRatio*(l*b)+"px"),f>=.995&&!o?(this.container.classList.add("theme-resolved"),this
.params.image2.element.classList.remove("hidden-state")):f<.995&&o&&(this.container.classList.remove("theme-resolved"),this.params.image2.element.classList.add("hidden-state")),T.default.makeResponsive(this.adSlot,u),a||(this.adSlot.getElement().style.top=r-l+"px")}},{key:"handleProperty",value:function(e,t,n){if(e.state[n]){var i=e.state[n].default-e.state[n].resolved,o=e.state[n].default-i*t+"%";this.params.thumbnail.style[n]=o,this.video&&(this.video.container.style[n]=o)}}}]),t}(S.BigFancyAdTheme),t.BfabTheme=function(e){function t(e,n){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.addAdvertisementLabel(),i}return r(t,e),s(t,[{key:"addAdvertisementLabel",value:function(){var e=new b.default;this.container.appendChild(e.render())}}]),t}(S.BigFancyAdTheme)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError(
"this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(9),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),r(t,[{key:"render",value:function(){var e=document.createElement("div");return e.
innerText="Advertisement",e.className="advertisement-label",e}}]),t}(l.default);t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i
.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)},c=n(71),d=i(c),f=n(9),T=i(f),h=n(3),b=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=this.props.onClick,t=this.classNames,n=new d.default({onClick:e,classNames:t}).render(),i=(0,h.createIcon)(h.icons.CROSS,["icon"]);return n.appendChild(i),n}},{key:"classNames",get:function(){return["button-close"].concat(o(u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"classNames",this)))}}]),t}(T.default);t.default=b},function(e,t,n){"use strict";function i(e){if(
Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===
t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)},u=n(9),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),s(t,[{key:"render",value:function(){var e=this,t=document.createElement("button");return this.classNames.forEach(function(e){return t.classList.add(e)}),t.addEventListener("click",function(t){return e.onClick(t)}),t}},{key:"onClick",value:function(e){var t=this.props.onClick;if("function"==typeof t)return t(e)}},{key:"classNames",get:function(){return["button-control"].concat(i(l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"classNames",this)))}}]),t}(c.default);t.default=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError(
"Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(1),r=function(e){return e&&e.__esModule?e:{default:e}}(a),s=n(13),l=n(2),u=function(){function e(t,n){i(this,e),this.adSlot=t,this.config=n,this.onViewed=this.onViewed.bind(this),this.isSticky=!1,this.logger=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return l.logger.apply(void 0,[e.LOG_GROUP].concat(n))}}return o(e,[{key:"run",value:function(){var e=this;r.default.onReady(this.adSlot).then(function(){document.hidden?window.addEventListener("visibilitychange",function(){return e.onAdReady()},{once:!0}):e.onAdReady()})}},{key:"applyStickiness",value:function(){this.isSticky?this.logger(
"bfaa stickiness is already applied"):(this.logger("Applying bfaa stickiness"),this.isSticky=!0,this.config.onStickBfaaCallback(this.adSlot))}},{key:"revertStickiness",value:function(){this.isSticky?(this.logger("Reverting bfaa stickiness"),this.isSticky=!1,this.config.onUnstickBfaaCallback(this.adSlot)):this.logger("bfaa stickiness is already reverted")}},{key:"onViewed",value:function(){var t=this,n=null,i=this.adSlot.getElement(),o=Math.abs(window.scrollY-i.offsetTop)<i.offsetHeight/2,a=function e(){clearTimeout(n),document.removeEventListener("scroll",e),t.revertStickiness()};this.adSlot.removeListener(s.SLOT_VIEWED_EVENT,this.onViewed),document.addEventListener("scroll",a),n=setTimeout(a,o?0:e.STICKINESS_REMOVAL_WINDOW),this.logger("slotViewed triggered on "+this.adSlot.getSlotName())}},{key:"onAdReady",value:function(){this.applyStickiness(),this.adSlot.once(s.SLOT_VIEWED_EVENT,this.onViewed)}}]),e}();t.default=u,Object.assign(u,{STICKINESS_REMOVAL_WINDOW:1e4,LOG_GROUP:
"sticky-bfaa"})},function(e,t,n){"use strict";function i(e){var t=e.adSlot,n=e.params;return a.default.makeResponsive(t,n.aspectRatio)}Object.defineProperty(t,"__esModule",{value:!0}),t.adIsReady=i;var o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,n){"use strict";function i(e,t){var n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),i=t?n/t:e.contentWindow.document.body.offsetHeight;l.setSiteHeadOffset(i)}function o(e,t,n){var o=function(t){i(e,t)},a=document.getElementsByClassName("application-wrapper")[0];l=window.Mercury.Modules.Ads.getInstance(),a.classList.add("bfaa-template"),i(e,t.aspectRatio),window.addEventListener("resize",o.bind(null,t.aspectRatio)),n&&n.onPageChange(function(){a.classList.remove("bfaa-template"),document.body.classList.remove("vuap-loaded"),document.body.classList.remove("has-bfaa"),document.body.style.paddingTop="",l.setSiteHeadOffset(0),window.removeEventListener("resize",o)})}function a(e){return{
slotsToEnable:["MOBILE_IN_CONTENT","MOBILE_PREFOOTER","MOBILE_BOTTOM_LEADERBOARD"],onInit:function(t,n){s.default.onReady(t).then(function(t){return o(t,n,e)})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getConfig=a;var r=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=void 0},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){return{slotsToEnable:["BOTTOM_LEADERBOARD","INCONTENT_BOXAD_1"],onInit:function(e,t){l.default.onReady(e).then(function(){(0,c.default)(t.config)}),r.default.addCallback(function(){(0,c.default)(t.config)})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getConfig=o;var a=n(5),r=i(a),s=n(1),l=i(s),u=n(76),c=i(u)},function(e,t,n){"use strict";function i(e){o(e)?s.classList.add(r):s.classList.remove(r)}function o(e){var t=window.scrollY||window.pageYOffset;return e&&e.aspectRatio?t<=document.body.offsetWidth/e.aspectRatio.default:t<=a.offsetHeight}Object.defineProperty(t,"__esModule",{value:!0});
var a=document.getElementById("TOP_LEADERBOARD"),r="bfaa-pinned",s=document.getElementById("globalNavigation");t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={adUnitId:"/{custom.dfpId}/wka.{targeting.s0}/{targeting.s1}//{targeting.s2}/{src}/{slotName}",custom:{dfpId:"5441"},events:{},slots:{},vast:{adUnitId:"/{custom.dfpId}/wka.{targeting.s0}/{targeting.s1}//{targeting.s2}/{src}/{slotName}",megaAdUnitId:"/{custom.dfpId}/{src}.{slotConfig.slotGroup}/{slotConfig.lowerSlotName}/{custom.device}/{targeting.skin}-{targeting.s2}/{targeting.s1}-{targeting.s0}"},targeting:{outstream:"none",uap:"none"},state:{adStack:window.adsQueue||[],isMobile:!1},options:{customAdLoader:{globalMethodName:"loadCustomAd"},video:{moatTracking:{enabled:!1,partnerCode:"wikiaimajsint377461931603",sampling:0}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={oasis:{TOP_LEADERBOARD:{disabled:!1,slotName:"TOP_LEADERBOARD",
lowerSlotName:"top_leaderboard",slotGroup:"LB",sizes:[{viewportSize:[728,0],sizes:[[3,3],[728,90],[1030,130],[1030,65],[1030,250],[970,365],[970,250],[970,90],[970,66],[970,180],[980,150],[1024,416],[1440,585]]}],defaultSizes:[[2,2]],targeting:{pos:"TOP_LEADERBOARD",loc:"top"}},BOTTOM_LEADERBOARD:{disabled:!0,slotName:"BOTTOM_LEADERBOARD",lowerSlotName:"bottom_leaderboard",slotGroup:"PF",sizes:[{viewportSize:[728,0],sizes:[[728,90],[970,250]]}],defaultSizes:[[2,2]],targeting:{pos:"BOTTOM_LEADERBOARD",loc:"footer"}}},mercury:{MOBILE_BOTTOM_LEADERBOARD:{disabled:!0,slotName:"MOBILE_BOTTOM_LEADERBOARD",lowerSlotName:"mobile_bottom_leaderboard",slotGroup:"PF",sizes:[{viewportSize:[0,0],sizes:[[320,480]]}],defaultSizes:[[2,2]],targeting:{pos:"MOBILE_BOTTOM_LEADERBOARD",loc:"footer"}},MOBILE_TOP_LEADERBOARD:{disabled:!1,slotName:"MOBILE_TOP_LEADERBOARD",lowerSlotName:"mobile_top_leaderboard",slotGroup:"TLB",sizes:[{viewportSize:[0,0],sizes:[[320,480]]}],defaultSizes:[[2,2]],targeting:{pos:
"MOBILE_TOP_LEADERBOARD",loc:"top"}}}}}])});;

(function(w,d,s,p,v,e,r){w['$igniter_var']=v;w[v]=w[v]||function(){(w[v].q=w[v].q||[]).push(arguments)};w[v].l=1*new Date();e=d.createElement(s),r=d.getElementsByTagName(s)[0];e.async=1;e.src=p+'?ts='+(+new Date()/3600000|0);r.parentNode.insertBefore(e,r)})(window,document,'script','//cdn.petametrics.com/l9ehhrb6mtv75bp2.js','$p');function getLiftIgniterGlobalContext(){var context={};if(window.ads&&window.ads.context&&window.ads.context.targeting){var targeting=window.ads.context.targeting;context={_wCategory:targeting.wikiCategory,_wName:targeting.wikiDbName,_wTop:targeting.wikiIsTop1000,_wikiLanguage:targeting.wikiLanguage,_wVert:targeting.wikiVertical,_pType:targeting.pageType,_pName:targeting.pageName};if(targeting.wikiCustomKeyValues){targeting.wikiCustomKeyValues.split(';').map(function(keyVal){return keyVal.split('=');}).forEach(function(parts){var key='_'+parts[0];if(!context[key]){context[key]=[parts[1]];}else{context[key].push(parts[1]);}})}}if(localStorage.kxallsegs){context
['_kruxTags']=localStorage.kxallsegs.split(',');}return context;}$p("init","l9ehhrb6mtv75bp2",{config:{globalCtx:getLiftIgniterGlobalContext()}});$p("send","pageview");$p("setRequestFields",["rank","thumbnail","title","url","presented_by","author","site_name","type"]);;

define('ext.wikia.recirculation.tracker',['wikia.tracker','wikia.abTest'],function(tracker,abTest){'use strict';function trackClick(label){tracker.track({action:tracker.ACTIONS.CLICK,category:'recirculation',label:label,trackingMethod:'analytics'});}function trackImpression(label){tracker.track({action:tracker.ACTIONS.IMPRESSION,category:'recirculation',label:label,trackingMethod:'analytics'});}return{trackImpression:trackImpression,trackClick:trackClick};});;define('ext.wikia.recirculation.utils',['jquery','wikia.loader','wikia.cache','wikia.mustache'],function($,loader,cache,Mustache){'use strict';var fandomHeartSvg='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">'+
'<path d="M12.77.13L9.44 3.5a.66.66 0 0 1-.94 0L5.16.17a.44.44 0 0 0-.63 0L.24 4.4a.77.77 0 0 0-.24.55V9a.77.77 0 0 0 .23.55l8.37 8.37a.44.44 0 0 0 .63 0L17.6 9.5a.77.77 0 0 0 .23-.5V5a.77.77 0 0 0-.22-.54L13.4.13a.44.44 0 0 0-.63 0zm-2.66 4.94a.22.22 0 0 1 0-.3L12 2.88a1.65 1.65 0 0 1 1.41-.47 1.73 1.73 0 0 1 1 .51l1.91 1.91a.22.22 0 0 1 0 .3L13.39 8a.22.22 0 0 1-.3 0zm1 5.24l-1.8 1.8a.22.22 0 0 1-.3 0l-6-6A1.66 1.66 0 0 1 3 3.73l1.8-1.8a.22.22 0 0 1 .3 0l6 6a1.66 1.66 0 0 1 .01 2.38zm5.37-3.11v1.29a.57.57 0 0 1-.16.4l-6.89 7a.51.51 0 0 1-.38.17.54.54 0 0 1-.4-.17l-.49-.46a.22.22 0 0 1 0-.31l8-8a.22.22 0 0 1 .33.09zm-8.63 6a.75.75 0 0 1-.2.54l-.39.36a.33.33 0 0 1-.45 0L1.56 8.92a.69.69 0 0 1-.21-.49v-1A.39.39 0 0 1 2 7.18l5.57 5.5a.81.81 0 0 1 .28.54z"/>'+'</svg>';function loadTemplate(templateName){var dfd=new $.Deferred(),templateLocation='extensions/wikia/Recirculation/templates/'+templateName,cacheKey='RecirculationAssets_'+templateLocation,template=cache.getVersioned(cacheKey);if
(!templateName){return dfd.reject('Invalid template name');}if(template){dfd.resolve(template);}else{loader({type:loader.MULTI,resources:{mustache:templateLocation}}).done(function(data){template=data.mustache[0];dfd.resolve(template);cache.setVersioned(cacheKey,template,86400);});}return dfd.promise();}function loadTemplates(templatesNames){var dfd=new $.Deferred(),templatePath='extensions/wikia/Recirculation/templates/',templateLocations=templatesNames.map(function(templatesName){return templatePath+templatesName;});loader({type:loader.MULTI,resources:{mustache:templateLocations.join(',')}}).done(function(data){dfd.resolve(data.mustache);});return dfd.promise();}function renderTemplate(template,data){return $(Mustache.render(template,data));}function renderTemplateByName(templateName,data){return loadTemplate(templateName).then(function(template){return $(Mustache.render(template,data));});}function buildLabel(element,label){var $parent=$(element).parent(),slot=$parent.data('index')+
1,source=$parent.data('source')||'undefined',isVideo=$parent.hasClass('is-video')?'video':'not-video',parts=[label,'slot-'+slot,source,isVideo];return parts.join('=');}function waitForRail(){var $rail=$('#WikiaRail'),deferred=$.Deferred(),args=Array.prototype.slice.call(arguments);if($rail.find('.loading').exists()){$rail.one('afterLoad.rail',function(){deferred.resolve.apply(null,args);});}else{deferred.resolve.apply(null,args);}return deferred.promise();}return{buildLabel:buildLabel,loadTemplates:loadTemplates,renderTemplate:renderTemplate,renderTemplateByName:renderTemplateByName,waitForRail:waitForRail,fandomHeartSvg:fandomHeartSvg};});;define('ext.wikia.recirculation.helpers.fandom',['jquery','wikia.window','wikia.abTest','wikia.nirvana'],function($,w,abTest,nirvana){'use strict';return function(config){var defaults={limit:3,type:'recent_popular',ignoreError:!1,fill:!1},options=$.extend({},defaults,config);function loadData(){var deferred=$.Deferred();nirvana.sendRequest({
controller:'RecirculationApi',method:'getFandomPosts',format:'json',type:'get',scriptPath:w.wgCdnApiUrl,data:{type:options.type,cityId:w.wgCityId,limit:options.limit,fill:options.fill},callback:function(data){data=formatData(data);if(data.items&&data.items.length>=options.limit){deferred.resolve(data);}else{if(options.ignoreError){deferred.resolve({title:data.title,items:[]});}else{deferred.reject('Recirc widget not shown. Not enough items returned from Fandom API');}}}});return deferred.promise();}function formatData(data){var items=[];$.each(data.posts,function(index,item){if(items.length<options.limit){item.thumbnail=item.image_url||item.thumbnail;item.index=index;items.push(item);}});return{title:data.title,items:items.sort(sortItem)};}function sortItem(a,b){if(a.type==='recent_popular'&&b.type!=='recent_popular'){return 1;}if(b.type==='recent_popular'&&a.type!=='recent_popular'){return-1;}return b.isVideo-a.isVideo;}return{loadData:loadData};};});;define(
'ext.wikia.recirculation.helpers.discussions',['jquery','wikia.window','wikia.abTest','wikia.nirvana'],function($,w,abTest,nirvana){'use strict';var deferred=$.Deferred();function prepare(){return deferred.promise();}function fetch(){nirvana.sendRequest({controller:'Recirculation',method:'discussions',format:'html',type:'get',data:{cityId:w.wgCityId,latest:!0,limit:10,ignoreWgEnableRecirculationDiscussions:!0},callback:function(response){deferred.resolve(response);}});}return{prepare:prepare,fetch:fetch};});;define('ext.wikia.recirculation.helpers.curatedContent',['jquery','underscore','wikia.window','wikia.nirvana','wikia.cache','ext.wikia.recirculation.tracker'],function($,_,w,nirvana,cache,tracker){'use strict';return function(config){var defaults={limit:1},options=$.extend({},defaults,config);function loadData(){var deferred=$.Deferred();nirvana.sendRequest({controller:'RecirculationApi',method:'getFandomPosts',format:'json',type:'get',scriptPath:w.wgCdnApiUrl,data:{type:
'curated'},callback:function(data){data=formatData(data);if(data&&data.length>0){deferred.resolve(data);}else{deferred.reject();}},onErrorCallback:function(){deferred.reject();}});return deferred.promise();}function formatData(data){var items=[];var posts=_.shuffle(data.posts);$.each(posts,function(index,item){if(items.length<options.limit&&!hasSeen(item)){items.push(item);}});return items;}function hasSeen(post){return cache.get(key(post));}function setSeen(post){return cache.set(key(post),true,cache.CACHE_STANDARD);}function key(post){return'recirculation:curated:'+post.id;}function injectContent(data){var deferred=$.Deferred();loadData().then(function(curatedPosts){var randomIndex=Math.floor(Math.random()*data.items.length);data.items.splice(randomIndex,1,curatedPosts[0]);data.items.map(function(item,index){item.index=index;return item;});setSeen(curatedPosts[0]);deferred.resolve(data);}).fail(function(){deferred.resolve(data);});return deferred.promise();}function setupTracking(
$html){var $curatedItem=$html.find('.item-curated'),label,slot,id;if($curatedItem.length){id=$curatedItem.data('id');slot=$curatedItem.data('index')+1;label='CURATED='+id+'=slot_'+slot;tracker.trackImpression(label);$curatedItem.on('mousedown','a',function(){tracker.trackClick(label);});}return $html;}return{injectContent:injectContent,setupTracking:setupTracking,loadData:loadData};};});;define('ext.wikia.recirculation.helpers.liftigniter',['jquery','wikia.window','wikia.thumbnailer'],function($,w,thumbnailer){'use strict';var willFetch={},fetchQueue=[],fetching=!1;var prepare=function(options){var deferred=$.Deferred(),registerOptions={max:options.max,widget:options.widget,callback:function(response){resizeThumbnails(response,options);deferred.resolve(response);fetching=!1;if(fetchQueue.length){setTimeout(function(){fetch(fetchQueue.shift());});}}};if(!w.$p){return deferred.reject('Liftigniter library not found').promise();}if(options.opts){registerOptions.opts=options.opts;}var
module={promise:deferred,options:registerOptions};if(willFetch[options.modelName]){willFetch[options.modelName].push(module)}else{willFetch[options.modelName]=[module];}return deferred.promise();};function resizeThumbnails(data,options){$.each(data.items,function(index,item){if(thumbnailer.isThumbUrl(item.thumbnail)){item.thumbnail=thumbnailer.getThumbURL(item.thumbnail,'image',options.width,options.height);}});}function fetch(modelName){if(willFetch[modelName]&&!fetching){willFetch[modelName].forEach(function(module){w.$p('register',module.options);});fetching=!0;w.$p('fetch');}else if(fetching){fetchQueue.push(modelName);}}function setupTracking(itemsSelector,options){var elements=$(itemsSelector).get(),trackOptions={elements:elements,name:options.widget,source:'LI',};if(options.opts){trackOptions.opts=options.opts}w.$p('track',trackOptions);}return{prepare:prepare,fetch:fetch,setupTracking:setupTracking};});;define('ext.wikia.recirculation.views.premiumRail',['jquery',
'wikia.window','wikia.abTest','ext.wikia.recirculation.tracker','ext.wikia.recirculation.utils','ext.wikia.recirculation.helpers.curatedContent'],function($,w,abTest,tracker,utils,CuratedHelper){'use strict';var options={};function render(data){var curated=new CuratedHelper();return curated.injectContent(data).then(renderTemplate('client/premiumRail.mustache')).then(utils.waitForRail).then(function($html){var $recirculationRail=$('#recirculation-rail');if(options.before){$html=options.before($html);}$recirculationRail.html($html);curated.setupTracking($html);$recirculationRail.trigger('premiumRecirculationRail.ready');return $html;});}function renderTemplate(templateName){return function(data){data.title=data.title||$.msg('recirculation-fandom-title');data.items=data.items.slice(0,5);data.fandomHeartSvg=utils.fandomHeartSvg;return utils.renderTemplateByName(templateName,data);};}function setupTracking(){return function($html){$html.on('mousedown','a',function(){tracker.trackClick(utils
.buildLabel(this,'rail'));});return $html;};}return function(config){$.extend(options,config);return{render:render,setupTracking:setupTracking,itemsSelector:'.premium-recirculation-rail .item'};};});;define('ext.wikia.recirculation.views.mixedFooter',['jquery','wikia.window','wikia.tracker','ext.wikia.recirculation.utils','ext.wikia.recirculation.plista'],function($,w,tracker,utils,plista){'use strict';var track=tracker.buildTrackingFunction({category:'mixed-content-footer',trackingMethod:'analytics'}),$mixedContentFooter=$('#mixed-content-footer');function render(data){var newsAndStoriesList=data.nsItems?data.nsItems.items:[],wikiArticlesList=data.wikiItems.items,templateList=getTemplateList(newsAndStoriesList),templates={},$discussions=$(data.discussions);$('.mcf-discussions-placeholder').replaceWith($discussions);$discussions.find('.discussion-timestamp').timeago();return utils.loadTemplates(templateList).then(function(data){templateList.forEach(function(templateName,index){
templates[templateName]=data[index];});}).then(plista.prepareData(wikiArticlesList)).then(function(){injectTemplates(templates,newsAndStoriesList,wikiArticlesList);setupTracking();})}function injectTemplates(templates,newsAndStoriesList,wikiArticlesList){var $newsAndStoriesHook=$('.mcf-card-ns-placeholder'),$wikiArticleHook=$('.mcf-card-wiki-placeholder');$.each($newsAndStoriesHook,function(index){var $this=$(this),template=templates['client/Recirculation_article.mustache'],newsAndStoriesItem=newsAndStoriesList[index],type;if(newsAndStoriesItem){type=newsAndStoriesItem.type;newsAndStoriesItem.shortTitle=newsAndStoriesItem.title;if(type==='topic'){template=templates['client/Recirculation_topic.mustache'];newsAndStoriesItem.buttonLabel=$.msg('recirculation-explore');}else if(type==='storyStream'){template=templates['client/Recirculation_storyStream.mustache'];newsAndStoriesItem.buttonLabel=$.msg('recirculation-explore-posts');}else if(type==='video'){newsAndStoriesItem.video=!0;}
newsAndStoriesItem.trackingLabels=$this.data('tracking')+','+type;newsAndStoriesItem.liType='ns';newsAndStoriesItem.classes=$this[0].className.replace('mcf-card-ns-placeholder','');$this.replaceWith(utils.renderTemplate(template,newsAndStoriesItem));}});$.each($wikiArticleHook,function(index){var $this=$(this),template=templates['client/Recirculation_article.mustache'],wikiArticle=wikiArticlesList[index];wikiArticle.shortTitle=wikiArticle.title;if(wikiArticle){if(!wikiArticle.thumbnail){wikiArticle.fandomHeartSvg=utils.fandomHeartSvg;}if(wikiArticle.title.length>90){wikiArticle.shortTitle=wikiArticle.title.substring(0,80)+'...';}wikiArticle.trackingLabels=$this.data('tracking')+',wiki-article';wikiArticle.classes=$this[0].className.replace('mcf-card-wiki-placeholder','');wikiArticle.liType='wiki';if(wikiArticle.type==='video'){wikiArticle.video=!0;}$this.replaceWith(utils.renderTemplate(template,wikiArticle));}});}function getTemplateList(newsAndStoriesArticles){var templateList=[
'client/Recirculation_article.mustache'],topicExist=!1,storyStreamExist=!1;newsAndStoriesArticles.forEach(function(article){if(article.type==='topic'&&!topicExist){templateList.push('client/Recirculation_topic.mustache');topicExist=!0;}else if(article.type==='storyStream'&&!storyStreamExist){templateList.push('client/Recirculation_storyStream.mustache');storyStreamExist=!0;}});return templateList;}function setupTracking(){track({action:tracker.ACTIONS.IMPRESSION});$mixedContentFooter.on('click','[data-tracking]',function(){var labels=$(this).data('tracking').split(',');labels.forEach(function(label){track({action:tracker.ACTIONS.CLICK,label:label});});});}return function(){return{render:render,nsItemsSelector:'#mixed-content-footer [data-li-type=ns]',wikiItemsSelector:'#mixed-content-footer [data-li-type=wiki]'};};});;require(['jquery','wikia.window','wikia.log','ext.wikia.recirculation.utils','ext.wikia.recirculation.views.mixedFooter',
'ext.wikia.recirculation.helpers.liftigniter','ext.wikia.recirculation.helpers.discussions','ext.wikia.recirculation.discussions',require.optional('videosmodule.controllers.rail')],function($,window,log,utils,mixedFooter,liftigniter,discussions,oldDiscussions,videosModule){'use strict';var $mixedContentFooter=$('#mixed-content-footer'),$mixedContentFooterContent=$('.mcf-content'),railRecirculation={max:5,widget:'wikia-rail',width:320,height:180,modelName:'ns',opts:{resultType:'cross-domain',domainType:'fandom.wikia.com'}},mixedContentFooter={nsItems:{max:$mixedContentFooter.data('number-of-ns-articles'),widget:'wikia-impactfooter',width:386,height:337,modelName:'ns',opts:{resultType:'cross-domain',domainType:'fandom.wikia.com'}},wikiItems:{max:$mixedContentFooter.data('number-of-wiki-articles'),widget:'wikia-footer-wiki-rec',width:386,height:337,modelName:'wiki',opts:{rule_language:window.wgContentLanguage}}};function prepareEnglishRecirculation(){liftigniter.prepare(railRecirculation)
.done(function(data){require(['ext.wikia.recirculation.views.premiumRail'],function(viewFactory){var view=viewFactory();view.render(data).then(view.setupTracking()).then(function(){liftigniter.setupTracking(view.itemsSelector,railRecirculation);});});});var mixedContentFooterData=[liftigniter.prepare(mixedContentFooter.nsItems),liftigniter.prepare(mixedContentFooter.wikiItems),discussions.prepare()];$.when.apply($,mixedContentFooterData).done(function(nsItems,wikiItems,discussions){$mixedContentFooterContent.show();require(['ext.wikia.recirculation.views.mixedFooter'],function(viewFactory){var view=viewFactory();view.render({nsItems:nsItems,wikiItems:wikiItems,discussions:discussions}).then(function(){liftigniter.setupTracking(view.nsItemsSelector,mixedContentFooter.nsItems);liftigniter.setupTracking(view.wikiItemsSelector,mixedContentFooter.wikiItems);});});});}function prepareInternationalRecirculation(){var mixedContentFooterData=[liftigniter.prepare(mixedContentFooter.wikiItems),
discussions.prepare()];$.when.apply($,mixedContentFooterData).done(function(wikiItems,discussions){$mixedContentFooterContent.show();require(['ext.wikia.recirculation.views.mixedFooter'],function(viewFactory){var view=viewFactory();view.render({wikiItems:wikiItems,discussions:discussions}).then(function(){liftigniter.setupTracking(view.wikiItemsSelector,mixedContentFooter.wikiItems);});});});}if(window.wgContentLanguage==='en'){prepareEnglishRecirculation();liftigniter.fetch('ns');}else{prepareInternationalRecirculation();if(videosModule){videosModule('#recirculation-rail');}}var lazyLoadHandler=$.throttle(50,function(){var mcfOffset=$mixedContentFooter.offset().top,scrollPosition=$(window).scrollTop(),windowInnerHeight=$(window).height(),lazyLoadOffset=500,aproachingMCF=scrollPosition>mcfOffset-windowInnerHeight-lazyLoadOffset;if(aproachingMCF){liftigniter.fetch('wiki');discussions.fetch();window.removeEventListener('scroll',lazyLoadHandler);}});window.addEventListener('scroll',
lazyLoadHandler);lazyLoadHandler();});;define('ext.wikia.recirculation.discussions',['jquery','wikia.window','wikia.abTest','wikia.nirvana','ext.wikia.recirculation.tracker'],function($,w,abTest,nirvana,tracker){'use strict';function injectDiscussions(){nirvana.sendRequest({controller:'Recirculation',method:'discussions',format:'html',type:'get',data:{cityId:w.wgCityId,limit:5},callback:function(response){var $WikiaArticleFooter=$('#WikiaArticleFooter'),$response=$(response);if($WikiaArticleFooter.length){$WikiaArticleFooter.before($response);}else{$('#WikiaMainContentContainer').append($response);}tracker.trackImpression('discussions');$response.find('.discussion-timestamp').timeago();$response.find('.discussion-thread').click(function(){var slot=$(this).index()+1,label='discussions-tile=slot-'+slot+'=discussions';tracker.trackClick(label);w.location=$(this).data('link');});$response.find('.discussion-link').mousedown(function(){tracker.trackClick('discussions-link');});}});}return injectDiscussions
;});;define('ext.wikia.recirculation.plista',['jquery'],function($){function shouldFetchPlista(items){var hasSponsoredContent=items.some(function(item){return item.presented_by;});return!hasSponsoredContent&&['AU','NZ'].indexOf(Geo.getCountryCode())>-1;}function fetchPlista(){return $.getJSON('https://farm.plista.com/recommendation/?publickey=845c651d11cf72a0f766713f&widgetname=api'+'&count=1&adcount=1&image[width]=320&image[height]=180').then(function(data){if(data[0]){return data[0];}else{return $.Deferred().reject('Plista returned no content');}});}function mapPlista(plistaData){return{source:'plista',thumbnail:plistaData.img,title:plistaData.title,url:plistaData.url,presented_by:'Plista',isPlista:!0}}function prepareData(renderData){return function(){var length=renderData.length;if(shouldFetchPlista(renderData)){return fetchPlista().then(mapPlista).then(function(data){renderData.splice(1,0,data);renderData=renderData.slice(0,length);},function(){return $.Deferred().resolve();});}
}}return{prepareData:prepareData}});;

(function(window,document){'use strict';var _kiq=[],createCookie,setABTestProperties;createCookie=function(cookieName){var cookieValue=cookieName+'=true;path=/;domain=',hostName=window.location.host,devDomainIndex=hostName.indexOf('wikia-dev');if(devDomainIndex>-1){cookieValue+='.'+hostName.substr(devDomainIndex);}else{cookieValue+='.wikia.com';}document.cookie=cookieValue;};setABTestProperties=function(){var ABTestPrefix='ABTest_',ABTestProperties={},isAnyABTestActive=!1;Wikia.AbTest.getExperiments().forEach(function(experiment){if(experiment.group){ABTestProperties[ABTestPrefix+experiment.name]=experiment.group.name;isAnyABTestActive=!0;}});if(isAnyABTestActive){_kiq.push(['set',ABTestProperties]);}};function loadQualaroo(){setTimeout(function(){var d=document,f=d.getElementsByTagName('script')[0],s=d.createElement('script');s.type='text/javascript';s.async=!0;s.src=window.wgQualarooUrl;f.parentNode.insertBefore(s,f);},1);}function setAdBlockEnabledAndLoadQualaroo(enabled){
_kiq.push(['set',{'adBlockEnabled':enabled}]);loadQualaroo();}if(window.wgUser){_kiq.push(['identify',window.wgUser]);}var dartGnreValues=window.dartGnreValues||[];_kiq.push(['set',{'userLanguage':window.wgUserLanguage,'contentLanguage':window.wgContentLanguage,'pageType':window.wikiaPageType,'isCorporatePage':(window.wikiaPageIsCorporate?'Yes':'No'),'verticalName':window.verticalName,'fullVerticalName':window.fullVerticalName,'visitorType':window.visitorType,'isPowerUserAdmin':!!window.wikiaIsPowerUserAdmin,'isPowerUserFrequent':!!window.wikiaIsPowerUserFrequent,'isPowerUserLifetime':!!window.wikiaIsPowerUserLifetime,'isLoggedIn':!!window.wgUserName,'cpBenefitsModalShown':document.cookie.indexOf('cpBenefitsModalShown')>-1,'isContributor':window.isContributor,'isCurrentWikiAdmin':window.isCurrentWikiAdmin,'isDartGnreAdventure':dartGnreValues.indexOf('adventure')>-1,'isDartGnreAction':dartGnreValues.indexOf('action')>-1,'isDartGnreFantasy':dartGnreValues.indexOf('fantasy')>-1,
'isDartGnreRpg':dartGnreValues.indexOf('rpg')>-1,'isDartGnreScifi':dartGnreValues.indexOf('scifi')>-1,'isDartGnreOpenworld':dartGnreValues.indexOf('openworld')>-1,'isDartGnreFighting':dartGnreValues.indexOf('fighting')>-1,'isDartGnreDrama':dartGnreValues.indexOf('drama')>-1,'isDartGnreCasual':dartGnreValues.indexOf('casual')>-1,'isDartGnreAnime':dartGnreValues.indexOf('anime')>-1,'isDartGnreShooter':dartGnreValues.indexOf('shooter')>-1,'isDartGnreCartoon':dartGnreValues.indexOf('cartoon')>-1,'isDartGnreComedy':dartGnreValues.indexOf('comedy')>-1,'isDartGnre3rdpersonshooter':dartGnreValues.indexOf('3rdpersonshooter')>-1,'isDartGnreFps':dartGnreValues.indexOf('fps')>-1,'isDartGnreHorror':dartGnreValues.indexOf('horror')>-1,'isDartGnreDriving':dartGnreValues.indexOf('driving')>-1,'isDartGnreSports':dartGnreValues.indexOf('sports')>-1}]);$('body').on('mousedown','form[id*="ki-"] > div[class*="ki-"]',function(){window._gaq.push(['_setSampleRate','100']);createCookie(
'qualaroo_survey_submission');});if(window.ads.context.opts.sourcePointDetection){if(!window.ads.runtime||!window.ads.runtime.sp||window.ads.runtime.sp.blocking===undefined){document.addEventListener('sp.blocking',function(){setAdBlockEnabledAndLoadQualaroo(true);});document.addEventListener('sp.not_blocking',function(){setAdBlockEnabledAndLoadQualaroo(false);});}else{setAdBlockEnabledAndLoadQualaroo(window.ads.runtime.sp.blocking);}}else{loadQualaroo();}setABTestProperties();window._kiq=_kiq;})(window,document);;